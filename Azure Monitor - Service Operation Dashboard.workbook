{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "![alt text](https://github.com/dshirdho/banner/blob/main/CloudOps-banner-small.png?raw=true)\r\n"
      },
      "customWidth": "100",
      "name": "text - 5"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "paragraph",
              "links": [
                {
                  "id": "0dbd7175-969f-4945-b346-5b6f6c8e46ec",
                  "cellValue": "selectedoption",
                  "linkTarget": "parameter",
                  "linkLabel": "Overview",
                  "subTarget": "overview",
                  "style": "primary"
                },
                {
                  "id": "57ce2c48-7b3e-4204-809e-0d7e985288e9",
                  "cellValue": "selectedoption",
                  "linkTarget": "parameter",
                  "linkLabel": "Compute",
                  "subTarget": "compute",
                  "preText": "",
                  "style": "primary"
                },
                {
                  "id": "6d587a23-8f5a-4554-9b5d-771719294720",
                  "cellValue": "selectedoption",
                  "linkTarget": "parameter",
                  "linkLabel": "Network",
                  "subTarget": "network",
                  "style": "primary"
                },
                {
                  "id": "716a5b8a-0c1b-43c1-bb1b-57f0a596bb2e",
                  "cellValue": "selectedoption",
                  "linkTarget": "parameter",
                  "linkLabel": "Storage",
                  "subTarget": "storage",
                  "style": "primary"
                },
                {
                  "id": "ffc4b9fc-8b7c-4b43-a6fc-5ac8ac62dda5",
                  "cellValue": "selectedoption",
                  "linkTarget": "parameter",
                  "linkLabel": "Database",
                  "subTarget": "database",
                  "style": "primary"
                },
                {
                  "id": "2cc0eae2-fa7b-4ae7-b5da-9e71ec702b3e",
                  "cellValue": "selectedoption",
                  "linkTarget": "parameter",
                  "linkLabel": "Backup",
                  "subTarget": "backup",
                  "style": "primary"
                },
                {
                  "id": "8240e492-7559-449c-a16e-8fac9993d60e",
                  "cellValue": "selectedoption",
                  "linkTarget": "parameter",
                  "linkLabel": "Patching",
                  "subTarget": "patching",
                  "style": "primary"
                },
                {
                  "id": "0053f2bd-f0ca-45ea-8f09-7b1b82a24083",
                  "cellValue": "selectedoption",
                  "linkTarget": "parameter",
                  "linkLabel": "Security",
                  "subTarget": "security",
                  "style": "primary"
                },
                {
                  "id": "d41b042d-93ec-4488-9db0-1e513f5e6add",
                  "cellValue": "selectedoption",
                  "linkTarget": "parameter",
                  "linkLabel": "Apps",
                  "subTarget": "applicationinsights",
                  "style": "primary"
                },
                {
                  "id": "f7ae02d5-1670-4112-919c-027208eab2b9",
                  "cellValue": "selectedoption",
                  "linkTarget": "parameter",
                  "linkLabel": "Alerts & Logs",
                  "subTarget": "events",
                  "style": "primary"
                },
                {
                  "id": "ad86f55e-71f0-4669-8275-3a091333c347",
                  "cellValue": "selectedoption",
                  "linkTarget": "parameter",
                  "linkLabel": "Governance",
                  "subTarget": "gorvernance",
                  "style": "primary"
                }
              ]
            },
            "name": "links - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "![alt text](https://gillianstravers.com/wp-content/uploads/2022/01/AzMonitor.png)\r\n"
                        },
                        "customWidth": "75",
                        "name": "text - 4"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Capgemini CloudOps - Service Operation Dashboard\r\n",
                          "style": "success"
                        },
                        "name": "text - 4 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions\"\r\n| summarize c = count()\r\n| extend Item = \"Subscriptions\",  Key = 1\r\n",
                          "size": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "value::all"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Item",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "c",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              }
                            },
                            "showBorder": false,
                            "size": "auto"
                          },
                          "textSettings": {
                            "style": "bignumber"
                          }
                        },
                        "customWidth": "33",
                        "name": "Subscription"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| summarize c = count()\r\n| extend Item = \"Resource Group\",  Key = 1\r\n",
                          "size": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "value::all"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Item",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "c",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              }
                            },
                            "showBorder": false,
                            "size": "auto"
                          },
                          "textSettings": {
                            "style": "bignumber"
                          }
                        },
                        "customWidth": "33",
                        "name": "Resource Group"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "Resources\r\n| summarize count()\r\n\r\n| extend Item = \"Resources\",  Key = 1\r\n",
                          "size": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "value::all"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Item",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              }
                            },
                            "showBorder": false,
                            "size": "auto"
                          },
                          "textSettings": {
                            "style": "bignumber"
                          }
                        },
                        "customWidth": "33",
                        "name": "Resources"
                      }
                    ]
                  },
                  "customWidth": "40",
                  "name": "Left"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "summarize count() by type\r\n| project type, total=count_\r\n| top 15 by total",
                    "size": 3,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "value::all"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "type",
                        "formatter": 16,
                        "formatOptions": {
                          "showIcon": true
                        }
                      },
                      "leftContent": {
                        "columnMatch": "total",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      },
                      "showBorder": true
                    },
                    "chartSettings": {
                      "seriesLabelSettings": [
                        {
                          "seriesName": "microsoft.compute/virtualmachines/extensions",
                          "label": "Extension"
                        },
                        {
                          "seriesName": "microsoft.compute/disks",
                          "label": "Disk"
                        },
                        {
                          "seriesName": "microsoft.network/networkinterfaces",
                          "label": "NIC"
                        },
                        {
                          "seriesName": "microsoft.compute/snapshots",
                          "label": "Snapshots"
                        },
                        {
                          "seriesName": "microsoft.network/networksecuritygroups",
                          "label": "NSG"
                        }
                      ]
                    }
                  },
                  "customWidth": "60",
                  "name": "query - 10"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "<hr>"
                  },
                  "name": "text - 4"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "ResourceContainers  | where type =~ 'Microsoft.Resources/subscriptions' | project SubscriptionName = name, subscriptionId | join (Resources| summarize resourceCount=count() by subscriptionId) on subscriptionId",
                    "size": 4,
                    "title": "Subscription Wise Reosurce Count",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "value::all"
                    ],
                    "visualization": "piechart",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "SubscriptionName",
                        "formatter": 15,
                        "formatOptions": {
                          "linkTarget": null,
                          "showIcon": false
                        }
                      },
                      "leftContent": {
                        "columnMatch": "resourceCount",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      },
                      "showBorder": true
                    },
                    "graphSettings": {
                      "type": 0,
                      "topContent": {
                        "columnMatch": "SubscriptionName",
                        "formatter": 1
                      },
                      "centerContent": {
                        "columnMatch": "resourceCount",
                        "formatter": 1,
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "name": "Subscription"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "Resource By Location",
                          "style": "upsell"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "summarize count() by location | project  location, total=count_ ",
                          "size": 2,
                          "color": "purple",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "value::all"
                          ],
                          "visualization": "map",
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "location",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "total",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "graphSettings": {
                            "type": 2,
                            "topContent": {
                              "columnMatch": "location",
                              "formatter": 1
                            },
                            "centerContent": {
                              "columnMatch": "total",
                              "formatter": 1,
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "nodeIdField": "total",
                            "graphOrientation": 3,
                            "showOrientationToggles": false,
                            "nodeSize": null,
                            "staticNodeSize": 100,
                            "colorSettings": null,
                            "hivesMargin": 5
                          },
                          "mapSettings": {
                            "locInfo": "AzureLoc",
                            "locInfoColumn": "location",
                            "sizeSettings": "total",
                            "sizeAggregation": "Sum",
                            "labelSettings": "location",
                            "legendMetric": "total",
                            "legendAggregation": "Sum",
                            "itemColorSettings": {
                              "nodeColorField": "total",
                              "colorAggregation": "Sum",
                              "type": "heatmap",
                              "heatmapPalette": "greenRed"
                            }
                          }
                        },
                        "name": "Resource By Location"
                      }
                    ]
                  },
                  "customWidth": "100",
                  "name": "Location Summary",
                  "styleSettings": {
                    "margin": "2px"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedoption",
              "comparison": "isEqualTo",
              "value": "overview"
            },
            "name": "Home "
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "![alt text](https://gillianstravers.com/wp-content/uploads/2022/01/AzMonitor.png)\r\n"
                        },
                        "customWidth": "75",
                        "name": "text - 4"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Capgemini CloudOps - Service Operation Dashboard\r\n",
                          "style": "success"
                        },
                        "name": "text - 4 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions\"\r\n| summarize c = count()\r\n| extend Item = \"Subscriptions\",  Key = 1\r\n",
                          "size": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "value::all"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Item",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "c",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              }
                            },
                            "showBorder": false,
                            "size": "auto"
                          },
                          "textSettings": {
                            "style": "bignumber"
                          }
                        },
                        "customWidth": "33",
                        "name": "Subscription"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| summarize c = count()\r\n| extend Item = \"Resource Group\",  Key = 1\r\n",
                          "size": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "value::all"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Item",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "c",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              }
                            },
                            "showBorder": false,
                            "size": "auto"
                          },
                          "textSettings": {
                            "style": "bignumber"
                          }
                        },
                        "customWidth": "33",
                        "name": "Resource Group"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "Resources\r\n| summarize count()\r\n\r\n| extend Item = \"Resources\",  Key = 1\r\n",
                          "size": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "value::all"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Item",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              }
                            },
                            "showBorder": false,
                            "size": "auto"
                          },
                          "textSettings": {
                            "style": "bignumber"
                          }
                        },
                        "customWidth": "33",
                        "name": "Resources"
                      }
                    ]
                  },
                  "customWidth": "40",
                  "name": "Left"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "summarize count() by type\r\n| project type, total=count_\r\n| top 15 by total",
                    "size": 3,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "value::all"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "type",
                        "formatter": 16,
                        "formatOptions": {
                          "showIcon": true
                        }
                      },
                      "leftContent": {
                        "columnMatch": "total",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      },
                      "showBorder": true
                    },
                    "chartSettings": {
                      "seriesLabelSettings": [
                        {
                          "seriesName": "microsoft.compute/virtualmachines/extensions",
                          "label": "Extension"
                        },
                        {
                          "seriesName": "microsoft.compute/disks",
                          "label": "Disk"
                        },
                        {
                          "seriesName": "microsoft.network/networkinterfaces",
                          "label": "NIC"
                        },
                        {
                          "seriesName": "microsoft.compute/snapshots",
                          "label": "Snapshots"
                        },
                        {
                          "seriesName": "microsoft.network/networksecuritygroups",
                          "label": "NSG"
                        }
                      ]
                    }
                  },
                  "customWidth": "60",
                  "name": "query - 10"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "<hr>"
                  },
                  "name": "text - 4"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "ResourceContainers  | where type =~ 'Microsoft.Resources/subscriptions' | project SubscriptionName = name, subscriptionId | join (Resources| summarize resourceCount=count() by subscriptionId) on subscriptionId",
                    "size": 4,
                    "title": "Subscription Wise Reosurce Count",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "value::all"
                    ],
                    "visualization": "piechart",
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "SubscriptionName",
                        "formatter": 15,
                        "formatOptions": {
                          "linkTarget": null,
                          "showIcon": false
                        }
                      },
                      "leftContent": {
                        "columnMatch": "resourceCount",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      },
                      "showBorder": true
                    },
                    "graphSettings": {
                      "type": 0,
                      "topContent": {
                        "columnMatch": "SubscriptionName",
                        "formatter": 1
                      },
                      "centerContent": {
                        "columnMatch": "resourceCount",
                        "formatter": 1,
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "name": "Subscription"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "Resource By Location",
                          "style": "upsell"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "summarize count() by location | project  location, total=count_ ",
                          "size": 2,
                          "color": "purple",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "value::all"
                          ],
                          "visualization": "map",
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "location",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "total",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "graphSettings": {
                            "type": 2,
                            "topContent": {
                              "columnMatch": "location",
                              "formatter": 1
                            },
                            "centerContent": {
                              "columnMatch": "total",
                              "formatter": 1,
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "nodeIdField": "total",
                            "graphOrientation": 3,
                            "showOrientationToggles": false,
                            "nodeSize": null,
                            "staticNodeSize": 100,
                            "colorSettings": null,
                            "hivesMargin": 5
                          },
                          "mapSettings": {
                            "locInfo": "AzureLoc",
                            "locInfoColumn": "location",
                            "sizeSettings": "total",
                            "sizeAggregation": "Sum",
                            "labelSettings": "location",
                            "legendMetric": "total",
                            "legendAggregation": "Sum",
                            "itemColorSettings": {
                              "nodeColorField": "total",
                              "colorAggregation": "Sum",
                              "type": "heatmap",
                              "heatmapPalette": "greenRed"
                            }
                          }
                        },
                        "name": "Resource By Location"
                      }
                    ]
                  },
                  "customWidth": "100",
                  "name": "Location Summary",
                  "styleSettings": {
                    "margin": "2px"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedoption",
              "comparison": "isEqualTo",
              "value": ""
            },
            "name": "Home - Without Tab"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "tabs",
                    "links": [
                      {
                        "id": "d5749b77-230f-45e3-89f5-be4c85ecfa36",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Overview",
                        "subTarget": "overview",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "df81f13c-1cfd-4dec-9f32-ba53c7fc1849",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Status",
                        "subTarget": "status",
                        "style": "link"
                      },
                      {
                        "id": "d2568e3f-dddc-47d7-8bb1-afcbc94c0f97",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Availability",
                        "subTarget": "availability",
                        "style": "link"
                      },
                      {
                        "id": "0bd8377f-44f2-4af3-b35b-08e7c2f38a82",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Performance",
                        "subTarget": "computeperformance",
                        "style": "link"
                      },
                      {
                        "id": "7ef3a846-67a4-4458-b430-b19d4d03e181",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Inventory",
                        "subTarget": "vmlist",
                        "style": "link"
                      },
                      {
                        "id": "e12edfd2-6dd6-44f4-a631-2e4f9d20a0c6",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "VM Extension",
                        "subTarget": "vmextension",
                        "style": "link"
                      },
                      {
                        "id": "59fd266d-e71b-408d-bfcf-5a046d0ae18f",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "VM Without Hybrid Benifits",
                        "subTarget": "vmwithouthybridbenifit",
                        "style": "link"
                      },
                      {
                        "id": "a840346a-c888-415d-84b6-75cacf7ca282",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "VM Accounts",
                        "subTarget": "vmaccounts",
                        "style": "link"
                      }
                    ]
                  },
                  "name": "links - 0"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "5e8f8ef7-c57e-4c97-8356-67e34bdd1eb1",
                        "version": "KqlParameterItem/1.0",
                        "name": "Subscription",
                        "type": 6,
                        "isRequired": true,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "typeSettings": {
                          "additionalResourceOptions": [
                            "value::1",
                            "value::3",
                            "value::all"
                          ],
                          "includeAll": true,
                          "showDefault": false
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "defaultValue": "value::3"
                      },
                      {
                        "id": "07837e25-86c0-4013-aea6-a4b49b7bd958",
                        "version": "KqlParameterItem/1.0",
                        "name": "Location",
                        "type": 8,
                        "isRequired": true,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "typeSettings": {
                          "additionalResourceOptions": [
                            "value::all"
                          ],
                          "includeAll": true
                        },
                        "defaultValue": "value::all"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "conditionalVisibilities": [
                    {
                      "parameterName": "submenu",
                      "comparison": "isNotEqualTo",
                      "value": "vmavailability"
                    },
                    {
                      "parameterName": "submenu",
                      "comparison": "isNotEqualTo",
                      "value": "computeperformance"
                    },
                    {
                      "parameterName": "submenu",
                      "comparison": "isNotEqualTo",
                      "value": "vmwithouthybridbenifit"
                    },
                    {
                      "parameterName": "submenu",
                      "comparison": "isNotEqualTo",
                      "value": "vmaccounts"
                    }
                  ],
                  "name": "parameters - 5"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type has \"microsoft\"\r\n| extend type = case(\r\n             \r\n              type == 'microsoft.compute/availabilitysets', \"Availability Set\",\r\n               type == 'microsoft.containerregistry/registries', \"Container Registry\", \r\n                type == 'microsoft.containerinstance/containergroups', \"Container Groups\", \r\n             type == 'microsoft.compute/virtualmachines', \"Virtual Machines\",\r\n             type == 'microsoft.compute/images', \"Images\",\r\n             type == 'microsoft.compute/galleries/images/versions', \"Image Version\",\r\n            \r\n              strcat(\"Not Translated: \", type))\r\n| summarize count() by type\r\n| where type !has \"Not Translated\"",
                          "size": 4,
                          "color": "green",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "type",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": true
                          }
                        },
                        "name": "query - 4"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where location in ({Location})\r\n| extend assessMode = iff(isnull(properties.osProfile.windowsConfiguration.patchSettings.assessmentMode), properties.osProfile.linuxConfiguration.patchSettings.assessmentMode,  properties.osProfile.windowsConfiguration.patchSettings.assessmentMode)\r\n| extend periodicAssessment = iff(isnotnull(assessMode) and assessMode =~ \"AutomaticByPlatform\", \"Yes\", \"No\")\r\n| summarize count() by periodicAssessment",
                          "size": 3,
                          "title": "Periodic assessment enabled for Azure VM & Arc enabled servers",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart"
                        },
                        "customWidth": "50",
                        "name": "query - 7",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources \r\n| extend osType = coalesce(tostring(properties.osName), tostring(properties.osType), tostring(properties.storageProfile.osDisk.osType))\r\n| summarize\r\nazureLinux = countif(type =~ \"microsoft.compute/virtualmachines\" and  osType =~ \"Linux\"),\r\narcLinux = countif(type =~ \"microsoft.hybridcompute/machines\" and osType =~ \"Linux\"),\r\nazureWindows = countif(type =~ \"microsoft.compute/virtualmachines\" and  osType =~ \"Windows\"),\r\narcWindows = countif(type =~ \"microsoft.hybridcompute/machines\" and osType =~ \"Windows\")\r\n| project machinePack = pack(\"Azure virtual machines-Linux\", azureLinux, \"Arc enabled servers-Linux\", arcLinux, \"Azure virtual machines-Windows\", azureWindows, \"Arc enabled servers-Windows\", arcWindows)\r\n| mv-expand machinePack\r\n| extend machine = tostring(bag_keys(machinePack)[0])\r\n| extend count_ = tolong(machinePack[machine])\r\n| project machine, count_ ",
                          "size": 3,
                          "title": "Total machines across subscriptions",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart",
                          "tileSettings": {
                            "showBorder": false
                          },
                          "graphSettings": {
                            "type": 0
                          },
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "sizeSettings": "azureLinux",
                            "sizeAggregation": "Sum",
                            "legendMetric": "azureLinux",
                            "legendAggregation": "Sum",
                            "itemColorSettings": {
                              "type": "heatmap",
                              "colorAggregation": "Sum",
                              "nodeColorField": "azureLinux",
                              "heatmapPalette": "greenRed"
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 0",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where location in~ ({Location})\r\n| extend statuso = iff(isnull(properties.extended.instanceView.powerState.displayStatus), (properties.status), (properties.extended.instanceView.powerState.displayStatus))\r\n| where isnotnull(statuso)\r\n| summarize count() by tostring(statuso)",
                          "size": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "statuso",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": true
                          }
                        },
                        "name": "query - 6"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "Resources\r\n| where type =~ 'Microsoft.Compute/virtualMachines'\r\n| summarize count() by tostring(properties.storageProfile.osDisk.osType)",
                          "size": 4,
                          "title": "Virtual machines by OS",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart",
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "PowerState",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "textSettings": {
                            "style": "bignumber"
                          }
                        },
                        "customWidth": "33",
                        "name": "VM Count - By OS",
                        "styleSettings": {
                          "margin": "2px",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "where type =~ 'Microsoft.Compute/virtualmachines'\r\n| summarize count() by location\r\n| project location, total=count_",
                          "size": 4,
                          "title": "Virtual machines by Location",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart",
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "PowerState",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "textSettings": {
                            "style": "bignumber"
                          }
                        },
                        "customWidth": "33",
                        "name": "VM Count - By  Location",
                        "styleSettings": {
                          "margin": "2px",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "Resources\r\n|where type =~ 'microsoft.compute/virtualMachines' \r\n| summarize count() by tostring(properties.storageProfile.imageReference.offer)",
                          "size": 4,
                          "title": "Virtual Machines By IMAGE",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart",
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "properties_storageProfile_imageReference_offer",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "sizeSettings": "count_",
                            "sizeAggregation": "Sum",
                            "legendMetric": "count_",
                            "legendAggregation": "Sum",
                            "itemColorSettings": {
                              "type": "heatmap",
                              "colorAggregation": "Sum",
                              "nodeColorField": "count_",
                              "heatmapPalette": "greenRed"
                            }
                          }
                        },
                        "customWidth": "33",
                        "name": "Vm by Images",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "where type =~ 'microsoft.compute/virtualMachines' | summarize count() by tostring(properties.hardwareProfile.vmSize)",
                          "size": 3,
                          "title": "Virtual Machines By Instance Family",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "properties_hardwareProfile_vmSize",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "name": "query - 4",
                        "styleSettings": {
                          "margin": "2px",
                          "showBorder": true
                        }
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "overview"
                  },
                  "name": "VM Overview"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "Resources\r\n| where type == 'microsoft.compute/virtualmachines'\r\n| summarize count() by PowerState = tostring(properties.extended.instanceView.powerState.code)",
                          "size": 4,
                          "title": "Virtual machines by State",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart",
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "PowerState",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "PowerState/running",
                                "color": "green"
                              },
                              {
                                "seriesName": "PowerState/deallocated",
                                "color": "redBright"
                              }
                            ]
                          },
                          "textSettings": {
                            "style": "bignumber"
                          }
                        },
                        "customWidth": "33",
                        "name": "VM Count - By State",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "Down Virtual Machines",
                          "style": "error"
                        },
                        "name": "text - 6"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "Resources\r\n| where type =~ 'Microsoft.Compute/virtualMachines'\r\n| where properties.extended.instanceView.powerState.code != 'PowerState/running'\r\n| project vmName = name",
                          "size": 3,
                          "color": "redBright",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "vmName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "vmName",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "failed",
                                    "text": "Powered Off"
                                  }
                                ]
                              }
                            },
                            "showBorder": true
                          },
                          "graphSettings": {
                            "type": 2,
                            "topContent": {
                              "columnMatch": "vmName",
                              "formatter": 5
                            },
                            "nodeIdField": "vmName",
                            "sourceIdField": "vmName",
                            "targetIdField": "vmName",
                            "graphOrientation": 3,
                            "showOrientationToggles": false,
                            "nodeSize": null,
                            "staticNodeSize": 100,
                            "colorSettings": {
                              "nodeColorField": "vmName",
                              "type": 3,
                              "thresholdsGrid": [
                                {
                                  "operator": "startsWith"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "redBright"
                                }
                              ]
                            },
                            "hivesMargin": 2
                          }
                        },
                        "name": "Down Virtual Machines"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "status"
                  },
                  "name": "Compute Status"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Availability rate \r\n// Calculate the availability rate of each connected computer. \r\nHeartbeat\r\n// bin_at is used to set the time grain to 1 hour, starting exactly 24 hours ago\r\n| summarize heartbeatPerHour = count() by bin_at(TimeGenerated, 1h, ago(24h)), Computer\r\n| extend availablePerHour = iff(heartbeatPerHour > 0, true, false)\r\n| summarize totalAvailableHours = countif(availablePerHour == true) by Computer\r\n| extend availabilityRate = totalAvailableHours*100.0/24",
                          "size": 3,
                          "title": "VM Availability Last 24 Hours",
                          "timeContext": {
                            "durationMs": 86400000
                          },
                          "queryType": 0,
                          "resourceType": "microsoft.resources/subscriptions",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "tiles",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "availabilityRate",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "max": 100,
                                  "palette": "redGreen"
                                }
                              }
                            ],
                            "labelSettings": [
                              {
                                "columnId": "Computer",
                                "label": "VM Name"
                              },
                              {
                                "columnId": "totalAvailableHours",
                                "label": "Available Hours"
                              },
                              {
                                "columnId": "availabilityRate",
                                "label": "% Availability"
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Computer",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "availabilityRate",
                              "formatter": 12,
                              "formatOptions": {
                                "min": 0,
                                "max": 100,
                                "palette": "redGreen"
                              },
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": true
                          }
                        },
                        "name": "VM Availibility",
                        "styleSettings": {
                          "margin": "50"
                        }
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "availability"
                  },
                  "name": "Availability",
                  "styleSettings": {
                    "margin": "25"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 11,
                        "content": {
                          "version": "LinkItem/1.0",
                          "style": "nav",
                          "links": [
                            {
                              "id": "0bd8377f-44f2-4af3-b35b-08e7c2f38a82",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "Performance",
                              "subTarget": "performance",
                              "style": "link"
                            },
                            {
                              "id": "3897c28f-0c75-4f8b-922e-c1b68bc94990",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "Region Performance",
                              "subTarget": "region",
                              "style": "link"
                            },
                            {
                              "id": "8a831961-140f-4ae2-b84c-6303abd8cb4c",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "VM Performance",
                              "subTarget": "vmperformance",
                              "style": "link"
                            },
                            {
                              "id": "228c694f-bd9e-4afd-a694-907441ea00f1",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "Performance Counters",
                              "subTarget": "performancecounter",
                              "style": "link"
                            },
                            {
                              "id": "55e4b191-3fab-4f87-a736-c479ab116b79",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "IOPS",
                              "subTarget": "iops",
                              "style": "link"
                            },
                            {
                              "id": "60636251-68d8-447a-90a0-2ba065feacd3",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "Top 5",
                              "subTarget": "top10",
                              "style": "link"
                            }
                          ]
                        },
                        "name": "links - 0"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "b0177105-7244-40a2-a13b-7f9cc63ff869",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Subscription",
                                    "label": "Choose a subscription",
                                    "type": 6,
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "'",
                                    "delimiter": ",",
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::1",
                                        "value::3",
                                        "value::all"
                                      ],
                                      "includeAll": true,
                                      "showDefault": false
                                    },
                                    "defaultValue": "value::3"
                                  },
                                  {
                                    "id": "7bd0f21c-30f8-44e1-9e91-f9e87118bea9",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "VirtualMachines",
                                    "label": "Virtual Machines",
                                    "type": 5,
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "'",
                                    "delimiter": ",",
                                    "query": "where type =~ 'microsoft.compute/virtualmachines'\r\n\t| order by name asc\r\n\t| extend Rank = row_number()\r\n\t| project value = id, label = id, selected = Rank <= 25",
                                    "crossComponentResources": [
                                      "{Subscription}"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::1",
                                        "value::5",
                                        "value::all"
                                      ],
                                      "showDefault": false
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "defaultValue": "value::5",
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources"
                                  },
                                  {
                                    "id": "920babe0-e044-45a5-bbfe-cc6ddfb12679",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TimeRange",
                                    "label": "Time Range",
                                    "type": 4,
                                    "typeSettings": {
                                      "selectableValues": [
                                        {
                                          "durationMs": 300000
                                        },
                                        {
                                          "durationMs": 900000
                                        },
                                        {
                                          "durationMs": 1800000
                                        },
                                        {
                                          "durationMs": 3600000
                                        },
                                        {
                                          "durationMs": 14400000
                                        },
                                        {
                                          "durationMs": 43200000
                                        },
                                        {
                                          "durationMs": 86400000
                                        },
                                        {
                                          "durationMs": 172800000
                                        },
                                        {
                                          "durationMs": 259200000
                                        },
                                        {
                                          "durationMs": 604800000
                                        },
                                        {
                                          "durationMs": 1209600000
                                        },
                                        {
                                          "durationMs": 2419200000
                                        },
                                        {
                                          "durationMs": 2592000000
                                        },
                                        {
                                          "durationMs": 5184000000
                                        },
                                        {
                                          "durationMs": 7776000000
                                        }
                                      ]
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "value": {
                                      "durationMs": 7776000000
                                    }
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.resourcegraph/resources"
                              },
                              "name": "parameters - 1"
                            },
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "loadType": "always",
                                "items": [
                                  {
                                    "type": 10,
                                    "content": {
                                      "chartId": "workbookdb19a8d8-91af-44ea-951d-5ffa133b2ebe",
                                      "version": "MetricsItem/2.0",
                                      "size": 2,
                                      "chartType": 0,
                                      "resourceType": "microsoft.compute/virtualmachines",
                                      "metricScope": 0,
                                      "resourceParameter": "VirtualMachines",
                                      "resourceIds": [
                                        "{VirtualMachines}"
                                      ],
                                      "timeContextFromParameter": "TimeRange",
                                      "timeContext": {
                                        "durationMs": 7776000000
                                      },
                                      "metrics": [
                                        {
                                          "namespace": "microsoft.compute/virtualmachines",
                                          "metric": "microsoft.compute/virtualmachines--Percentage CPU",
                                          "aggregation": 4
                                        },
                                        {
                                          "namespace": "microsoft.compute/virtualmachines",
                                          "metric": "microsoft.compute/virtualmachines--Disk Read Bytes",
                                          "aggregation": 1
                                        },
                                        {
                                          "namespace": "microsoft.compute/virtualmachines",
                                          "metric": "microsoft.compute/virtualmachines--Disk Write Bytes",
                                          "aggregation": 1
                                        },
                                        {
                                          "namespace": "microsoft.compute/virtualmachines",
                                          "metric": "microsoft.compute/virtualmachines--Network In Total",
                                          "aggregation": 1
                                        },
                                        {
                                          "namespace": "microsoft.compute/virtualmachines",
                                          "metric": "microsoft.compute/virtualmachines--Network Out Total",
                                          "aggregation": 1
                                        },
                                        {
                                          "namespace": "microsoft.compute/virtualmachines",
                                          "metric": "microsoft.compute/virtualmachines--Percentage CPU",
                                          "aggregation": 3,
                                          "columnName": "CPU Max"
                                        }
                                      ],
                                      "gridSettings": {
                                        "formatters": [
                                          {
                                            "columnMatch": "Subscription",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "Name",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "microsoft.compute/virtualmachines--Percentage CPU",
                                            "formatter": 8,
                                            "formatOptions": {
                                              "min": 0,
                                              "palette": "blue",
                                              "linkTarget": "WorkbookTemplate",
                                              "linkIsContextBlade": true,
                                              "workbookContext": {
                                                "componentIdSource": "column",
                                                "componentId": "Name",
                                                "resourceIdsSource": "column",
                                                "resourceIds": "Name",
                                                "templateIdSource": "static",
                                                "templateId": "Community-Workbooks/Virtual Machines/Virtual machine details",
                                                "typeSource": "static",
                                                "type": "workbook",
                                                "gallerySource": "static",
                                                "gallery": "microsoft.compute/virtualmachines",
                                                "locationSource": "default"
                                              }
                                            },
                                            "numberFormat": {
                                              "unit": 1,
                                              "options": {
                                                "style": "decimal",
                                                "maximumFractionDigits": 1
                                              }
                                            }
                                          },
                                          {
                                            "columnMatch": "microsoft.compute/virtualmachines--Percentage CPU Timeline",
                                            "formatter": 21,
                                            "formatOptions": {
                                              "min": 0,
                                              "palette": "blue"
                                            }
                                          },
                                          {
                                            "columnMatch": "microsoft.compute/virtualmachines--Disk Read Bytes|microsoft.compute/virtualmachines--Disk Write Bytes",
                                            "formatter": 8,
                                            "formatOptions": {
                                              "min": 0,
                                              "palette": "yellow"
                                            },
                                            "numberFormat": {
                                              "unit": 2,
                                              "options": {
                                                "style": "decimal",
                                                "maximumFractionDigits": 1
                                              }
                                            }
                                          },
                                          {
                                            "columnMatch": "microsoft.compute/virtualmachines--Disk Read Bytes Timeline",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "microsoft.compute/virtualmachines--Disk Write Bytes Timeline",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "microsoft.compute/virtualmachines--Network In Total|microsoft.compute/virtualmachines--Network Out Total",
                                            "formatter": 8,
                                            "formatOptions": {
                                              "min": 0,
                                              "palette": "orange"
                                            },
                                            "numberFormat": {
                                              "unit": 2,
                                              "options": {
                                                "style": "decimal",
                                                "maximumFractionDigits": 1
                                              }
                                            }
                                          },
                                          {
                                            "columnMatch": "microsoft.compute/virtualmachines--Network In Total Timeline",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "microsoft.compute/virtualmachines--Network Out Total Timeline",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "CPU Max Timeline",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "{VirtualMachines:resourcegroup}",
                                            "formatter": 14,
                                            "formatOptions": {
                                              "linkTarget": null
                                            }
                                          }
                                        ],
                                        "rowLimit": 10000,
                                        "filter": true,
                                        "labelSettings": [
                                          {
                                            "columnId": "Subscription",
                                            "label": "Subscription"
                                          },
                                          {
                                            "columnId": "Name",
                                            "label": "Storage Name"
                                          },
                                          {
                                            "columnId": "microsoft.compute/virtualmachines--Percentage CPU",
                                            "label": "Percentage CPU (Average)"
                                          },
                                          {
                                            "columnId": "microsoft.compute/virtualmachines--Percentage CPU Timeline",
                                            "label": "Percentage CPU Timeline"
                                          },
                                          {
                                            "columnId": "microsoft.compute/virtualmachines--Disk Read Bytes",
                                            "label": "Disk Read Bytes (Sum)"
                                          },
                                          {
                                            "columnId": "microsoft.compute/virtualmachines--Disk Read Bytes Timeline",
                                            "label": "Disk Read Bytes Timeline"
                                          },
                                          {
                                            "columnId": "microsoft.compute/virtualmachines--Disk Write Bytes",
                                            "label": "Disk Write Bytes (Sum)"
                                          },
                                          {
                                            "columnId": "microsoft.compute/virtualmachines--Disk Write Bytes Timeline",
                                            "label": "Disk Write Bytes Timeline"
                                          },
                                          {
                                            "columnId": "microsoft.compute/virtualmachines--Network In Total",
                                            "label": "Network In Total (Sum)"
                                          },
                                          {
                                            "columnId": "microsoft.compute/virtualmachines--Network In Total Timeline",
                                            "label": "Network In Total Timeline"
                                          },
                                          {
                                            "columnId": "microsoft.compute/virtualmachines--Network Out Total",
                                            "label": "Network Out Total (Sum)"
                                          },
                                          {
                                            "columnId": "microsoft.compute/virtualmachines--Network Out Total Timeline",
                                            "label": "Network Out Total Timeline"
                                          },
                                          {
                                            "columnId": "CPU Max",
                                            "label": "CPU Max"
                                          },
                                          {
                                            "columnId": "CPU Max Timeline",
                                            "label": "CPU Max Timeline"
                                          }
                                        ]
                                      },
                                      "sortBy": [],
                                      "showExportToExcel": true
                                    },
                                    "conditionalVisibility": {
                                      "parameterName": "test",
                                      "comparison": "isEqualTo",
                                      "value": "false"
                                    },
                                    "showPin": true,
                                    "name": "Azure Monitor VM Key Metrics"
                                  },
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "advisorresources\r\n| where type == 'microsoft.advisor/recommendations'\r\n| where properties.category == 'Cost'\r\n| extend\r\n    resourceid = tolower(tostring(properties.resourceMetadata.resourceId)),\r\n    savings = todouble(properties.extendedProperties.savingsAmount),\r\n    solution = tostring(properties.shortDescription.solution),\r\n    currency = tostring(properties.extendedProperties.savingsCurrency)\r\n| where resourceid in~ ({VirtualMachines})\r\n| extend action = strcat(\"Resize \", properties.extendedProperties.currentSku, \" to \", properties.extendedProperties.targetSku)\r\n| project resourceid, action",
                                      "size": 0,
                                      "queryType": 1,
                                      "resourceType": "microsoft.resourcegraph/resources",
                                      "crossComponentResources": [
                                        "{Subscription}"
                                      ]
                                    },
                                    "conditionalVisibility": {
                                      "parameterName": "test",
                                      "comparison": "isEqualTo",
                                      "value": "false"
                                    },
                                    "name": "Azure Advisor"
                                  },
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "Resources\r\n| where id in~ ({VirtualMachines})\r\n| extend resourceid = tolower(id)\r\n| project Resource = id, Subscription = subscriptionId, ['Resource group'] = strcat('/subscriptions/', subscriptionId, '/resourceGroups/', resourceGroup), Location = location, Size = properties.hardwareProfile.vmSize",
                                      "size": 0,
                                      "exportToExcelOptions": "all",
                                      "queryType": 1,
                                      "resourceType": "microsoft.resourcegraph/resources",
                                      "crossComponentResources": [
                                        "{Subscription}"
                                      ],
                                      "gridSettings": {
                                        "formatters": [
                                          {
                                            "columnMatch": "Resource",
                                            "formatter": 13,
                                            "formatOptions": {
                                              "linkTarget": null,
                                              "showIcon": true
                                            }
                                          },
                                          {
                                            "columnMatch": "Subscription",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "Resource group",
                                            "formatter": 5
                                          }
                                        ]
                                      },
                                      "sortBy": []
                                    },
                                    "conditionalVisibility": {
                                      "parameterName": "test",
                                      "comparison": "isEqualTo",
                                      "value": "false"
                                    },
                                    "name": "Resource graph query"
                                  },
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"2a962bc4-6379-4ff9-a467-0f4745ef7354\",\"mergeType\":\"leftouter\",\"leftTable\":\"Resource graph query\",\"rightTable\":\"Azure Advisor\",\"leftColumn\":\"Resource\",\"rightColumn\":\"resourceid\"},{\"id\":\"594addb0-aa79-49ad-8a5b-99025e63f0d2\",\"mergeType\":\"leftouter\",\"leftTable\":\"Resource graph query\",\"rightTable\":\"Azure Monitor VM Key Metrics\",\"leftColumn\":\"Resource\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Resource graph query].Resource\",\"mergedName\":\"Resource\",\"fromId\":\"2a962bc4-6379-4ff9-a467-0f4745ef7354\"},{\"originalName\":\"[Resource graph query].Subscription\",\"mergedName\":\"Subscription\",\"fromId\":\"2a962bc4-6379-4ff9-a467-0f4745ef7354\"},{\"originalName\":\"[Resource graph query].Resource group\",\"mergedName\":\"Resource group\",\"fromId\":\"2a962bc4-6379-4ff9-a467-0f4745ef7354\"},{\"originalName\":\"[Resource graph query].Location\",\"mergedName\":\"Location\",\"fromId\":\"2a962bc4-6379-4ff9-a467-0f4745ef7354\"},{\"originalName\":\"[Resource graph query].Size\",\"mergedName\":\"Size\",\"fromId\":\"2a962bc4-6379-4ff9-a467-0f4745ef7354\"},{\"originalName\":\"[Azure Advisor].resourceid\",\"mergedName\":\"resourceid\",\"fromId\":\"2a962bc4-6379-4ff9-a467-0f4745ef7354\"},{\"originalName\":\"[Azure Advisor].currency\",\"mergedName\":\"currency\",\"fromId\":\"2a962bc4-6379-4ff9-a467-0f4745ef7354\"},{\"originalName\":\"[Azure Monitor VM Key Metrics].Subscription\",\"mergedName\":\"Subscription1\",\"fromId\":\"594addb0-aa79-49ad-8a5b-99025e63f0d2\"},{\"originalName\":\"[Azure Monitor VM Key Metrics].Name\",\"mergedName\":\"Name\",\"fromId\":\"594addb0-aa79-49ad-8a5b-99025e63f0d2\"},{\"originalName\":\"[Azure Monitor VM Key Metrics].microsoft.compute/virtualmachines--Percentage CPU\",\"mergedName\":\"Percentage CPU (Average)\",\"fromId\":\"594addb0-aa79-49ad-8a5b-99025e63f0d2\"},{\"originalName\":\"[Azure Monitor VM Key Metrics].microsoft.compute/virtualmachines--Percentage CPU Timeline\",\"mergedName\":\"Percentage CPU (Average) Timeline\",\"fromId\":\"594addb0-aa79-49ad-8a5b-99025e63f0d2\"},{\"originalName\":\"[Azure Monitor VM Key Metrics].CPU Max\",\"mergedName\":\"Percentage CPU (Max)\",\"fromId\":\"594addb0-aa79-49ad-8a5b-99025e63f0d2\"},{\"originalName\":\"[Azure Monitor VM Key Metrics].CPU Max Timeline\",\"mergedName\":\"Percentage CPU (Max) Timeline\",\"fromId\":\"594addb0-aa79-49ad-8a5b-99025e63f0d2\"},{\"originalName\":\"[Azure Monitor VM Key Metrics].microsoft.compute/virtualmachines--Disk Read Bytes\",\"mergedName\":\"Disk Read Bytes (Sum)\",\"fromId\":\"594addb0-aa79-49ad-8a5b-99025e63f0d2\"},{\"originalName\":\"[Azure Monitor VM Key Metrics].microsoft.compute/virtualmachines--Disk Read Bytes Timeline\",\"mergedName\":\"Disk Read Bytes Timeline\",\"fromId\":\"594addb0-aa79-49ad-8a5b-99025e63f0d2\"},{\"originalName\":\"[Azure Monitor VM Key Metrics].microsoft.compute/virtualmachines--Disk Write Bytes\",\"mergedName\":\"Disk Write Bytes (Sum)\",\"fromId\":\"594addb0-aa79-49ad-8a5b-99025e63f0d2\"},{\"originalName\":\"[Azure Monitor VM Key Metrics].microsoft.compute/virtualmachines--Disk Write Bytes Timeline\",\"mergedName\":\"Disk Write Bytes Timeline\",\"fromId\":\"594addb0-aa79-49ad-8a5b-99025e63f0d2\"},{\"originalName\":\"[Azure Monitor VM Key Metrics].microsoft.compute/virtualmachines--Network In Total\",\"mergedName\":\"Network In Total (Sum)\",\"fromId\":\"594addb0-aa79-49ad-8a5b-99025e63f0d2\"},{\"originalName\":\"[Azure Monitor VM Key Metrics].microsoft.compute/virtualmachines--Network In Total Timeline\",\"mergedName\":\"Network In Total Timeline\",\"fromId\":\"594addb0-aa79-49ad-8a5b-99025e63f0d2\"},{\"originalName\":\"[Azure Monitor VM Key Metrics].microsoft.compute/virtualmachines--Network Out Total\",\"mergedName\":\"Network Out Total (Sum)\",\"fromId\":\"594addb0-aa79-49ad-8a5b-99025e63f0d2\"},{\"originalName\":\"[Azure Monitor VM Key Metrics].microsoft.compute/virtualmachines--Network Out Total Timeline\",\"mergedName\":\"Network Out Total Timeline\",\"fromId\":\"594addb0-aa79-49ad-8a5b-99025e63f0d2\"},{\"originalName\":\"[Azure Advisor].solution\",\"mergedName\":\"Azure Advisor Solution\",\"fromId\":\"2a962bc4-6379-4ff9-a467-0f4745ef7354\"},{\"originalName\":\"[Azure Advisor].savings\",\"mergedName\":\"Azure Advisor Saving\",\"fromId\":\"2a962bc4-6379-4ff9-a467-0f4745ef7354\"},{\"originalName\":\"[Azure Advisor].action\",\"mergedName\":\"Azure Advisor recommended action\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 3].resourceid\"},{\"originalName\":\"[query - 3].currency\"}]}",
                                      "size": 3,
                                      "queryType": 7,
                                      "gridSettings": {
                                        "formatters": [
                                          {
                                            "columnMatch": "$gen_group",
                                            "formatter": 13,
                                            "formatOptions": {
                                              "linkTarget": "Resource",
                                              "showIcon": true
                                            }
                                          },
                                          {
                                            "columnMatch": "Resource",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "Subscription",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "Resource group",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "Location",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "resourceid",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "Subscription1",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "Name",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "Percentage CPU (Average)",
                                            "formatter": 8,
                                            "formatOptions": {
                                              "min": 0,
                                              "palette": "blue"
                                            },
                                            "numberFormat": {
                                              "unit": 1,
                                              "options": {
                                                "style": "decimal",
                                                "useGrouping": false,
                                                "maximumFractionDigits": 1
                                              }
                                            }
                                          },
                                          {
                                            "columnMatch": "Percentage CPU (Average) Timeline",
                                            "formatter": 21,
                                            "formatOptions": {
                                              "min": 0,
                                              "palette": "blue"
                                            }
                                          },
                                          {
                                            "columnMatch": "Percentage CPU (Max)",
                                            "formatter": 8,
                                            "formatOptions": {
                                              "min": 0,
                                              "palette": "blue"
                                            },
                                            "numberFormat": {
                                              "unit": 1,
                                              "options": {
                                                "style": "decimal",
                                                "maximumFractionDigits": 1
                                              }
                                            }
                                          },
                                          {
                                            "columnMatch": "Percentage CPU (Max) Timeline",
                                            "formatter": 21,
                                            "formatOptions": {
                                              "min": 0,
                                              "palette": "blue"
                                            }
                                          },
                                          {
                                            "columnMatch": "Disk Read Bytes (Sum)",
                                            "formatter": 8,
                                            "formatOptions": {
                                              "min": 0,
                                              "palette": "yellow"
                                            },
                                            "numberFormat": {
                                              "unit": 2,
                                              "options": {
                                                "style": "decimal",
                                                "maximumSignificantDigits": 1
                                              }
                                            }
                                          },
                                          {
                                            "columnMatch": "Disk Read Bytes Timeline",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "Disk Write Bytes (Sum)",
                                            "formatter": 8,
                                            "formatOptions": {
                                              "min": 0,
                                              "palette": "yellow"
                                            },
                                            "numberFormat": {
                                              "unit": 2,
                                              "options": {
                                                "style": "decimal",
                                                "maximumFractionDigits": 1
                                              }
                                            }
                                          },
                                          {
                                            "columnMatch": "Disk Write Bytes Timeline",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "Network In Total (Sum)",
                                            "formatter": 8,
                                            "formatOptions": {
                                              "min": 0,
                                              "palette": "orange"
                                            },
                                            "numberFormat": {
                                              "unit": 2,
                                              "options": {
                                                "style": "decimal",
                                                "maximumSignificantDigits": 1
                                              }
                                            }
                                          },
                                          {
                                            "columnMatch": "Network In Total Timeline",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "Network Out Total (Sum)",
                                            "formatter": 8,
                                            "formatOptions": {
                                              "min": 0,
                                              "palette": "orange"
                                            },
                                            "numberFormat": {
                                              "unit": 2,
                                              "options": {
                                                "style": "decimal",
                                                "maximumFractionDigits": 1
                                              }
                                            }
                                          },
                                          {
                                            "columnMatch": "Network Out Total Timeline",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "currency",
                                            "formatter": 5
                                          }
                                        ],
                                        "hierarchySettings": {
                                          "treeType": 1,
                                          "groupBy": [
                                            "Subscription"
                                          ],
                                          "expandTopLevel": true,
                                          "finalBy": "Name"
                                        }
                                      }
                                    },
                                    "showPin": false,
                                    "name": "Merge ARG and Advisor"
                                  }
                                ]
                              },
                              "name": "Details"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "performance"
                        },
                        "name": "Performance"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "parameters": [
                                  {
                                    "id": "b0177105-7244-40a2-a13b-7f9cc63ff869",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Subscription",
                                    "label": "Choose a subscription",
                                    "type": 6,
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "'",
                                    "delimiter": ",",
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::1",
                                        "value::all"
                                      ],
                                      "includeAll": true,
                                      "showDefault": false
                                    },
                                    "defaultValue": "value::1",
                                    "value": [
                                      "/subscriptions/b661db5b-6c7e-435f-a989-6de3b26c40d3"
                                    ]
                                  },
                                  {
                                    "id": "7bd0f21c-30f8-44e1-9e91-f9e87118bea9",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "VirtualMachines",
                                    "label": "Virtual Machines",
                                    "type": 5,
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "'",
                                    "delimiter": ",",
                                    "query": "where type =~ 'microsoft.compute/virtualmachines'\r\n\t| order by name asc\r\n\t| extend Rank = row_number()\r\n\t| project value = id, label = id, selected = Rank <= 25",
                                    "crossComponentResources": [
                                      "{Subscription}"
                                    ],
                                    "value": [
                                      "/subscriptions/b661db5b-6c7e-435f-a989-6de3b26c40d3/resourceGroups/VPK-EUN-PR-SEC-RG/providers/Microsoft.Compute/virtualMachines/svgrp-cgsam01",
                                      "/subscriptions/b661db5b-6c7e-435f-a989-6de3b26c40d3/resourceGroups/VPK-EUN-PR-SEC-RG/providers/Microsoft.Compute/virtualMachines/svgrp-cgsam02"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::all"
                                      ],
                                      "showDefault": false
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "defaultValue": "value::all",
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources"
                                  },
                                  {
                                    "id": "920babe0-e044-45a5-bbfe-cc6ddfb12679",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TimeRange",
                                    "label": "Time Range",
                                    "type": 4,
                                    "typeSettings": {
                                      "selectableValues": [
                                        {
                                          "durationMs": 300000
                                        },
                                        {
                                          "durationMs": 900000
                                        },
                                        {
                                          "durationMs": 1800000
                                        },
                                        {
                                          "durationMs": 3600000
                                        },
                                        {
                                          "durationMs": 14400000
                                        },
                                        {
                                          "durationMs": 43200000
                                        },
                                        {
                                          "durationMs": 86400000
                                        },
                                        {
                                          "durationMs": 172800000
                                        },
                                        {
                                          "durationMs": 259200000
                                        },
                                        {
                                          "durationMs": 604800000
                                        },
                                        {
                                          "durationMs": 1209600000
                                        },
                                        {
                                          "durationMs": 2419200000
                                        },
                                        {
                                          "durationMs": 2592000000
                                        },
                                        {
                                          "durationMs": 5184000000
                                        },
                                        {
                                          "durationMs": 7776000000
                                        }
                                      ]
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "value": {
                                      "durationMs": 300000
                                    }
                                  }
                                ],
                                "style": "pills",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources"
                              },
                              "name": "parameters - 1"
                            },
                            {
                              "type": 10,
                              "content": {
                                "chartId": "workbookdb19a8d8-91af-44ea-951d-5ffa133b2ebe",
                                "version": "MetricsItem/2.0",
                                "size": 0,
                                "chartType": -2,
                                "resourceType": "microsoft.compute/virtualmachines",
                                "metricScope": 0,
                                "resourceParameter": "VirtualMachines",
                                "resourceIds": [
                                  "{VirtualMachines}"
                                ],
                                "timeContextFromParameter": "TimeRange",
                                "timeContext": {
                                  "durationMs": 300000
                                },
                                "metrics": [
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--Percentage CPU",
                                    "aggregation": 4
                                  }
                                ],
                                "mapSettings": {
                                  "locInfo": "AzureResource",
                                  "locInfoColumn": "Name",
                                  "sizeSettings": "Name",
                                  "sizeAggregation": "Count",
                                  "legendMetric": "microsoft.compute/virtualmachines--Percentage CPU",
                                  "legendAggregation": "Max",
                                  "itemColorSettings": {
                                    "nodeColorField": "microsoft.compute/virtualmachines--Percentage CPU",
                                    "colorAggregation": "Max",
                                    "type": "heatmap",
                                    "heatmapPalette": "greenRed",
                                    "heatmapMin": 30,
                                    "heatmapMax": 80
                                  },
                                  "numberFormatSettings": {
                                    "unit": 1,
                                    "options": {
                                      "style": "decimal",
                                      "maximumFractionDigits": 1
                                    }
                                  }
                                },
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Percentage CPU",
                                      "formatter": 1,
                                      "numberFormat": {
                                        "unit": 1,
                                        "options": null
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000,
                                  "labelSettings": [
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Percentage CPU",
                                      "label": "Percentage CPU (Average)"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Percentage CPU Timeline",
                                      "label": "Percentage CPU Timeline"
                                    }
                                  ]
                                },
                                "sortBy": [],
                                "exportMultipleValues": true,
                                "exportAggregateParts": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "Name",
                                    "parameterName": "ResourcesInSelectedRegion",
                                    "parameterType": 1
                                  }
                                ]
                              },
                              "customWidth": "55",
                              "showPin": false,
                              "name": "CPU data"
                            },
                            {
                              "type": 10,
                              "content": {
                                "chartId": "workbook0b213afb-2aee-4fe6-9df0-96d2b608cd42",
                                "version": "MetricsItem/2.0",
                                "size": 0,
                                "chartType": 0,
                                "resourceType": "microsoft.compute/virtualmachines",
                                "metricScope": 0,
                                "resourceParameter": "VirtualMachines",
                                "resourceIds": [
                                  "{VirtualMachines}"
                                ],
                                "timeContextFromParameter": "TimeRange",
                                "timeContext": {
                                  "durationMs": 300000
                                },
                                "metrics": [
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--Percentage CPU",
                                    "aggregation": 4
                                  }
                                ],
                                "title": "Virtual machines in selected region",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "$gen_group",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Subscription",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Name",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Percentage CPU",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 30,
                                        "max": 80,
                                        "palette": "greenRed",
                                        "showIcon": true
                                      },
                                      "numberFormat": {
                                        "unit": 1,
                                        "options": {
                                          "style": "decimal",
                                          "useGrouping": false,
                                          "maximumFractionDigits": 1
                                        },
                                        "emptyValCustomText": "-"
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Percentage CPU Timeline",
                                      "formatter": 9,
                                      "formatOptions": {
                                        "min": 30,
                                        "max": 80,
                                        "palette": "greenRed",
                                        "showIcon": true
                                      },
                                      "numberFormat": {
                                        "unit": 1,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000,
                                  "filter": true,
                                  "hierarchySettings": {
                                    "treeType": 1,
                                    "groupBy": [
                                      "Subscription"
                                    ],
                                    "expandTopLevel": true,
                                    "finalBy": "Name"
                                  },
                                  "sortBy": [
                                    {
                                      "itemKey": "$gen_heatmap_microsoft.compute/virtualmachines--Percentage CPU_3",
                                      "sortOrder": 2
                                    }
                                  ],
                                  "labelSettings": [
                                    {
                                      "columnId": "Subscription",
                                      "label": "Subscription"
                                    },
                                    {
                                      "columnId": "Name",
                                      "label": "Storage Name"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Percentage CPU",
                                      "label": "Percentage CPU (Average)"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Percentage CPU Timeline",
                                      "label": "Percentage CPU Timeline"
                                    }
                                  ]
                                },
                                "sortBy": [
                                  {
                                    "itemKey": "$gen_heatmap_microsoft.compute/virtualmachines--Percentage CPU_3",
                                    "sortOrder": 2
                                  }
                                ]
                              },
                              "customWidth": "45",
                              "name": "Region VM details"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "region"
                        },
                        "name": "Region Performance"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "b0177105-7244-40a2-a13b-7f9cc63ff869",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Subscription",
                                    "label": "Choose a subscription",
                                    "type": 6,
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "'",
                                    "delimiter": ",",
                                    "value": [
                                      "/subscriptions/b17d03eb-4598-4cc2-9046-83a94e7c56ee",
                                      "/subscriptions/b661db5b-6c7e-435f-a989-6de3b26c40d3"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::1"
                                      ],
                                      "includeAll": true,
                                      "showDefault": false
                                    },
                                    "defaultValue": "value::1"
                                  },
                                  {
                                    "id": "7bd0f21c-30f8-44e1-9e91-f9e87118bea9",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "VirtualMachines",
                                    "label": "Virtual Machines",
                                    "type": 5,
                                    "isRequired": true,
                                    "query": "where type =~ 'microsoft.compute/virtualmachines'\r\n\t| order by name asc\r\n\t| extend Rank = row_number()\r\n\t| project value = id, label = id, selected = Rank <= 25",
                                    "crossComponentResources": [
                                      "{Subscription}"
                                    ],
                                    "value": "/subscriptions/b17d03eb-4598-4cc2-9046-83a94e7c56ee/resourceGroups/VPK-EUN-PR-SPK-NONDMZ-RG/providers/Microsoft.Compute/virtualMachines/svbe-dbs09-test",
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources"
                                  },
                                  {
                                    "id": "920babe0-e044-45a5-bbfe-cc6ddfb12679",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TimeRange",
                                    "label": "Time Range",
                                    "type": 4,
                                    "typeSettings": {
                                      "selectableValues": [
                                        {
                                          "durationMs": 300000
                                        },
                                        {
                                          "durationMs": 900000
                                        },
                                        {
                                          "durationMs": 1800000
                                        },
                                        {
                                          "durationMs": 3600000
                                        },
                                        {
                                          "durationMs": 14400000
                                        },
                                        {
                                          "durationMs": 43200000
                                        },
                                        {
                                          "durationMs": 86400000
                                        },
                                        {
                                          "durationMs": 172800000
                                        },
                                        {
                                          "durationMs": 259200000
                                        },
                                        {
                                          "durationMs": 604800000
                                        },
                                        {
                                          "durationMs": 1209600000
                                        },
                                        {
                                          "durationMs": 2419200000
                                        },
                                        {
                                          "durationMs": 2592000000
                                        },
                                        {
                                          "durationMs": 5184000000
                                        },
                                        {
                                          "durationMs": 7776000000
                                        }
                                      ]
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "value": {
                                      "durationMs": 86400000
                                    }
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "parameters - 1"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "VMComputer\r\n|distinct Computer, AzureLocation, AzureSize,  CpuSpeed, PhysicalMemoryMB , OperatingSystemFamily, OperatingSystemFullName,  tostring(Ipv4Addresses), tostring(Ipv4DefaultGateways)",
                                "size": 3,
                                "color": "green",
                                "queryType": 0,
                                "resourceType": "microsoft.compute/virtualmachines",
                                "crossComponentResources": [
                                  "{VirtualMachines}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "labelSettings": [
                                    {
                                      "columnId": "AzureLocation",
                                      "label": "Location"
                                    },
                                    {
                                      "columnId": "AzureSize",
                                      "label": "Size"
                                    },
                                    {
                                      "columnId": "PhysicalMemoryMB",
                                      "label": "Memory (MB)"
                                    },
                                    {
                                      "columnId": "OperatingSystemFamily",
                                      "label": "OS Family"
                                    },
                                    {
                                      "columnId": "OperatingSystemFullName",
                                      "label": "OS Name"
                                    },
                                    {
                                      "columnId": "Ipv4Addresses",
                                      "label": "IP Address"
                                    },
                                    {
                                      "columnId": "Ipv4DefaultGateways",
                                      "label": "Default Gateway"
                                    }
                                  ]
                                },
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "resource",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  },
                                  "showBorder": true,
                                  "size": "auto"
                                },
                                "graphSettings": {
                                  "type": 0,
                                  "topContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 1
                                  },
                                  "centerContent": {
                                    "columnMatch": "CpuSpeed",
                                    "formatter": 1,
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "100",
                              "name": "VM Name"
                            },
                            {
                              "type": 10,
                              "content": {
                                "chartId": "workbook9661841b-f22f-4597-8eef-dc179ad740b5",
                                "version": "MetricsItem/2.0",
                                "size": 3,
                                "chartType": -1,
                                "resourceType": "microsoft.compute/virtualmachines",
                                "metricScope": 0,
                                "resourceParameter": "VirtualMachines",
                                "resourceIds": [
                                  "{VirtualMachines}"
                                ],
                                "timeContextFromParameter": "TimeRange",
                                "timeContext": {
                                  "durationMs": 86400000
                                },
                                "metrics": [
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--Network In Total",
                                    "aggregation": 4
                                  },
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--Network Out Total",
                                    "aggregation": 4
                                  },
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--OS Disk Write Operations/Sec",
                                    "aggregation": 4
                                  },
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--OS Disk Read Operations/Sec",
                                    "aggregation": 4
                                  },
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--Data Disk Write Operations/Sec",
                                    "aggregation": 4
                                  },
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--Disk Read Operations/Sec",
                                    "aggregation": 4
                                  }
                                ],
                                "gridFormatType": 1,
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Metric",
                                    "formatter": 13,
                                    "formatOptions": {
                                      "linkTarget": "Resource",
                                      "showIcon": false
                                    }
                                  },
                                  "subtitleContent": {
                                    "columnMatch": "Aggregation"
                                  },
                                  "leftContent": {
                                    "columnMatch": "Value",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": true
                                },
                                "gridSettings": {
                                  "rowLimit": 10000
                                }
                              },
                              "name": "VM Metrics"
                            },
                            {
                              "type": 10,
                              "content": {
                                "chartId": "workbook95f2a469-3090-4fe7-878b-b0cc0d88a646",
                                "version": "MetricsItem/2.0",
                                "size": 4,
                                "chartType": 0,
                                "resourceType": "microsoft.compute/virtualmachines",
                                "metricScope": 0,
                                "resourceParameter": "VirtualMachines",
                                "resourceIds": [
                                  "{VirtualMachines}"
                                ],
                                "timeContextFromParameter": "TimeRange",
                                "timeContext": {
                                  "durationMs": 86400000
                                },
                                "metrics": [
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--Percentage CPU",
                                    "aggregation": 4
                                  },
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--Disk Read Bytes",
                                    "aggregation": 1
                                  },
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--Disk Write Bytes",
                                    "aggregation": 1
                                  },
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--Network In Total",
                                    "aggregation": 1
                                  },
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--Network Out Total",
                                    "aggregation": 1
                                  }
                                ],
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "Name",
                                    "formatter": 13
                                  },
                                  "leftContent": {
                                    "columnMatch": "Value",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                },
                                "resourceLimit": 10000,
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Subscription",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Name",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "linkTarget": "Resource"
                                      }
                                    },
                                    {
                                      "columnMatch": "Metric",
                                      "formatter": 1
                                    },
                                    {
                                      "columnMatch": "Aggregation",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Value",
                                      "formatter": 1
                                    },
                                    {
                                      "columnMatch": "Timeline",
                                      "formatter": 9,
                                      "formatOptions": {
                                        "palette": "blue"
                                      }
                                    },
                                    {
                                      "columnMatch": "-- Group By --",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Percentage CPU",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "blue",
                                        "linkTarget": "WorkbookTemplate",
                                        "workbookContext": {
                                          "componentIdSource": "column",
                                          "componentId": "Name",
                                          "resourceIdsSource": "column",
                                          "resourceIds": "Name",
                                          "templateIdSource": "static",
                                          "templateId": "COS//Virtual Machines/Virtual machine details",
                                          "typeSource": "static",
                                          "type": "workbook",
                                          "gallerySource": "static",
                                          "gallery": "microsoft.compute/virtualmachines",
                                          "locationSource": "default"
                                        }
                                      },
                                      "numberFormat": {
                                        "unit": 1,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Percentage CPU Timeline",
                                      "formatter": 21,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "blue"
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Disk Read Bytes",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "yellow"
                                      },
                                      "numberFormat": {
                                        "unit": 2,
                                        "options": {
                                          "style": "decimal",
                                          "maximumFractionDigits": 1
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Disk Read Bytes Timeline",
                                      "formatter": 5,
                                      "numberFormat": {
                                        "unit": 2,
                                        "options": {
                                          "style": "decimal",
                                          "maximumFractionDigits": 1
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Disk Write Bytes",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "yellow"
                                      },
                                      "numberFormat": {
                                        "unit": 2,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Disk Write Bytes Timeline",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Network In Total",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "orange"
                                      },
                                      "numberFormat": {
                                        "unit": 2,
                                        "options": {
                                          "style": "decimal",
                                          "maximumFractionDigits": 1
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Network In Total Timeline",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Network Out Total",
                                      "formatter": 1,
                                      "numberFormat": {
                                        "unit": 2,
                                        "options": null
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Network Out Total Timeline",
                                      "formatter": 5
                                    }
                                  ],
                                  "rowLimit": 10000,
                                  "sortBy": [
                                    {
                                      "itemKey": "$gen_heatmap_microsoft.compute/virtualmachines--Percentage CPU_2",
                                      "sortOrder": 1
                                    }
                                  ],
                                  "labelSettings": [
                                    {
                                      "columnId": "Subscription",
                                      "label": "Subscription"
                                    },
                                    {
                                      "columnId": "Name",
                                      "label": "Storage Name"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Percentage CPU",
                                      "label": "Percentage CPU (Average)"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Percentage CPU Timeline",
                                      "label": "Percentage CPU Timeline"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Disk Read Bytes",
                                      "label": "Disk Read Bytes (Sum)"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Disk Read Bytes Timeline",
                                      "label": "Disk Read Bytes Timeline"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Disk Write Bytes",
                                      "label": "Disk Write Bytes (Sum)"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Disk Write Bytes Timeline",
                                      "label": "Disk Write Bytes Timeline"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Network In Total",
                                      "label": "Network In Total (Sum)"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Network In Total Timeline",
                                      "label": "Network In Total Timeline"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Network Out Total",
                                      "label": "Network Out Total (Sum)"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Network Out Total Timeline",
                                      "label": "Network Out Total Timeline"
                                    }
                                  ]
                                },
                                "sortBy": [
                                  {
                                    "itemKey": "$gen_heatmap_microsoft.compute/virtualmachines--Percentage CPU_2",
                                    "sortOrder": 1
                                  }
                                ]
                              },
                              "name": "metric - 4"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "// Virtual Machine available memory \r\n// Virtual Machine available memory. \r\nInsightsMetrics\r\n\r\n| where Origin == \"vm.azm.ms\"\r\n| where Namespace == \"Memory\"\r\n| where Name == \"AvailableMB\"\r\n| summarize avg(Val) by bin(TimeGenerated, 5m), Computer\r\n| render timechart ",
                                "size": 1,
                                "title": "Available Memory",
                                "color": "orange",
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "{VirtualMachines}",
                                "crossComponentResources": [
                                  "{VirtualMachines}"
                                ],
                                "visualization": "timechart",
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "avg_Val",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                },
                                "graphSettings": {
                                  "type": 0,
                                  "topContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 1
                                  },
                                  "centerContent": {
                                    "columnMatch": "avg_Val",
                                    "formatter": 1,
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                },
                                "mapSettings": {
                                  "locInfo": "LatLong",
                                  "sizeSettings": "avg_Val",
                                  "sizeAggregation": "Sum",
                                  "legendMetric": "avg_Val",
                                  "legendAggregation": "Sum",
                                  "itemColorSettings": {
                                    "type": "heatmap",
                                    "colorAggregation": "Sum",
                                    "nodeColorField": "avg_Val",
                                    "heatmapPalette": "greenRed"
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "query - 4"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "// Chart CPU usage trends by computer\r\n// Calculate CPU usage patterns over the last hour, chart by percentiles.\r\nInsightsMetrics\r\n\r\n| where Origin == \"vm.azm.ms\"\r\n| where Namespace == \"Processor\"\r\n| where Name == \"UtilizationPercentage\"\r\n| summarize avg(Val) by bin(TimeGenerated, 5m), Computer //split up by computer\r\n| render timechart",
                                "size": 1,
                                "title": "CPU Trend",
                                "color": "lightBlue",
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.compute/virtualmachines",
                                "crossComponentResources": [
                                  "{VirtualMachines}"
                                ],
                                "visualization": "timechart"
                              },
                              "customWidth": "50",
                              "name": "CPU Trend"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "vmperformance"
                        },
                        "name": "VM Performance"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "parameters": [
                                  {
                                    "id": "7d3239b1-19a0-44fd-a771-df82340e0d88",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "DefaultResource",
                                    "type": 5,
                                    "value": "value::1",
                                    "isHiddenWhenLocked": true,
                                    "typeSettings": {
                                      "resourceTypeFilter": {
                                        "microsoft.resources/subscriptions": true,
                                        "microsoft.resources/resourcegroups": true
                                      },
                                      "additionalResourceOptions": [
                                        "value::1"
                                      ]
                                    }
                                  },
                                  {
                                    "id": "0caf61ec-d776-4642-8553-5293060a62c7",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ContextFree",
                                    "type": 1,
                                    "query": "{\"version\":\"1.0.0\",\"content\":\"\\\"{DefaultResource}\\\"\"}",
                                    "isHiddenWhenLocked": true,
                                    "queryType": 8
                                  },
                                  {
                                    "id": "6e82c4c1-769e-4549-bd80-b356ef999efa",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Selection",
                                    "type": 1,
                                    "query": "take 1\r\n| extend x = split ({DefaultResource:value}, '/')\r\n| project value = tostring(pack('sub', x[2], 'rg', case(x[4] != 'null', x[4], ''), 'vm', case(x[8] != 'null', x[8], '')))",
                                    "crossComponentResources": [
                                      "value::selected"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "timeContext": {
                                      "durationMs": 0
                                    },
                                    "timeContextFromParameter": "TimeRange",
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources"
                                  },
                                  {
                                    "id": "604f6d89-c6f9-4bdb-b4ca-483f56a8946c",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Subscriptions",
                                    "type": 6,
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "'",
                                    "delimiter": ",",
                                    "query": "where type in~('microsoft.compute/virtualmachines', 'microsoft.compute/virtualmachinescalesets')\r\n| summarize Count = count() by subscriptionId\r\n| order by Count desc\r\n| extend Rank = row_number()\r\n| project value = subscriptionId, label = subscriptionId, selected = iff(subscriptionId =~ todynamic('{Selection}').sub, true, false)",
                                    "crossComponentResources": [
                                      "value::selected"
                                    ],
                                    "value": [
                                      "value::1"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::1"
                                      ],
                                      "showDefault": false
                                    },
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources"
                                  },
                                  {
                                    "id": "efc388e8-ac7b-4e72-8573-e97cfe370f16",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ResourceGroup",
                                    "label": "Resource groups",
                                    "type": 2,
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "'",
                                    "delimiter": ",",
                                    "query": "where type in~('microsoft.compute/virtualmachines', 'microsoft.compute/virtualmachinescalesets')\r\n| summarize Count = count() by resourceGroup\r\n| order by Count desc\r\n| extend Rank = row_number()\r\n| project value = resourceGroup, label = resourceGroup, selected = iff(resourceGroup =~ todynamic('{Selection}').rg, true, false)\r\n| order by value asc",
                                    "crossComponentResources": [
                                      "{Subscriptions}"
                                    ],
                                    "value": [
                                      "value::all"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::all"
                                      ]
                                    },
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources"
                                  },
                                  {
                                    "id": "ff31cd1b-224e-42bd-8d65-f803ca13ce13",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Resources",
                                    "label": "Virtual machines",
                                    "type": 5,
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "'",
                                    "delimiter": ",",
                                    "query": "Resources \r\n| where resourceGroup in~({ResourceGroup}) and type in~('microsoft.compute/virtualmachines', 'microsoft.compute/virtualmachinescalesets')\r\n| project id, name, selected=false, group=iff(type =~ \"microsoft.compute/virtualmachines\", \"Virtual machines\", \"Virtual machine scale sets\")",
                                    "crossComponentResources": [
                                      "{Subscriptions}"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::5",
                                        "value::all"
                                      ],
                                      "showDefault": false
                                    },
                                    "defaultValue": "value::5",
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources"
                                  },
                                  {
                                    "id": "feb5ccab-6fe6-4c5f-9161-ca0e412bd637",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TimeRange",
                                    "label": "Time range",
                                    "type": 4,
                                    "value": {
                                      "durationMs": 1800000
                                    },
                                    "typeSettings": {
                                      "selectableValues": [
                                        {
                                          "durationMs": 1800000
                                        },
                                        {
                                          "durationMs": 3600000
                                        },
                                        {
                                          "durationMs": 14400000
                                        },
                                        {
                                          "durationMs": 43200000
                                        },
                                        {
                                          "durationMs": 86400000
                                        },
                                        {
                                          "durationMs": 172800000
                                        },
                                        {
                                          "durationMs": 259200000
                                        },
                                        {
                                          "durationMs": 604800000
                                        },
                                        {
                                          "durationMs": 1209600000
                                        },
                                        {
                                          "durationMs": 2592000000
                                        }
                                      ],
                                      "allowCustom": true
                                    }
                                  },
                                  {
                                    "id": "d643672d-1bc2-497d-a5ce-20f631ee9399",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ResourceScope",
                                    "type": 7,
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "'",
                                    "delimiter": ",",
                                    "query": "Resources\r\n| take 1\r\n| project x = dynamic([\"microsoft.compute/virtualmachines\", \"microsoft.compute/virtualmachinescalesets\", \"microsoft.resources/resourcegroups\", \"microsoft.resources/subscriptions\"])\r\n| mvexpand x to typeof(string)\r\n| extend jkey = 1\r\n| join kind = inner (Resources \r\n| where id in~ ({Resources})\r\n| summarize Subs = dcount(subscriptionId), resourceGroups = dcount(resourceGroup), resourceCount = count()\r\n| extend jkey = 1) on jkey\r\n| project x, label = 'x', selected = case(x in ('microsoft.compute/virtualmachinescalesets', 'microsoft.compute/virtualmachines') and resourceCount <= 5, true, x == 'microsoft.resources/resourcegroups' and resourceGroups <= 3 and resourceCount > 5, true, x == 'microsoft.resources/subscriptions' and resourceGroups > 3 and resourceCount > 5, true, false)\r\n",
                                    "crossComponentResources": [
                                      "{Subscriptions}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources"
                                  },
                                  {
                                    "id": "1a0a93cf-0406-40d1-80e1-572b1a8d640e",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TimeGrain",
                                    "type": 2,
                                    "isRequired": true,
                                    "value": "30m",
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    {\r\n        \"label\": \"1 minute\",\r\n        \"value\": \"1m\"\r\n    },\r\n    {\r\n        \"label\": \"5 minutes\",\r\n        \"value\": \"5m\"\r\n    },\r\n    {\r\n        \"label\": \"15 minutes\",\r\n        \"value\": \"15m\"\r\n    },\r\n    {\r\n        \"label\": \"30 minutes\",\r\n        \"value\": \"30m\"\r\n    },\r\n    {\r\n        \"label\": \"1 hour\",\r\n        \"value\": \"1h\"\r\n    }\r\n]"
                                  },
                                  {
                                    "id": "112823d7-bf58-4604-a299-78ccc5899516",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "LineChartQuerySnippet",
                                    "type": 1,
                                    "query": "print(\"bin(TimeGenerated, {TimeGrain}), ResourceName | render linechart\")",
                                    "crossComponentResources": [
                                      "{Subscriptions}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "7055a395-0d53-4724-93ad-15e03d4e2ffa",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "GridQuerySnippet",
                                    "type": 1,
                                    "value": "ResourceName",
                                    "isHiddenWhenLocked": true
                                  },
                                  {
                                    "id": "9c56155c-9a7e-41db-ac56-40cabb7d7ddf",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TopN",
                                    "type": 1,
                                    "isRequired": true,
                                    "query": "print 5",
                                    "crossComponentResources": [
                                      "{Subscriptions}"
                                    ],
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "4261aa48-5274-47a9-8642-1618c8aa7a95",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Mode",
                                    "type": 2,
                                    "isRequired": true,
                                    "value": "1",
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    {\r\n        \"label\": \"Locked\",\r\n        \"value\": \"1\"\r\n    },\r\n    {\r\n        \"label\": \"Unlocked\",\r\n        \"value\": \"0\"\r\n    }\r\n]"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources"
                              },
                              "name": "parameters - 0"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "parameters": [
                                  {
                                    "id": "aa2368fc-ad30-4608-b96a-72abf7b1e1af",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Counter1",
                                    "label": "Counter",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "InsightsMetrics\r\n| where TimeGenerated {TimeRange}\r\n| summarize by Name, Namespace, CounterText = Name\r\n| order by Namespace asc, CounterText asc\r\n| project Counter = pack('counter', Name, 'object', Namespace), CounterText, group = Namespace",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "6a7306ea-247f-46ca-abca-501911f9e9d3",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregator1",
                                    "label": "Trend Aggregator",
                                    "type": 2,
                                    "isRequired": true,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    { \"value\":\"Average = round(avg(Val), 2)\", \"label\":\"Average\", \"selected\":false},\r\n    { \"value\":\"P5th = round(percentile(Val, 5), 2)\", \"label\":\"P5th\", \"selected\":false},\r\n    { \"value\":\"P10th = round(percentile(Val, 10), 2)\", \"label\":\"P10th\", \"selected\":false},\r\n    { \"value\":\"P50th = round(percentile(Val, 50), 2)\", \"label\":\"P50th\", \"selected\":false},\r\n    { \"value\":\"P80th = round(percentile(Val, 80), 2)\", \"label\":\"P80th\", \"selected\":false},\r\n    { \"value\":\"P90th = round(percentile(Val, 90), 2)\", \"label\":\"P90th\", \"selected\":false},\r\n    { \"value\":\"P95th = round(percentile(Val, 95), 2)\", \"label\":\"P95th\", \"selected\":true}    \r\n]"
                                  },
                                  {
                                    "id": "0327f26e-cdde-4b48-b512-6c35f06ad1d0",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregatorOrder1",
                                    "type": 1,
                                    "query": "print(iff('{TrendAggregator1:label}' == 'P5th'  or '{TrendAggregator1:label}' == 'P10th', 'asc', 'desc'))",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "d026cf36-d22e-4f92-a577-94220726ba3f",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Visualization",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "datatable (value:long, Display:string, isSelected:boolean)\r\n    [0, \"Line Chart\", true,\r\n     1, \"Grid\", false]",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "a9ac011f-176f-4c31-b82e-139aba93a426",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Snippet1",
                                    "type": 1,
                                    "isRequired": true,
                                    "query": "print(iff({Visualization} == 0, \"{LineChartQuerySnippet}\", \"{GridQuerySnippet}\") )",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "26106dfe-4e33-4c7c-b4b6-2eff5cc76476",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Unit",
                                    "type": 2,
                                    "value": null,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    {\r\n        \"label\": \"B -> MB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"B -> GB\",\r\n        \"value\": \"/1024/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> GB\",\r\n        \"value\": \"/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> TB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Mb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Gb\",\r\n        \"value\": \"/1000/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Gb\",\r\n        \"value\": \"/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Tb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"s -> ms\",\r\n        \"value\": \"*1000\"\r\n    },\r\n    {\r\n        \"label\": \"ms -> s\",\r\n        \"value\": \"/1000\"\r\n    }\r\n]"
                                  }
                                ],
                                "style": "above",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/subscriptions"
                              },
                              "customWidth": "25",
                              "conditionalVisibility": {
                                "parameterName": "Mode",
                                "comparison": "isEqualTo",
                                "value": "0"
                              },
                              "name": "parameters - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "parameters": [
                                  {
                                    "id": "aa2368fc-ad30-4608-b96a-72abf7b1e1af",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Counter2",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "InsightsMetrics\r\n| where TimeGenerated {TimeRange}\r\n| summarize by Name, Namespace, CounterText = Name\r\n| order by Namespace asc, CounterText asc\r\n| project Counter = pack('counter', Name, 'object', Namespace), CounterText, group = Namespace",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "value": "{\"counter\":\"AvailableMB\",\"object\":\"Memory\"}",
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "6a7306ea-247f-46ca-abca-501911f9e9d3",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregator2",
                                    "type": 2,
                                    "isRequired": true,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    { \"value\":\"Average = round(avg(Val), 2)\", \"label\":\"Average\", \"selected\":false},\r\n    { \"value\":\"P5th = round(percentile(Val, 5), 2)\", \"label\":\"P5th\", \"selected\":false},\r\n    { \"value\":\"P10th = round(percentile(Val, 10), 2)\", \"label\":\"P10th\", \"selected\":false},\r\n    { \"value\":\"P50th = round(percentile(Val, 50), 2)\", \"label\":\"P50th\", \"selected\":false},\r\n    { \"value\":\"P80th = round(percentile(Val, 80), 2)\", \"label\":\"P80th\", \"selected\":false},\r\n    { \"value\":\"P90th = round(percentile(Val, 90), 2)\", \"label\":\"P90th\", \"selected\":false},\r\n    { \"value\":\"P95th = round(percentile(Val, 95), 2)\", \"label\":\"P95th\", \"selected\":true}    \r\n]",
                                    "value": "P5th = round(percentile(Val, 5), 2)"
                                  },
                                  {
                                    "id": "0327f26e-cdde-4b48-b512-6c35f06ad1d0",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregatorOrder2",
                                    "type": 1,
                                    "query": "print(iff('{TrendAggregator2:label}' == 'P5th'  or '{TrendAggregator2:label}' == 'P10th', 'asc', 'desc'))",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "bf55b759-7b6a-4ea6-8040-e3e6cc2ffe25",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Visualization2",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "datatable (value:long, Display:string, isSelected:boolean)\r\n    [0, \"Line Chart\", true,\r\n     1, \"Grid\", false]",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "de7bf116-f413-457b-8c71-fb95cc6adc87",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Snippet2",
                                    "type": 1,
                                    "isRequired": true,
                                    "query": "print(iff({Visualization2} == 0, \"{LineChartQuerySnippet}\", \"{GridQuerySnippet}\") )",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "2ce20c70-a462-4c7d-b5af-7f3b4cc27511",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Unit2",
                                    "type": 2,
                                    "value": null,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    {\r\n        \"label\": \"B -> MB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"B -> GB\",\r\n        \"value\": \"/1024/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> GB\",\r\n        \"value\": \"/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> TB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Mb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Gb\",\r\n        \"value\": \"/1000/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Gb\",\r\n        \"value\": \"/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Tb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"s -> ms\",\r\n        \"value\": \"*1000\"\r\n    },\r\n    {\r\n        \"label\": \"ms -> s\",\r\n        \"value\": \"/1000\"\r\n    }\r\n]"
                                  }
                                ],
                                "style": "above",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/subscriptions"
                              },
                              "customWidth": "25",
                              "conditionalVisibility": {
                                "parameterName": "Mode",
                                "comparison": "isEqualTo",
                                "value": "0"
                              },
                              "name": "parameters - 3"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "parameters": [
                                  {
                                    "id": "aa2368fc-ad30-4608-b96a-72abf7b1e1af",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Counter3",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "InsightsMetrics\r\n| where TimeGenerated {TimeRange}\r\n| summarize by Name, Namespace, CounterText = Name\r\n| order by Namespace asc, CounterText asc\r\n| project Counter = pack('counter', Name, 'object', Namespace), CounterText, group = Namespace",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "value": "{\"counter\":\"UtilizationPercentage\",\"object\":\"Processor\"}",
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::1"
                                      ]
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "6a7306ea-247f-46ca-abca-501911f9e9d3",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregator3",
                                    "type": 2,
                                    "isRequired": true,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    { \"value\":\"Average = round(avg(Val), 2)\", \"label\":\"Average\", \"selected\":false},\r\n    { \"value\":\"P5th = round(percentile(Val, 5), 2)\", \"label\":\"P5th\", \"selected\":false},\r\n    { \"value\":\"P10th = round(percentile(Val, 10), 2)\", \"label\":\"P10th\", \"selected\":false},\r\n    { \"value\":\"P50th = round(percentile(Val, 50), 2)\", \"label\":\"P50th\", \"selected\":false},\r\n    { \"value\":\"P80th = round(percentile(Val, 80), 2)\", \"label\":\"P80th\", \"selected\":false},\r\n    { \"value\":\"P90th = round(percentile(Val, 90), 2)\", \"label\":\"P90th\", \"selected\":false},\r\n    { \"value\":\"P95th = round(percentile(Val, 95), 2)\", \"label\":\"P95th\", \"selected\":true}    \r\n]"
                                  },
                                  {
                                    "id": "0327f26e-cdde-4b48-b512-6c35f06ad1d0",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregatorOrder3",
                                    "type": 1,
                                    "query": "print(iff('{TrendAggregator3:label}' == 'P5th'  or '{TrendAggregator3:label}' == 'P10th', 'asc', 'desc'))",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "db1c9737-0d87-41ad-8f3c-f22c853be400",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Visualization3",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "datatable (value:long, Display:string, isSelected:boolean)\r\n    [0, \"Line Chart\", true,\r\n     1, \"Grid\", false]",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "82cef2b6-4ce0-4a64-bd64-017810211147",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Snippet3",
                                    "type": 1,
                                    "isRequired": true,
                                    "query": "print(iff({Visualization3} == 0, \"{LineChartQuerySnippet}\", \"{GridQuerySnippet}\") )",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "def72a65-f496-4619-8fcb-85c338641907",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Unit3",
                                    "type": 2,
                                    "value": null,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    {\r\n        \"label\": \"B -> MB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"B -> GB\",\r\n        \"value\": \"/1024/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> GB\",\r\n        \"value\": \"/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> TB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Mb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Gb\",\r\n        \"value\": \"/1000/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Gb\",\r\n        \"value\": \"/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Tb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"s -> ms\",\r\n        \"value\": \"*1000\"\r\n    },\r\n    {\r\n        \"label\": \"ms -> s\",\r\n        \"value\": \"/1000\"\r\n    }\r\n]"
                                  }
                                ],
                                "style": "above",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/subscriptions"
                              },
                              "customWidth": "25",
                              "conditionalVisibility": {
                                "parameterName": "Mode",
                                "comparison": "isEqualTo",
                                "value": "0"
                              },
                              "name": "parameters - 4"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "parameters": [
                                  {
                                    "id": "aa2368fc-ad30-4608-b96a-72abf7b1e1af",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Counter4",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "InsightsMetrics\r\n| where TimeGenerated {TimeRange}\r\n| summarize by Name, Namespace, CounterText = Name\r\n| order by Namespace asc, CounterText asc\r\n| project Counter = pack('counter', Name, 'object', Namespace), CounterText, group = Namespace",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "value": "{\"counter\":\"BytesPerSecond\",\"object\":\"LogicalDisk\"}",
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "6a7306ea-247f-46ca-abca-501911f9e9d3",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregator4",
                                    "type": 2,
                                    "isRequired": true,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    { \"value\":\"Average = round(avg(Val), 2)\", \"label\":\"Average\", \"selected\":false},\r\n    { \"value\":\"P5th = round(percentile(Val, 5), 2)\", \"label\":\"P5th\", \"selected\":false},\r\n    { \"value\":\"P10th = round(percentile(Val, 10), 2)\", \"label\":\"P10th\", \"selected\":false},\r\n    { \"value\":\"P50th = round(percentile(Val, 50), 2)\", \"label\":\"P50th\", \"selected\":false},\r\n    { \"value\":\"P80th = round(percentile(Val, 80), 2)\", \"label\":\"P80th\", \"selected\":false},\r\n    { \"value\":\"P90th = round(percentile(Val, 90), 2)\", \"label\":\"P90th\", \"selected\":false},\r\n    { \"value\":\"P95th = round(percentile(Val, 95), 2)\", \"label\":\"P95th\", \"selected\":true}    \r\n]"
                                  },
                                  {
                                    "id": "0327f26e-cdde-4b48-b512-6c35f06ad1d0",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregatorOrder4",
                                    "type": 1,
                                    "query": "print(iff('{TrendAggregator4:label}' == 'P5th'  or '{TrendAggregator4:label}' == 'P10th', 'asc', 'desc'))",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "16d42161-ad5d-4bd8-9b2a-8e834e3b8fed",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Visualization4",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "datatable (value:long, Display:string, isSelected:boolean)\r\n    [0, \"Line Chart\", true,\r\n     1, \"Grid\", false]",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "d768c009-20aa-4476-83cd-afacf4694818",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Snippet4",
                                    "type": 1,
                                    "isRequired": true,
                                    "query": "print(iff({Visualization4} == 0, \"{LineChartQuerySnippet}\", \"{GridQuerySnippet}\") )",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "eb3e4d65-ee3c-481c-af2e-8b41e4049bf8",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Unit4",
                                    "type": 2,
                                    "value": null,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    {\r\n        \"label\": \"B -> MB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"B -> GB\",\r\n        \"value\": \"/1024/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> GB\",\r\n        \"value\": \"/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> TB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Mb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Gb\",\r\n        \"value\": \"/1000/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Gb\",\r\n        \"value\": \"/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Tb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"s -> ms\",\r\n        \"value\": \"*1000\"\r\n    },\r\n    {\r\n        \"label\": \"ms -> s\",\r\n        \"value\": \"/1000\"\r\n    }\r\n]"
                                  }
                                ],
                                "style": "above",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/subscriptions"
                              },
                              "customWidth": "25",
                              "conditionalVisibility": {
                                "parameterName": "Mode",
                                "comparison": "isEqualTo",
                                "value": "0"
                              },
                              "name": "parameters - 5"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "<h3 style=\"margin-bottom:0;\">{Counter1:label}</h3><h4 style=\"margin-top:0;font-weight:normal;color:#777;\">{TrendAggregator1:label} {TrendAggregatorOrder1} {Unit:label}</h4>"
                              },
                              "customWidth": "25",
                              "name": "text - 5"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "<h3 style=\"margin-bottom:0;\">{Counter2:label}</h3><h4 style=\"margin-top:0;font-weight:normal;color:#777;\">{TrendAggregator2:label} {TrendAggregatorOrder2} {Unit2:label}</h4>"
                              },
                              "customWidth": "25",
                              "name": "text - 7"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "<h3 style=\"margin-bottom:0;\">{Counter3:label}</h3><h4 style=\"margin-top:0;font-weight:normal;color:#777;\">{TrendAggregator3:label} {TrendAggregatorOrder3} {Unit3:label}</h4>"
                              },
                              "customWidth": "25",
                              "name": "text - 8"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "<h3 style=\"margin-bottom:0;\">{Counter4:label}</h3><h4 style=\"margin-top:0;font-weight:normal;color:#777;\">{TrendAggregator4:label} {TrendAggregatorOrder4} {Unit4:label}</h4>"
                              },
                              "customWidth": "25",
                              "name": "text - 9"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let metric = dynamic({Counter1});\r\nlet cpuSummary=totable(InsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where _ResourceId in~ ({Resources})\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | summarize hint.shufflekey=Computer {TrendAggregator1:value} by Computer, Name\r\n    | top {TopN} by {TrendAggregator1:label} {TrendAggregatorOrder1});\r\nlet computerList=(cpuSummary \r\n    | project Computer);\r\nlet EmptyNodeIdentityAndProps = datatable(Computer:string, NodeId:string, NodeProps:dynamic, Priority: long) [];\r\nlet OmsNodeIdentityAndProps = computerList\r\n    | extend NodeId = Computer\r\n    | extend Priority = 1\r\n    | extend NodeProps = pack('type', 'StandAloneNode', 'name', Computer);\r\nlet ServiceMapNodeIdentityAndProps = VMComputer | extend ResourceId=strcat('machines/', Machine) | extend Bitness=columnifexists('Bitness', '')\r\n    | where TimeGenerated {TimeRange}\r\n    | where Computer in (computerList)\r\n    | summarize arg_max(TimeGenerated, *) by Computer\r\n    | extend AzureCloudServiceNodeIdentity = iif(isnotempty(AzureCloudServiceName), strcat(AzureCloudServiceInstanceId, '|',                     AzureCloudServiceDeployment), ''),          AzureScaleSetNodeIdentity = iif(isnotempty(AzureVmScaleSetName),              strcat(AzureVmScaleSetInstanceId, '|',                     AzureVmScaleSetDeployment), ''),          ComputerProps =              pack('type', 'StandAloneNode',                   'name', Computer,                   'mappingResourceId', ResourceId,                   'subscriptionId', AzureSubscriptionId,                   'resourceGroup', AzureResourceGroup,                   'azureResourceId', columnifexists('_ResourceId', '')),          AzureCloudServiceNodeProps =              pack('type', 'AzureCloudServiceNode',                   'cloudServiceInstanceId', AzureCloudServiceInstanceId,                   'cloudServiceRoleName', columnifexists('AzureCloudServiceRoleName', ''),                   'cloudServiceDeploymentId', AzureCloudServiceDeployment,                   'cloudServiceName', AzureCloudServiceName,                   'mappingResourceId', ResourceId),          AzureScaleSetNodeProps =               pack('type', 'AzureScaleSetNode',                   'scaleSetInstanceId', columnifexists('Computer', ''),                   'vmScaleSetDeploymentId', AzureVmScaleSetDeployment,                   'vmScaleSetName', AzureVmScaleSetName,                   'serviceFabricClusterName', AzureServiceFabricClusterName,                   'vmScaleSetResourceId', AzureVmScaleSetResourceId,                   'resourceGroupName', columnifexists('AzureResourceGroup', ''),                   'subscriptionId', columnifexists('AzureSubscriptionId', ''),                   'mappingResourceId', ResourceId)| project   Computer,            NodeId = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeIdentity,                       isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeIdentity, Computer),            NodeProps = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeProps,                          isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeProps, ComputerProps),            Priority = 2;\r\nlet NodeIdentityAndProps = union kind=inner isfuzzy = true                                  EmptyNodeIdentityAndProps, OmsNodeIdentityAndProps, ServiceMapNodeIdentityAndProps                            \r\n    | summarize arg_max(Priority, *) by Computer; \r\nlet NodeIdentityAndPropsMin = NodeIdentityAndProps\r\n    | extend Kind = iff(NodeProps.type == \"StandAloneNode\", iff(NodeProps.azureResourceId == \"\", \"Non-Azure Virtual Machine\", \"Azure Virtual Machine\"), NodeProps.type), \r\n    ResourceId = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.vmScaleSetResourceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceDeploymentId, Computer)),\r\n    ResourceName = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.scaleSetInstanceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceInstanceId, Computer))\r\n    | project Computer, Kind, ResourceId, ResourceName;\r\nInsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | where Computer in (computerList)\r\n    | join kind=leftouter (NodeIdentityAndPropsMin) on Computer\r\n    | summarize {TrendAggregator1:value}{Unit} by {Snippet1}\r\n\t\r\n",
                                "size": 0,
                                "aggregation": 3,
                                "showAnnotations": true,
                                "noDataMessage": "No computers are emitting data for this performance counter.",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/resourcegroups",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "value",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "25",
                              "name": "query - 10"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let metric = dynamic({Counter2});\r\nlet cpuSummary=totable(InsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where _ResourceId in~ ({Resources})\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | summarize hint.shufflekey=Computer {TrendAggregator2} by Computer, Name\r\n    | top {TopN} by {TrendAggregator2:label} {TrendAggregatorOrder2});\r\nlet computerList=(cpuSummary \r\n    | project Computer);\r\nlet EmptyNodeIdentityAndProps = datatable(Computer:string, NodeId:string, NodeProps:dynamic, Priority: long) [];\r\nlet OmsNodeIdentityAndProps = computerList\r\n    | extend NodeId = Computer\r\n    | extend Priority = 1\r\n    | extend NodeProps = pack('type', 'StandAloneNode', 'name', Computer);\r\nlet ServiceMapNodeIdentityAndProps = VMComputer | extend ResourceId=strcat('machines/', Machine) | extend Bitness=columnifexists('Bitness', '')\r\n    | where TimeGenerated {TimeRange}\r\n    | where Computer in (computerList)\r\n    | summarize arg_max(TimeGenerated, *) by Computer\r\n    | extend AzureCloudServiceNodeIdentity = iif(isnotempty(AzureCloudServiceName), strcat(AzureCloudServiceInstanceId, '|',                     AzureCloudServiceDeployment), ''),          AzureScaleSetNodeIdentity = iif(isnotempty(AzureVmScaleSetName),              strcat(AzureVmScaleSetInstanceId, '|',                     AzureVmScaleSetDeployment), ''),          ComputerProps =              pack('type', 'StandAloneNode',                   'name', Computer,                   'mappingResourceId', ResourceId,                   'subscriptionId', AzureSubscriptionId,                   'resourceGroup', AzureResourceGroup,                   'azureResourceId', columnifexists('_ResourceId', '')),          AzureCloudServiceNodeProps =              pack('type', 'AzureCloudServiceNode',                   'cloudServiceInstanceId', AzureCloudServiceInstanceId,                   'cloudServiceRoleName', columnifexists('AzureCloudServiceRoleName', ''),                   'cloudServiceDeploymentId', AzureCloudServiceDeployment,                   'cloudServiceName', AzureCloudServiceName,                   'mappingResourceId', ResourceId),          AzureScaleSetNodeProps =               pack('type', 'AzureScaleSetNode',                   'scaleSetInstanceId', columnifexists('Computer', ''),                   'vmScaleSetDeploymentId', AzureVmScaleSetDeployment,                   'vmScaleSetName', AzureVmScaleSetName,                   'serviceFabricClusterName', AzureServiceFabricClusterName,                   'vmScaleSetResourceId', AzureVmScaleSetResourceId,                   'resourceGroupName', columnifexists('AzureResourceGroup', ''),                   'subscriptionId', columnifexists('AzureSubscriptionId', ''),                   'mappingResourceId', ResourceId)| project   Computer,            NodeId = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeIdentity,                       isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeIdentity, Computer),            NodeProps = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeProps,                          isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeProps, ComputerProps),            Priority = 2;\r\nlet NodeIdentityAndProps = union kind=inner isfuzzy = true                                  EmptyNodeIdentityAndProps, OmsNodeIdentityAndProps, ServiceMapNodeIdentityAndProps                            \r\n    | summarize arg_max(Priority, *) by Computer; \r\nlet NodeIdentityAndPropsMin = NodeIdentityAndProps\r\n    | extend Kind = iff(NodeProps.type == \"StandAloneNode\", iff(NodeProps.azureResourceId == \"\", \"Non-Azure Virtual Machine\", \"Azure Virtual Machine\"), NodeProps.type), \r\n    ResourceId = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.vmScaleSetResourceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceDeploymentId, Computer)),\r\n    ResourceName = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.scaleSetInstanceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceInstanceId, Computer))\r\n    | project Computer, Kind, ResourceId, ResourceName;\r\nInsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | where Computer in (computerList)\r\n    | join kind=leftouter (NodeIdentityAndPropsMin) on Computer\r\n    | summarize {TrendAggregator2}{Unit2} by {Snippet2}",
                                "size": 0,
                                "aggregation": 3,
                                "showAnnotations": true,
                                "noDataMessage": "No computers are emitting data for this performance counter.",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/resourcegroups",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "value",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "25",
                              "name": "query - 11"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let metric = dynamic({Counter3});\r\nlet cpuSummary=totable(InsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where _ResourceId in~ ({Resources})\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | summarize hint.shufflekey=Computer {TrendAggregator3} by Computer, Name\r\n    | top {TopN} by {TrendAggregator3:label} {TrendAggregatorOrder3});\r\nlet computerList=(cpuSummary \r\n    | project Computer);\r\nlet EmptyNodeIdentityAndProps = datatable(Computer:string, NodeId:string, NodeProps:dynamic, Priority: long) [];\r\nlet OmsNodeIdentityAndProps = computerList\r\n    | extend NodeId = Computer\r\n    | extend Priority = 1\r\n    | extend NodeProps = pack('type', 'StandAloneNode', 'name', Computer);\r\nlet ServiceMapNodeIdentityAndProps = VMComputer | extend ResourceId=strcat('machines/', Machine) | extend Bitness=columnifexists('Bitness', '')\r\n    | where TimeGenerated {TimeRange}\r\n    | where Computer in (computerList)\r\n    | summarize arg_max(TimeGenerated, *) by Computer\r\n    | extend AzureCloudServiceNodeIdentity = iif(isnotempty(AzureCloudServiceName), strcat(AzureCloudServiceInstanceId, '|',                     AzureCloudServiceDeployment), ''),          AzureScaleSetNodeIdentity = iif(isnotempty(AzureVmScaleSetName),              strcat(AzureVmScaleSetInstanceId, '|',                     AzureVmScaleSetDeployment), ''),          ComputerProps =              pack('type', 'StandAloneNode',                   'name', Computer,                   'mappingResourceId', ResourceId,                   'subscriptionId', AzureSubscriptionId,                   'resourceGroup', AzureResourceGroup,                   'azureResourceId', columnifexists('_ResourceId', '')),          AzureCloudServiceNodeProps =              pack('type', 'AzureCloudServiceNode',                   'cloudServiceInstanceId', AzureCloudServiceInstanceId,                   'cloudServiceRoleName', columnifexists('AzureCloudServiceRoleName', ''),                   'cloudServiceDeploymentId', AzureCloudServiceDeployment,                   'cloudServiceName', AzureCloudServiceName,                   'mappingResourceId', ResourceId),          AzureScaleSetNodeProps =               pack('type', 'AzureScaleSetNode',                   'scaleSetInstanceId', columnifexists('Computer', ''),                   'vmScaleSetDeploymentId', AzureVmScaleSetDeployment,                   'vmScaleSetName', AzureVmScaleSetName,                   'serviceFabricClusterName', AzureServiceFabricClusterName,                   'vmScaleSetResourceId', AzureVmScaleSetResourceId,                   'resourceGroupName', columnifexists('AzureResourceGroup', ''),                   'subscriptionId', columnifexists('AzureSubscriptionId', ''),                   'mappingResourceId', ResourceId)| project   Computer,            NodeId = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeIdentity,                       isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeIdentity, Computer),            NodeProps = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeProps,                          isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeProps, ComputerProps),            Priority = 2;\r\nlet NodeIdentityAndProps = union kind=inner isfuzzy = true                                  EmptyNodeIdentityAndProps, OmsNodeIdentityAndProps, ServiceMapNodeIdentityAndProps                            \r\n    | summarize arg_max(Priority, *) by Computer; \r\nlet NodeIdentityAndPropsMin = NodeIdentityAndProps\r\n    | extend Kind = iff(NodeProps.type == \"StandAloneNode\", iff(NodeProps.azureResourceId == \"\", \"Non-Azure Virtual Machine\", \"Azure Virtual Machine\"), NodeProps.type), \r\n    ResourceId = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.vmScaleSetResourceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceDeploymentId, Computer)),\r\n    ResourceName = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.scaleSetInstanceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceInstanceId, Computer))\r\n    | project Computer, Kind, ResourceId, ResourceName;\r\nInsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | where Computer in (computerList)\r\n    | join kind=leftouter (NodeIdentityAndPropsMin) on Computer\r\n    | summarize {TrendAggregator3}{Unit3} by {Snippet3}",
                                "size": 0,
                                "aggregation": 3,
                                "showAnnotations": true,
                                "noDataMessage": "No computers are emitting data for this performance counter.",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/resourcegroups",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "value",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "25",
                              "name": "query - 12"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let metric = dynamic({Counter4});\r\nlet cpuSummary=totable(InsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where _ResourceId in~ ({Resources})\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | summarize hint.shufflekey=Computer {TrendAggregator4} by Computer, Name\r\n    | top {TopN} by {TrendAggregator4:label} {TrendAggregatorOrder4});\r\nlet computerList=(cpuSummary \r\n    | project Computer);\r\nlet EmptyNodeIdentityAndProps = datatable(Computer:string, NodeId:string, NodeProps:dynamic, Priority: long) [];\r\nlet OmsNodeIdentityAndProps = computerList\r\n    | extend NodeId = Computer\r\n    | extend Priority = 1\r\n    | extend NodeProps = pack('type', 'StandAloneNode', 'name', Computer);\r\nlet ServiceMapNodeIdentityAndProps = VMComputer | extend ResourceId=strcat('machines/', Machine) | extend Bitness=columnifexists('Bitness', '')\r\n    | where TimeGenerated {TimeRange}\r\n    | where Computer in (computerList)\r\n    | summarize arg_max(TimeGenerated, *) by Computer\r\n    | extend AzureCloudServiceNodeIdentity = iif(isnotempty(AzureCloudServiceName), strcat(AzureCloudServiceInstanceId, '|',                     AzureCloudServiceDeployment), ''),          AzureScaleSetNodeIdentity = iif(isnotempty(AzureVmScaleSetName),              strcat(AzureVmScaleSetInstanceId, '|',                     AzureVmScaleSetDeployment), ''),          ComputerProps =              pack('type', 'StandAloneNode',                   'name', Computer,                   'mappingResourceId', ResourceId,                   'subscriptionId', AzureSubscriptionId,                   'resourceGroup', AzureResourceGroup,                   'azureResourceId', columnifexists('_ResourceId', '')),          AzureCloudServiceNodeProps =              pack('type', 'AzureCloudServiceNode',                   'cloudServiceInstanceId', AzureCloudServiceInstanceId,                   'cloudServiceRoleName', columnifexists('AzureCloudServiceRoleName', ''),                   'cloudServiceDeploymentId', AzureCloudServiceDeployment,                   'cloudServiceName', AzureCloudServiceName,                   'mappingResourceId', ResourceId),          AzureScaleSetNodeProps =               pack('type', 'AzureScaleSetNode',                   'scaleSetInstanceId', columnifexists('Computer', ''),                   'vmScaleSetDeploymentId', AzureVmScaleSetDeployment,                   'vmScaleSetName', AzureVmScaleSetName,                   'serviceFabricClusterName', AzureServiceFabricClusterName,                   'vmScaleSetResourceId', AzureVmScaleSetResourceId,                   'resourceGroupName', columnifexists('AzureResourceGroup', ''),                   'subscriptionId', columnifexists('AzureSubscriptionId', ''),                   'mappingResourceId', ResourceId)| project   Computer,            NodeId = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeIdentity,                       isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeIdentity, Computer),            NodeProps = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeProps,                          isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeProps, ComputerProps),            Priority = 2;\r\nlet NodeIdentityAndProps = union kind=inner isfuzzy = true                                  EmptyNodeIdentityAndProps, OmsNodeIdentityAndProps, ServiceMapNodeIdentityAndProps                            \r\n    | summarize arg_max(Priority, *) by Computer; \r\nlet NodeIdentityAndPropsMin = NodeIdentityAndProps\r\n    | extend Kind = iff(NodeProps.type == \"StandAloneNode\", iff(NodeProps.azureResourceId == \"\", \"Non-Azure Virtual Machine\", \"Azure Virtual Machine\"), NodeProps.type), \r\n    ResourceId = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.vmScaleSetResourceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceDeploymentId, Computer)),\r\n    ResourceName = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.scaleSetInstanceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceInstanceId, Computer))\r\n    | project Computer, Kind, ResourceId, ResourceName;\r\nInsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | where Computer in (computerList)\r\n    | join kind=leftouter (NodeIdentityAndPropsMin) on Computer\r\n    | summarize {TrendAggregator4}{Unit4} by {Snippet4}",
                                "size": 0,
                                "aggregation": 3,
                                "showAnnotations": true,
                                "noDataMessage": "No computers are emitting data for this performance counter.",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/resourcegroups",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "value",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "25",
                              "name": "query - 13"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "parameters": [
                                  {
                                    "id": "aa2368fc-ad30-4608-b96a-72abf7b1e1af",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Counter5",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "InsightsMetrics\r\n| where TimeGenerated {TimeRange}\r\n| summarize by Name, Namespace, CounterText = Name\r\n| order by Namespace asc, CounterText asc\r\n| project Counter = pack('counter', Name, 'object', Namespace), CounterText, group = Namespace",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "value": "{\"counter\":\"FreeSpaceMB\",\"object\":\"LogicalDisk\"}",
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::1"
                                      ]
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "6a7306ea-247f-46ca-abca-501911f9e9d3",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregator5",
                                    "type": 2,
                                    "isRequired": true,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    { \"value\":\"Average = round(avg(Val), 2)\", \"label\":\"Average\", \"selected\":false},\r\n    { \"value\":\"P5th = round(percentile(Val, 5), 2)\", \"label\":\"P5th\", \"selected\":false},\r\n    { \"value\":\"P10th = round(percentile(Val, 10), 2)\", \"label\":\"P10th\", \"selected\":false},\r\n    { \"value\":\"P50th = round(percentile(Val, 50), 2)\", \"label\":\"P50th\", \"selected\":false},\r\n    { \"value\":\"P80th = round(percentile(Val, 80), 2)\", \"label\":\"P80th\", \"selected\":false},\r\n    { \"value\":\"P90th = round(percentile(Val, 90), 2)\", \"label\":\"P90th\", \"selected\":false},\r\n    { \"value\":\"P95th = round(percentile(Val, 95), 2)\", \"label\":\"P95th\", \"selected\":true}    \r\n]"
                                  },
                                  {
                                    "id": "0327f26e-cdde-4b48-b512-6c35f06ad1d0",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregatorOrder5",
                                    "type": 1,
                                    "query": "print(iff('{TrendAggregator5:label}' == 'P5th'  or '{TrendAggregator5:label}' == 'P10th', 'asc', 'desc'))",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "b75e4ca5-7d71-4d29-b69e-9104934905ba",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Visualization5",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "datatable (value:long, Display:string, isSelected:boolean)\r\n    [0, \"Line Chart\", true,\r\n     1, \"Grid\", false]",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "7df7ee71-c054-4a88-b8b1-33ba6dd9d70d",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Snippet5",
                                    "type": 1,
                                    "isRequired": true,
                                    "query": "print(iff({Visualization5} == 0, \"{LineChartQuerySnippet}\", \"{GridQuerySnippet}\") )",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "bb81032c-59e4-417f-a5e1-fc6552c3190f",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Unit5",
                                    "type": 2,
                                    "value": null,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    {\r\n        \"label\": \"B -> MB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"B -> GB\",\r\n        \"value\": \"/1024/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> GB\",\r\n        \"value\": \"/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> TB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Mb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Gb\",\r\n        \"value\": \"/1000/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Gb\",\r\n        \"value\": \"/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Tb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"s -> ms\",\r\n        \"value\": \"*1000\"\r\n    },\r\n    {\r\n        \"label\": \"ms -> s\",\r\n        \"value\": \"/1000\"\r\n    }\r\n]"
                                  }
                                ],
                                "style": "above",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/subscriptions"
                              },
                              "customWidth": "25",
                              "conditionalVisibility": {
                                "parameterName": "Mode",
                                "comparison": "isEqualTo",
                                "value": "0"
                              },
                              "name": "parameters - 14"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "parameters": [
                                  {
                                    "id": "aa2368fc-ad30-4608-b96a-72abf7b1e1af",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Counter6",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "InsightsMetrics\r\n| where TimeGenerated {TimeRange}\r\n| summarize by Name, Namespace, CounterText = Name\r\n| order by Namespace asc, CounterText asc\r\n| project Counter = pack('counter', Name, 'object', Namespace), CounterText, group = Namespace",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "value": "{\"counter\":\"FreeSpacePercentage\",\"object\":\"LogicalDisk\"}",
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::1"
                                      ]
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "6a7306ea-247f-46ca-abca-501911f9e9d3",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregator6",
                                    "type": 2,
                                    "isRequired": true,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    { \"value\":\"Average = round(avg(Val), 2)\", \"label\":\"Average\", \"selected\":false},\r\n    { \"value\":\"P5th = round(percentile(Val, 5), 2)\", \"label\":\"P5th\", \"selected\":false},\r\n    { \"value\":\"P10th = round(percentile(Val, 10), 2)\", \"label\":\"P10th\", \"selected\":false},\r\n    { \"value\":\"P50th = round(percentile(Val, 50), 2)\", \"label\":\"P50th\", \"selected\":false},\r\n    { \"value\":\"P80th = round(percentile(Val, 80), 2)\", \"label\":\"P80th\", \"selected\":false},\r\n    { \"value\":\"P90th = round(percentile(Val, 90), 2)\", \"label\":\"P90th\", \"selected\":false},\r\n    { \"value\":\"P95th = round(percentile(Val, 95), 2)\", \"label\":\"P95th\", \"selected\":true}    \r\n]"
                                  },
                                  {
                                    "id": "0327f26e-cdde-4b48-b512-6c35f06ad1d0",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregatorOrder6",
                                    "type": 1,
                                    "query": "print(iff('{TrendAggregator6:label}' == 'P5th'  or '{TrendAggregator6:label}' == 'P10th', 'asc', 'desc'))",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "5b1ee58a-5d4d-4be8-b38c-3a8eb37a2f3e",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Visualization6",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "datatable (value:long, Display:string, isSelected:boolean)\r\n    [0, \"Line Chart\", true,\r\n     1, \"Grid\", false]",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "d931d741-2f83-4ca0-bc2b-5c0c13fe8058",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Snippet6",
                                    "type": 1,
                                    "isRequired": true,
                                    "query": "print(iff({Visualization6} == 0, \"{LineChartQuerySnippet}\", \"{GridQuerySnippet}\") )",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "ab35d419-d8c1-45be-8885-e39a55c0648d",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Unit6",
                                    "type": 2,
                                    "value": null,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    {\r\n        \"label\": \"B -> MB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"B -> GB\",\r\n        \"value\": \"/1024/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> GB\",\r\n        \"value\": \"/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> TB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Mb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Gb\",\r\n        \"value\": \"/1000/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Gb\",\r\n        \"value\": \"/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Tb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"s -> ms\",\r\n        \"value\": \"*1000\"\r\n    },\r\n    {\r\n        \"label\": \"ms -> s\",\r\n        \"value\": \"/1000\"\r\n    }\r\n]"
                                  }
                                ],
                                "style": "above",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/subscriptions"
                              },
                              "customWidth": "25",
                              "conditionalVisibility": {
                                "parameterName": "Mode",
                                "comparison": "isEqualTo",
                                "value": "0"
                              },
                              "name": "parameters - 15"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "parameters": [
                                  {
                                    "id": "aa2368fc-ad30-4608-b96a-72abf7b1e1af",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Counter7",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "InsightsMetrics\r\n| where TimeGenerated {TimeRange}\r\n| summarize by Name, Namespace, CounterText = Name\r\n| order by Namespace asc, CounterText asc\r\n| project Counter = pack('counter', Name, 'object', Namespace), CounterText, group = Namespace",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "value": "{\"counter\":\"ReadBytesPerSecond\",\"object\":\"LogicalDisk\"}",
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::1"
                                      ]
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "6a7306ea-247f-46ca-abca-501911f9e9d3",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregator7",
                                    "type": 2,
                                    "isRequired": true,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    { \"value\":\"Average = round(avg(Val), 2)\", \"label\":\"Average\", \"selected\":false},\r\n    { \"value\":\"P5th = round(percentile(Val, 5), 2)\", \"label\":\"P5th\", \"selected\":false},\r\n    { \"value\":\"P10th = round(percentile(Val, 10), 2)\", \"label\":\"P10th\", \"selected\":false},\r\n    { \"value\":\"P50th = round(percentile(Val, 50), 2)\", \"label\":\"P50th\", \"selected\":false},\r\n    { \"value\":\"P80th = round(percentile(Val, 80), 2)\", \"label\":\"P80th\", \"selected\":false},\r\n    { \"value\":\"P90th = round(percentile(Val, 90), 2)\", \"label\":\"P90th\", \"selected\":false},\r\n    { \"value\":\"P95th = round(percentile(Val, 95), 2)\", \"label\":\"P95th\", \"selected\":true}    \r\n]"
                                  },
                                  {
                                    "id": "0327f26e-cdde-4b48-b512-6c35f06ad1d0",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregatorOrder7",
                                    "type": 1,
                                    "query": "print(iff('{TrendAggregator7:label}' == 'P5th'  or '{TrendAggregator7:label}' == 'P10th', 'asc', 'desc'))",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "bc1291ba-dd26-4224-9b25-3a1e7b3eb024",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Visualization7",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "datatable (value:long, Display:string, isSelected:boolean)\r\n    [0, \"Line Chart\", true,\r\n     1, \"Grid\", false]",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "6cc1a388-27c6-4cfe-a787-ff00cb8f4fae",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Snippet7",
                                    "type": 1,
                                    "isRequired": true,
                                    "query": "print(iff({Visualization7} == 0, \"{LineChartQuerySnippet}\", \"{GridQuerySnippet}\") )",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "dce874fa-b71d-4a09-bcee-bd1b3f672f7f",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Unit7",
                                    "type": 2,
                                    "value": null,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    {\r\n        \"label\": \"B -> MB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"B -> GB\",\r\n        \"value\": \"/1024/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> GB\",\r\n        \"value\": \"/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> TB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Mb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Gb\",\r\n        \"value\": \"/1000/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Gb\",\r\n        \"value\": \"/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Tb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"s -> ms\",\r\n        \"value\": \"*1000\"\r\n    },\r\n    {\r\n        \"label\": \"ms -> s\",\r\n        \"value\": \"/1000\"\r\n    }\r\n]"
                                  }
                                ],
                                "style": "above",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/subscriptions"
                              },
                              "customWidth": "25",
                              "conditionalVisibility": {
                                "parameterName": "Mode",
                                "comparison": "isEqualTo",
                                "value": "0"
                              },
                              "name": "parameters - 16"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "parameters": [
                                  {
                                    "id": "aa2368fc-ad30-4608-b96a-72abf7b1e1af",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Counter8",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "InsightsMetrics\r\n| where TimeGenerated {TimeRange}\r\n| summarize by Name, Namespace, CounterText = Name\r\n| order by Namespace asc, CounterText asc\r\n| project Counter = pack('counter', Name, 'object', Namespace), CounterText, group = Namespace",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "value": "{\"counter\":\"ReadLatencyMs\",\"object\":\"LogicalDisk\"}",
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::1"
                                      ]
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "6a7306ea-247f-46ca-abca-501911f9e9d3",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregator8",
                                    "type": 2,
                                    "isRequired": true,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    { \"value\":\"Average = round(avg(Val), 2)\", \"label\":\"Average\", \"selected\":false},\r\n    { \"value\":\"P5th = round(percentile(Val, 5), 2)\", \"label\":\"P5th\", \"selected\":false},\r\n    { \"value\":\"P10th = round(percentile(Val, 10), 2)\", \"label\":\"P10th\", \"selected\":false},\r\n    { \"value\":\"P50th = round(percentile(Val, 50), 2)\", \"label\":\"P50th\", \"selected\":false},\r\n    { \"value\":\"P80th = round(percentile(Val, 80), 2)\", \"label\":\"P80th\", \"selected\":false},\r\n    { \"value\":\"P90th = round(percentile(Val, 90), 2)\", \"label\":\"P90th\", \"selected\":false},\r\n    { \"value\":\"P95th = round(percentile(Val, 95), 2)\", \"label\":\"P95th\", \"selected\":true}    \r\n]"
                                  },
                                  {
                                    "id": "0327f26e-cdde-4b48-b512-6c35f06ad1d0",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregatorOrder8",
                                    "type": 1,
                                    "query": "print(iff('{TrendAggregator8:label}' == 'P5th'  or '{TrendAggregator8:label}' == 'P10th', 'asc', 'desc'))",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "68468652-570f-4d77-af12-a59d463d5f02",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Visualization8",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "datatable (value:long, Display:string, isSelected:boolean)\r\n    [0, \"Line Chart\", true,\r\n     1, \"Grid\", false]",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "15738505-f7e6-446e-995d-280cf70dde93",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Snippet8",
                                    "type": 1,
                                    "isRequired": true,
                                    "query": "print(iff({Visualization8} == 0, \"{LineChartQuerySnippet}\", \"{GridQuerySnippet}\") )",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "c78d15dd-79cb-4cd2-8749-df9d97625b31",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Unit8",
                                    "type": 2,
                                    "value": null,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    {\r\n        \"label\": \"B -> MB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"B -> GB\",\r\n        \"value\": \"/1024/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> GB\",\r\n        \"value\": \"/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> TB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Mb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Gb\",\r\n        \"value\": \"/1000/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Gb\",\r\n        \"value\": \"/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Tb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"s -> ms\",\r\n        \"value\": \"*1000\"\r\n    },\r\n    {\r\n        \"label\": \"ms -> s\",\r\n        \"value\": \"/1000\"\r\n    }\r\n]"
                                  }
                                ],
                                "style": "above",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/subscriptions"
                              },
                              "customWidth": "25",
                              "conditionalVisibility": {
                                "parameterName": "Mode",
                                "comparison": "isEqualTo",
                                "value": "0"
                              },
                              "name": "parameters - 17"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "<h3 style=\"margin-bottom:0;\">{Counter5:label}</h3><h4 style=\"margin-top:0;font-weight:normal;color:#777;\">{TrendAggregator5:label} {TrendAggregatorOrder5} {Unit5:label}</h4>"
                              },
                              "customWidth": "25",
                              "name": "text - 18"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "<h3 style=\"margin-bottom:0;\">{Counter6:label}</h3><h4 style=\"margin-top:0;font-weight:normal;color:#777;\">{TrendAggregator6:label} {TrendAggregatorOrder6} {Unit6:label}</h4>"
                              },
                              "customWidth": "25",
                              "name": "text - 19"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "<h3 style=\"margin-bottom:0;\">{Counter7:label}</h3><h4 style=\"margin-top:0;font-weight:normal;color:#777;\">{TrendAggregator7:label} {TrendAggregatorOrder7} {Unit7:label}</h4>"
                              },
                              "customWidth": "25",
                              "name": "text - 20"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "<h3 style=\"margin-bottom:0;\">{Counter8:label}</h3><h4 style=\"margin-top:0;font-weight:normal;color:#777;\">{TrendAggregator8:label} {TrendAggregatorOrder8} {Unit8:label}</h4>"
                              },
                              "customWidth": "25",
                              "name": "text - 21"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let metric = dynamic({Counter5});\r\nlet cpuSummary=totable(InsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where _ResourceId in~ ({Resources})\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | summarize hint.shufflekey=Computer {TrendAggregator5} by Computer, Name\r\n    | top {TopN} by {TrendAggregator5:label} {TrendAggregatorOrder5});\r\nlet computerList=(cpuSummary \r\n    | project Computer);\r\nlet EmptyNodeIdentityAndProps = datatable(Computer:string, NodeId:string, NodeProps:dynamic, Priority: long) [];\r\nlet OmsNodeIdentityAndProps = computerList\r\n    | extend NodeId = Computer\r\n    | extend Priority = 1\r\n    | extend NodeProps = pack('type', 'StandAloneNode', 'name', Computer);\r\nlet ServiceMapNodeIdentityAndProps = VMComputer | extend ResourceId=strcat('machines/', Machine) | extend Bitness=columnifexists('Bitness', '')\r\n    | where TimeGenerated {TimeRange}\r\n    | where Computer in (computerList)\r\n    | summarize arg_max(TimeGenerated, *) by Computer\r\n    | extend AzureCloudServiceNodeIdentity = iif(isnotempty(AzureCloudServiceName), strcat(AzureCloudServiceInstanceId, '|',                     AzureCloudServiceDeployment), ''),          AzureScaleSetNodeIdentity = iif(isnotempty(AzureVmScaleSetName),              strcat(AzureVmScaleSetInstanceId, '|',                     AzureVmScaleSetDeployment), ''),          ComputerProps =              pack('type', 'StandAloneNode',                   'name', Computer,                   'mappingResourceId', ResourceId,                   'subscriptionId', AzureSubscriptionId,                   'resourceGroup', AzureResourceGroup,                   'azureResourceId', columnifexists('_ResourceId', '')),          AzureCloudServiceNodeProps =              pack('type', 'AzureCloudServiceNode',                   'cloudServiceInstanceId', AzureCloudServiceInstanceId,                   'cloudServiceRoleName', columnifexists('AzureCloudServiceRoleName', ''),                   'cloudServiceDeploymentId', AzureCloudServiceDeployment,                   'cloudServiceName', AzureCloudServiceName,                   'mappingResourceId', ResourceId),          AzureScaleSetNodeProps =               pack('type', 'AzureScaleSetNode',                   'scaleSetInstanceId', columnifexists('Computer', ''),                   'vmScaleSetDeploymentId', AzureVmScaleSetDeployment,                   'vmScaleSetName', AzureVmScaleSetName,                   'serviceFabricClusterName', AzureServiceFabricClusterName,                   'vmScaleSetResourceId', AzureVmScaleSetResourceId,                   'resourceGroupName', columnifexists('AzureResourceGroup', ''),                   'subscriptionId', columnifexists('AzureSubscriptionId', ''),                   'mappingResourceId', ResourceId)| project   Computer,            NodeId = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeIdentity,                       isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeIdentity, Computer),            NodeProps = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeProps,                          isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeProps, ComputerProps),            Priority = 2;\r\nlet NodeIdentityAndProps = union kind=inner isfuzzy = true                                  EmptyNodeIdentityAndProps, OmsNodeIdentityAndProps, ServiceMapNodeIdentityAndProps                            \r\n    | summarize arg_max(Priority, *) by Computer; \r\nlet NodeIdentityAndPropsMin = NodeIdentityAndProps\r\n    | extend Kind = iff(NodeProps.type == \"StandAloneNode\", iff(NodeProps.azureResourceId == \"\", \"Non-Azure Virtual Machine\", \"Azure Virtual Machine\"), NodeProps.type), \r\n    ResourceId = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.vmScaleSetResourceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceDeploymentId, Computer)),\r\n    ResourceName = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.scaleSetInstanceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceInstanceId, Computer))\r\n    | project Computer, Kind, ResourceId, ResourceName;\r\nInsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | where Computer in (computerList)\r\n    | join kind=leftouter (NodeIdentityAndPropsMin) on Computer\r\n    | summarize {TrendAggregator5}{Unit5} by {Snippet5}",
                                "size": 0,
                                "aggregation": 3,
                                "showAnnotations": true,
                                "noDataMessage": "No computers are emitting data for this performance counter.",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/resourcegroups",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "value",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "25",
                              "name": "query - 22"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let metric = dynamic({Counter6});\r\nlet cpuSummary=totable(InsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where _ResourceId in~ ({Resources})\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | summarize hint.shufflekey=Computer {TrendAggregator6} by Computer, Name\r\n    | top {TopN} by {TrendAggregator6:label} {TrendAggregatorOrder6});\r\nlet computerList=(cpuSummary \r\n    | project Computer);\r\nlet EmptyNodeIdentityAndProps = datatable(Computer:string, NodeId:string, NodeProps:dynamic, Priority: long) [];\r\nlet OmsNodeIdentityAndProps = computerList\r\n    | extend NodeId = Computer\r\n    | extend Priority = 1\r\n    | extend NodeProps = pack('type', 'StandAloneNode', 'name', Computer);\r\nlet ServiceMapNodeIdentityAndProps = VMComputer | extend ResourceId=strcat('machines/', Machine) | extend Bitness=columnifexists('Bitness', '')\r\n    | where TimeGenerated {TimeRange}\r\n    | where Computer in (computerList)\r\n    | summarize arg_max(TimeGenerated, *) by Computer\r\n    | extend AzureCloudServiceNodeIdentity = iif(isnotempty(AzureCloudServiceName), strcat(AzureCloudServiceInstanceId, '|',                     AzureCloudServiceDeployment), ''),          AzureScaleSetNodeIdentity = iif(isnotempty(AzureVmScaleSetName),              strcat(AzureVmScaleSetInstanceId, '|',                     AzureVmScaleSetDeployment), ''),          ComputerProps =              pack('type', 'StandAloneNode',                   'name', Computer,                   'mappingResourceId', ResourceId,                   'subscriptionId', AzureSubscriptionId,                   'resourceGroup', AzureResourceGroup,                   'azureResourceId', columnifexists('_ResourceId', '')),          AzureCloudServiceNodeProps =              pack('type', 'AzureCloudServiceNode',                   'cloudServiceInstanceId', AzureCloudServiceInstanceId,                   'cloudServiceRoleName', columnifexists('AzureCloudServiceRoleName', ''),                   'cloudServiceDeploymentId', AzureCloudServiceDeployment,                   'cloudServiceName', AzureCloudServiceName,                   'mappingResourceId', ResourceId),          AzureScaleSetNodeProps =               pack('type', 'AzureScaleSetNode',                   'scaleSetInstanceId', columnifexists('Computer', ''),                   'vmScaleSetDeploymentId', AzureVmScaleSetDeployment,                   'vmScaleSetName', AzureVmScaleSetName,                   'serviceFabricClusterName', AzureServiceFabricClusterName,                   'vmScaleSetResourceId', AzureVmScaleSetResourceId,                   'resourceGroupName', columnifexists('AzureResourceGroup', ''),                   'subscriptionId', columnifexists('AzureSubscriptionId', ''),                   'mappingResourceId', ResourceId)| project   Computer,            NodeId = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeIdentity,                       isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeIdentity, Computer),            NodeProps = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeProps,                          isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeProps, ComputerProps),            Priority = 2;\r\nlet NodeIdentityAndProps = union kind=inner isfuzzy = true                                  EmptyNodeIdentityAndProps, OmsNodeIdentityAndProps, ServiceMapNodeIdentityAndProps                            \r\n    | summarize arg_max(Priority, *) by Computer; \r\nlet NodeIdentityAndPropsMin = NodeIdentityAndProps\r\n    | extend Kind = iff(NodeProps.type == \"StandAloneNode\", iff(NodeProps.azureResourceId == \"\", \"Non-Azure Virtual Machine\", \"Azure Virtual Machine\"), NodeProps.type), \r\n    ResourceId = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.vmScaleSetResourceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceDeploymentId, Computer)),\r\n    ResourceName = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.scaleSetInstanceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceInstanceId, Computer))\r\n    | project Computer, Kind, ResourceId, ResourceName;\r\nInsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | where Computer in (computerList)\r\n    | join kind=leftouter (NodeIdentityAndPropsMin) on Computer\r\n    | summarize {TrendAggregator6}{Unit6} by {Snippet6}",
                                "size": 0,
                                "aggregation": 3,
                                "showAnnotations": true,
                                "noDataMessage": "No computers are emitting data for this performance counter.",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/resourcegroups",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "value",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "25",
                              "name": "query - 23"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let metric = dynamic({Counter7});\r\nlet cpuSummary=totable(InsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where _ResourceId in~ ({Resources})\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | summarize hint.shufflekey=Computer {TrendAggregator7} by Computer, Name\r\n    | top {TopN} by {TrendAggregator7:label} {TrendAggregatorOrder7});\r\nlet computerList=(cpuSummary \r\n    | project Computer);\r\nlet EmptyNodeIdentityAndProps = datatable(Computer:string, NodeId:string, NodeProps:dynamic, Priority: long) [];\r\nlet OmsNodeIdentityAndProps = computerList\r\n    | extend NodeId = Computer\r\n    | extend Priority = 1\r\n    | extend NodeProps = pack('type', 'StandAloneNode', 'name', Computer);\r\nlet ServiceMapNodeIdentityAndProps = VMComputer | extend ResourceId=strcat('machines/', Machine) | extend Bitness=columnifexists('Bitness', '')\r\n    | where TimeGenerated {TimeRange}\r\n    | where Computer in (computerList)\r\n    | summarize arg_max(TimeGenerated, *) by Computer\r\n    | extend AzureCloudServiceNodeIdentity = iif(isnotempty(AzureCloudServiceName), strcat(AzureCloudServiceInstanceId, '|',                     AzureCloudServiceDeployment), ''),          AzureScaleSetNodeIdentity = iif(isnotempty(AzureVmScaleSetName),              strcat(AzureVmScaleSetInstanceId, '|',                     AzureVmScaleSetDeployment), ''),          ComputerProps =              pack('type', 'StandAloneNode',                   'name', Computer,                   'mappingResourceId', ResourceId,                   'subscriptionId', AzureSubscriptionId,                   'resourceGroup', AzureResourceGroup,                   'azureResourceId', columnifexists('_ResourceId', '')),          AzureCloudServiceNodeProps =              pack('type', 'AzureCloudServiceNode',                   'cloudServiceInstanceId', AzureCloudServiceInstanceId,                   'cloudServiceRoleName', columnifexists('AzureCloudServiceRoleName', ''),                   'cloudServiceDeploymentId', AzureCloudServiceDeployment,                   'cloudServiceName', AzureCloudServiceName,                   'mappingResourceId', ResourceId),          AzureScaleSetNodeProps =               pack('type', 'AzureScaleSetNode',                   'scaleSetInstanceId', columnifexists('Computer', ''),                   'vmScaleSetDeploymentId', AzureVmScaleSetDeployment,                   'vmScaleSetName', AzureVmScaleSetName,                   'serviceFabricClusterName', AzureServiceFabricClusterName,                   'vmScaleSetResourceId', AzureVmScaleSetResourceId,                   'resourceGroupName', columnifexists('AzureResourceGroup', ''),                   'subscriptionId', columnifexists('AzureSubscriptionId', ''),                   'mappingResourceId', ResourceId)| project   Computer,            NodeId = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeIdentity,                       isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeIdentity, Computer),            NodeProps = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeProps,                          isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeProps, ComputerProps),            Priority = 2;\r\nlet NodeIdentityAndProps = union kind=inner isfuzzy = true                                  EmptyNodeIdentityAndProps, OmsNodeIdentityAndProps, ServiceMapNodeIdentityAndProps                            \r\n    | summarize arg_max(Priority, *) by Computer; \r\nlet NodeIdentityAndPropsMin = NodeIdentityAndProps\r\n    | extend Kind = iff(NodeProps.type == \"StandAloneNode\", iff(NodeProps.azureResourceId == \"\", \"Non-Azure Virtual Machine\", \"Azure Virtual Machine\"), NodeProps.type), \r\n    ResourceId = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.vmScaleSetResourceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceDeploymentId, Computer)),\r\n    ResourceName = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.scaleSetInstanceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceInstanceId, Computer))\r\n    | project Computer, Kind, ResourceId, ResourceName;\r\nInsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | where Computer in (computerList)\r\n    | join kind=leftouter (NodeIdentityAndPropsMin) on Computer\r\n    | summarize {TrendAggregator7}{Unit7} by {Snippet7}",
                                "size": 0,
                                "aggregation": 3,
                                "showAnnotations": true,
                                "noDataMessage": "No computers are emitting data for this performance counter.",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/resourcegroups",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "value",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "25",
                              "name": "query - 24"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let metric = dynamic({Counter8});\r\nlet cpuSummary=totable(InsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where _ResourceId in~ ({Resources})\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | summarize hint.shufflekey=Computer {TrendAggregator8} by Computer, Name\r\n    | top {TopN} by {TrendAggregator8:label} {TrendAggregatorOrder8});\r\nlet computerList=(cpuSummary \r\n    | project Computer);\r\nlet EmptyNodeIdentityAndProps = datatable(Computer:string, NodeId:string, NodeProps:dynamic, Priority: long) [];\r\nlet OmsNodeIdentityAndProps = computerList\r\n    | extend NodeId = Computer\r\n    | extend Priority = 1\r\n    | extend NodeProps = pack('type', 'StandAloneNode', 'name', Computer);\r\nlet ServiceMapNodeIdentityAndProps = VMComputer | extend ResourceId=strcat('machines/', Machine) | extend Bitness=columnifexists('Bitness', '')\r\n    | where TimeGenerated {TimeRange}\r\n    | where Computer in (computerList)\r\n    | summarize arg_max(TimeGenerated, *) by Computer\r\n    | extend AzureCloudServiceNodeIdentity = iif(isnotempty(AzureCloudServiceName), strcat(AzureCloudServiceInstanceId, '|',                     AzureCloudServiceDeployment), ''),          AzureScaleSetNodeIdentity = iif(isnotempty(AzureVmScaleSetName),              strcat(AzureVmScaleSetInstanceId, '|',                     AzureVmScaleSetDeployment), ''),          ComputerProps =              pack('type', 'StandAloneNode',                   'name', Computer,                   'mappingResourceId', ResourceId,                   'subscriptionId', AzureSubscriptionId,                   'resourceGroup', AzureResourceGroup,                   'azureResourceId', columnifexists('_ResourceId', '')),          AzureCloudServiceNodeProps =              pack('type', 'AzureCloudServiceNode',                   'cloudServiceInstanceId', AzureCloudServiceInstanceId,                   'cloudServiceRoleName', columnifexists('AzureCloudServiceRoleName', ''),                   'cloudServiceDeploymentId', AzureCloudServiceDeployment,                   'cloudServiceName', AzureCloudServiceName,                   'mappingResourceId', ResourceId),          AzureScaleSetNodeProps =               pack('type', 'AzureScaleSetNode',                   'scaleSetInstanceId', columnifexists('Computer', ''),                   'vmScaleSetDeploymentId', AzureVmScaleSetDeployment,                   'vmScaleSetName', AzureVmScaleSetName,                   'serviceFabricClusterName', AzureServiceFabricClusterName,                   'vmScaleSetResourceId', AzureVmScaleSetResourceId,                   'resourceGroupName', columnifexists('AzureResourceGroup', ''),                   'subscriptionId', columnifexists('AzureSubscriptionId', ''),                   'mappingResourceId', ResourceId)| project   Computer,            NodeId = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeIdentity,                       isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeIdentity, Computer),            NodeProps = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeProps,                          isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeProps, ComputerProps),            Priority = 2;\r\nlet NodeIdentityAndProps = union kind=inner isfuzzy = true                                  EmptyNodeIdentityAndProps, OmsNodeIdentityAndProps, ServiceMapNodeIdentityAndProps                            \r\n    | summarize arg_max(Priority, *) by Computer; \r\nlet NodeIdentityAndPropsMin = NodeIdentityAndProps\r\n    | extend Kind = iff(NodeProps.type == \"StandAloneNode\", iff(NodeProps.azureResourceId == \"\", \"Non-Azure Virtual Machine\", \"Azure Virtual Machine\"), NodeProps.type), \r\n    ResourceId = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.vmScaleSetResourceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceDeploymentId, Computer)),\r\n    ResourceName = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.scaleSetInstanceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceInstanceId, Computer))\r\n    | project Computer, Kind, ResourceId, ResourceName;\r\nInsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | where Computer in (computerList)\r\n    | join kind=leftouter (NodeIdentityAndPropsMin) on Computer\r\n    | summarize {TrendAggregator8}{Unit8} by {Snippet8}",
                                "size": 0,
                                "aggregation": 3,
                                "showAnnotations": true,
                                "noDataMessage": "No computers are emitting data for this performance counter.",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/resourcegroups",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "value",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "25",
                              "name": "query - 25"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "parameters": [
                                  {
                                    "id": "eba3fa3a-2f37-4dfb-80be-c19b680f31b0",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Counter9",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "InsightsMetrics\r\n| where TimeGenerated {TimeRange}\r\n| summarize by Name, Namespace, CounterText = Name\r\n| order by Namespace asc, CounterText asc\r\n| project Counter = pack('counter', Name, 'object', Namespace), CounterText, group = Namespace",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "value": "{\"counter\":\"ReadsPerSecond\",\"object\":\"LogicalDisk\"}",
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::1"
                                      ]
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "f3137f3e-9ff1-4a7f-b503-5b2b87431713",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregator9",
                                    "type": 2,
                                    "isRequired": true,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    { \"value\":\"Average = round(avg(Val), 2)\", \"label\":\"Average\", \"selected\":false},\r\n    { \"value\":\"P5th = round(percentile(Val, 5), 2)\", \"label\":\"P5th\", \"selected\":false},\r\n    { \"value\":\"P10th = round(percentile(Val, 10), 2)\", \"label\":\"P10th\", \"selected\":false},\r\n    { \"value\":\"P50th = round(percentile(Val, 50), 2)\", \"label\":\"P50th\", \"selected\":false},\r\n    { \"value\":\"P80th = round(percentile(Val, 80), 2)\", \"label\":\"P80th\", \"selected\":false},\r\n    { \"value\":\"P90th = round(percentile(Val, 90), 2)\", \"label\":\"P90th\", \"selected\":false},\r\n    { \"value\":\"P95th = round(percentile(Val, 95), 2)\", \"label\":\"P95th\", \"selected\":true}    \r\n]"
                                  },
                                  {
                                    "id": "01a4cf96-e12f-4d2a-9cf3-25da44a6ebe4",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregatorOrder9",
                                    "type": 1,
                                    "query": "print(iff('{TrendAggregator9:label}' == 'P5th'  or '{TrendAggregator9:label}' == 'P10th', 'asc', 'desc'))",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "2ad65081-725a-4bc6-9198-9ab653dbb1aa",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Visualization9",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "datatable (value:long, Display:string, isSelected:boolean)\r\n    [0, \"Line Chart\", true,\r\n     1, \"Grid\", false]",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "d08e406f-4725-45f5-a5ec-1aa0b6ae4afd",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Snippet9",
                                    "type": 1,
                                    "isRequired": true,
                                    "query": "print(iff({Visualization5} == 0, \"{LineChartQuerySnippet}\", \"{GridQuerySnippet}\") )",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "31e0e738-54eb-4fab-92b7-ae000819fc7d",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Unit9",
                                    "type": 2,
                                    "value": null,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    {\r\n        \"label\": \"B -> MB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"B -> GB\",\r\n        \"value\": \"/1024/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> GB\",\r\n        \"value\": \"/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> TB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Mb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Gb\",\r\n        \"value\": \"/1000/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Gb\",\r\n        \"value\": \"/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Tb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"s -> ms\",\r\n        \"value\": \"*1000\"\r\n    },\r\n    {\r\n        \"label\": \"ms -> s\",\r\n        \"value\": \"/1000\"\r\n    }\r\n]"
                                  }
                                ],
                                "style": "above",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/subscriptions"
                              },
                              "customWidth": "25",
                              "conditionalVisibility": {
                                "parameterName": "Mode",
                                "comparison": "isEqualTo",
                                "value": "0"
                              },
                              "name": "parameters - 26"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "parameters": [
                                  {
                                    "id": "aa2368fc-ad30-4608-b96a-72abf7b1e1ad",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Counter10",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "InsightsMetrics\r\n| where TimeGenerated {TimeRange}\r\n| summarize by Name, Namespace, CounterText = Name\r\n| order by Namespace asc, CounterText asc\r\n| project Counter = pack('counter', Name, 'object', Namespace), CounterText, group = Namespace",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "value": "{\"counter\":\"WritesPerSecond\",\"object\":\"LogicalDisk\"}",
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::1"
                                      ]
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "6a7306ea-247f-46ca-abca-501911f9e9dd",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregator10",
                                    "type": 2,
                                    "isRequired": true,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    { \"value\":\"Average = round(avg(Val), 2)\", \"label\":\"Average\", \"selected\":false},\r\n    { \"value\":\"P5th = round(percentile(Val, 5), 2)\", \"label\":\"P5th\", \"selected\":false},\r\n    { \"value\":\"P10th = round(percentile(Val, 10), 2)\", \"label\":\"P10th\", \"selected\":false},\r\n    { \"value\":\"P50th = round(percentile(Val, 50), 2)\", \"label\":\"P50th\", \"selected\":false},\r\n    { \"value\":\"P80th = round(percentile(Val, 80), 2)\", \"label\":\"P80th\", \"selected\":false},\r\n    { \"value\":\"P90th = round(percentile(Val, 90), 2)\", \"label\":\"P90th\", \"selected\":false},\r\n    { \"value\":\"P95th = round(percentile(Val, 95), 2)\", \"label\":\"P95th\", \"selected\":true}    \r\n]"
                                  },
                                  {
                                    "id": "0327f26e-cdde-4b48-b512-6c35f06ad1dd",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregatorOrder10",
                                    "type": 1,
                                    "query": "print(iff('{TrendAggregator10:label}' == 'P5th'  or '{TrendAggregator10:label}' == 'P10th', 'asc', 'desc'))",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "5b1ee58a-5d4d-4be8-b38c-3a8eb37a2f3d",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Visualization10",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "datatable (value:long, Display:string, isSelected:boolean)\r\n    [0, \"Line Chart\", true,\r\n     1, \"Grid\", false]",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "d931d741-2f83-4ca0-bc2b-5c0c13fe805d",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Snippet10",
                                    "type": 1,
                                    "isRequired": true,
                                    "query": "print(iff({Visualization6} == 0, \"{LineChartQuerySnippet}\", \"{GridQuerySnippet}\") )",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "089bb686-434d-43ea-a958-c344763cef7f",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Unit10",
                                    "type": 2,
                                    "value": null,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    {\r\n        \"label\": \"B -> MB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"B -> GB\",\r\n        \"value\": \"/1024/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> GB\",\r\n        \"value\": \"/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> TB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Mb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Gb\",\r\n        \"value\": \"/1000/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Gb\",\r\n        \"value\": \"/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Tb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"s -> ms\",\r\n        \"value\": \"*1000\"\r\n    },\r\n    {\r\n        \"label\": \"ms -> s\",\r\n        \"value\": \"/1000\"\r\n    }\r\n]"
                                  }
                                ],
                                "style": "above",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/subscriptions"
                              },
                              "customWidth": "25",
                              "conditionalVisibility": {
                                "parameterName": "Mode",
                                "comparison": "isEqualTo",
                                "value": "0"
                              },
                              "name": "parameters - 27"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "parameters": [
                                  {
                                    "id": "aa2368fc-ad30-4608-b96a-72abf7b1e1ad",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Counter11",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "InsightsMetrics\r\n| where TimeGenerated {TimeRange}\r\n| summarize by Name, Namespace, CounterText = Name\r\n| order by Namespace asc, CounterText asc\r\n| project Counter = pack('counter', Name, 'object', Namespace), CounterText, group = Namespace",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "value": "{\"counter\":\"ReadBytesPerSecond\",\"object\":\"Network\"}",
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::1"
                                      ]
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "6a7306ea-247f-46ca-abca-501911f9e9dd",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregator11",
                                    "type": 2,
                                    "isRequired": true,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    { \"value\":\"Average = round(avg(Val), 2)\", \"label\":\"Average\", \"selected\":false},\r\n    { \"value\":\"P5th = round(percentile(Val, 5), 2)\", \"label\":\"P5th\", \"selected\":false},\r\n    { \"value\":\"P10th = round(percentile(Val, 10), 2)\", \"label\":\"P10th\", \"selected\":false},\r\n    { \"value\":\"P50th = round(percentile(Val, 50), 2)\", \"label\":\"P50th\", \"selected\":false},\r\n    { \"value\":\"P80th = round(percentile(Val, 80), 2)\", \"label\":\"P80th\", \"selected\":false},\r\n    { \"value\":\"P90th = round(percentile(Val, 90), 2)\", \"label\":\"P90th\", \"selected\":false},\r\n    { \"value\":\"P95th = round(percentile(Val, 95), 2)\", \"label\":\"P95th\", \"selected\":true}    \r\n]"
                                  },
                                  {
                                    "id": "0327f26e-cdde-4b48-b512-6c35f06ad1dd",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregatorOrder11",
                                    "type": 1,
                                    "query": "print(iff('{TrendAggregator11:label}' == 'P5th'  or '{TrendAggregator11:label}' == 'P10th', 'asc', 'desc'))",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "bc1291ba-dd26-4224-9b25-3a1e7b3eb02d",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Visualization11",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "datatable (value:long, Display:string, isSelected:boolean)\r\n    [0, \"Line Chart\", true,\r\n     1, \"Grid\", false]",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "6cc1a388-27c6-4cfe-a787-ff00cb8f4fad",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Snippet11",
                                    "type": 1,
                                    "isRequired": true,
                                    "query": "print(iff({Visualization7} == 0, \"{LineChartQuerySnippet}\", \"{GridQuerySnippet}\") )",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "77870d8a-bf65-4405-a722-fdf0826106ac",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Unit11",
                                    "type": 2,
                                    "value": null,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    {\r\n        \"label\": \"B -> MB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"B -> GB\",\r\n        \"value\": \"/1024/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> GB\",\r\n        \"value\": \"/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> TB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Mb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Gb\",\r\n        \"value\": \"/1000/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Gb\",\r\n        \"value\": \"/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Tb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"s -> ms\",\r\n        \"value\": \"*1000\"\r\n    },\r\n    {\r\n        \"label\": \"ms -> s\",\r\n        \"value\": \"/1000\"\r\n    }\r\n]"
                                  }
                                ],
                                "style": "above",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/subscriptions"
                              },
                              "customWidth": "25",
                              "conditionalVisibility": {
                                "parameterName": "Mode",
                                "comparison": "isEqualTo",
                                "value": "0"
                              },
                              "name": "parameters - 28"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "parameters": [
                                  {
                                    "id": "aa2368fc-ad30-4608-b96a-72abf7b1e1ad",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Counter12",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "InsightsMetrics\r\n| where TimeGenerated {TimeRange}\r\n| summarize by Name, Namespace, CounterText = Name\r\n| order by Namespace asc, CounterText asc\r\n| project Counter = pack('counter', Name, 'object', Namespace), CounterText, group = Namespace",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "value": "{\"counter\":\"WriteBytesPerSecond\",\"object\":\"Network\"}",
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::1"
                                      ]
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "6a7306ea-247f-46ca-abca-501911f9e9dd",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregator12",
                                    "type": 2,
                                    "isRequired": true,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    { \"value\":\"Average = round(avg(Val), 2)\", \"label\":\"Average\", \"selected\":false},\r\n    { \"value\":\"P5th = round(percentile(Val, 5), 2)\", \"label\":\"P5th\", \"selected\":false},\r\n    { \"value\":\"P10th = round(percentile(Val, 10), 2)\", \"label\":\"P10th\", \"selected\":false},\r\n    { \"value\":\"P50th = round(percentile(Val, 50), 2)\", \"label\":\"P50th\", \"selected\":false},\r\n    { \"value\":\"P80th = round(percentile(Val, 80), 2)\", \"label\":\"P80th\", \"selected\":false},\r\n    { \"value\":\"P90th = round(percentile(Val, 90), 2)\", \"label\":\"P90th\", \"selected\":false},\r\n    { \"value\":\"P95th = round(percentile(Val, 95), 2)\", \"label\":\"P95th\", \"selected\":true}    \r\n]"
                                  },
                                  {
                                    "id": "0327f26e-cdde-4b48-b512-6c35f06ad1dd",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TrendAggregatorOrder12",
                                    "type": 1,
                                    "query": "print(iff('{TrendAggregator12:label}' == 'P5th'  or '{TrendAggregator12:label}' == 'P10th', 'asc', 'desc'))",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "68468652-570f-4d77-af12-a59d463d5f0d",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Visualization12",
                                    "type": 2,
                                    "isRequired": true,
                                    "query": "datatable (value:long, Display:string, isSelected:boolean)\r\n    [0, \"Line Chart\", true,\r\n     1, \"Grid\", false]",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "15738505-f7e6-446e-995d-280cf70dde9d",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Snippet12",
                                    "type": 1,
                                    "isRequired": true,
                                    "query": "print(iff({Visualization8} == 0, \"{LineChartQuerySnippet}\", \"{GridQuerySnippet}\") )",
                                    "crossComponentResources": [
                                      "{Resources}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.resources/subscriptions"
                                  },
                                  {
                                    "id": "beb8493f-b5db-4bb5-865b-c8a4fed0ca0c",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Unit12",
                                    "type": 2,
                                    "value": null,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    {\r\n        \"label\": \"B -> MB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"B -> GB\",\r\n        \"value\": \"/1024/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> GB\",\r\n        \"value\": \"/1024\"\r\n    },\r\n    {\r\n        \"label\": \"MB -> TB\",\r\n        \"value\": \"/1024/1024\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Mb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"b -> Gb\",\r\n        \"value\": \"/1000/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Gb\",\r\n        \"value\": \"/1000\"\r\n    },\r\n    {\r\n        \"label\": \"Mb -> Tb\",\r\n        \"value\": \"/1000/1000\"\r\n    },\r\n    {\r\n        \"label\": \"s -> ms\",\r\n        \"value\": \"*1000\"\r\n    },\r\n    {\r\n        \"label\": \"ms -> s\",\r\n        \"value\": \"/1000\"\r\n    }\r\n]"
                                  }
                                ],
                                "style": "above",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/subscriptions"
                              },
                              "customWidth": "25",
                              "conditionalVisibility": {
                                "parameterName": "Mode",
                                "comparison": "isEqualTo",
                                "value": "0"
                              },
                              "name": "parameters - 29"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "<h3 style=\"margin-bottom:0;\">{Counter9:label}</h3><h4 style=\"margin-top:0;font-weight:normal;color:#777;\">{TrendAggregator9:label} {TrendAggregatorOrder9} {Unit9:label}</h4>"
                              },
                              "customWidth": "25",
                              "name": "text - 30"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "<h3 style=\"margin-bottom:0;\">{Counter10:label}</h3><h4 style=\"margin-top:0;font-weight:normal;color:#777;\">{TrendAggregator10:label} {TrendAggregatorOrder10} {Unit10:label}</h4>"
                              },
                              "customWidth": "25",
                              "name": "text - 31"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "<h3 style=\"margin-bottom:0;\">{Counter11:label}</h3><h4 style=\"margin-top:0;font-weight:normal;color:#777;\">{TrendAggregator11:label} {TrendAggregatorOrder11} {Unit11:label}</h4>"
                              },
                              "customWidth": "25",
                              "name": "text - 32"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "<h3 style=\"margin-bottom:0;\">{Counter12:label}</h3><h4 style=\"margin-top:0;font-weight:normal;color:#777;\">{TrendAggregator12:label} {TrendAggregatorOrder12} {Unit12:label}</h4>"
                              },
                              "customWidth": "25",
                              "name": "text - 33"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let metric = dynamic({Counter9});\r\nlet cpuSummary=totable(InsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where _ResourceId in~ ({Resources})\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | summarize hint.shufflekey=Computer {TrendAggregator9} by Computer, Name\r\n    | top {TopN} by {TrendAggregator9:label} {TrendAggregatorOrder9});\r\nlet computerList=(cpuSummary \r\n    | project Computer);\r\nlet EmptyNodeIdentityAndProps = datatable(Computer:string, NodeId:string, NodeProps:dynamic, Priority: long) [];\r\nlet OmsNodeIdentityAndProps = computerList\r\n    | extend NodeId = Computer\r\n    | extend Priority = 1\r\n    | extend NodeProps = pack('type', 'StandAloneNode', 'name', Computer);\r\nlet ServiceMapNodeIdentityAndProps = VMComputer | extend ResourceId=strcat('machines/', Machine) | extend Bitness=columnifexists('Bitness', '')\r\n    | where TimeGenerated {TimeRange}\r\n    | where Computer in (computerList)\r\n    | summarize arg_max(TimeGenerated, *) by Computer\r\n    | extend AzureCloudServiceNodeIdentity = iif(isnotempty(AzureCloudServiceName), strcat(AzureCloudServiceInstanceId, '|',                     AzureCloudServiceDeployment), ''),          AzureScaleSetNodeIdentity = iif(isnotempty(AzureVmScaleSetName),              strcat(AzureVmScaleSetInstanceId, '|',                     AzureVmScaleSetDeployment), ''),          ComputerProps =              pack('type', 'StandAloneNode',                   'name', Computer,                   'mappingResourceId', ResourceId,                   'subscriptionId', AzureSubscriptionId,                   'resourceGroup', AzureResourceGroup,                   'azureResourceId', columnifexists('_ResourceId', '')),          AzureCloudServiceNodeProps =              pack('type', 'AzureCloudServiceNode',                   'cloudServiceInstanceId', AzureCloudServiceInstanceId,                   'cloudServiceRoleName', columnifexists('AzureCloudServiceRoleName', ''),                   'cloudServiceDeploymentId', AzureCloudServiceDeployment,                   'cloudServiceName', AzureCloudServiceName,                   'mappingResourceId', ResourceId),          AzureScaleSetNodeProps =               pack('type', 'AzureScaleSetNode',                   'scaleSetInstanceId', columnifexists('Computer', ''),                   'vmScaleSetDeploymentId', AzureVmScaleSetDeployment,                   'vmScaleSetName', AzureVmScaleSetName,                   'serviceFabricClusterName', AzureServiceFabricClusterName,                   'vmScaleSetResourceId', AzureVmScaleSetResourceId,                   'resourceGroupName', columnifexists('AzureResourceGroup', ''),                   'subscriptionId', columnifexists('AzureSubscriptionId', ''),                   'mappingResourceId', ResourceId)| project   Computer,            NodeId = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeIdentity,                       isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeIdentity, Computer),            NodeProps = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeProps,                          isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeProps, ComputerProps),            Priority = 2;\r\nlet NodeIdentityAndProps = union kind=inner isfuzzy = true                                  EmptyNodeIdentityAndProps, OmsNodeIdentityAndProps, ServiceMapNodeIdentityAndProps                            \r\n    | summarize arg_max(Priority, *) by Computer; \r\nlet NodeIdentityAndPropsMin = NodeIdentityAndProps\r\n    | extend Kind = iff(NodeProps.type == \"StandAloneNode\", iff(NodeProps.azureResourceId == \"\", \"Non-Azure Virtual Machine\", \"Azure Virtual Machine\"), NodeProps.type), \r\n    ResourceId = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.vmScaleSetResourceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceDeploymentId, Computer)),\r\n    ResourceName = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.scaleSetInstanceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceInstanceId, Computer))\r\n    | project Computer, Kind, ResourceId, ResourceName;\r\nInsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | where Computer in (computerList)\r\n    | join kind=leftouter (NodeIdentityAndPropsMin) on Computer\r\n    | summarize {TrendAggregator9}{Unit9} by {Snippet9}",
                                "size": 0,
                                "aggregation": 3,
                                "showAnnotations": true,
                                "noDataMessage": "No computers are emitting data for this performance counter.",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/resourcegroups",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "value",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "25",
                              "name": "query - 34"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let metric = dynamic({Counter10});\r\nlet cpuSummary=totable(InsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where _ResourceId in~ ({Resources})\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | summarize hint.shufflekey=Computer {TrendAggregator10} by Computer, Name\r\n    | top {TopN} by {TrendAggregator10:label} {TrendAggregatorOrder10});\r\nlet computerList=(cpuSummary \r\n    | project Computer);\r\nlet EmptyNodeIdentityAndProps = datatable(Computer:string, NodeId:string, NodeProps:dynamic, Priority: long) [];\r\nlet OmsNodeIdentityAndProps = computerList\r\n    | extend NodeId = Computer\r\n    | extend Priority = 1\r\n    | extend NodeProps = pack('type', 'StandAloneNode', 'name', Computer);\r\nlet ServiceMapNodeIdentityAndProps = VMComputer | extend ResourceId=strcat('machines/', Machine) | extend Bitness=columnifexists('Bitness', '')\r\n    | where TimeGenerated {TimeRange}\r\n    | where Computer in (computerList)\r\n    | summarize arg_max(TimeGenerated, *) by Computer\r\n    | extend AzureCloudServiceNodeIdentity = iif(isnotempty(AzureCloudServiceName), strcat(AzureCloudServiceInstanceId, '|',                     AzureCloudServiceDeployment), ''),          AzureScaleSetNodeIdentity = iif(isnotempty(AzureVmScaleSetName),              strcat(AzureVmScaleSetInstanceId, '|',                     AzureVmScaleSetDeployment), ''),          ComputerProps =              pack('type', 'StandAloneNode',                   'name', Computer,                   'mappingResourceId', ResourceId,                   'subscriptionId', AzureSubscriptionId,                   'resourceGroup', AzureResourceGroup,                   'azureResourceId', columnifexists('_ResourceId', '')),          AzureCloudServiceNodeProps =              pack('type', 'AzureCloudServiceNode',                   'cloudServiceInstanceId', AzureCloudServiceInstanceId,                   'cloudServiceRoleName', columnifexists('AzureCloudServiceRoleName', ''),                   'cloudServiceDeploymentId', AzureCloudServiceDeployment,                   'cloudServiceName', AzureCloudServiceName,                   'mappingResourceId', ResourceId),          AzureScaleSetNodeProps =               pack('type', 'AzureScaleSetNode',                   'scaleSetInstanceId', columnifexists('Computer', ''),                   'vmScaleSetDeploymentId', AzureVmScaleSetDeployment,                   'vmScaleSetName', AzureVmScaleSetName,                   'serviceFabricClusterName', AzureServiceFabricClusterName,                   'vmScaleSetResourceId', AzureVmScaleSetResourceId,                   'resourceGroupName', columnifexists('AzureResourceGroup', ''),                   'subscriptionId', columnifexists('AzureSubscriptionId', ''),                   'mappingResourceId', ResourceId)| project   Computer,            NodeId = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeIdentity,                       isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeIdentity, Computer),            NodeProps = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeProps,                          isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeProps, ComputerProps),            Priority = 2;\r\nlet NodeIdentityAndProps = union kind=inner isfuzzy = true                                  EmptyNodeIdentityAndProps, OmsNodeIdentityAndProps, ServiceMapNodeIdentityAndProps                            \r\n    | summarize arg_max(Priority, *) by Computer; \r\nlet NodeIdentityAndPropsMin = NodeIdentityAndProps\r\n    | extend Kind = iff(NodeProps.type == \"StandAloneNode\", iff(NodeProps.azureResourceId == \"\", \"Non-Azure Virtual Machine\", \"Azure Virtual Machine\"), NodeProps.type), \r\n    ResourceId = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.vmScaleSetResourceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceDeploymentId, Computer)),\r\n    ResourceName = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.scaleSetInstanceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceInstanceId, Computer))\r\n    | project Computer, Kind, ResourceId, ResourceName;\r\nInsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | where Computer in (computerList)\r\n    | join kind=leftouter (NodeIdentityAndPropsMin) on Computer\r\n    | summarize {TrendAggregator10}{Unit10} by {Snippet10}",
                                "size": 0,
                                "aggregation": 3,
                                "showAnnotations": true,
                                "noDataMessage": "No computers are emitting data for this performance counter.",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/resourcegroups",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "value",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "25",
                              "name": "query - 35"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let metric = dynamic({Counter11});\r\nlet cpuSummary=totable(InsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where _ResourceId in~ ({Resources})\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | summarize hint.shufflekey=Computer {TrendAggregator11} by Computer, Name\r\n    | top {TopN} by {TrendAggregator11:label} {TrendAggregatorOrder11});\r\nlet computerList=(cpuSummary \r\n    | project Computer);\r\nlet EmptyNodeIdentityAndProps = datatable(Computer:string, NodeId:string, NodeProps:dynamic, Priority: long) [];\r\nlet OmsNodeIdentityAndProps = computerList\r\n    | extend NodeId = Computer\r\n    | extend Priority = 1\r\n    | extend NodeProps = pack('type', 'StandAloneNode', 'name', Computer);\r\nlet ServiceMapNodeIdentityAndProps = VMComputer | extend ResourceId=strcat('machines/', Machine) | extend Bitness=columnifexists('Bitness', '')\r\n    | where TimeGenerated {TimeRange}\r\n    | where Computer in (computerList)\r\n    | summarize arg_max(TimeGenerated, *) by Computer\r\n    | extend AzureCloudServiceNodeIdentity = iif(isnotempty(AzureCloudServiceName), strcat(AzureCloudServiceInstanceId, '|',                     AzureCloudServiceDeployment), ''),          AzureScaleSetNodeIdentity = iif(isnotempty(AzureVmScaleSetName),              strcat(AzureVmScaleSetInstanceId, '|',                     AzureVmScaleSetDeployment), ''),          ComputerProps =              pack('type', 'StandAloneNode',                   'name', Computer,                   'mappingResourceId', ResourceId,                   'subscriptionId', AzureSubscriptionId,                   'resourceGroup', AzureResourceGroup,                   'azureResourceId', columnifexists('_ResourceId', '')),          AzureCloudServiceNodeProps =              pack('type', 'AzureCloudServiceNode',                   'cloudServiceInstanceId', AzureCloudServiceInstanceId,                   'cloudServiceRoleName', columnifexists('AzureCloudServiceRoleName', ''),                   'cloudServiceDeploymentId', AzureCloudServiceDeployment,                   'cloudServiceName', AzureCloudServiceName,                   'mappingResourceId', ResourceId),          AzureScaleSetNodeProps =               pack('type', 'AzureScaleSetNode',                   'scaleSetInstanceId', columnifexists('Computer', ''),                   'vmScaleSetDeploymentId', AzureVmScaleSetDeployment,                   'vmScaleSetName', AzureVmScaleSetName,                   'serviceFabricClusterName', AzureServiceFabricClusterName,                   'vmScaleSetResourceId', AzureVmScaleSetResourceId,                   'resourceGroupName', columnifexists('AzureResourceGroup', ''),                   'subscriptionId', columnifexists('AzureSubscriptionId', ''),                   'mappingResourceId', ResourceId)| project   Computer,            NodeId = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeIdentity,                       isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeIdentity, Computer),            NodeProps = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeProps,                          isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeProps, ComputerProps),            Priority = 2;\r\nlet NodeIdentityAndProps = union kind=inner isfuzzy = true                                  EmptyNodeIdentityAndProps, OmsNodeIdentityAndProps, ServiceMapNodeIdentityAndProps                            \r\n    | summarize arg_max(Priority, *) by Computer; \r\nlet NodeIdentityAndPropsMin = NodeIdentityAndProps\r\n    | extend Kind = iff(NodeProps.type == \"StandAloneNode\", iff(NodeProps.azureResourceId == \"\", \"Non-Azure Virtual Machine\", \"Azure Virtual Machine\"), NodeProps.type), \r\n    ResourceId = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.vmScaleSetResourceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceDeploymentId, Computer)),\r\n    ResourceName = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.scaleSetInstanceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceInstanceId, Computer))\r\n    | project Computer, Kind, ResourceId, ResourceName;\r\nInsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | where Computer in (computerList)\r\n    | join kind=leftouter (NodeIdentityAndPropsMin) on Computer\r\n    | summarize {TrendAggregator11}{Unit11} by {Snippet11}",
                                "size": 0,
                                "aggregation": 3,
                                "showAnnotations": true,
                                "noDataMessage": "No computers are emitting data for this performance counter.",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/resourcegroups",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "value",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "25",
                              "name": "query - 36"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let metric = dynamic({Counter12});\r\nlet cpuSummary=totable(InsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where _ResourceId in~ ({Resources})\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | summarize hint.shufflekey=Computer {TrendAggregator12} by Computer, Name\r\n    | top {TopN} by {TrendAggregator12:label} {TrendAggregatorOrder12});\r\nlet computerList=(cpuSummary \r\n    | project Computer);\r\nlet EmptyNodeIdentityAndProps = datatable(Computer:string, NodeId:string, NodeProps:dynamic, Priority: long) [];\r\nlet OmsNodeIdentityAndProps = computerList\r\n    | extend NodeId = Computer\r\n    | extend Priority = 1\r\n    | extend NodeProps = pack('type', 'StandAloneNode', 'name', Computer);\r\nlet ServiceMapNodeIdentityAndProps = VMComputer | extend ResourceId=strcat('machines/', Machine) | extend Bitness=columnifexists('Bitness', '')\r\n    | where TimeGenerated {TimeRange}\r\n    | where Computer in (computerList)\r\n    | summarize arg_max(TimeGenerated, *) by Computer\r\n    | extend AzureCloudServiceNodeIdentity = iif(isnotempty(AzureCloudServiceName), strcat(AzureCloudServiceInstanceId, '|',                     AzureCloudServiceDeployment), ''),          AzureScaleSetNodeIdentity = iif(isnotempty(AzureVmScaleSetName),              strcat(AzureVmScaleSetInstanceId, '|',                     AzureVmScaleSetDeployment), ''),          ComputerProps =              pack('type', 'StandAloneNode',                   'name', Computer,                   'mappingResourceId', ResourceId,                   'subscriptionId', AzureSubscriptionId,                   'resourceGroup', AzureResourceGroup,                   'azureResourceId', columnifexists('_ResourceId', '')),          AzureCloudServiceNodeProps =              pack('type', 'AzureCloudServiceNode',                   'cloudServiceInstanceId', AzureCloudServiceInstanceId,                   'cloudServiceRoleName', columnifexists('AzureCloudServiceRoleName', ''),                   'cloudServiceDeploymentId', AzureCloudServiceDeployment,                   'cloudServiceName', AzureCloudServiceName,                   'mappingResourceId', ResourceId),          AzureScaleSetNodeProps =               pack('type', 'AzureScaleSetNode',                   'scaleSetInstanceId', columnifexists('Computer', ''),                   'vmScaleSetDeploymentId', AzureVmScaleSetDeployment,                   'vmScaleSetName', AzureVmScaleSetName,                   'serviceFabricClusterName', AzureServiceFabricClusterName,                   'vmScaleSetResourceId', AzureVmScaleSetResourceId,                   'resourceGroupName', columnifexists('AzureResourceGroup', ''),                   'subscriptionId', columnifexists('AzureSubscriptionId', ''),                   'mappingResourceId', ResourceId)| project   Computer,            NodeId = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeIdentity,                       isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeIdentity, Computer),            NodeProps = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeProps,                          isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeProps, ComputerProps),            Priority = 2;\r\nlet NodeIdentityAndProps = union kind=inner isfuzzy = true                                  EmptyNodeIdentityAndProps, OmsNodeIdentityAndProps, ServiceMapNodeIdentityAndProps                            \r\n    | summarize arg_max(Priority, *) by Computer; \r\nlet NodeIdentityAndPropsMin = NodeIdentityAndProps\r\n    | extend Kind = iff(NodeProps.type == \"StandAloneNode\", iff(NodeProps.azureResourceId == \"\", \"Non-Azure Virtual Machine\", \"Azure Virtual Machine\"), NodeProps.type), \r\n    ResourceId = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.vmScaleSetResourceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceDeploymentId, Computer)),\r\n    ResourceName = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.scaleSetInstanceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceInstanceId, Computer))\r\n    | project Computer, Kind, ResourceId, ResourceName;\r\nInsightsMetrics\r\n    | where TimeGenerated {TimeRange}\r\n    | where Namespace == metric.object and Name == metric.counter\r\n    | where Computer in (computerList)\r\n    | join kind=leftouter (NodeIdentityAndPropsMin) on Computer\r\n    | summarize {TrendAggregator12}{Unit12} by {Snippet12}",
                                "size": 0,
                                "aggregation": 3,
                                "showAnnotations": true,
                                "noDataMessage": "No computers are emitting data for this performance counter.",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/resourcegroups",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "value",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "25",
                              "name": "query - 37"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "performancecounter"
                        },
                        "name": "Performance Counter"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "parameters": [
                                  {
                                    "id": "b0177105-7244-40a2-a13b-7f9cc63ff869",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Subscription",
                                    "label": "Choose a subscription",
                                    "type": 6,
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "'",
                                    "delimiter": ",",
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::1",
                                        "value::all"
                                      ],
                                      "includeAll": true,
                                      "showDefault": false
                                    },
                                    "defaultValue": "value::1",
                                    "value": [
                                      "/subscriptions/b661db5b-6c7e-435f-a989-6de3b26c40d3"
                                    ]
                                  },
                                  {
                                    "id": "7bd0f21c-30f8-44e1-9e91-f9e87118bea9",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "VirtualMachines",
                                    "label": "Virtual Machines",
                                    "type": 5,
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "'",
                                    "delimiter": ",",
                                    "query": "where type =~ 'microsoft.compute/virtualmachines'\r\n\t| order by name asc\r\n\t| extend Rank = row_number()\r\n\t| project value = id, label = id, selected = Rank <= 25",
                                    "crossComponentResources": [
                                      "{Subscription}"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::5",
                                        "value::all"
                                      ],
                                      "showDefault": false
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "defaultValue": "value::5",
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources"
                                  },
                                  {
                                    "id": "920babe0-e044-45a5-bbfe-cc6ddfb12679",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TimeRange",
                                    "label": "Time Range",
                                    "type": 4,
                                    "typeSettings": {
                                      "selectableValues": [
                                        {
                                          "durationMs": 300000
                                        },
                                        {
                                          "durationMs": 900000
                                        },
                                        {
                                          "durationMs": 1800000
                                        },
                                        {
                                          "durationMs": 3600000
                                        },
                                        {
                                          "durationMs": 14400000
                                        },
                                        {
                                          "durationMs": 43200000
                                        },
                                        {
                                          "durationMs": 86400000
                                        },
                                        {
                                          "durationMs": 172800000
                                        },
                                        {
                                          "durationMs": 259200000
                                        },
                                        {
                                          "durationMs": 604800000
                                        },
                                        {
                                          "durationMs": 1209600000
                                        },
                                        {
                                          "durationMs": 2419200000
                                        },
                                        {
                                          "durationMs": 2592000000
                                        },
                                        {
                                          "durationMs": 5184000000
                                        },
                                        {
                                          "durationMs": 7776000000
                                        }
                                      ]
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "value": {
                                      "durationMs": 5184000000
                                    }
                                  }
                                ],
                                "style": "pills",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources"
                              },
                              "name": "parameters - 1"
                            },
                            {
                              "type": 10,
                              "content": {
                                "chartId": "workbookaa8f3450-485a-4c8e-87db-f85a1c96594d",
                                "version": "MetricsItem/2.0",
                                "size": 3,
                                "chartType": 0,
                                "resourceType": "microsoft.compute/virtualmachines",
                                "metricScope": 0,
                                "resourceParameter": "VirtualMachines",
                                "resourceIds": [
                                  "{VirtualMachines}"
                                ],
                                "timeContextFromParameter": "TimeRange",
                                "timeContext": {
                                  "durationMs": 5184000000
                                },
                                "metrics": [
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--OS Disk IOPS Consumed Percentage",
                                    "aggregation": 2
                                  },
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--OS Disk IOPS Consumed Percentage",
                                    "aggregation": 3
                                  },
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--OS Disk IOPS Consumed Percentage",
                                    "aggregation": 4
                                  },
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--Data Disk IOPS Consumed Percentage",
                                    "aggregation": 2
                                  },
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--Data Disk IOPS Consumed Percentage",
                                    "aggregation": 3
                                  },
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--Data Disk IOPS Consumed Percentage",
                                    "aggregation": 4
                                  }
                                ],
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Subscription",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Name",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--OS Disk IOPS Consumed Percentage",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "max": 100,
                                        "palette": "greenRed"
                                      },
                                      "numberFormat": {
                                        "unit": 1,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--OS Disk IOPS Consumed Percentage Timeline",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Data Disk IOPS Consumed Percentage",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "max": 100,
                                        "palette": "greenRed"
                                      },
                                      "numberFormat": {
                                        "unit": 1,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Data Disk IOPS Consumed Percentage Timeline",
                                      "formatter": 5
                                    }
                                  ],
                                  "rowLimit": 10000,
                                  "filter": true,
                                  "labelSettings": [
                                    {
                                      "columnId": "Subscription",
                                      "label": "Subscription"
                                    },
                                    {
                                      "columnId": "Name",
                                      "label": "Storage Name"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--OS Disk IOPS Consumed Percentage",
                                      "label": "OS Disk IOPS (AVG)"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--OS Disk IOPS Consumed Percentage Timeline",
                                      "label": "OS Disk IOPS Consumed Percentage Timeline"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--OS Disk IOPS Consumed Percentage",
                                      "label": "OS Disk IOPS (AVG)"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--OS Disk IOPS Consumed Percentage Timeline",
                                      "label": "OS Disk IOPS Consumed Percentage Timeline"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--OS Disk IOPS Consumed Percentage",
                                      "label": "OS Disk IOPS (AVG)"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--OS Disk IOPS Consumed Percentage Timeline",
                                      "label": "OS Disk IOPS Consumed Percentage Timeline"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Data Disk IOPS Consumed Percentage",
                                      "label": "Data Disk IOPS Consumed Percentage (Min)"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Data Disk IOPS Consumed Percentage Timeline",
                                      "label": "Data Disk IOPS Consumed Percentage Timeline"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Data Disk IOPS Consumed Percentage",
                                      "label": "Data Disk IOPS Consumed Percentage (Min)"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Data Disk IOPS Consumed Percentage Timeline",
                                      "label": "Data Disk IOPS Consumed Percentage Timeline"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Data Disk IOPS Consumed Percentage",
                                      "label": "Data Disk IOPS Consumed Percentage (Min)"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Data Disk IOPS Consumed Percentage Timeline",
                                      "label": "Data Disk IOPS Consumed Percentage Timeline"
                                    }
                                  ]
                                },
                                "showExportToExcel": true
                              },
                              "name": "metric - 5"
                            },
                            {
                              "type": 10,
                              "content": {
                                "chartId": "workbookdb898a17-dacf-4b8e-ab4e-7d6b023a81c2",
                                "version": "MetricsItem/2.0",
                                "size": 3,
                                "chartType": 0,
                                "resourceType": "microsoft.compute/virtualmachines",
                                "metricScope": 0,
                                "resourceParameter": "VirtualMachines",
                                "resourceIds": [
                                  "{VirtualMachines}"
                                ],
                                "timeContextFromParameter": "TimeRange",
                                "timeContext": {
                                  "durationMs": 5184000000
                                },
                                "metrics": [
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--OS Disk Read Operations/Sec",
                                    "aggregation": 4
                                  },
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--OS Disk Write Operations/Sec",
                                    "aggregation": 4
                                  }
                                ],
                                "title": "OS Disk Read and Write Operations",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Subscription",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Name",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Data Disk Target IOPS",
                                      "formatter": 1,
                                      "numberFormat": {
                                        "unit": 0,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Data Disk Target IOPS Timeline",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Data Disk IOPS Consumed Percentage",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "palette": "greenRed"
                                      },
                                      "numberFormat": {
                                        "unit": 1,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Data Disk IOPS Consumed Percentage Timeline",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--OS Disk Target IOPS",
                                      "formatter": 1,
                                      "numberFormat": {
                                        "unit": 0,
                                        "options": null
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--OS Disk Target IOPS Timeline",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--OS Disk IOPS Consumed Percentage",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "palette": "greenRed"
                                      },
                                      "numberFormat": {
                                        "unit": 1,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--OS Disk IOPS Consumed Percentage Timeline",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/disks-Disk Performance-Composite Disk Read Operations/sec Timeline",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/disks-Disk Performance-Composite Disk Read Operations/sec",
                                      "formatter": 1,
                                      "numberFormat": {
                                        "unit": 31,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "Metric",
                                      "formatter": 1
                                    },
                                    {
                                      "columnMatch": "Aggregation",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Value",
                                      "formatter": 1
                                    },
                                    {
                                      "columnMatch": "Timeline",
                                      "formatter": 9
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Data Disk Read Operations/Sec",
                                      "formatter": 1,
                                      "numberFormat": {
                                        "unit": 31,
                                        "options": null
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--OS Disk Read Operations/Sec",
                                      "formatter": 1,
                                      "numberFormat": {
                                        "unit": 31,
                                        "options": null
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Data Disk Write Operations/Sec",
                                      "formatter": 1,
                                      "numberFormat": {
                                        "unit": 31,
                                        "options": null
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--OS Disk Write Operations/Sec",
                                      "formatter": 1,
                                      "numberFormat": {
                                        "unit": 31,
                                        "options": null
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000,
                                  "filter": true,
                                  "labelSettings": [
                                    {
                                      "columnId": "Subscription",
                                      "label": "Subscription"
                                    },
                                    {
                                      "columnId": "Name",
                                      "label": "Storage Name"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--OS Disk Read Operations/Sec",
                                      "label": "OS Disk Read Operations/Sec (Average)"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--OS Disk Read Operations/Sec Timeline",
                                      "label": "OS Disk Read Operations/Sec Timeline"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--OS Disk Write Operations/Sec",
                                      "label": "OS Disk Write Operations/Sec (Average)"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--OS Disk Write Operations/Sec Timeline",
                                      "label": "OS Disk Write Operations/Sec Timeline"
                                    }
                                  ]
                                },
                                "showExportToExcel": true
                              },
                              "name": "metric - 2 - Copy"
                            },
                            {
                              "type": 10,
                              "content": {
                                "chartId": "workbookdb898a17-dacf-4b8e-ab4e-7d6b023a81c2",
                                "version": "MetricsItem/2.0",
                                "size": 3,
                                "chartType": 0,
                                "resourceType": "microsoft.compute/virtualmachines",
                                "metricScope": 0,
                                "resourceParameter": "VirtualMachines",
                                "resourceIds": [
                                  "{VirtualMachines}"
                                ],
                                "timeContextFromParameter": "TimeRange",
                                "timeContext": {
                                  "durationMs": 5184000000
                                },
                                "metrics": [
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--Data Disk Read Operations/Sec",
                                    "aggregation": 4
                                  },
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--Data Disk Write Operations/Sec",
                                    "aggregation": 4
                                  }
                                ],
                                "title": "Data Disk Read and Write Operations",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Subscription",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Name",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Data Disk Target IOPS",
                                      "formatter": 1,
                                      "numberFormat": {
                                        "unit": 0,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Data Disk Target IOPS Timeline",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Data Disk IOPS Consumed Percentage",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "palette": "greenRed"
                                      },
                                      "numberFormat": {
                                        "unit": 1,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Data Disk IOPS Consumed Percentage Timeline",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--OS Disk Target IOPS",
                                      "formatter": 1,
                                      "numberFormat": {
                                        "unit": 0,
                                        "options": null
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--OS Disk Target IOPS Timeline",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--OS Disk IOPS Consumed Percentage",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "palette": "greenRed"
                                      },
                                      "numberFormat": {
                                        "unit": 1,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--OS Disk IOPS Consumed Percentage Timeline",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/disks-Disk Performance-Composite Disk Read Operations/sec Timeline",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/disks-Disk Performance-Composite Disk Read Operations/sec",
                                      "formatter": 1,
                                      "numberFormat": {
                                        "unit": 31,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "Metric",
                                      "formatter": 1
                                    },
                                    {
                                      "columnMatch": "Aggregation",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Value",
                                      "formatter": 1
                                    },
                                    {
                                      "columnMatch": "Timeline",
                                      "formatter": 9
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Data Disk Read Operations/Sec",
                                      "formatter": 1,
                                      "numberFormat": {
                                        "unit": 31,
                                        "options": null
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--OS Disk Read Operations/Sec",
                                      "formatter": 1,
                                      "numberFormat": {
                                        "unit": 31,
                                        "options": null
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Data Disk Write Operations/Sec",
                                      "formatter": 1,
                                      "numberFormat": {
                                        "unit": 31,
                                        "options": null
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--OS Disk Write Operations/Sec",
                                      "formatter": 1,
                                      "numberFormat": {
                                        "unit": 31,
                                        "options": null
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000,
                                  "filter": true,
                                  "labelSettings": [
                                    {
                                      "columnId": "Subscription",
                                      "label": "Subscription"
                                    },
                                    {
                                      "columnId": "Name",
                                      "label": "Storage Name"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Data Disk Read Operations/Sec",
                                      "label": "Data Disk Read Operations/Sec (Average)"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Data Disk Read Operations/Sec Timeline",
                                      "label": "Data Disk Read Operations/Sec (Average) Timeline"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Data Disk Write Operations/Sec",
                                      "label": "Data Disk Write Operations/Sec (Average)"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Data Disk Write Operations/Sec Timeline",
                                      "label": "Data Disk Write Operations/Sec (Average) Timeline"
                                    }
                                  ]
                                },
                                "showExportToExcel": true
                              },
                              "name": "metric - 2 - Copy - Copy"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "iops"
                        },
                        "name": "IOPS"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "b0177105-7244-40a2-a13b-7f9cc63ff869",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Subscription",
                                    "label": "Choose a subscription",
                                    "type": 6,
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "'",
                                    "delimiter": ",",
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::1",
                                        "value::3",
                                        "value::all"
                                      ],
                                      "includeAll": true,
                                      "showDefault": false
                                    },
                                    "defaultValue": "value::3"
                                  },
                                  {
                                    "id": "920babe0-e044-45a5-bbfe-cc6ddfb12679",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TimeRange",
                                    "label": "Time Range",
                                    "type": 4,
                                    "typeSettings": {
                                      "selectableValues": [
                                        {
                                          "durationMs": 300000
                                        },
                                        {
                                          "durationMs": 900000
                                        },
                                        {
                                          "durationMs": 1800000
                                        },
                                        {
                                          "durationMs": 3600000
                                        },
                                        {
                                          "durationMs": 14400000
                                        },
                                        {
                                          "durationMs": 43200000
                                        },
                                        {
                                          "durationMs": 86400000
                                        },
                                        {
                                          "durationMs": 172800000
                                        },
                                        {
                                          "durationMs": 259200000
                                        },
                                        {
                                          "durationMs": 604800000
                                        },
                                        {
                                          "durationMs": 1209600000
                                        },
                                        {
                                          "durationMs": 2419200000
                                        },
                                        {
                                          "durationMs": 2592000000
                                        },
                                        {
                                          "durationMs": 5184000000
                                        },
                                        {
                                          "durationMs": 7776000000
                                        }
                                      ]
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "value": {
                                      "durationMs": 604800000
                                    }
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "parameters - 1"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "// Top 10 Virtual Machines by CPU utilization \r\n// Top 10 Virtual Machines by CPU utilization. \r\nInsightsMetrics\r\n\r\n| where Origin == \"vm.azm.ms\"\r\n| where Namespace == \"Processor\" and Name == \"UtilizationPercentage\"\r\n| summarize P90 = percentile(Val, 90) by Computer\r\n| top 5 by P90",
                                "size": 3,
                                "title": "Top 5 CPU Consumption",
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/subscriptions",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "P90",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "min": 1,
                                      "max": 100,
                                      "palette": "greenRed"
                                    },
                                    "numberFormat": {
                                      "unit": 1,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": true
                                },
                                "graphSettings": {
                                  "type": 2,
                                  "topContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 1
                                  },
                                  "centerContent": {
                                    "columnMatch": "P90",
                                    "formatter": 8,
                                    "formatOptions": {
                                      "min": 1,
                                      "max": 100,
                                      "palette": "hotCold",
                                      "linkColumn": "P90",
                                      "linkTarget": "Metrics",
                                      "linkIsContextBlade": true
                                    },
                                    "numberFormat": {
                                      "unit": 1,
                                      "options": {
                                        "style": "decimal"
                                      },
                                      "emptyValCustomText": "0"
                                    }
                                  },
                                  "nodeIdField": "P90",
                                  "graphOrientation": 3,
                                  "showOrientationToggles": false,
                                  "nodeSize": null,
                                  "staticNodeSize": 100,
                                  "colorSettings": null,
                                  "hivesMargin": 5
                                },
                                "mapSettings": {
                                  "locInfo": "LatLong",
                                  "sizeSettings": "P90",
                                  "sizeAggregation": "Sum",
                                  "legendMetric": "P90",
                                  "legendAggregation": "Sum",
                                  "itemColorSettings": {
                                    "type": "heatmap",
                                    "colorAggregation": "Sum",
                                    "nodeColorField": "P90",
                                    "heatmapPalette": "greenRed"
                                  }
                                }
                              },
                              "name": "Top 5 CPU Consumption"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "// Bottom 10 Free disk space % \r\n// Bottom 10 Free disk space % by computer, for the last 7 days. \r\nPerf\r\n\r\n| where (ObjectName == \"Logical Disk\" or ObjectName == \"LogicalDisk\") and CounterName contains \"%\" and InstanceName != \"_Total\" and InstanceName != \"HarddiskVolume1\"\r\n| project TimeGenerated, Computer, ObjectName, CounterName, InstanceName, CounterValue \r\n| summarize arg_max(TimeGenerated, *) by Computer\r\n| top 5 by CounterValue desc",
                                "size": 3,
                                "title": "Top 5 Disk Space Utilziation",
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/subscriptions",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "CounterValue",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "min": 1,
                                      "max": 100,
                                      "palette": "greenRed",
                                      "linkColumn": "CounterName",
                                      "linkTarget": "Resource",
                                      "linkIsContextBlade": false
                                    },
                                    "numberFormat": {
                                      "unit": 1,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": true
                                },
                                "graphSettings": {
                                  "type": 2,
                                  "topContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 1
                                  },
                                  "centerContent": {
                                    "columnMatch": "P90",
                                    "formatter": 8,
                                    "formatOptions": {
                                      "min": 1,
                                      "max": 100,
                                      "palette": "hotCold",
                                      "linkColumn": "P90",
                                      "linkTarget": "Metrics",
                                      "linkIsContextBlade": true
                                    },
                                    "numberFormat": {
                                      "unit": 1,
                                      "options": {
                                        "style": "decimal"
                                      },
                                      "emptyValCustomText": "0"
                                    }
                                  },
                                  "nodeIdField": "P90",
                                  "graphOrientation": 3,
                                  "showOrientationToggles": false,
                                  "nodeSize": null,
                                  "staticNodeSize": 100,
                                  "colorSettings": null,
                                  "hivesMargin": 5
                                },
                                "mapSettings": {
                                  "locInfo": "LatLong",
                                  "sizeSettings": "P90",
                                  "sizeAggregation": "Sum",
                                  "legendMetric": "P90",
                                  "legendAggregation": "Sum",
                                  "itemColorSettings": {
                                    "type": "heatmap",
                                    "colorAggregation": "Sum",
                                    "nodeColorField": "P90",
                                    "heatmapPalette": "greenRed"
                                  }
                                }
                              },
                              "name": "Bottom 10 Free Disk Space"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "// Virtual Machine available memory \r\n// Virtual Machine available memory. \r\nInsightsMetrics\r\n\r\n| where Origin == \"vm.azm.ms\"\r\n| where Namespace == \"Memory\"\r\n| where Name == \"AvailableMB\"\r\n| summarize P90= avg(Val) by  Computer\r\n| top 5 by P90",
                                "size": 3,
                                "title": "Top 5 VM Available Memory",
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/subscriptions",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "P90",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": true
                                }
                              },
                              "name": "Top 5 VM Available Memory"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "top10"
                        },
                        "name": "Top10"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "computeperformance"
                  },
                  "name": "Performance"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources \r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| project id, vmName = name, powerstate = tostring(properties.extended.instanceView.powerState.displayStatus), vmsize = tostring(properties.hardwareProfile.vmSize), \r\n os_type = tostring(properties.storageProfile.osDisk.osType),publisher= tostring(properties.storageProfile.imageReference.publisher), version= tostring(properties.storageProfile.imageReference.version), imagesku= tostring(properties.storageProfile.imageReference.sku) ,offer= tostring(properties.storageProfile.imageReference.offer),\r\n  location, bootDiagnostics =tostring(properties.diagnosticsProfile.bootDiagnostics.enabled) ,avZone = tostring(zones), resourceGroup\r\n \r\n",
                          "size": 3,
                          "showExportToExcel": true,
                          "exportToExcelOptions": "all",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "id",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "linkIsContextBlade": true,
                                  "showIcon": true,
                                  "aggregation": "Count",
                                  "customColumnWidthSetting": "18ch"
                                },
                                "tooltipFormat": {
                                  "tooltip": "Virtual Machine Name"
                                }
                              },
                              {
                                "columnMatch": "vmName",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "powerstate",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "16ch"
                                }
                              },
                              {
                                "columnMatch": "vmsize",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "18ch"
                                }
                              },
                              {
                                "columnMatch": "os_type",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20ch"
                                }
                              },
                              {
                                "columnMatch": "publisher",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "is Empty",
                                      "representation": "1",
                                      "text": "{0}BYOL"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ],
                                  "customColumnWidthSetting": "27ch"
                                }
                              },
                              {
                                "columnMatch": "version",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "15ch"
                                }
                              },
                              {
                                "columnMatch": "imagesku",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "contains",
                                      "thresholdValue": "gen2",
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "contains",
                                      "thresholdValue": "gensecond",
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "1",
                                      "text": "{0}Review"
                                    }
                                  ],
                                  "customColumnWidthSetting": "20ch"
                                }
                              },
                              {
                                "columnMatch": "offer",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20ch"
                                }
                              },
                              {
                                "columnMatch": "location",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "12ch"
                                }
                              },
                              {
                                "columnMatch": "bootDiagnostics",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "true",
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "true",
                                      "representation": "1",
                                      "text": "{0}Review"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ],
                                  "customColumnWidthSetting": "20ch"
                                }
                              },
                              {
                                "columnMatch": "adminUsername",
                                "formatter": 5,
                                "formatOptions": {
                                  "customColumnWidthSetting": "15ch"
                                }
                              },
                              {
                                "columnMatch": "avSet",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "18ch"
                                }
                              },
                              {
                                "columnMatch": "ppg",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "10ch"
                                }
                              },
                              {
                                "columnMatch": "avZone",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "10ch"
                                }
                              },
                              {
                                "columnMatch": "resourceGroup",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "15ch"
                                }
                              },
                              {
                                "columnMatch": "HyperVgen",
                                "formatter": 5,
                                "formatOptions": {
                                  "customColumnWidthSetting": "10ch"
                                }
                              }
                            ],
                            "rowLimit": 10000,
                            "filter": true,
                            "sortBy": [
                              {
                                "itemKey": "$gen_thresholds_publisher_5",
                                "sortOrder": 1
                              }
                            ],
                            "labelSettings": [
                              {
                                "columnId": "id",
                                "label": "VM Name"
                              },
                              {
                                "columnId": "powerstate",
                                "label": "VM State"
                              },
                              {
                                "columnId": "vmsize",
                                "label": "VM SKU"
                              },
                              {
                                "columnId": "os_type",
                                "label": "Operating System"
                              },
                              {
                                "columnId": "publisher",
                                "label": "OS Image Publisher"
                              },
                              {
                                "columnId": "version",
                                "label": "Image version"
                              },
                              {
                                "columnId": "imagesku",
                                "label": "OS Image SKU"
                              },
                              {
                                "columnId": "location",
                                "label": "Azure Region"
                              },
                              {
                                "columnId": "bootDiagnostics",
                                "label": "Boot Diagnostic"
                              },
                              {
                                "columnId": "avZone",
                                "label": "AvZone"
                              },
                              {
                                "columnId": "resourceGroup",
                                "label": "Resource Group"
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "$gen_thresholds_publisher_5",
                              "sortOrder": 1
                            }
                          ]
                        },
                        "name": "VM List"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "vmlist"
                  },
                  "name": "vmlist"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "Resources\r\n| where type == 'microsoft.compute/virtualmachines'\r\n| extend\r\n    JoinID = toupper(id),\r\n    OSName = tostring(properties.osProfile.computerName),\r\n    OSType = tostring(properties.storageProfile.osDisk.osType),\r\n    VMSize = tostring(properties.hardwareProfile.vmSize)\r\n| join kind=leftouter(\r\n    Resources\r\n    | where type == 'microsoft.compute/virtualmachines/extensions'\r\n    | extend\r\n        VMId = toupper(substring(id, 0, indexof(id, '/extensions')))\r\n        ,ExtensionName = name\r\n    , provisioningState = tostring(properties.provisioningState), autoUpgradeMinorVersion= tostring(properties.autoUpgradeMinorVersion), typeHandlerVersion= tostring(properties.typeHandlerVersion)\r\n) on $left.JoinID == $right.VMId\r\n| summarize Extensions = make_list(ExtensionName) by id, VMSize, OSType, provisioningState, autoUpgradeMinorVersion, typeHandlerVersion",
                          "size": 0,
                          "title": "VM Extensions Status",
                          "noDataMessage": "No VM Extensions",
                          "showExportToExcel": true,
                          "exportToExcelOptions": "all",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "id",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "linkIsContextBlade": true,
                                  "showIcon": true,
                                  "customColumnWidthSetting": "18ch"
                                }
                              },
                              {
                                "columnMatch": "provisioningState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Succeeded",
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Failed",
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "autoUpgradeMinorVersion",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "false",
                                      "representation": "Sev1",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "true",
                                      "representation": "Sev3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "rowLimit": 10000,
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "id",
                                "label": "VM Name"
                              },
                              {
                                "columnId": "VMSize",
                                "label": "VM SKU"
                              },
                              {
                                "columnId": "OSType",
                                "label": "Operating System"
                              },
                              {
                                "columnId": "provisioningState",
                                "label": "Extension State"
                              },
                              {
                                "columnId": "autoUpgradeMinorVersion",
                                "label": "AutoUpgrade"
                              },
                              {
                                "columnId": "typeHandlerVersion",
                                "label": "Version"
                              },
                              {
                                "columnId": "Extensions",
                                "label": "Extension Name"
                              }
                            ]
                          }
                        },
                        "name": " Failed VM Extension "
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "vmextension"
                  },
                  "name": "VM Extension"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "4e6c0062-8388-48ed-9d51-87dce6012e0d",
                              "version": "KqlParameterItem/1.0",
                              "name": "Subscription",
                              "label": "Choose Subscription",
                              "type": 6,
                              "description": "Choose a subscription",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "includeAll": true,
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::3"
                            },
                            {
                              "id": "d32f4df4-51d9-4816-b3d2-a23e18ab65db",
                              "version": "KqlParameterItem/1.0",
                              "name": "Workspace",
                              "label": "Choose Workspace",
                              "type": 5,
                              "description": "Choose a LA Workspace",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "Resources\r\n| where type =~ \"Microsoft.operationalinsights/workspaces\"\r\n| summarize by id",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "value": [
                                "value::all"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Filter"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name | join ( resources | where type =~ 'microsoft.compute/virtualmachines' and  tostring(properties.storageProfile.osDisk.osType) == 'Windows' and tostring(properties.['licenseType']) !has 'Windows' | extend WindowsId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.storageProfile.imageReference.offer), OsVersion = tostring(properties.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.['licenseType'])) on subscriptionId \r\n    | order by VMSize asc \r\n    | project WindowsId,VMRG,VMSize, VMLocation,OSType, OsVersion,LicenseType, SubscriptionName",
                          "size": 3,
                          "title": "Virtual Machines without Azure Hybrid Benefit ",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "table",
                          "gridSettings": {
                            "filter": true,
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "SubscriptionName",
                                "VMSize"
                              ]
                            },
                            "labelSettings": [
                              {
                                "columnId": "WindowsId",
                                "label": "VIrtual Machine"
                              },
                              {
                                "columnId": "VMRG",
                                "label": "Resource Group"
                              },
                              {
                                "columnId": "VMSize",
                                "label": "Size"
                              },
                              {
                                "columnId": "VMLocation",
                                "label": "Location"
                              },
                              {
                                "columnId": "OSType",
                                "label": "OS"
                              },
                              {
                                "columnId": "OsVersion",
                                "label": "Version"
                              },
                              {
                                "columnId": "LicenseType",
                                "label": "Licence Type"
                              },
                              {
                                "columnId": "SubscriptionName",
                                "label": "Subscription"
                              }
                            ]
                          }
                        },
                        "name": "query - 3"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name | join ( resources | where type =~ 'microsoft.compute/virtualmachines' and properties.storageProfile.imageReference.publisher == 'suse' or properties.storageProfile.imageReference.publisher=='RedHat' and tostring(properties.['licenseType']) != 'SLES_BYOS' and tostring(properties.['licenseType']) != 'REHL_BYOS' | extend WindowsId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.storageProfile.imageReference.offer), OsVersion = tostring(properties.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.['licenseType'])) on subscriptionId \r\n    | order by VMSize asc \r\n    | project WindowsId,VMName,VMRG, VMLocation,OSType, OsVersion,LicenseType, VMSize, SubscriptionName",
                          "size": 3,
                          "title": "Linux Machine not Running with Azure Hybrid Benifits",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "filter": true,
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "SubscriptionName",
                                "VMSize"
                              ]
                            },
                            "labelSettings": [
                              {
                                "columnId": "WindowsId",
                                "label": "VM"
                              },
                              {
                                "columnId": "VMRG",
                                "label": "Resource Group"
                              },
                              {
                                "columnId": "VMLocation",
                                "label": "Location"
                              },
                              {
                                "columnId": "OSType",
                                "label": "OS"
                              },
                              {
                                "columnId": "OsVersion",
                                "label": "Version"
                              },
                              {
                                "columnId": "LicenseType",
                                "label": "Licence Type"
                              },
                              {
                                "columnId": "VMSize",
                                "label": "Size"
                              },
                              {
                                "columnId": "SubscriptionName",
                                "label": "Subscription"
                              }
                            ]
                          }
                        },
                        "name": "query - 6"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "vmwithouthybridbenifit"
                  },
                  "name": "VM Without Hybrid Benifit"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "41c15091-2f8d-4702-86ca-11190caac787",
                              "version": "KqlParameterItem/1.0",
                              "name": "Subscription",
                              "type": 6,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "includeAll": true,
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::3"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "parameters - 5 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| project name , properties['osProfile']['adminUsername']\r\n",
                          "size": 3,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "filter": true,
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "properties_osProfile_adminUsername"
                              ]
                            },
                            "labelSettings": [
                              {
                                "columnId": "name",
                                "label": "VM Name"
                              },
                              {
                                "columnId": "properties_osProfile_adminUsername",
                                "label": "User Name"
                              }
                            ]
                          }
                        },
                        "name": "Usernames"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "vmaccounts"
                  },
                  "name": "VM Accounts"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedoption",
              "comparison": "isEqualTo",
              "value": "compute"
            },
            "name": "Compute Dashboard"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "tabs",
                    "links": [
                      {
                        "id": "d5749b77-230f-45e3-89f5-be4c85ecfa36",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Overview",
                        "subTarget": "networkoverview",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "d2568e3f-dddc-47d7-8bb1-afcbc94c0f97",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Express Route",
                        "subTarget": "expressroute",
                        "style": "link"
                      },
                      {
                        "id": "7ef3a846-67a4-4458-b430-b19d4d03e181",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Private DNS",
                        "subTarget": "privatedns",
                        "style": "link"
                      },
                      {
                        "id": "e12edfd2-6dd6-44f4-a631-2e4f9d20a0c6",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Private End Points",
                        "subTarget": "privateendpoint",
                        "style": "link"
                      },
                      {
                        "id": "a7661fff-0686-4a3b-872e-8b7f86e5664f",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Public IP",
                        "subTarget": "publicip",
                        "style": "link"
                      },
                      {
                        "id": "487ada78-0a69-4262-965f-7ba8875a9bd8",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Application Gateway",
                        "subTarget": "appgw",
                        "style": "link"
                      },
                      {
                        "id": "ed5e80d3-1667-4fb1-94cf-8d509a89875e",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Load Balancer",
                        "subTarget": "loadbalancer",
                        "style": "link"
                      },
                      {
                        "id": "f5fe460e-d245-4401-bb4e-b74af6cfcf79",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "VM Traffic",
                        "subTarget": "vmtraffic",
                        "style": "link"
                      },
                      {
                        "id": "513f99ba-f563-4699-b480-ae1e6163d0ba",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Rule Reconsiliation",
                        "subTarget": "rulereconsiliation",
                        "style": "link"
                      }
                    ]
                  },
                  "name": "links - 0"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "5e8f8ef7-c57e-4c97-8356-67e34bdd1eb1",
                        "version": "KqlParameterItem/1.0",
                        "name": "Subscription",
                        "type": 6,
                        "isRequired": true,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "typeSettings": {
                          "additionalResourceOptions": [
                            "value::1",
                            "value::3",
                            "value::all"
                          ],
                          "includeAll": true,
                          "showDefault": false
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "defaultValue": "value::3"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isNotEqualTo",
                    "value": "vmtraffic"
                  },
                  "name": "parameters - 5"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type =~ \"microsoft.network/applicationgateways\"\r\n| extend tier = parse_json(properties).sku.tier\r\n| project SKU = iff(tier contains \"v2\", \"v2\", \"v1\")\r\n| summarize count() by SKU",
                          "size": 3,
                          "title": "Application Gateway Overview",
                          "noDataMessage": "No App GW found in selected subscription.",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart",
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "vmsize",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "graphSettings": {
                            "type": 0,
                            "topContent": {
                              "columnMatch": "vmsize",
                              "formatter": 1
                            },
                            "centerContent": {
                              "columnMatch": "count_",
                              "formatter": 1,
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "v2",
                                "label": "Application GW V2"
                              },
                              {
                                "seriesName": "v1",
                                "label": "Application GW V1"
                              }
                            ]
                          }
                        },
                        "customWidth": "35",
                        "name": "App Gateway Overview",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.network/applicationgateways\"\r\n| extend sku = tostring(properties.sku.name)\r\n| project subscriptionId\r\n, id\r\n, AppGWName=name\r\n, resourceGroup\r\n, sku_tier = tostring(properties.sku.tier)\r\n, sku_capacity = tostring(properties.sku.capacity)\r\n, location",
                          "size": 3,
                          "title": "Application Gateway Overview",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "subscriptionId",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "id",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "linkIsContextBlade": true,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "AppGWName",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "sku_capacity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "is Empty",
                                      "representation": "trendup",
                                      "text": "Auto"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "right",
                                      "text": "{0} (Manual)"
                                    }
                                  ]
                                }
                              }
                            ],
                            "rowLimit": 10000,
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "id",
                                "label": "App Gateway Name"
                              },
                              {
                                "columnId": "resourceGroup",
                                "label": "Resource Group"
                              },
                              {
                                "columnId": "sku_tier",
                                "label": "SKU"
                              },
                              {
                                "columnId": "sku_capacity",
                                "label": "Capacity Mode"
                              },
                              {
                                "columnId": "location",
                                "label": "Azure Location"
                              }
                            ]
                          },
                          "sortBy": []
                        },
                        "customWidth": "65",
                        "showPin": true,
                        "name": "query - Application Gateway Overview"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "parameters": [
                            {
                              "id": "892cfb5f-6614-4238-816c-03b47ad6a8ba",
                              "version": "KqlParameterItem/1.0",
                              "name": "ApplicationGateway",
                              "label": "Application Gateway",
                              "type": 5,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "resources\r\n| where type == \"microsoft.network/applicationgateways\"\r\n| order by name asc\r\n| extend Rank = row_number()\r\n| project value = id, label = id, selected = Rank <= 5",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "resourceTypeFilter": {
                                  "microsoft.management/managementgroups/providers/privatelinkassociations": true,
                                  "microsoft.network/applicationgateways": true
                                },
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::3",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "id": "8e067db8-a2c2-4ff5-b9c7-6338c20a6811",
                              "version": "KqlParameterItem/1.0",
                              "name": "TimeRange",
                              "type": 4,
                              "isRequired": true,
                              "value": {
                                "durationMs": 604800000
                              },
                              "typeSettings": {
                                "selectableValues": [
                                  {
                                    "durationMs": 300000
                                  },
                                  {
                                    "durationMs": 900000
                                  },
                                  {
                                    "durationMs": 1800000
                                  },
                                  {
                                    "durationMs": 3600000
                                  },
                                  {
                                    "durationMs": 14400000
                                  },
                                  {
                                    "durationMs": 43200000
                                  },
                                  {
                                    "durationMs": 86400000
                                  },
                                  {
                                    "durationMs": 172800000
                                  },
                                  {
                                    "durationMs": 259200000
                                  },
                                  {
                                    "durationMs": 604800000
                                  },
                                  {
                                    "durationMs": 1209600000
                                  },
                                  {
                                    "durationMs": 2419200000
                                  },
                                  {
                                    "durationMs": 2592000000
                                  },
                                  {
                                    "durationMs": 5184000000
                                  },
                                  {
                                    "durationMs": 7776000000
                                  }
                                ],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "name": "parameters - App GW"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Top HTTP versions \r\n// Count of request per HTTP version. \r\nAzureDiagnostics\r\n| where ResourceType == \"APPLICATIONGATEWAYS\" and OperationName == \"ApplicationGatewayAccess\"\r\n| summarize AggregatedValue = count() by httpVersion_s\r\n| where httpVersion_s != \"\"\r\n| top 10 by AggregatedValue",
                          "size": 4,
                          "title": "Top HTTP Versions",
                          "timeContext": {
                            "durationMs": 86400000
                          },
                          "queryType": 0,
                          "resourceType": "microsoft.network/applicationgateways",
                          "crossComponentResources": [
                            "{ApplicationGateway}"
                          ],
                          "visualization": "piechart"
                        },
                        "customWidth": "30",
                        "name": "Top HTTP Versions"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Failed requests per hour \r\n// Count of requests to which Application Gateway responded with an error. \r\n// To create an alert for this query, click '+ New alert rule'\r\nAzureDiagnostics\r\n| where ResourceType == \"APPLICATIONGATEWAYS\" and OperationName == \"ApplicationGatewayAccess\" and httpStatus_d > 399\r\n| summarize AggregatedValue = count() by bin(TimeGenerated, 1h), _ResourceId\r\n| render timechart",
                          "size": 1,
                          "title": "Failed Requests",
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.network/applicationgateways",
                          "crossComponentResources": [
                            "{ApplicationGateway}"
                          ],
                          "visualization": "linechart",
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "_ResourceId",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "AggregatedValue",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "70",
                        "name": "Failed Requests"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbookda4dcfe0-e85b-4914-ad14-d6ac507dec91",
                          "version": "MetricsItem/2.0",
                          "size": 1,
                          "chartType": 2,
                          "resourceType": "microsoft.network/applicationgateways",
                          "metricScope": 0,
                          "resourceParameter": "ApplicationGateway",
                          "resourceIds": [
                            "{ApplicationGateway}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 604800000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.network/applicationgateways",
                              "metric": "microsoft.network/applicationgateways--CurrentConnections",
                              "aggregation": 1,
                              "splitBy": null
                            }
                          ],
                          "title": " Current Connections",
                          "showCreateAlertRule": true,
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "33",
                        "name": "metric - Current Connections"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbookc9d71de0-846b-44b8-b7cd-57b5f5d1c973",
                          "version": "MetricsItem/2.0",
                          "size": 1,
                          "chartType": 2,
                          "resourceType": "microsoft.network/applicationgateways",
                          "metricScope": 0,
                          "resourceParameter": "ApplicationGateway",
                          "resourceIds": [
                            "{ApplicationGateway}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 604800000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.network/applicationgateways",
                              "metric": "microsoft.network/applicationgateways--TotalRequests",
                              "aggregation": 1,
                              "splitBy": null
                            }
                          ],
                          "title": "Total Requests",
                          "gridSettings": {
                            "rowLimit": 10000
                          },
                          "exportToExcelOptions": "all"
                        },
                        "customWidth": "33",
                        "name": "metric - Total Requests"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook6eede7d4-47b4-44d2-a257-4fc172dcae95",
                          "version": "MetricsItem/2.0",
                          "size": 1,
                          "chartType": 2,
                          "resourceType": "microsoft.network/applicationgateways",
                          "metricScope": 0,
                          "resourceParameter": "ApplicationGateway",
                          "resourceIds": [
                            "{ApplicationGateway}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 604800000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.network/applicationgateways",
                              "metric": "microsoft.network/applicationgateways--Throughput",
                              "aggregation": 4,
                              "splitBy": null
                            }
                          ],
                          "title": "Throughput",
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "33",
                        "name": "metric - Throughput"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Count of requests per client IP. \r\nAzureDiagnostics\r\n| where ResourceType == \"APPLICATIONGATEWAYS\" and OperationName == \"ApplicationGatewayAccess\"\r\n| summarize AggregatedValue = count() by clientIP_s\r\n| top 10 by AggregatedValue",
                          "size": 3,
                          "title": "IP wise Request Count",
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.network/applicationgateways",
                          "crossComponentResources": [
                            "{ApplicationGateway}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "clientIP_s",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "AggregatedValue",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": true,
                            "size": "auto"
                          }
                        },
                        "name": "query - 9"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.network/applicationgateways\"\r\n| extend sku = tostring(properties.sku.name)\r\n| mv-expand backendHttpSettingsCollection = properties.backendHttpSettingsCollection\r\n| project subscriptionId\r\n, AppGWName=name\r\n, resourceGroup\r\n, name = tostring(backendHttpSettingsCollection.name)\r\n, provisioningState= tostring(backendHttpSettingsCollection.properties.provisioningState)\r\n, protocol = tostring(backendHttpSettingsCollection.properties.protocol)\r\n, port = tostring(backendHttpSettingsCollection.properties.port)\r\n, pickHostNameFromBackendAddress = tostring(backendHttpSettingsCollection.properties.pickHostNameFromBackendAddress)\r\n, cookieBasedAffinity = tostring(backendHttpSettingsCollection.properties.cookieBasedAffinity)\r\n, requestTimeout = tostring(backendHttpSettingsCollection.properties.requestTimeout)",
                          "size": 3,
                          "title": "Backend Pool Configurations",
                          "showExportToExcel": true,
                          "exportToExcelOptions": "all",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{ApplicationGateway}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "subscriptionId",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "protocol",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Https",
                                      "representation": "Resolved",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Http",
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "requestTimeout",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "30",
                                      "representation": "Resolved",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "30",
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "AppGWName",
                                "label": "AppGW Name"
                              },
                              {
                                "columnId": "resourceGroup",
                                "label": "Resource Group"
                              },
                              {
                                "columnId": "name",
                                "label": "Name"
                              },
                              {
                                "columnId": "provisioningState",
                                "label": "Provisioning State"
                              },
                              {
                                "columnId": "protocol",
                                "label": "Protocol"
                              },
                              {
                                "columnId": "port",
                                "label": "Port"
                              },
                              {
                                "columnId": "pickHostNameFromBackendAddress",
                                "label": "Pick Host Name From Backend Address"
                              },
                              {
                                "columnId": "cookieBasedAffinity",
                                "label": "Cookies Based Affinity"
                              },
                              {
                                "columnId": "requestTimeout",
                                "label": "Request Timeout"
                              }
                            ]
                          }
                        },
                        "name": "Backend Pool Configurations"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "appgw"
                  },
                  "name": "Application Gateway"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "where type has \"microsoft.network\"\r\n    or type has 'microsoft.cdn'\r\n| extend type = case(\r\n\ttype == 'microsoft.network/networkinterfaces', \"NICs\",\r\n\ttype == 'microsoft.network/networksecuritygroups', \"NSGs\", \r\n\ttype == \"microsoft.network/publicipaddresses\", \"Public IPs\", \r\n\ttype == 'microsoft.network/virtualnetworks', \"vNets\",\r\n\ttype == 'microsoft.network/networkwatchers/connectionmonitors', \"Connection Monitors\",\r\n\ttype == 'microsoft.network/privatednszones', \"Private DNS\",\r\n\ttype == 'microsoft.network/virtualnetworkgateways', @\"vNet Gateways\",\r\n\ttype == 'microsoft.network/connections', \"Connections\",\r\n\ttype == 'microsoft.network/networkwatchers', \"Network Watchers\",\r\n\ttype == 'microsoft.network/privateendpoints', \"Private Endpoints\",\r\n\ttype == 'microsoft.network/localnetworkgateways', \"Local Network Gateways\",\r\n\ttype == 'microsoft.network/privatednszones/virtualnetworklinks', \"vNet Links\",\r\n\ttype == 'microsoft.network/dnszones', 'DNS Zones',\r\n\ttype == 'microsoft.network/networkwatchers/flowlogs', 'Flow Logs',\r\n\ttype == 'microsoft.network/routetables', 'Route Tables',\r\n\ttype == 'microsoft.network/loadbalancers', 'Load Balancers',\r\n\ttype == 'microsoft.network/ddosprotectionplans', 'DDoS Protection Plans',\r\n\ttype == 'microsoft.network/applicationsecuritygroups', 'App Security Groups',\r\n\ttype == 'microsoft.network/azurefirewalls', 'Azure Firewalls',\r\n\ttype == 'microsoft.network/applicationgateways', 'App Gateways',\r\n\ttype == 'microsoft.network/frontdoors', 'Front Doors',\r\n\ttype == 'microsoft.network/applicationgatewaywebapplicationfirewallpolicies', 'AppGateway Policies',\r\n\ttype == 'microsoft.network/bastionhosts', 'Bastion Hosts',\r\n\ttype == 'microsoft.network/frontdoorwebapplicationfirewallpolicies', 'FrontDoor Policies',\r\n\ttype == 'microsoft.network/firewallpolicies', 'Firewall Policies',\r\n\ttype == 'microsoft.network/networkintentpolicies', 'Network Intent Policies',\r\n\ttype == 'microsoft.network/trafficmanagerprofiles', 'Traffic Manager Profiles',\r\n\ttype == 'microsoft.network/publicipprefixes', 'PublicIP Prefixes',\r\n\ttype == 'microsoft.network/privatelinkservices', 'Private Link',\r\n\ttype == 'microsoft.network/expressroutecircuits', 'Express Route Circuits',\r\n\ttype =~ 'microsoft.cdn/cdnwebapplicationfirewallpolicies', 'CDN Web App Firewall Policies',\r\n\ttype =~ 'microsoft.cdn/profiles', 'CDN Profiles',\r\n\ttype =~ 'microsoft.cdn/profiles/afdendpoints', 'CDN Front Door Endpoints',\r\n\ttype =~ 'microsoft.cdn/profiles/endpoints', 'CDN Endpoints',\r\n\tstrcat(\"Not Translated: \", type))\r\n| summarize count() by type",
                          "size": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "type",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": true
                          }
                        },
                        "name": "query - 7"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "networkoverview"
                  },
                  "name": "Overview"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "parameters": [
                            {
                              "id": "c72755d6-9fac-458b-979a-f2ce197f6ddf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Resources",
                              "label": "ExpressRoute Ckt",
                              "type": 5,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "resources\r\n| where type == \"microsoft.network/expressroutecircuits\"\r\n| order by name asc\r\n| extend Rank = row_number()\r\n| project value = id, label = id, selected = Rank <= 5",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::3",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "id": "a1f082dc-094f-48bb-8ae7-6467f2bfd916",
                              "version": "KqlParameterItem/1.0",
                              "name": "TimeRange",
                              "type": 4,
                              "isRequired": true,
                              "value": {
                                "durationMs": 7776000000
                              },
                              "typeSettings": {
                                "selectableValues": [
                                  {
                                    "durationMs": 300000
                                  },
                                  {
                                    "durationMs": 900000
                                  },
                                  {
                                    "durationMs": 1800000
                                  },
                                  {
                                    "durationMs": 3600000
                                  },
                                  {
                                    "durationMs": 14400000
                                  },
                                  {
                                    "durationMs": 43200000
                                  },
                                  {
                                    "durationMs": 86400000
                                  },
                                  {
                                    "durationMs": 172800000
                                  },
                                  {
                                    "durationMs": 259200000
                                  },
                                  {
                                    "durationMs": 604800000
                                  },
                                  {
                                    "durationMs": 1209600000
                                  },
                                  {
                                    "durationMs": 2419200000
                                  },
                                  {
                                    "durationMs": 2592000000
                                  },
                                  {
                                    "durationMs": 5184000000
                                  },
                                  {
                                    "durationMs": 7776000000
                                  }
                                ],
                                "allowCustom": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "4798ec15-23a7-446e-ba82-fb56e49fd5ee",
                              "version": "KqlParameterItem/1.0",
                              "name": "Message",
                              "type": 1,
                              "query": "where type == \"microsoft.network/expressroutecircuits\"\r\n| summarize Selected = countif(id in ({Resources:value})), Total = count()\r\n| extend Selected = iff(Selected > 200, 200, Selected)\r\n| project Message = strcat('# ', Selected, ' / ', Total)",
                              "crossComponentResources": [
                                "{Subscriptions}"
                              ],
                              "isHiddenWhenLocked": true,
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "id": "4e35d916-4d5a-4dbf-b7b2-39cd379fa727",
                              "version": "KqlParameterItem/1.0",
                              "name": "ResourceName",
                              "type": 1,
                              "isRequired": true,
                              "isHiddenWhenLocked": true,
                              "criteriaData": [
                                {
                                  "criteriaContext": {
                                    "operator": "Default",
                                    "resultValType": "static",
                                    "resultVal": "ExpressRoute Ckt"
                                  }
                                }
                              ],
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "name": "Express Route"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// BGP route table \r\n// BPG route table learned over last 12 hours. \r\nAzureDiagnostics\r\n| where ResourceType == \"EXPRESSROUTECIRCUITS\"\r\n| project TimeGenerated , ResourceType , network_s , path_s , OperationName\r\n| summarize c = count()\r\n| extend Item = \"Route Learned\",  Key = 1",
                          "size": 3,
                          "queryType": 0,
                          "resourceType": "microsoft.network/expressroutecircuits",
                          "crossComponentResources": [
                            "{Resources}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Item"
                            },
                            "leftContent": {
                              "columnMatch": "c",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              }
                            },
                            "showBorder": true
                          }
                        },
                        "customWidth": "20",
                        "name": "query - 6"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"AzureHealthQuery/1.0\",\"queryType\":\"Detailed\"}",
                          "size": 3,
                          "title": "Express Route Circuits",
                          "showExportToExcel": true,
                          "queryType": 4,
                          "resourceType": "microsoft.network/expressroutecircuits",
                          "crossComponentResources": [
                            "{Resources}"
                          ],
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Detailed status",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Reason chronicity",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Reason type",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Title",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Resource group",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Subscription",
                                "formatter": 5
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "80",
                        "name": "ExpressRoute Circuit Status"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook491f1ae0-8005-4638-848a-dc181b2f797d",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.network/expressroutecircuits",
                          "metricScope": 0,
                          "resourceParameter": "Resources",
                          "resourceIds": [
                            "{Resources}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 7776000000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.network/expressroutecircuits",
                              "metric": "microsoft.network/expressroutecircuits-Circuit Availability-BgpAvailability",
                              "aggregation": 4,
                              "splitBy": null
                            },
                            {
                              "namespace": "microsoft.network/expressroutecircuits",
                              "metric": "microsoft.network/expressroutecircuits-Circuit Availability-ArpAvailability",
                              "aggregation": 4
                            }
                          ],
                          "title": "Availability ExpressRoute Ckt",
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "50",
                        "name": "metric - 3"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook581d65e4-97e7-416b-824b-3a154d21a848",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.network/expressroutecircuits",
                          "metricScope": 0,
                          "resourceParameter": "Resources",
                          "resourceIds": [
                            "{Resources}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 7776000000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.network/expressroutecircuits",
                              "metric": "microsoft.network/expressroutecircuits-Circuit Traffic-BitsInPerSecond",
                              "aggregation": 4,
                              "splitBy": null
                            },
                            {
                              "namespace": "microsoft.network/expressroutecircuits",
                              "metric": "microsoft.network/expressroutecircuits-Circuit Traffic-BitsOutPerSecond",
                              "aggregation": 4
                            }
                          ],
                          "title": "Avg speed through ExpressRoute Ckt",
                          "resourceLimit": 10000,
                          "timeBrushParameterName": "Time",
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "50",
                        "name": "metric - Speed"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbookf18a2fba-74bf-435b-a99c-eba0722d7fc0",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.network/expressroutecircuits",
                          "metricScope": 0,
                          "resourceParameter": "Resources",
                          "resourceIds": [
                            "{Resources}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 7776000000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.network/expressroutecircuits",
                              "metric": "microsoft.network/expressroutecircuits-Circuit Traffic-BitsInPerSecond",
                              "aggregation": 4,
                              "splitBy": null
                            },
                            {
                              "namespace": "microsoft.network/expressroutecircuits",
                              "metric": "microsoft.network/expressroutecircuits-Circuit Qos-QosDropBitsOutPerSecond",
                              "aggregation": 4
                            }
                          ],
                          "title": "Avg Traffic dropped ",
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "50",
                        "name": "metric - Avg Dropped Traffic"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook8800b475-0a9a-4985-8ce3-41a474abd690",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.network/expressroutecircuits",
                          "metricScope": 0,
                          "resourceParameter": "Resources",
                          "resourceIds": [
                            "{Resources}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 7776000000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.network/expressroutecircuits",
                              "metric": "microsoft.network/expressroutecircuits-GlobalReach Traffic-GlobalReachBitsInPerSecond",
                              "aggregation": 4,
                              "splitBy": null
                            },
                            {
                              "namespace": "microsoft.network/expressroutecircuits",
                              "metric": "microsoft.network/expressroutecircuits-GlobalReach Traffic-GlobalReachBitsOutPerSecond",
                              "aggregation": 4
                            }
                          ],
                          "title": "Avg GlobalReach In/Out",
                          "resourceLimit": 10000,
                          "gridSettings": {
                            "rowLimit": 10000
                          },
                          "exportToExcelOptions": "all"
                        },
                        "customWidth": "50",
                        "name": "metric - GlobalReach In/Out"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "expressroute"
                  },
                  "name": "Express Route"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Run query to see results.\r\nresources\r\n| where type =~ \"microsoft.network/privateEndpoints\" and isnotnull(properties)\r\n| extend connection = iff(array_length(properties.manualPrivateLinkServiceConnections) > 0, properties.manualPrivateLinkServiceConnections[0], properties.privateLinkServiceConnections[0])\r\n| extend subnetId = properties.subnet.id\r\n| extend subnetIdSplit = split(subnetId, \"/\")\r\n| extend vnetId = strcat_array(array_slice(subnetIdSplit,0,8), \"/\")\r\n| extend vnetParameters = parse_json(strcat('{\"id\":\"',vnetId,'\",','\"menuid\":\"subnets\"','}'))\r\n| extend subnetName = strcat(subnetIdSplit[8], \"/\", subnetIdSplit[10])\r\n| extend serviceId = tostring(connection.properties.privateLinkServiceId)\r\n| extend serviceIdSplit = split(serviceId, \"/\")\r\n| extend serviceName = tostring(serviceIdSplit[8])\r\n| extend serviceTypeEnum = iff(isnotnull(serviceIdSplit[6]), tolower(strcat(serviceIdSplit[6], \"/\", serviceIdSplit[7])), \"microsoft.network/privatelinkservices\")\r\n| extend stateEnum = tostring(connection.properties.privateLinkServiceConnectionState.status)\r\n| extend statusIcon = case(\r\n    stateEnum == \"Approved\", 8,\r\n    stateEnum == \"Rejected\", 252,\r\n    stateEnum == \"Pending\", 88,\r\n    stateEnum == \"Disconnected\", 131,\r\n    7\r\n)\r\n| extend groupId = tostring(connection.properties.groupIds[0])\r\n| extend id = tolower(tostring(id))\r\n| join kind=leftouter hint.strategy=shuffle ( data\r\n        | where type =~ \"microsoft.network/networkInterfaces\" and isnotnull(properties) and isnotnull(properties.ipConfigurations) and isnotnull(properties.ipConfigurations[0].properties.privateLinkConnectionProperties)\r\n        | extend networkInterfaceId = id\r\n        | extend id = tolower(tostring(properties.privateEndpoint.id))\r\n        | extend ipAddress = properties.ipConfigurations[0].properties.privateIPAddress\r\n        | extend ipBladeParameters = parse_json(strcat('{\"id\":\"',networkInterfaceId,'\"}'))\r\n        | project id, ipBladeParameters, ipAddress)\r\n    on id\r\n| project id, name, type, location, subscriptionId, resourceGroup, kind, tags, serviceId, serviceName, serviceTypeEnum, groupId, subnetId, subnetName, stateEnum, privateIP = coalesce(ipAddress, \" \"), sortedIPs = parse_ipv6(tostring(ipAddress)), statusIcon, ipBladeParameters, vnetParameters\r\n| where (type !~ ('dynatrace.observability/monitors'))\r\n| where (type !~ ('nginx.nginxplus/nginxdeployments'))\r\n| where (type !~ ('microsoft.agfoodplatform/farmbeats'))\r\n| where (type !~ ('microsoft.cdn/profiles/afdendpoints'))\r\n| where (type !~ ('microsoft.cdn/profiles/customdomains'))\r\n| where (type !~ ('microsoft.cdn/profiles/origingroups'))\r\n| where (type !~ ('microsoft.cdn/profiles/rulesets'))\r\n| where (type !~ ('microsoft.cdn/profiles/secrets'))\r\n| where (type !~ ('microsoft.cdn/profiles/securitypolicies'))\r\n| where (type !~ ('microsoft.cdn/profiles/afdendpoints/routes'))\r\n| where (type !~ ('microsoft.cdn/profiles/origingroups/origins'))\r\n| where (type !~ ('microsoft.cdn/profiles/rulesets/rules'))\r\n| where (type !~ ('microsoft.kubernetes/connectedclusters/microsoft.kubernetesconfiguration/fluxconfigurations'))\r\n| where (type !~ ('microsoft.containerservice/managedclusters/microsoft.kubernetesconfiguration/fluxconfigurations'))\r\n| where (type !~ ('microsoft.portal/extensions/deployments'))\r\n| where (type !~ ('microsoft.portal/extensions'))\r\n| where (type !~ ('microsoft.portal/extensions/slots'))\r\n| where (type !~ ('microsoft.portal/extensions/versions'))\r\n| where (type !~ ('microsoft.datacollaboration/workspaces'))\r\n| where (type !~ ('microsoft.network/dnsforwardingrulesets'))\r\n| where (type !~ ('microsoft.network/dnsresolvers'))\r\n| where (type !~ ('microsoft.azurestack/registrations'))\r\n| where (type !~ ('microsoft.communication/emailservices/domains'))\r\n| where (type !~ ('microsoft.communication/emailservices'))\r\n| where (type !~ ('microsoft.hdinsight/clusterpools/clusters'))\r\n| where (type !~ ('microsoft.hdinsight/clusterpools/clusters/sessionclusters'))\r\n| where (type !~ ('microsoft.hdinsight/clusterpools'))\r\n| where (type !~ ('microsoft.hpcworkbench/instances'))\r\n| where (type !~ ('microsoft.scvmm/vmmservers'))\r\n| where (type !~ ('microsoft.connectedvmwarevsphere/vcenters'))\r\n| where (type !~ ('microsoft.intelligentitdigitaltwin/digitaltwins/assets'))\r\n| where (type !~ ('microsoft.intelligentitdigitaltwin/digitaltwins/tests'))\r\n| where (type !~ ('microsoft.intelligentitdigitaltwin/digitaltwins/executionplans'))\r\n| where (type !~ ('microsoft.intelligentitdigitaltwin/digitaltwins/testplans'))\r\n| where (type !~ ('microsoft.intelligentitdigitaltwin/digitaltwins'))\r\n| where not((type =~ ('microsoft.network/serviceendpointpolicies')) and ((kind =~ ('internal'))))\r\n| where (type !~ ('microsoft.openlogisticsplatform/workspaces'))\r\n| where (type !~ ('microsoft.scom/managedinstances'))\r\n| where (type !~ ('microsoft.orbital/spacecrafts/contacts'))\r\n| where (type !~ ('microsoft.orbital/contactprofiles'))\r\n| where (type !~ ('microsoft.orbital/edgesites'))\r\n| where (type !~ ('microsoft.orbital/groundstations'))\r\n| where (type !~ ('microsoft.orbital/l2connections'))\r\n| where (type !~ ('microsoft.orbital/spacecrafts'))\r\n| where (type !~ ('microsoft.azurepercept/accounts'))\r\n| where (type !~ ('microsoft.workloads/phpworkloads'))\r\n| where (type !~ ('microsoft.playfab/playeraccountpools'))\r\n| where (type !~ ('microsoft.playfab/playfabresources'))\r\n| where (type !~ ('microsoft.playfab/titles'))\r\n| where (type !~ ('microsoft.recommendationsservice/accounts/modeling'))\r\n| where (type !~ ('microsoft.recommendationsservice/accounts/serviceendpoints'))\r\n| where (type !~ ('microsoft.recoveryservicesbvtd2/vaults'))\r\n| where (type !~ ('microsoft.recoveryservicesbvtd/vaults'))\r\n| where (type !~ ('microsoft.recoveryservicesintd/vaults'))\r\n| where (type !~ ('microsoft.recoveryservicesintd2/vaults'))\r\n| where (type !~ ('microsoft.billingbenefits/savingsplanorders/savingsplans'))\r\n| where (type !~ ('microsoft.billingbenefits/savingsplanorders'))\r\n| where (type !~ ('microsoft.workloads/sapvirtualinstances/applicationinstances'))\r\n| where (type !~ ('microsoft.workloads/sapvirtualinstances/centralinstances'))\r\n| where (type !~ ('microsoft.workloads/sapvirtualinstances/databaseinstances'))\r\n| where (type !~ ('microsoft.workloads/sapvirtualinstances'))\r\n| where (type !~ ('microsoft.datareplication/replicationvaults'))\r\n| where (type !~ ('microsoft.storagecache/amlfilesystems'))\r\n| where not((type =~ ('microsoft.synapse/workspaces/sqlpools')) and ((kind =~ ('v3'))))\r\n| where (type !~ ('microsoft.testbase/testbaseaccounts/packages'))\r\n| where (type !~ ('microsoft.mobilenetwork/mobilenetworks/datanetworks'))\r\n| where (type !~ ('microsoft.mobilenetwork/mobilenetworks'))\r\n| where (type !~ ('microsoft.mobilenetwork/mobilenetworks/sites'))\r\n| where (type !~ ('microsoft.mobilenetwork/packetcorecontrolplanes/packetcoredataplanes/attacheddatanetworks'))\r\n| where (type !~ ('microsoft.mobilenetwork/packetcorecontrolplanes'))\r\n| where (type !~ ('microsoft.mobilenetwork/packetcorecontrolplanes/packetcoredataplanes'))\r\n| where (type !~ ('microsoft.mobilenetwork/mobilenetworks/services'))\r\n| where (type !~ ('microsoft.mobilenetwork/sims'))\r\n| where (type !~ ('microsoft.mobilenetwork/mobilenetworks/simpolicies'))\r\n| where (type !~ ('microsoft.mobilenetwork/mobilenetworks/slices'))\r\n| where (type !~ ('microsoft.workloads/monitors'))\r\n| where not((type =~ ('microsoft.sql/servers/databases')) and ((kind in~ ('system','v2.0,system','v12.0,system','v12.0,user,datawarehouse,gen2,analytics'))))\r\n| where not((type =~ ('microsoft.sql/servers')) and ((kind =~ ('v12.0,analytics'))))\r\n| project id, name,privateIP,serviceId,groupId,subnetName,statusIcon,location,subscriptionId,resourceGroup\r\n| sort by (tolower(tostring(name))) asc",
                          "size": 3,
                          "noDataMessage": "No Private Endpoints exist!",
                          "showExportToExcel": true,
                          "exportToExcelOptions": "all",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "id",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "linkIsContextBlade": true,
                                  "showIcon": true,
                                  "customColumnWidthSetting": "25ch"
                                }
                              },
                              {
                                "columnMatch": "name",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "privateIP",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "15ch"
                                }
                              },
                              {
                                "columnMatch": "serviceId",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "linkIsContextBlade": true,
                                  "showIcon": true,
                                  "customColumnWidthSetting": "25ch"
                                }
                              },
                              {
                                "columnMatch": "statusIcon",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "8",
                                      "representation": "Available",
                                      "text": "Approved"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "252",
                                      "representation": "3",
                                      "text": "Rejected"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "88",
                                      "representation": "2",
                                      "text": "Pending"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "131",
                                      "representation": "disabled",
                                      "text": "Disconnected"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "1",
                                      "text": "Unknown"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "subscriptionId",
                                "formatter": 5
                              }
                            ],
                            "filter": true,
                            "sortBy": [
                              {
                                "itemKey": "$gen_thresholds_statusIcon_6",
                                "sortOrder": 1
                              }
                            ],
                            "labelSettings": [
                              {
                                "columnId": "id",
                                "label": "Name"
                              },
                              {
                                "columnId": "privateIP",
                                "label": "IP address"
                              },
                              {
                                "columnId": "serviceId",
                                "label": "Resource"
                              },
                              {
                                "columnId": "groupId",
                                "label": "Sub-Resource"
                              },
                              {
                                "columnId": "subnetName",
                                "label": "Subnt"
                              },
                              {
                                "columnId": "statusIcon",
                                "label": "Connection State"
                              },
                              {
                                "columnId": "resourceGroup",
                                "label": "Resource Group"
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "$gen_thresholds_statusIcon_6",
                              "sortOrder": 1
                            }
                          ]
                        },
                        "name": "query - PrivateEndpoint"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "privateendpoint"
                  },
                  "name": "Private Endpoint"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.network/privatednszones\"\r\n| project id, provisioningState=properties.provisioningState, maxNumberOfRecordSets=properties.maxNumberOfRecordSets, RecordSets=properties.numberOfRecordSets, MaxVNetLinksWithRegistration=properties.maxNumberOfVirtualNetworkLinksWithRegistration, VNetLinksWithRegistration=properties.numberOfVirtualNetworkLinksWithRegistration, MaxVNetLinks=properties.maxNumberOfVirtualNetworkLinks, VNetLinks=properties.numberOfVirtualNetworkLinks, location, resourceGroup",
                          "size": 3,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "id",
                                "label": "Name"
                              },
                              {
                                "columnId": "provisioningState",
                                "label": "State"
                              },
                              {
                                "columnId": "maxNumberOfRecordSets",
                                "label": "Max Number of Record Sets"
                              },
                              {
                                "columnId": "RecordSets",
                                "label": "Record Set"
                              },
                              {
                                "columnId": "MaxVNetLinksWithRegistration",
                                "label": "Max Vnet Links With Registration"
                              },
                              {
                                "columnId": "VNetLinksWithRegistration",
                                "label": "Vnet Link With Registration"
                              },
                              {
                                "columnId": "MaxVNetLinks",
                                "label": "Max VNet Links"
                              },
                              {
                                "columnId": "VNetLinks",
                                "label": "VNet Links"
                              },
                              {
                                "columnId": "location",
                                "label": "Location"
                              },
                              {
                                "columnId": "resourceGroup",
                                "label": "Resource Group"
                              }
                            ]
                          }
                        },
                        "name": "query - 0"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "privatedns"
                  },
                  "name": "Private DNS"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "PUBLIC IP SUMMARY",
                          "style": "info"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "Resources\r\n| where type contains 'publicIPAddresses' and isnotempty(properties.ipAddress)\r\n| summarize count () by subscriptionId",
                          "size": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart",
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "subscriptionId",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "40",
                        "name": "query - 3"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "Resources\r\n| where type contains 'publicIPAddresses' and isnotempty(properties.ipAddress)\r\n| project name, properties.ipAddress \r\n| limit 100",
                          "size": 3,
                          "color": "green",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "name",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "properties_ipAddress",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "success",
                                    "text": "{0}{1}"
                                  }
                                ],
                                "compositeBarSettings": {
                                  "labelText": "",
                                  "columnSettings": []
                                }
                              }
                            },
                            "showBorder": true,
                            "sortCriteriaField": "name"
                          }
                        },
                        "customWidth": "60",
                        "name": "query - 2"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "publicip"
                  },
                  "name": "Public IP "
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.network/loadbalancers\"\r\n| project id, name = tostring(sku.name), tier = tostring(sku.tier)\r\n| summarize count() by name",
                          "size": 1,
                          "title": "Azure Load Balancer Overview",
                          "noDataMessage": "No Azure Load Balancer found in selected subscription.",
                          "exportToExcelOptions": "all",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart",
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "vmsize",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "graphSettings": {
                            "type": 0,
                            "topContent": {
                              "columnMatch": "vmsize",
                              "formatter": 1
                            },
                            "centerContent": {
                              "columnMatch": "count_",
                              "formatter": 1,
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "v2",
                                "label": "Application GW V2"
                              },
                              {
                                "seriesName": "v1",
                                "label": "Application GW V1"
                              }
                            ]
                          }
                        },
                        "customWidth": "25",
                        "name": " Azure Load Balancer Overview"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.network/loadbalancers\"\r\n| extend sku = tostring(sku.name)\r\n| mv-expand lbrules = properties.loadBalancingRules\r\n| mv-expand feip = properties.frontendIPConfigurations\r\n| mv-expand probes = properties.probes\r\n| project subscriptionId\r\n, id\r\n, resourceGroup\r\n, lbName=name\r\n, sku\r\n, location\r\n, rulename=tostring(lbrules.name)\r\n, frontendIP=tostring(feip.properties.privateIPAddress)\r\n, probeport=tostring(probes.properties.port)\r\n, HA_Ports= tostring(lbrules.properties.protocol)\r\n, rule_idleTimeoutMinutes=tostring(lbrules.properties.idleTimeoutInMinutes)\r\n, rule_isFloatingIPEnabled = tostring(lbrules.properties.enableFloatingIP)\r\n, rule_isTCP_ResetEnabled = tostring(lbrules.properties.enableTcpReset)\r\n, rule_loadDistribution = tostring(lbrules.properties.loadDistribution)\r\n| summarize by subscriptionId\r\n, id\r\n, lbName\r\n, resourceGroup\r\n, location\r\n, sku\r\n, rulename\r\n, frontendIP\r\n, probeport\r\n, HA_Ports\r\n, rule_idleTimeoutMinutes\r\n, rule_isFloatingIPEnabled\r\n, rule_isTCP_ResetEnabled\r\n, rule_loadDistribution",
                          "size": 1,
                          "title": "Standard Load Balancer Overview",
                          "showExportToExcel": true,
                          "exportToExcelOptions": "all",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "subscriptionId",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "id",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "linkIsContextBlade": true,
                                  "showIcon": true,
                                  "customColumnWidthSetting": "25ch"
                                }
                              },
                              {
                                "columnMatch": "lbName",
                                "formatter": 5,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "linkIsContextBlade": true
                                }
                              },
                              {
                                "columnMatch": "resourceGroup",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20ch"
                                }
                              },
                              {
                                "columnMatch": "rulename",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20ch"
                                }
                              },
                              {
                                "columnMatch": "frontendIP",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "10ch"
                                }
                              },
                              {
                                "columnMatch": "probeport",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "10ch"
                                }
                              },
                              {
                                "columnMatch": "HA_Ports",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "All",
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "All",
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "rule_idleTimeoutMinutes",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "10ch"
                                }
                              },
                              {
                                "columnMatch": "rule_isFloatingIPEnabled",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "true",
                                      "representation": "Available",
                                      "text": "Enabled"
                                    },
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "true",
                                      "representation": "2",
                                      "text": "Review SAP Note 2743751"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ],
                                  "customColumnWidthSetting": "10ch"
                                }
                              },
                              {
                                "columnMatch": "rule_isTCP_ResetEnabled",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "10ch"
                                }
                              },
                              {
                                "columnMatch": "rule_loadDistribution",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "10ch"
                                }
                              }
                            ],
                            "rowLimit": 10000,
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "subscriptionId",
                                "label": "Subscription Name"
                              },
                              {
                                "columnId": "id",
                                "label": "LB Name"
                              },
                              {
                                "columnId": "resourceGroup",
                                "label": "Resource Group"
                              },
                              {
                                "columnId": "location",
                                "label": "Azure Region"
                              },
                              {
                                "columnId": "sku",
                                "label": "LB SKU"
                              },
                              {
                                "columnId": "rulename",
                                "label": "LB Rule name"
                              },
                              {
                                "columnId": "frontendIP",
                                "label": "LB FrontEnd IP"
                              },
                              {
                                "columnId": "probeport",
                                "label": "LB Probe Port"
                              },
                              {
                                "columnId": "HA_Ports",
                                "label": "HA Ports"
                              },
                              {
                                "columnId": "rule_idleTimeoutMinutes",
                                "label": "LB Idle Timeout"
                              },
                              {
                                "columnId": "rule_isFloatingIPEnabled",
                                "label": "LB Floating IP"
                              },
                              {
                                "columnId": "rule_isTCP_ResetEnabled",
                                "label": "LB TCP Reset"
                              },
                              {
                                "columnId": "rule_loadDistribution",
                                "label": "LB Load Distribution"
                              }
                            ]
                          },
                          "sortBy": []
                        },
                        "customWidth": "75",
                        "showPin": false,
                        "name": "Load Balancer Overview"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "parameters": [
                            {
                              "id": "173cfcd1-93dd-4eb1-9d1d-c8f10bc9973c",
                              "version": "KqlParameterItem/1.0",
                              "name": "Resources",
                              "label": "Load Balancer",
                              "type": 5,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "resources\r\n| where type == \"microsoft.network/loadbalancers\"\r\n| order by name asc\r\n| extend Rank = row_number()\r\n| project value = id, label = id, selected = Rank <= 5",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::3",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "id": "ee1d322c-ed49-4840-94eb-a4f32d098f71",
                              "version": "KqlParameterItem/1.0",
                              "name": "TimeRange",
                              "type": 4,
                              "isRequired": true,
                              "value": {
                                "durationMs": 1800000
                              },
                              "typeSettings": {
                                "selectableValues": [
                                  {
                                    "durationMs": 300000
                                  },
                                  {
                                    "durationMs": 900000
                                  },
                                  {
                                    "durationMs": 1800000
                                  },
                                  {
                                    "durationMs": 3600000
                                  },
                                  {
                                    "durationMs": 14400000
                                  },
                                  {
                                    "durationMs": 43200000
                                  },
                                  {
                                    "durationMs": 86400000
                                  },
                                  {
                                    "durationMs": 172800000
                                  },
                                  {
                                    "durationMs": 259200000
                                  },
                                  {
                                    "durationMs": 604800000
                                  },
                                  {
                                    "durationMs": 1209600000
                                  },
                                  {
                                    "durationMs": 2419200000
                                  },
                                  {
                                    "durationMs": 2592000000
                                  },
                                  {
                                    "durationMs": 5184000000
                                  },
                                  {
                                    "durationMs": 7776000000
                                  }
                                ]
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "name": "Load Balancer"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook8642f436-3fbb-4a96-ba03-5c5d4b0edbad",
                          "version": "MetricsItem/2.0",
                          "size": 3,
                          "chartType": 0,
                          "resourceType": "microsoft.network/loadbalancers",
                          "metricScope": 0,
                          "resourceParameter": "Resources",
                          "resourceIds": [
                            "{Resources}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 1800000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.network/loadbalancers",
                              "metric": "microsoft.network/loadbalancers--VipAvailability",
                              "aggregation": 4
                            },
                            {
                              "namespace": "microsoft.network/loadbalancers",
                              "metric": "microsoft.network/loadbalancers--DipAvailability",
                              "aggregation": 4
                            },
                            {
                              "namespace": "microsoft.network/loadbalancers",
                              "metric": "microsoft.network/loadbalancers--SnatConnectionCount",
                              "aggregation": 1
                            },
                            {
                              "namespace": "microsoft.network/loadbalancers",
                              "metric": "microsoft.network/loadbalancers--SYNCount",
                              "aggregation": 1
                            },
                            {
                              "namespace": "microsoft.network/loadbalancers",
                              "metric": "microsoft.network/loadbalancers--ByteCount",
                              "aggregation": 1
                            }
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "$gen_group",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Subscription",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Name",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "linkIsContextBlade": true,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "microsoft.network/loadbalancers--VipAvailability",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "redGreen"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "microsoft.network/loadbalancers--VipAvailability Timeline",
                                "formatter": 10,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "microsoft.network/loadbalancers--DipAvailability",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "redGreen"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "microsoft.network/loadbalancers--DipAvailability Timeline",
                                "formatter": 10,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "microsoft.network/loadbalancers--SnatConnectionCount",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 0,
                                  "options": null
                                }
                              },
                              {
                                "columnMatch": "microsoft.network/loadbalancers--SnatConnectionCount Timeline",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "microsoft.network/loadbalancers--SYNCount",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 0,
                                  "options": null
                                }
                              },
                              {
                                "columnMatch": "microsoft.network/loadbalancers--SYNCount Timeline",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "microsoft.network/loadbalancers--ByteCount",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 0,
                                  "options": null
                                }
                              },
                              {
                                "columnMatch": "microsoft.network/loadbalancers--ByteCount Timeline",
                                "formatter": 5
                              }
                            ],
                            "rowLimit": 10000,
                            "filter": true,
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "Subscription"
                              ],
                              "expandTopLevel": true
                            },
                            "sortBy": [
                              {
                                "itemKey": "$gen_heatmap_microsoft.network/loadbalancers--VipAvailability_3",
                                "sortOrder": 2
                              }
                            ],
                            "labelSettings": [
                              {
                                "columnId": "Subscription",
                                "label": "Subscription"
                              },
                              {
                                "columnId": "Name",
                                "label": "Load Balancer Name"
                              },
                              {
                                "columnId": "microsoft.network/loadbalancers--VipAvailability",
                                "label": "Data Path Availability (Average)"
                              },
                              {
                                "columnId": "microsoft.network/loadbalancers--VipAvailability Timeline",
                                "label": "Data Path Availability (Average) Timeline"
                              },
                              {
                                "columnId": "microsoft.network/loadbalancers--DipAvailability",
                                "label": "Health Probe Status (Average)"
                              },
                              {
                                "columnId": "microsoft.network/loadbalancers--DipAvailability Timeline",
                                "label": "Health Probe Status (Average) Timeline"
                              },
                              {
                                "columnId": "microsoft.network/loadbalancers--SnatConnectionCount",
                                "label": "SNAT Connection Count (Sum)"
                              },
                              {
                                "columnId": "microsoft.network/loadbalancers--SnatConnectionCount Timeline",
                                "label": "SNAT Connection Count (Sum) Timeline"
                              },
                              {
                                "columnId": "microsoft.network/loadbalancers--SYNCount",
                                "label": "SYN Count (Sum)"
                              },
                              {
                                "columnId": "microsoft.network/loadbalancers--SYNCount Timeline",
                                "label": "SYN Count (Sum) Timeline"
                              },
                              {
                                "columnId": "microsoft.network/loadbalancers--ByteCount",
                                "label": "Byte Count (Sum)"
                              },
                              {
                                "columnId": "microsoft.network/loadbalancers--ByteCount Timeline",
                                "label": "Byte Count (Sum) Timeline"
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "$gen_heatmap_microsoft.network/loadbalancers--VipAvailability_3",
                              "sortOrder": 2
                            }
                          ],
                          "showExportToExcel": true
                        },
                        "showPin": false,
                        "name": "Load Balancer Metrics"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "loadbalancer"
                  },
                  "name": "Load Balancer"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "2942e38e-232e-4d89-9ada-12f9863b3c5b",
                              "version": "KqlParameterItem/1.0",
                              "name": "Subscriptions",
                              "type": 6,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "includeAll": true,
                                "showDefault": false
                              },
                              "defaultValue": "value::3"
                            },
                            {
                              "id": "d0f502a4-2f0f-4d3d-af70-5198d41f3e0c",
                              "version": "KqlParameterItem/1.0",
                              "name": "TimeRange",
                              "type": 4,
                              "isRequired": true,
                              "value": {
                                "durationMs": 900000
                              },
                              "typeSettings": {
                                "selectableValues": [
                                  {
                                    "durationMs": 300000,
                                    "createdTime": "2019-02-20T19:49:16.686Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 900000,
                                    "createdTime": "2019-02-20T19:49:16.686Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 1800000,
                                    "createdTime": "2019-02-20T19:49:16.686Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 3600000,
                                    "createdTime": "2019-02-20T19:49:16.686Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 14400000,
                                    "createdTime": "2019-02-20T19:49:16.687Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 43200000,
                                    "createdTime": "2019-02-20T19:49:16.687Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 86400000,
                                    "createdTime": "2019-02-20T19:49:16.687Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 172800000,
                                    "createdTime": "2019-02-20T19:49:16.687Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 259200000,
                                    "createdTime": "2019-02-20T19:49:16.688Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 604800000,
                                    "createdTime": "2019-02-20T19:49:16.688Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 1209600000,
                                    "createdTime": "2019-02-20T19:49:16.688Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 2592000000,
                                    "createdTime": "2019-02-20T19:49:16.688Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 5184000000,
                                    "createdTime": "2019-02-20T19:49:16.688Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 7776000000,
                                    "createdTime": "2019-02-20T19:49:16.688Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  }
                                ],
                                "allowCustom": true
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "name": "parameters - 0"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "VMConnection\r\n| where TimeGenerated {TimeRange}\r\n| summarize Data=sum(BytesReceived + BytesSent ), Sent=sum(BytesSent), Received=sum(BytesReceived) by Computer\r\n| project Computer=strcat('💻 ', Computer), Data, Received, Sent\r\n| sort by Data desc",
                          "size": 3,
                          "title": "Top VMs (Network Traffic)",
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.resources/subscriptions",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Data",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "palette": "blue",
                                  "showIcon": true
                                },
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "Sent",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "palette": "orange",
                                  "showIcon": true
                                },
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "Received",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "palette": "green",
                                  "showIcon": true
                                },
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 9"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "VMConnection\r\n| where TimeGenerated {TimeRange}\r\n| summarize Data=sum(BytesReceived + BytesSent), Received=sum(BytesReceived), Sent=sum(BytesSent), Sessions=dcount(ConnectionId) by RemoteIp, RemoteCountry\r\n| project   RemoteIp=strcat('🌐 ', RemoteIp), Data, Received, Sent, Sessions, RemoteCountry\r\n| sort by Data desc",
                          "size": 3,
                          "title": "Top Destinations (Remote IPs)",
                          "noDataMessage": "No destination traffic found",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.resources/subscriptions",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Data",
                                "formatter": 8,
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "Received",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "green"
                                },
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "Sent",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "orange"
                                },
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "Sessions",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "purple"
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              }
                            ],
                            "rowLimit": 10000,
                            "filter": true,
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "RemoteCountry"
                              ]
                            },
                            "labelSettings": [
                              {
                                "columnId": "RemoteIp",
                                "label": "Remote IP"
                              },
                              {
                                "columnId": "RemoteCountry",
                                "label": "Remote Country"
                              }
                            ]
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 11"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "VMBoundPort\n| where Ip != \"127.0.0.1\"\n| summarize BytesSent=sum(BytesSent), BytesReceived=sum(BytesReceived), LinksEstablished=sum(LinksEstablished), LinksTerminated=sum(LinksTerminated), arg_max(TimeGenerated, LinksLive) by Computer, ProcessName, Ip, Port, IsWildcardBind\n| project-away TimeGenerated\n| order by BytesSent desc",
                          "size": 3,
                          "title": "VM Traffic to Ports",
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.resources/subscriptions",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "BytesSent",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "orange"
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "BytesReceived",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "green"
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "LinksEstablished",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blueDark"
                                }
                              },
                              {
                                "columnMatch": "LinksTerminated",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blueDark"
                                }
                              },
                              {
                                "columnMatch": "LinksLive",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blueDark"
                                }
                              }
                            ],
                            "rowLimit": 10000,
                            "filter": true,
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "Computer"
                              ]
                            },
                            "labelSettings": [
                              {
                                "columnId": "ProcessName",
                                "label": "Process Name"
                              },
                              {
                                "columnId": "Ip",
                                "label": "IP Address"
                              },
                              {
                                "columnId": "IsWildcardBind",
                                "label": "Is  WildCard Bind ?"
                              },
                              {
                                "columnId": "BytesSent",
                                "label": "Bytes Sent"
                              },
                              {
                                "columnId": "BytesReceived",
                                "label": "Bytes Recieved"
                              },
                              {
                                "columnId": "LinksEstablished",
                                "label": "Links Established"
                              },
                              {
                                "columnId": "LinksTerminated",
                                "label": "Links Terminated"
                              },
                              {
                                "columnId": "LinksLive",
                                "label": "Links Live"
                              }
                            ]
                          }
                        },
                        "name": "query - 2"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "vmtraffic"
                  },
                  "name": "VM Traffic"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 11,
                        "content": {
                          "version": "LinkItem/1.0",
                          "style": "paragraph",
                          "links": [
                            {
                              "id": "6fd83c56-0130-451d-a883-8d2ab4e94910",
                              "cellValue": "buttonname",
                              "linkTarget": "parameter",
                              "linkLabel": "Outbound Traffic to All Destination Port's",
                              "subTarget": "Outbound Traffic to All Destination Ports",
                              "preText": "",
                              "style": "primary"
                            },
                            {
                              "id": "57ce2c48-7b3e-4204-809e-0d7e985288e9",
                              "cellValue": "buttonname",
                              "linkTarget": "parameter",
                              "linkLabel": "Inbound Traffic From All Source IP's",
                              "subTarget": "Inbound Traffic From Any IP",
                              "preText": "",
                              "style": "primary"
                            },
                            {
                              "id": "6d587a23-8f5a-4554-9b5d-771719294720",
                              "cellValue": "buttonname",
                              "linkTarget": "parameter",
                              "linkLabel": "Outbound Traffic To All Destinations  IP's",
                              "subTarget": "Outbound Traffic To Any IP",
                              "style": "primary"
                            }
                          ]
                        },
                        "name": "links - 5"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type =~ \"microsoft.network/networksecuritygroups\"\r\n| join kind=leftouter (resourcecontainers | where type =='microsoft.resources/subscriptions' | project SubscriptionName=name, subscriptionId) on subscriptionId\r\n|mv-expand rules=properties.securityRules\r\n|extend direction=tostring(rules.properties.direction)\r\n|extend priority=toint(rules.properties.priority)\r\n|extend rule_name = rules.name\r\n|extend nsg_name = name\r\n|extend description=rules.properties.description\r\n|extend destination_prefix=iif(rules.properties.destinationAddressPrefixes=='[]', rules.properties.destinationAddressPrefix, strcat_array(rules.properties.destinationAddressPrefixes, \",\"))\r\n|extend destination_asgs=iif(isempty(rules.properties.destinationApplicationSecurityGroups), '', strcat_array(parse_json(rules.properties.destinationApplicationSecurityGroups), \",\"))\r\n|extend destination=iif(isempty(destination_asgs), destination_prefix, destination_asgs)\r\n|extend destination=iif(destination=='*', \"Any\", destination)\r\n|extend destination_port=iif(isempty(rules.properties.destinationPortRange), strcat_array(rules.properties.destinationPortRanges,\",\"), rules.properties.destinationPortRange)\r\n|extend source_prefix=iif(rules.properties.sourceAddressPrefixes=='[]', rules.properties.sourceAddressPrefix, strcat_array(rules.properties.sourceAddressPrefixes, \",\"))\r\n|extend source_asgs=iif(isempty(rules.properties.sourceApplicationSecurityGroups), \"\", strcat_array(parse_json(rules.properties.sourceApplicationSecurityGroups), \",\"))\r\n|extend source=iif(isempty(source_asgs), source_prefix, tostring(source_asgs))\r\n|extend source=iif(source=='*', 'Any', source)\r\n|extend source_port=iif(isempty(rules.properties.sourcePortRange), strcat_array(rules.properties.sourcePortRanges,\",\"), rules.properties.sourcePortRange)\r\n|extend action=rules.properties.access\r\n|extend subnets = strcat_array(properties.subnets, \",\")\r\n|where destination_port == \"*\"\r\n| summarize c = count()\r\n| extend Item = \"Outbound Traffic to All Destination Port's\",  Key = 1",
                                "size": 3,
                                "noDataMessageStyle": 5,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Item",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "c",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": true,
                                  "size": "auto"
                                },
                                "mapSettings": {
                                  "locInfo": "LatLong",
                                  "sizeSettings": "Count",
                                  "sizeAggregation": "Sum",
                                  "legendMetric": "Count",
                                  "legendAggregation": "Sum",
                                  "itemColorSettings": {
                                    "type": "heatmap",
                                    "colorAggregation": "Sum",
                                    "nodeColorField": "Count",
                                    "heatmapPalette": "greenRed"
                                  }
                                },
                                "textSettings": {
                                  "style": "bignumber"
                                }
                              },
                              "name": "Traffic to All Destination Ports"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "List of Rules That Allowing Outbound Traffic to All Destination Port's",
                                "style": "warning"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type =~ \"microsoft.network/networksecuritygroups\"\r\n| join kind=leftouter (resourcecontainers | where type =='microsoft.resources/subscriptions' | project SubscriptionName=name, subscriptionId) on subscriptionId\r\n|mv-expand rules=properties.securityRules\r\n|extend direction=tostring(rules.properties.direction)\r\n|extend priority=toint(rules.properties.priority)\r\n|extend rule_name = rules.name\r\n|extend nsg_name = name\r\n|extend description=rules.properties.description\r\n|extend destination_prefix=iif(rules.properties.destinationAddressPrefixes=='[]', rules.properties.destinationAddressPrefix, strcat_array(rules.properties.destinationAddressPrefixes, \",\"))\r\n|extend destination_asgs=iif(isempty(rules.properties.destinationApplicationSecurityGroups), '', strcat_array(parse_json(rules.properties.destinationApplicationSecurityGroups), \",\"))\r\n|extend destination=iif(isempty(destination_asgs), destination_prefix, destination_asgs)\r\n|extend destination=iif(destination=='*', \"Any\", destination)\r\n|extend destination_port=iif(isempty(rules.properties.destinationPortRange), strcat_array(rules.properties.destinationPortRanges,\",\"), rules.properties.destinationPortRange)\r\n|extend source_prefix=iif(rules.properties.sourceAddressPrefixes=='[]', rules.properties.sourceAddressPrefix, strcat_array(rules.properties.sourceAddressPrefixes, \",\"))\r\n|extend source_asgs=iif(isempty(rules.properties.sourceApplicationSecurityGroups), \"\", strcat_array(parse_json(rules.properties.sourceApplicationSecurityGroups), \",\"))\r\n|extend source=iif(isempty(source_asgs), source_prefix, tostring(source_asgs))\r\n|extend source=iif(source=='*', 'Any', source)\r\n|extend source_port=iif(isempty(rules.properties.sourcePortRange), strcat_array(rules.properties.sourcePortRanges,\",\"), rules.properties.sourcePortRange)\r\n|extend action=rules.properties.access\r\n|extend subnets = strcat_array(properties.subnets, \",\")\r\n|where destination_port == \"*\"\r\n|project SubscriptionName, resourceGroup, nsg_name, rule_name, subnets, direction, priority, action, source, source_port, destination, destination_port, description\r\n|sort by SubscriptionName, resourceGroup asc, nsg_name, direction asc, priority asc",
                                "size": 3,
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "filter": true,
                                  "labelSettings": [
                                    {
                                      "columnId": "SubscriptionName",
                                      "label": "Subscription"
                                    },
                                    {
                                      "columnId": "resourceGroup",
                                      "label": "Resource Group"
                                    },
                                    {
                                      "columnId": "nsg_name",
                                      "label": "NSG"
                                    },
                                    {
                                      "columnId": "rule_name",
                                      "label": "Rule"
                                    },
                                    {
                                      "columnId": "subnets",
                                      "label": "Subnet"
                                    },
                                    {
                                      "columnId": "direction",
                                      "label": "Direction"
                                    },
                                    {
                                      "columnId": "priority",
                                      "label": "Priority"
                                    },
                                    {
                                      "columnId": "action",
                                      "label": "Action"
                                    },
                                    {
                                      "columnId": "source",
                                      "label": "Source"
                                    },
                                    {
                                      "columnId": "source_port",
                                      "label": "Source Port"
                                    },
                                    {
                                      "columnId": "destination",
                                      "label": "Destination"
                                    },
                                    {
                                      "columnId": "destination_port",
                                      "label": "Destionation Port"
                                    },
                                    {
                                      "columnId": "description",
                                      "label": "Description"
                                    }
                                  ]
                                }
                              },
                              "name": "List of Rules That Allowing Traffic to All Ports"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "buttonname",
                          "comparison": "isEqualTo",
                          "value": "Outbound Traffic to All Destination Ports"
                        },
                        "name": "Outbound Traffic to All Destination Ports"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type =~ \"microsoft.network/networksecuritygroups\"\r\n| join kind=leftouter (resourcecontainers | where type =='microsoft.resources/subscriptions' | project SubscriptionName=name, subscriptionId) on subscriptionId\r\n|mv-expand rules=properties.securityRules\r\n|extend direction=tostring(rules.properties.direction)\r\n|extend priority=toint(rules.properties.priority)\r\n|extend rule_name = rules.name\r\n|extend nsg_name = name\r\n|extend description=rules.properties.description\r\n|extend destination_prefix=iif(rules.properties.destinationAddressPrefixes=='[]', rules.properties.destinationAddressPrefix, strcat_array(rules.properties.destinationAddressPrefixes, \",\"))\r\n|extend destination_asgs=iif(isempty(rules.properties.destinationApplicationSecurityGroups), '', strcat_array(parse_json(rules.properties.destinationApplicationSecurityGroups), \",\"))\r\n|extend destination=iif(isempty(destination_asgs), destination_prefix, destination_asgs)\r\n|extend destination=iif(destination=='*', \"Any\", destination)\r\n|extend destination_port=iif(isempty(rules.properties.destinationPortRange), strcat_array(rules.properties.destinationPortRanges,\",\"), rules.properties.destinationPortRange)\r\n|extend source_prefix=iif(rules.properties.sourceAddressPrefixes=='[]', rules.properties.sourceAddressPrefix, strcat_array(rules.properties.sourceAddressPrefixes, \",\"))\r\n|extend source_asgs=iif(isempty(rules.properties.sourceApplicationSecurityGroups), \"\", strcat_array(parse_json(rules.properties.sourceApplicationSecurityGroups), \",\"))\r\n|extend source=iif(isempty(source_asgs), source_prefix, tostring(source_asgs))\r\n|extend source=iif(source=='*', 'Any', source)\r\n|extend source_port=iif(isempty(rules.properties.sourcePortRange), strcat_array(rules.properties.sourcePortRanges,\",\"), rules.properties.sourcePortRange)\r\n|extend action=rules.properties.access\r\n|extend subnets = strcat_array(properties.subnets, \",\")\r\n|where source == \"Any\"\r\n|project SubscriptionName, resourceGroup, nsg_name, rule_name, subnets, direction, priority, action, source, source_port, destination, destination_port, description\r\n|sort by SubscriptionName, resourceGroup asc, nsg_name, direction asc, priority asc\r\n| summarize c = count()\r\n| extend Item = \"Inbound Traffic From All Source IP's\",  Key = 1",
                                "size": 4,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Item"
                                  },
                                  "leftContent": {
                                    "columnMatch": "c",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    }
                                  },
                                  "showBorder": true,
                                  "size": "auto"
                                }
                              },
                              "name": "Inbound Traffic from Any IP"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "List of Rules That Allowing Inbound Traffic From All Source IP's",
                                "style": "warning"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type =~ \"microsoft.network/networksecuritygroups\"\r\n| join kind=leftouter (resourcecontainers | where type =='microsoft.resources/subscriptions' | project SubscriptionName=name, subscriptionId) on subscriptionId\r\n|mv-expand rules=properties.securityRules\r\n|extend direction=tostring(rules.properties.direction)\r\n|extend priority=toint(rules.properties.priority)\r\n|extend rule_name = rules.name\r\n|extend nsg_name = name\r\n|extend description=rules.properties.description\r\n|extend destination_prefix=iif(rules.properties.destinationAddressPrefixes=='[]', rules.properties.destinationAddressPrefix, strcat_array(rules.properties.destinationAddressPrefixes, \",\"))\r\n|extend destination_asgs=iif(isempty(rules.properties.destinationApplicationSecurityGroups), '', strcat_array(parse_json(rules.properties.destinationApplicationSecurityGroups), \",\"))\r\n|extend destination=iif(isempty(destination_asgs), destination_prefix, destination_asgs)\r\n|extend destination=iif(destination=='*', \"Any\", destination)\r\n|extend destination_port=iif(isempty(rules.properties.destinationPortRange), strcat_array(rules.properties.destinationPortRanges,\",\"), rules.properties.destinationPortRange)\r\n|extend source_prefix=iif(rules.properties.sourceAddressPrefixes=='[]', rules.properties.sourceAddressPrefix, strcat_array(rules.properties.sourceAddressPrefixes, \",\"))\r\n|extend source_asgs=iif(isempty(rules.properties.sourceApplicationSecurityGroups), \"\", strcat_array(parse_json(rules.properties.sourceApplicationSecurityGroups), \",\"))\r\n|extend source=iif(isempty(source_asgs), source_prefix, tostring(source_asgs))\r\n|extend source=iif(source=='*', 'Any', source)\r\n|extend source_port=iif(isempty(rules.properties.sourcePortRange), strcat_array(rules.properties.sourcePortRanges,\",\"), rules.properties.sourcePortRange)\r\n|extend action=rules.properties.access\r\n|extend subnets = strcat_array(properties.subnets, \",\")\r\n|where source == \"Any\"\r\n|project SubscriptionName, resourceGroup, nsg_name, rule_name, subnets, direction, priority, action, source, source_port, destination, destination_port, description\r\n|sort by SubscriptionName, resourceGroup asc, nsg_name, direction asc, priority asc",
                                "size": 3,
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "labelSettings": [
                                    {
                                      "columnId": "SubscriptionName",
                                      "label": "Subscription"
                                    },
                                    {
                                      "columnId": "resourceGroup",
                                      "label": "Resource Group"
                                    },
                                    {
                                      "columnId": "nsg_name",
                                      "label": "NSG"
                                    },
                                    {
                                      "columnId": "rule_name",
                                      "label": "Rule"
                                    },
                                    {
                                      "columnId": "subnets",
                                      "label": "Subnet"
                                    },
                                    {
                                      "columnId": "direction",
                                      "label": "Direction"
                                    },
                                    {
                                      "columnId": "priority",
                                      "label": "Priority"
                                    },
                                    {
                                      "columnId": "action",
                                      "label": "Action"
                                    },
                                    {
                                      "columnId": "source",
                                      "label": "Source"
                                    },
                                    {
                                      "columnId": "source_port",
                                      "label": "Source Port"
                                    },
                                    {
                                      "columnId": "destination",
                                      "label": "Destinmation"
                                    },
                                    {
                                      "columnId": "destination_port",
                                      "label": "Destinmation Port"
                                    },
                                    {
                                      "columnId": "description",
                                      "label": "Description"
                                    }
                                  ]
                                }
                              },
                              "name": "Inbound Traffic from Any IP"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "buttonname",
                          "comparison": "isEqualTo",
                          "value": "Inbound Traffic From Any IP"
                        },
                        "name": "Inbound Traffic From Any IP"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type =~ \"microsoft.network/networksecuritygroups\"\r\n| join kind=leftouter (resourcecontainers | where type =='microsoft.resources/subscriptions' | project SubscriptionName=name, subscriptionId) on subscriptionId\r\n|mv-expand rules=properties.securityRules\r\n|extend direction=tostring(rules.properties.direction)\r\n|extend priority=toint(rules.properties.priority)\r\n|extend rule_name = rules.name\r\n|extend nsg_name = name\r\n|extend description=rules.properties.description\r\n|extend destination_prefix=iif(rules.properties.destinationAddressPrefixes=='[]', rules.properties.destinationAddressPrefix, strcat_array(rules.properties.destinationAddressPrefixes, \",\"))\r\n|extend destination_asgs=iif(isempty(rules.properties.destinationApplicationSecurityGroups), '', strcat_array(parse_json(rules.properties.destinationApplicationSecurityGroups), \",\"))\r\n|extend destination=iif(isempty(destination_asgs), destination_prefix, destination_asgs)\r\n|extend destination=iif(destination=='*', \"Any\", destination)\r\n|extend destination_port=iif(isempty(rules.properties.destinationPortRange), strcat_array(rules.properties.destinationPortRanges,\",\"), rules.properties.destinationPortRange)\r\n|extend source_prefix=iif(rules.properties.sourceAddressPrefixes=='[]', rules.properties.sourceAddressPrefix, strcat_array(rules.properties.sourceAddressPrefixes, \",\"))\r\n|extend source_asgs=iif(isempty(rules.properties.sourceApplicationSecurityGroups), \"\", strcat_array(parse_json(rules.properties.sourceApplicationSecurityGroups), \",\"))\r\n|extend source=iif(isempty(source_asgs), source_prefix, tostring(source_asgs))\r\n|extend source=iif(source=='*', 'Any', source)\r\n|extend source_port=iif(isempty(rules.properties.sourcePortRange), strcat_array(rules.properties.sourcePortRanges,\",\"), rules.properties.sourcePortRange)\r\n|extend action=rules.properties.access\r\n|extend subnets = strcat_array(properties.subnets, \",\")\r\n|where destination == \"Any\"\r\n| summarize c = count()\r\n| extend Item = \"Rules allowing Outbound Traffic To All Destinations  IP's\",  Key = 1\r\n",
                                "size": 3,
                                "noDataMessageStyle": 5,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Item",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "c",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": true,
                                  "size": "auto"
                                },
                                "mapSettings": {
                                  "locInfo": "LatLong",
                                  "sizeSettings": "Count",
                                  "sizeAggregation": "Sum",
                                  "legendMetric": "Count",
                                  "legendAggregation": "Sum",
                                  "itemColorSettings": {
                                    "type": "heatmap",
                                    "colorAggregation": "Sum",
                                    "nodeColorField": "Count",
                                    "heatmapPalette": "greenRed"
                                  }
                                },
                                "textSettings": {
                                  "style": "bignumber"
                                }
                              },
                              "name": "Count of Rules That Allowing Traffic to Any Destination"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "List of Rules That Allowing Outbound Traffic To All Destinations  IP's",
                                "style": "warning"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type =~ \"microsoft.network/networksecuritygroups\"\r\n| join kind=leftouter (resourcecontainers | where type =='microsoft.resources/subscriptions' | project SubscriptionName=name, subscriptionId) on subscriptionId\r\n|mv-expand rules=properties.securityRules\r\n|extend direction=tostring(rules.properties.direction)\r\n|extend priority=toint(rules.properties.priority)\r\n|extend rule_name = rules.name\r\n|extend nsg_name = name\r\n|extend description=rules.properties.description\r\n|extend destination_prefix=iif(rules.properties.destinationAddressPrefixes=='[]', rules.properties.destinationAddressPrefix, strcat_array(rules.properties.destinationAddressPrefixes, \",\"))\r\n|extend destination_asgs=iif(isempty(rules.properties.destinationApplicationSecurityGroups), '', strcat_array(parse_json(rules.properties.destinationApplicationSecurityGroups), \",\"))\r\n|extend destination=iif(isempty(destination_asgs), destination_prefix, destination_asgs)\r\n|extend destination=iif(destination=='*', \"Any\", destination)\r\n|extend destination_port=iif(isempty(rules.properties.destinationPortRange), strcat_array(rules.properties.destinationPortRanges,\",\"), rules.properties.destinationPortRange)\r\n|extend source_prefix=iif(rules.properties.sourceAddressPrefixes=='[]', rules.properties.sourceAddressPrefix, strcat_array(rules.properties.sourceAddressPrefixes, \",\"))\r\n|extend source_asgs=iif(isempty(rules.properties.sourceApplicationSecurityGroups), \"\", strcat_array(parse_json(rules.properties.sourceApplicationSecurityGroups), \",\"))\r\n|extend source=iif(isempty(source_asgs), source_prefix, tostring(source_asgs))\r\n|extend source=iif(source=='*', 'Any', source)\r\n|extend source_port=iif(isempty(rules.properties.sourcePortRange), strcat_array(rules.properties.sourcePortRanges,\",\"), rules.properties.sourcePortRange)\r\n|extend action=rules.properties.access\r\n|extend subnets = strcat_array(properties.subnets, \",\")\r\n|where destination == \"Any\"\r\n|project SubscriptionName, resourceGroup, nsg_name, rule_name, subnets, direction, priority, action, source, source_port, destination, destination_port, description\r\n|sort by SubscriptionName, resourceGroup asc, nsg_name, direction asc, priority asc",
                                "size": 3,
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "filter": true,
                                  "labelSettings": [
                                    {
                                      "columnId": "SubscriptionName",
                                      "label": "Subscription"
                                    },
                                    {
                                      "columnId": "resourceGroup",
                                      "label": "Resource Group"
                                    },
                                    {
                                      "columnId": "nsg_name",
                                      "label": "NSG"
                                    },
                                    {
                                      "columnId": "rule_name",
                                      "label": "Rule"
                                    },
                                    {
                                      "columnId": "subnets",
                                      "label": "Subnet"
                                    },
                                    {
                                      "columnId": "direction",
                                      "label": "Direction"
                                    },
                                    {
                                      "columnId": "priority",
                                      "label": "Priority"
                                    },
                                    {
                                      "columnId": "action",
                                      "label": "Action"
                                    },
                                    {
                                      "columnId": "source",
                                      "label": "Source"
                                    },
                                    {
                                      "columnId": "source_port",
                                      "label": "Source Port"
                                    },
                                    {
                                      "columnId": "destination",
                                      "label": "Destination"
                                    },
                                    {
                                      "columnId": "destination_port",
                                      "label": "Destination Port"
                                    },
                                    {
                                      "columnId": "description",
                                      "label": "Description"
                                    }
                                  ]
                                }
                              },
                              "name": "List Of Rules That Allowing Traffic to All Destinations"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "buttonname",
                          "comparison": "isEqualTo",
                          "value": "Outbound Traffic To Any IP"
                        },
                        "name": "Rules allowing Traffic to All Destination"
                      }
                    ]
                  },
                  "customWidth": "100",
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "rulereconsiliation"
                  },
                  "name": "Firewall Rule Analysis"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedoption",
              "comparison": "isEqualTo",
              "value": "network"
            },
            "name": "Network Dashboard"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "tabs",
                    "links": [
                      {
                        "id": "d5749b77-230f-45e3-89f5-be4c85ecfa36",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Storage Overview",
                        "subTarget": "storageoverview",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "87a0c257-bc32-4306-aa40-bda93f59511a",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Storage Inventory",
                        "subTarget": "storageinventory",
                        "style": "link"
                      },
                      {
                        "id": "b9611180-11b6-4a06-a7f6-335cbe60661a",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Storage Performance",
                        "subTarget": "storageperformance",
                        "style": "link"
                      },
                      {
                        "id": "7ef3a846-67a4-4458-b430-b19d4d03e181",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Disk Overview",
                        "subTarget": "diskoverview",
                        "style": "link"
                      },
                      {
                        "id": "1041af3d-be55-4fb9-b628-f3f684be1e56",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Key Vault",
                        "subTarget": "keyvault",
                        "style": "link"
                      }
                    ]
                  },
                  "name": "links - 0"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "5e8f8ef7-c57e-4c97-8356-67e34bdd1eb1",
                        "version": "KqlParameterItem/1.0",
                        "name": "Subscription",
                        "type": 6,
                        "isRequired": true,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "value": [
                          "value::3"
                        ],
                        "typeSettings": {
                          "additionalResourceOptions": [
                            "value::1",
                            "value::3",
                            "value::all"
                          ],
                          "includeAll": true,
                          "showDefault": false
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "defaultValue": "value::3"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isNotEqualTo",
                    "value": "keyvault"
                  },
                  "name": "parameters - 5"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type has \"microsoft\"\r\n| extend type = case(\r\n             \r\n              type == 'microsoft.storage/storageaccounts', \"Storage Account\",\r\n               type == 'microsoft.compute/disks', \"Number of Disk\", \r\n                          strcat(\"Not Translated: \", type))\r\n| summarize count() by type\r\n| where type !has \"Not Translated\"",
                                "size": 4,
                                "color": "green",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "type",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "count_",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                }
                              },
                              "name": "query - 4"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "Resources\r\n| where type contains \"microsoft.compute/disks\"\r\n| summarize DiskSizeGB=sum(toint(properties.diskSizeGB))\r\n\r\n| extend Item = \"Total Storage Capacity (in GB)\",  Key = 1\r\n",
                                "size": 3,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Item",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "DiskSizeGB",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false,
                                        "minimumIntegerDigits": 1,
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": false,
                                  "size": "auto"
                                },
                                "graphSettings": {
                                  "type": 0
                                },
                                "mapSettings": {
                                  "locInfo": "LatLong",
                                  "sizeSettings": "count_",
                                  "sizeAggregation": "Sum",
                                  "legendMetric": "count_",
                                  "legendAggregation": "Sum",
                                  "itemColorSettings": {
                                    "type": "heatmap",
                                    "colorAggregation": "Sum",
                                    "nodeColorField": "count_",
                                    "heatmapPalette": "greenRed"
                                  }
                                },
                                "textSettings": {
                                  "style": "bignumber"
                                }
                              },
                              "name": "Total Storage Capacitly"
                            }
                          ]
                        },
                        "customWidth": "35",
                        "name": "Summary -1 "
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "where type =~ \"microsoft.storage/storageaccounts\"\r\n| summarize count() by location\r\n|project Location=['location'], Total=count_",
                                "size": 4,
                                "title": "Storage Account - By  Location",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "piechart",
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "PowerState",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "count_",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                },
                                "textSettings": {
                                  "style": "bignumber"
                                }
                              },
                              "customWidth": "50",
                              "name": "Storage Account - By  Location",
                              "styleSettings": {
                                "margin": "10px"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.storage/storageaccounts\"\r\n| project id, name = tostring(sku.name), tier = tostring(sku.tier)\r\n| summarize count() by name",
                                "size": 4,
                                "title": "Azure Storage Accounts - By SKU",
                                "noDataMessage": "No Storage Account found in selected subscription.",
                                "exportToExcelOptions": "all",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "piechart",
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "PowerState",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "count_",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "query - Storage Account Overview"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": " where type == \"microsoft.storage/storageaccounts\"\r\n | summarize StorageCount=count() by PrimaryStatus=tostring(properties.statusOfPrimary), SecondaryStatus=tostring(properties.statusOfSecondary)\r\n |extend ['Count (Storage accounts)']=StorageCount\r\n | extend SecondaryStatus= iff(strlen(SecondaryStatus) == 0, \"No secondary\", SecondaryStatus)\r\n | project-away StorageCount",
                                "size": 4,
                                "title": "Storage Account  by State",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "PrimaryStatus",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "available",
                                            "representation": "success",
                                            "text": ""
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "No Secondary",
                                            "representation": "4",
                                            "text": ""
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": ""
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "SecondaryStatus",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "available",
                                            "representation": "Available",
                                            "text": ""
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "No secondary",
                                            "representation": "4",
                                            "text": ""
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": ""
                                          }
                                        ]
                                      }
                                    }
                                  ],
                                  "labelSettings": [
                                    {
                                      "columnId": "PrimaryStatus",
                                      "label": "Primary Status"
                                    },
                                    {
                                      "columnId": "SecondaryStatus",
                                      "label": "Secondary Status"
                                    },
                                    {
                                      "columnId": "Count (Storage accounts)",
                                      "label": "Storage Account"
                                    }
                                  ]
                                },
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Count (Storage accounts)",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "PrimaryStatus",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": false
                                },
                                "textSettings": {
                                  "style": "bignumber"
                                }
                              },
                              "name": "Storage Account  by State",
                              "styleSettings": {
                                "margin": "10px"
                              }
                            }
                          ]
                        },
                        "customWidth": "65",
                        "name": "Summary -2"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "storageoverview"
                  },
                  "name": "Storage Overview"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.storage/storageaccounts\"\r\n| mv-expand privatepoint=properties.privateEndpointConnections\r\n| project id,  sku=sku.name, Tier=sku.tier, status= tostring(properties.provisioningState), Create_Time=tostring(properties.creationTime), supportsHttpsTrafficOnly=tostring(properties.supportsHttpsTrafficOnly), allowBlobPublicAccess=tostring(properties.allowBlobPublicAccess),minimumTlsVersion=tostring(properties.minimumTlsVersion), Primary_Region=tostring(properties.primaryLocation), statusOfPrimary=tostring(properties.statusOfPrimary), accessTier=tostring(properties.accessTier) ,Secondary_Available=tostring(properties.secondaryLocation), Secondary_Status=tostring(properties.statusOfSecondary), PrivateEndPoint=privatepoint.name",
                          "size": 3,
                          "title": "Standard Storage Account",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "supportsHttpsTrafficOnly",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "true",
                                      "representation": "1",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "false",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ],
                                  "customColumnWidthSetting": "15ch"
                                }
                              },
                              {
                                "columnMatch": "allowBlobPublicAccess",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "true",
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "false",
                                      "representation": "Resolved",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ],
                                  "customColumnWidthSetting": "15ch"
                                }
                              },
                              {
                                "columnMatch": "minimumTlsVersion",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "TLS1_2",
                                      "representation": "Resolved",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "TLS1_2",
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ],
                                  "customColumnWidthSetting": "15ch"
                                }
                              }
                            ],
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "id",
                                "label": "Name"
                              },
                              {
                                "columnId": "sku",
                                "label": "SKU"
                              },
                              {
                                "columnId": "Create_Time",
                                "label": "Creation TIme"
                              },
                              {
                                "columnId": "supportsHttpsTrafficOnly",
                                "label": "Support HTTPS Traffuc Only"
                              },
                              {
                                "columnId": "allowBlobPublicAccess",
                                "label": "Allow Blob Public Access"
                              },
                              {
                                "columnId": "minimumTlsVersion",
                                "label": "Minimum TLS Version"
                              },
                              {
                                "columnId": "Primary_Region",
                                "label": "Perimary Region"
                              },
                              {
                                "columnId": "statusOfPrimary",
                                "label": "Status of Primary"
                              },
                              {
                                "columnId": "accessTier",
                                "label": "Access Tier"
                              },
                              {
                                "columnId": "Secondary_Available",
                                "label": "Secondary Available"
                              },
                              {
                                "columnId": "Secondary_Status",
                                "label": "Seconday Status"
                              },
                              {
                                "columnId": "PrivateEndPoint",
                                "label": "Private End Point"
                              }
                            ]
                          },
                          "sortBy": []
                        },
                        "name": "Standard Storage Account"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "storageinventory"
                  },
                  "name": "storageinventory"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "parameters": [
                            {
                              "id": "a0373635-ad8d-4770-82bf-a6b6acc47a88",
                              "version": "KqlParameterItem/1.0",
                              "name": "Resources",
                              "label": "Storage accounts",
                              "type": 5,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "where type =~ 'microsoft.storage/storageaccounts'\r\n| order by name asc\r\n| extend Rank = row_number()\r\n| project value = id, label = id, selected = Rank <= 5",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "resourceTypeFilter": {
                                  "microsoft.storage/storageaccounts": true
                                },
                                "additionalResourceOptions": [
                                  "value::5",
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::5",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "id": "34ecbb4e-158f-409d-8074-1c408be01c42",
                              "version": "KqlParameterItem/1.0",
                              "name": "TimeRange",
                              "type": 4,
                              "isRequired": true,
                              "value": {
                                "durationMs": 1800000
                              },
                              "typeSettings": {
                                "selectableValues": [
                                  {
                                    "durationMs": 300000
                                  },
                                  {
                                    "durationMs": 900000
                                  },
                                  {
                                    "durationMs": 1800000
                                  },
                                  {
                                    "durationMs": 3600000
                                  },
                                  {
                                    "durationMs": 14400000
                                  },
                                  {
                                    "durationMs": 43200000
                                  },
                                  {
                                    "durationMs": 86400000
                                  },
                                  {
                                    "durationMs": 172800000
                                  },
                                  {
                                    "durationMs": 259200000
                                  },
                                  {
                                    "durationMs": 604800000
                                  },
                                  {
                                    "durationMs": 1209600000
                                  },
                                  {
                                    "durationMs": 2419200000
                                  },
                                  {
                                    "durationMs": 2592000000
                                  },
                                  {
                                    "durationMs": 5184000000
                                  },
                                  {
                                    "durationMs": 7776000000
                                  }
                                ]
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "bcd653bc-bc9d-49d2-b70d-9d4ed5174f8f",
                              "version": "KqlParameterItem/1.0",
                              "name": "Message",
                              "type": 1,
                              "query": "where type == 'microsoft.storage/storageaccounts' \r\n| summarize Selected = countif(id in ({Resources:value})), Total = count()\r\n| extend Selected = iff(Selected > 200, 200, Selected)\r\n| project Message = strcat('# ', Selected, ' / ', Total)",
                              "crossComponentResources": [
                                "{Subscriptions}"
                              ],
                              "isHiddenWhenLocked": true,
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "id": "16a97aee-d216-46c6-8ebd-5d14acb1fcff",
                              "version": "KqlParameterItem/1.0",
                              "name": "ResourceName",
                              "type": 1,
                              "isRequired": true,
                              "isHiddenWhenLocked": true,
                              "criteriaData": [
                                {
                                  "criteriaContext": {
                                    "operator": "Default",
                                    "resultValType": "static",
                                    "resultVal": "Storage account"
                                  }
                                }
                              ],
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "name": "parameters - Blob Overview"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbookccea5694-99c5-4e38-8b61-011c07d379f3",
                          "version": "MetricsItem/2.0",
                          "size": 3,
                          "chartType": 0,
                          "resourceType": "microsoft.storage/storageaccounts",
                          "metricScope": 0,
                          "resourceParameter": "Resources",
                          "resourceIds": [
                            "{Resources}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 1800000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.storage/storageaccounts",
                              "metric": "microsoft.storage/storageaccounts-Capacity-UsedCapacity",
                              "aggregation": 4
                            },
                            {
                              "namespace": "microsoft.storage/storageaccounts/blobservices",
                              "metric": "microsoft.storage/storageaccounts/blobservices-Capacity-BlobCapacity",
                              "aggregation": 4
                            },
                            {
                              "namespace": "microsoft.storage/storageaccounts/fileservices",
                              "metric": "microsoft.storage/storageaccounts/fileservices-Capacity-FileCapacity",
                              "aggregation": 4
                            },
                            {
                              "namespace": "microsoft.storage/storageaccounts/queueservices",
                              "metric": "microsoft.storage/storageaccounts/queueservices-Capacity-QueueCapacity",
                              "aggregation": 4
                            },
                            {
                              "namespace": "microsoft.storage/storageaccounts/tableservices",
                              "metric": "microsoft.storage/storageaccounts/tableservices-Capacity-TableCapacity",
                              "aggregation": 4
                            }
                          ],
                          "title": "Storage Capacity Overview",
                          "resourceLimit": 10000,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "$gen_group",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "subTarget": "insights",
                                  "linkIsContextBlade": true,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Subscription",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Name",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "linkIsContextBlade": true,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "microsoft.storage/storageaccounts-Capacity-UsedCapacity$|microsoft.storage/storageaccounts/blobservices-Capacity-BlobCapacity$|microsoft.storage/storageaccounts/fileservices-Capacity-FileCapacity$|microsoft.storage/storageaccounts/queueservices-Capacity-QueueCapacity$|microsoft.storage/storageaccounts/tableservices-Capacity-TableCapacity$",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "palette": "blue",
                                  "linkColumn": "Name",
                                  "linkTarget": "WorkbookTemplate",
                                  "workbookContext": {
                                    "componentIdSource": "column",
                                    "componentId": "Name",
                                    "resourceIdsSource": "column",
                                    "resourceIds": "Name",
                                    "templateIdSource": "static",
                                    "templateId": "Community-Workbooks/Individual Storage/Capacity",
                                    "typeSource": "static",
                                    "type": "workbook",
                                    "gallerySource": "static",
                                    "gallery": "microsoft.storage/storageaccounts",
                                    "locationSource": "default"
                                  }
                                },
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 1
                                  }
                                }
                              },
                              {
                                "columnMatch": "microsoft.storage/storageaccounts-Capacity-UsedCapacity Timeline",
                                "formatter": 21,
                                "formatOptions": {
                                  "palette": "blue"
                                },
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "microsoft.storage/storageaccounts/blobservices-Capacity-BlobCapacity",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue",
                                  "workbookContext": {
                                    "componentIdSource": "column",
                                    "componentId": "Name",
                                    "resourceIdsSource": "column",
                                    "resourceIds": "Name",
                                    "templateIdSource": "static",
                                    "templateId": "Community-Workbooks/Individual Storage/Capacity",
                                    "typeSource": "static",
                                    "type": "workbook",
                                    "gallerySource": "static",
                                    "gallery": "microsoft.storage/storageaccounts",
                                    "locationSource": "default"
                                  }
                                },
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "microsoft.storage/storageaccounts/blobservices-Capacity-BlobCapacity Timeline",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "microsoft.storage/storageaccounts/fileservices-Capacity-FileCapacity",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                },
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "microsoft.storage/storageaccounts/fileservices-Capacity-FileCapacity Timeline",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "microsoft.storage/storageaccounts/queueservices-Capacity-QueueCapacity",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                },
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "microsoft.storage/storageaccounts/queueservices-Capacity-QueueCapacity Timeline",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "microsoft.storage/storageaccounts/tableservices-Capacity-TableCapacity",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                },
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "microsoft.storage/storageaccounts/tableservices-Capacity-TableCapacity Timeline",
                                "formatter": 5
                              }
                            ],
                            "rowLimit": 10000,
                            "filter": true,
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "Subscription"
                              ],
                              "expandTopLevel": true
                            },
                            "sortBy": [
                              {
                                "itemKey": "$gen_heatmap_microsoft.storage/storageaccounts-Capacity-UsedCapacity$|microsoft.storage/storageaccounts/blobservices-Capacity-BlobCapacity$|microsoft.storage/storageaccounts/fileservices-Capacity-FileCapacity$|microsoft.storage/storageaccounts/queueservices-Capacity-QueueCapacity$|microsoft.storage/storageaccounts/tableservices-Capacity-TableCapacity$_3",
                                "sortOrder": 1
                              }
                            ],
                            "labelSettings": [
                              {
                                "columnId": "Subscription",
                                "label": "Subscription"
                              },
                              {
                                "columnId": "Name",
                                "label": "Storage Name"
                              },
                              {
                                "columnId": "microsoft.storage/storageaccounts-Capacity-UsedCapacity",
                                "label": "Used capacity (Average)"
                              },
                              {
                                "columnId": "microsoft.storage/storageaccounts-Capacity-UsedCapacity Timeline",
                                "label": "Used capacity Timeline"
                              },
                              {
                                "columnId": "microsoft.storage/storageaccounts/blobservices-Capacity-BlobCapacity",
                                "label": "Blob Capacity (Average)"
                              },
                              {
                                "columnId": "microsoft.storage/storageaccounts/blobservices-Capacity-BlobCapacity Timeline",
                                "label": "Blob Capacity Timeline"
                              },
                              {
                                "columnId": "microsoft.storage/storageaccounts/fileservices-Capacity-FileCapacity",
                                "label": "File Capacity (Average)"
                              },
                              {
                                "columnId": "microsoft.storage/storageaccounts/fileservices-Capacity-FileCapacity Timeline",
                                "label": "File Capacity Timeline"
                              },
                              {
                                "columnId": "microsoft.storage/storageaccounts/queueservices-Capacity-QueueCapacity",
                                "label": "Queue Capacity (Average)"
                              },
                              {
                                "columnId": "microsoft.storage/storageaccounts/queueservices-Capacity-QueueCapacity Timeline",
                                "label": "Queue Capacity Timeline"
                              },
                              {
                                "columnId": "microsoft.storage/storageaccounts/tableservices-Capacity-TableCapacity",
                                "label": "Table Capacity (Average)"
                              },
                              {
                                "columnId": "microsoft.storage/storageaccounts/tableservices-Capacity-TableCapacity Timeline",
                                "label": "Table Capacity Timeline"
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "$gen_heatmap_microsoft.storage/storageaccounts-Capacity-UsedCapacity$|microsoft.storage/storageaccounts/blobservices-Capacity-BlobCapacity$|microsoft.storage/storageaccounts/fileservices-Capacity-FileCapacity$|microsoft.storage/storageaccounts/queueservices-Capacity-QueueCapacity$|microsoft.storage/storageaccounts/tableservices-Capacity-TableCapacity$_3",
                              "sortOrder": 1
                            }
                          ],
                          "showExportToExcel": true,
                          "exportToExcelOptions": "all"
                        },
                        "name": "metric - Storage Capacity Overview"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook14690fcf-55b7-484e-8efd-8df92c6a6446",
                          "version": "MetricsItem/2.0",
                          "size": 3,
                          "chartType": 0,
                          "resourceType": "microsoft.storage/storageaccounts",
                          "metricScope": 0,
                          "resourceParameter": "Resources",
                          "resourceIds": [
                            "{Resources}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 1800000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.storage/storageaccounts",
                              "metric": "microsoft.storage/storageaccounts-Transaction-Transactions",
                              "aggregation": 1
                            },
                            {
                              "namespace": "microsoft.storage/storageaccounts",
                              "metric": "microsoft.storage/storageaccounts-Transaction-SuccessE2ELatency",
                              "aggregation": 4
                            },
                            {
                              "namespace": "microsoft.storage/storageaccounts",
                              "metric": "microsoft.storage/storageaccounts-Transaction-Ingress",
                              "aggregation": 1
                            },
                            {
                              "namespace": "microsoft.storage/storageaccounts",
                              "metric": "microsoft.storage/storageaccounts-Transaction-Egress",
                              "aggregation": 1
                            }
                          ],
                          "title": "Blob Perfomance Metrics",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "$gen_group",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Subscription",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Name",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "linkIsContextBlade": true,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "microsoft.storage/storageaccounts-Transaction-Transactions",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "palette": "blue"
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "microsoft.storage/storageaccounts-Transaction-Transactions Timeline",
                                "formatter": 21,
                                "formatOptions": {
                                  "min": 0,
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "microsoft.storage/storageaccounts-Transaction-SuccessE2ELatency",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "palette": "blue"
                                },
                                "numberFormat": {
                                  "unit": 23,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "microsoft.storage/storageaccounts-Transaction-SuccessE2ELatency Timeline",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "microsoft.storage/storageaccounts-Transaction-Ingress",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "palette": "blue"
                                },
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "microsoft.storage/storageaccounts-Transaction-Ingress Timeline",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "microsoft.storage/storageaccounts-Transaction-Egress",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                },
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "microsoft.storage/storageaccounts-Transaction-Egress Timeline",
                                "formatter": 5
                              }
                            ],
                            "rowLimit": 10000,
                            "filter": true,
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "Subscription"
                              ],
                              "expandTopLevel": true
                            },
                            "sortBy": [
                              {
                                "itemKey": "$gen_heatmap_microsoft.storage/storageaccounts-Transaction-Transactions_3",
                                "sortOrder": 1
                              }
                            ],
                            "labelSettings": [
                              {
                                "columnId": "Subscription",
                                "label": "Subscription"
                              },
                              {
                                "columnId": "Name",
                                "label": "Storage Name"
                              },
                              {
                                "columnId": "microsoft.storage/storageaccounts-Transaction-Transactions",
                                "label": "Transactions (Sum)"
                              },
                              {
                                "columnId": "microsoft.storage/storageaccounts-Transaction-Transactions Timeline",
                                "label": "Transactions Timeline"
                              },
                              {
                                "columnId": "microsoft.storage/storageaccounts-Transaction-SuccessE2ELatency",
                                "label": "Success E2E Latency (Average)"
                              },
                              {
                                "columnId": "microsoft.storage/storageaccounts-Transaction-SuccessE2ELatency Timeline",
                                "label": "Success E2E Latency Timeline"
                              },
                              {
                                "columnId": "microsoft.storage/storageaccounts-Transaction-Ingress",
                                "label": "Ingress (Sum)"
                              },
                              {
                                "columnId": "microsoft.storage/storageaccounts-Transaction-Ingress Timeline",
                                "label": "Ingress Timeline"
                              },
                              {
                                "columnId": "microsoft.storage/storageaccounts-Transaction-Egress",
                                "label": "Egress (Sum)"
                              },
                              {
                                "columnId": "microsoft.storage/storageaccounts-Transaction-Egress Timeline",
                                "label": "Egress Timeline"
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "$gen_heatmap_microsoft.storage/storageaccounts-Transaction-Transactions_3",
                              "sortOrder": 1
                            }
                          ],
                          "showExportToExcel": true
                        },
                        "name": "metric - Overview"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "storageperformance"
                  },
                  "name": "Storage Performance"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "where type == \"microsoft.compute/disks\"\r\n| summarize DiskCount=count() by State=tostring(properties.diskState)\r\n| order by DiskCount desc\r\n| extend [\"Count (Disks)\"]=DiskCount\r\n| project State, [\"Count (Disks)\"]",
                          "size": 3,
                          "title": "Disk By State",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart",
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "PowerState",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "PowerState/running",
                                "color": "green"
                              },
                              {
                                "seriesName": "PowerState/deallocated",
                                "color": "redBright"
                              }
                            ]
                          },
                          "textSettings": {
                            "style": "bignumber"
                          }
                        },
                        "customWidth": "33",
                        "name": "VM Count - By State"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "Resources\r\n| where type contains \"microsoft.compute/disks\"\r\n| summarize DiskSizeGB=sum(toint(properties.diskSizeGB)) by DiskSku=tostring(sku.name), location",
                          "size": 3,
                          "title": "Disk Size & SKU by Location",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "DiskSku",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "DiskSizeGB",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "location"
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "33",
                        "name": "query - 4 - Copy",
                        "styleSettings": {
                          "margin": "2px"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/disks\"\r\n| project id, name = tostring(sku.name), tier = tostring(sku.tier)\r\n| summarize count() by name",
                          "size": 3,
                          "title": "Managed Disk overview",
                          "noDataMessage": "No Azure Managed Disk found in selected subscription.",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "DiskSku",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "DiskSizeGB",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "location"
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "33",
                        "name": "Managed Disk Overview",
                        "styleSettings": {
                          "margin": "0",
                          "padding": "0",
                          "maxWidth": "33%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources \r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n//| mv-expand datadisks = properties.storageProfile.dataDisks\r\n| project id, vmName = name, vmSize=tostring(properties.hardwareProfile.vmSize), osDisk = tostring(properties.storageProfile.osDisk.name), ppg = tostring(split(properties.proximityPlacementGroup.id,\"/\",8)[0]), caching= tostring(properties.storageProfile.osDisk.caching)\r\n, createOption=tostring(properties.storageProfile.osDisk.createOption), osType=tostring(properties.storageProfile.osDisk.osType), avSet= tostring(split(properties.availabilitySet.id,\"/\",8)[0])\r\n| join ( \r\nresources\r\n| where type == \"microsoft.compute/disks\"\r\n| project id1=id, diskname=name, osDisk=tostring(split(id,\"/\",8)[0]), vmName=tostring(split(managedBy,\"/\",8)[0]), sku.name, disk_tier = tostring(properties.tier), disk_size_GB = tostring(properties.diskSizeGB), \r\n diskbandwidthMBps = tostring(properties.diskMBpsReadWrite), disk_iops = tostring(properties.diskIOPSReadWrite),  managedBy, location, resourceGroup\r\n)\r\non vmName, osDisk\r\n| project id, vmName, vmSize, osType, id1, diskname, caching,disk_tier, disk_size_GB,diskbandwidthMBps, disk_iops, createOption, location, resourceGroup , ppg , avSet",
                          "size": 2,
                          "title": "Disk Inventory",
                          "showExportToExcel": true,
                          "exportToExcelOptions": "all",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "id",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "linkIsContextBlade": true,
                                  "showIcon": true,
                                  "customColumnWidthSetting": "18ch"
                                },
                                "tooltipFormat": {
                                  "tooltip": "Virtual Name must be =< 13 Characters"
                                }
                              },
                              {
                                "columnMatch": "vmName",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "vmSize",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "18ch"
                                }
                              },
                              {
                                "columnMatch": "id1",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Metrics",
                                  "linkIsContextBlade": true,
                                  "showIcon": true,
                                  "customColumnWidthSetting": "20ch"
                                }
                              },
                              {
                                "columnMatch": "diskname",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "disk_tier",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "12ch"
                                }
                              },
                              {
                                "columnMatch": "disk_size_GB",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "15ch"
                                }
                              },
                              {
                                "columnMatch": "diskbandwidthMBps",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20ch"
                                }
                              },
                              {
                                "columnMatch": "location",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20ch"
                                }
                              },
                              {
                                "columnMatch": "resourceGroup",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "25ch"
                                }
                              },
                              {
                                "columnMatch": "ppg",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "15ch"
                                }
                              },
                              {
                                "columnMatch": "avSet",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "15ch"
                                }
                              },
                              {
                                "columnMatch": "os_type",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "12ch"
                                }
                              },
                              {
                                "columnMatch": "datadisk_lun",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "14ch"
                                }
                              },
                              {
                                "columnMatch": "datadisk_wa",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "15ch"
                                }
                              },
                              {
                                "columnMatch": "id2",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20ch"
                                }
                              },
                              {
                                "columnMatch": "sku_name",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "10ch"
                                }
                              },
                              {
                                "columnMatch": "powerstate",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20ch"
                                }
                              },
                              {
                                "columnMatch": "vmsize",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20ch"
                                }
                              },
                              {
                                "columnMatch": "vmgen",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "V2",
                                      "representation": "success",
                                      "text": "V2"
                                    },
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "V2",
                                      "representation": "1",
                                      "text": "Consider a review."
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "avZone",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "15ch"
                                }
                              },
                              {
                                "columnMatch": "tags",
                                "formatter": 5
                              }
                            ],
                            "rowLimit": 10000,
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "id",
                                "label": "VM Name"
                              },
                              {
                                "columnId": "vmName",
                                "label": "VM Name"
                              },
                              {
                                "columnId": "vmSize",
                                "label": "Size"
                              },
                              {
                                "columnId": "osType",
                                "label": "OS Type"
                              },
                              {
                                "columnId": "id1",
                                "label": "Disk Name"
                              },
                              {
                                "columnId": "diskname",
                                "label": "Disk Name"
                              },
                              {
                                "columnId": "caching",
                                "label": "Caching"
                              },
                              {
                                "columnId": "disk_tier",
                                "label": "Tier"
                              },
                              {
                                "columnId": "disk_size_GB",
                                "label": "Disk Size"
                              },
                              {
                                "columnId": "diskbandwidthMBps",
                                "label": "Disk Bandwith (Mbps)"
                              },
                              {
                                "columnId": "disk_iops",
                                "label": "IOPS"
                              },
                              {
                                "columnId": "createOption",
                                "label": "Create Option"
                              },
                              {
                                "columnId": "location",
                                "label": "Azure Region"
                              },
                              {
                                "columnId": "resourceGroup",
                                "label": "Resource Group"
                              },
                              {
                                "columnId": "ppg",
                                "label": "PPG"
                              },
                              {
                                "columnId": "avSet",
                                "label": "Availability Set"
                              }
                            ]
                          }
                        },
                        "showPin": false,
                        "name": "query - Compute+OS Disk",
                        "styleSettings": {
                          "showBorder": true
                        }
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "diskoverview"
                  },
                  "name": "Disk Overview"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "parameters": [
                            {
                              "id": "d5d7c033-d737-495b-a84c-bdd7e4e78a08",
                              "version": "KqlParameterItem/1.0",
                              "name": "Subscriptions",
                              "type": 6,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "Resources\r\n| where type =~ 'microsoft.keyvault/vaults'\r\n| summarize by subscriptionId\r\n| union (Resources\r\n| where type =~ 'microsoft.keyvault/vaults'\r\n| summarize Count = count() by subscriptionId\r\n| top 1 by Count desc)\r\n| summarize Count = count() by subscriptionId\r\n| project value = subscriptionId, label = subscriptionId, selected = Count > 1",
                              "crossComponentResources": [
                                "value::selected"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "defaultValue": "value::3",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "id": "3be310b0-14a6-416f-ae3c-0a98fda5c729",
                              "version": "KqlParameterItem/1.0",
                              "name": "ResourceGroups",
                              "label": "Resource groups",
                              "type": 2,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "where type in~('microsoft.keyvault/vaults')\r\n| summarize Count = count() by resourceGroup\r\n| order by Count desc\r\n| extend Rank = row_number()\r\n| project value = resourceGroup, label = resourceGroup, selected = Rank == 1",
                              "crossComponentResources": [
                                "{Subscriptions}"
                              ],
                              "isHiddenWhenLocked": true,
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "selectAllValue": "",
                                "showDefault": false
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "id": "827a53dc-62fe-49ee-88a6-f9f751ed5ab3",
                              "version": "KqlParameterItem/1.0",
                              "name": "Resources",
                              "label": "Key vaults",
                              "type": 5,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "\"",
                              "delimiter": ",",
                              "query": "Resources\r\n| where type =~ 'microsoft.keyvault/vaults' and resourceGroup in~({ResourceGroups}) \r\n| project name, id\r\n| union (Resources\r\n| where type =~ 'microsoft.keyvault/vaults' and resourceGroup in~({ResourceGroups}) \r\n| order by name asc\r\n| take 5\r\n| project id, name)\r\n| summarize Count = count() by id, name\r\n| order by name asc\r\n| project value = id, label = id, selected = Count > 1",
                              "crossComponentResources": [
                                "{Subscriptions}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::5",
                                  "value::all"
                                ],
                                "selectAllValue": "",
                                "showDefault": false
                              },
                              "defaultValue": "value::5",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "id": "65f81355-b707-45be-b7e1-f8450b537da4",
                              "version": "KqlParameterItem/1.0",
                              "name": "TimeRange",
                              "label": "Time Range",
                              "type": 4,
                              "isRequired": true,
                              "value": {
                                "durationMs": 2592000000
                              },
                              "typeSettings": {
                                "selectableValues": [
                                  {
                                    "durationMs": 1800000
                                  },
                                  {
                                    "durationMs": 3600000
                                  },
                                  {
                                    "durationMs": 14400000
                                  },
                                  {
                                    "durationMs": 43200000
                                  },
                                  {
                                    "durationMs": 86400000
                                  },
                                  {
                                    "durationMs": 172800000
                                  },
                                  {
                                    "durationMs": 604800000
                                  },
                                  {
                                    "durationMs": 1209600000
                                  },
                                  {
                                    "durationMs": 2592000000
                                  }
                                ],
                                "allowCustom": true
                              }
                            },
                            {
                              "id": "ed145907-5677-426b-8737-66ac01714250",
                              "version": "KqlParameterItem/1.0",
                              "name": "Message",
                              "type": 1,
                              "query": "where type =~ 'microsoft.keyvault/vaults' and resourceGroup in~({ResourceGroups}) \r\n| summarize Selected = countif(id in ({Resources:value})), Total = count()\r\n| extend Selected = iff(Selected > 200, 200, Selected)\r\n| project Message = strcat('# ', Selected, ' / ', Total)",
                              "crossComponentResources": [
                                "{Subscriptions}"
                              ],
                              "isHiddenWhenLocked": true,
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "TimeRange",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "id": "148a4084-ce64-44cc-9fdc-6b3ab6c00830",
                              "version": "KqlParameterItem/1.0",
                              "name": "ResourceName",
                              "type": 1,
                              "description": "Used in 'No Subscription' workbook template",
                              "isHiddenWhenLocked": true,
                              "criteriaData": [
                                {
                                  "condition": "else result = 'Key vault'",
                                  "criteriaContext": {
                                    "operator": "Default",
                                    "rightValType": "param",
                                    "resultValType": "static",
                                    "resultVal": "Key vault"
                                  }
                                }
                              ]
                            },
                            {
                              "id": "d8328492-f765-4a9e-b3cb-3d0d653f403c",
                              "version": "KqlParameterItem/1.0",
                              "name": "ResourceImageUrl",
                              "type": 1,
                              "description": "Used in 'No Subscription' workbook template",
                              "isHiddenWhenLocked": true
                            }
                          ],
                          "style": "pills",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "name": "KeyVault-Parameters",
                        "styleSettings": {
                          "margin": "15px 0 0 0"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "{Message}\r\n_Key vaults_"
                        },
                        "name": "text - 5",
                        "styleSettings": {
                          "margin": "15px 0 10px 10px"
                        }
                      },
                      {
                        "type": 11,
                        "content": {
                          "version": "LinkItem/1.0",
                          "style": "tabs",
                          "links": [
                            {
                              "id": "3b07f936-c74f-4ff6-ac61-445099d1bc92",
                              "cellValue": "selectedTab",
                              "linkTarget": "parameter",
                              "linkLabel": "Overview",
                              "subTarget": "Overview",
                              "style": "link"
                            },
                            {
                              "id": "a37e1a30-7b16-493f-945f-e90b027134c9",
                              "cellValue": "selectedTab",
                              "linkTarget": "parameter",
                              "linkLabel": "Failures",
                              "subTarget": "Failures",
                              "style": "link"
                            },
                            {
                              "id": "002d53b7-06bd-4502-93ab-34708686afd2",
                              "cellValue": "selectedTab",
                              "linkTarget": "parameter",
                              "linkLabel": "Retention",
                              "subTarget": "Retention",
                              "style": "link"
                            },
                            {
                              "id": "6135fd9a-1d5a-46ec-b719-3037ec0fca48",
                              "cellValue": "selectedTab",
                              "linkTarget": "parameter",
                              "linkLabel": "Users",
                              "subTarget": "Users",
                              "style": "link"
                            },
                            {
                              "id": "57ebedb1-aa41-4adc-9bcf-e6542ea5fca5",
                              "cellValue": "selectedTab",
                              "linkTarget": "parameter",
                              "linkLabel": "Operation",
                              "subTarget": "Operations",
                              "style": "link"
                            },
                            {
                              "id": "2797650f-c521-4c0a-8ab6-2a2a210e5ac4",
                              "cellValue": "selectedTab",
                              "linkTarget": "parameter",
                              "linkLabel": "URI Performance",
                              "subTarget": "UriPerformance",
                              "style": "link"
                            }
                          ]
                        },
                        "name": "links - 3"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 10,
                              "content": {
                                "chartId": "workbook6f5ece70-86e7-4a7e-9a20-72fe3c12eeb4",
                                "version": "MetricsItem/2.0",
                                "size": 3,
                                "chartType": 0,
                                "resourceType": "microsoft.keyvault/vaults",
                                "metricScope": 0,
                                "resourceParameter": "Resources",
                                "resourceIds": [
                                  "{Resources}"
                                ],
                                "timeContextFromParameter": "TimeRange",
                                "timeContext": {
                                  "durationMs": 2592000000
                                },
                                "metrics": [
                                  {
                                    "namespace": "microsoft.keyvault/vaults",
                                    "metric": "microsoft.keyvault/vaults--ServiceApiResult",
                                    "aggregation": 1,
                                    "splitBy": "ActivityName",
                                    "splitBySortOrder": -1,
                                    "splitByLimit": 10,
                                    "columnName": "Api hits"
                                  },
                                  {
                                    "namespace": "microsoft.keyvault/vaults",
                                    "metric": "microsoft.keyvault/vaults--ServiceApiResult",
                                    "aggregation": 1,
                                    "splitBy": "ActivityName",
                                    "splitBySortOrder": -1,
                                    "splitByLimit": 5,
                                    "columnName": "Api hit failures",
                                    "filters": [
                                      {
                                        "key": "StatusCode",
                                        "operator": 1,
                                        "values": [
                                          "200",
                                          "201",
                                          "202",
                                          "206"
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "namespace": "microsoft.keyvault/vaults",
                                    "metric": "microsoft.keyvault/vaults--ServiceApiLatency",
                                    "aggregation": 4,
                                    "splitBy": "ActivityName",
                                    "splitBySortOrder": -1,
                                    "splitByLimit": 5
                                  },
                                  {
                                    "namespace": "microsoft.keyvault/vaults",
                                    "metric": "microsoft.keyvault/vaults--SaturationShoebox",
                                    "aggregation": 4,
                                    "splitBy": "ActivityName",
                                    "splitBySortOrder": 2,
                                    "splitByLimit": 5,
                                    "columnName": "Saturation"
                                  }
                                ],
                                "gridFormatType": 2,
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "$gen_group",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "insights",
                                        "showIcon": true,
                                        "workbookContext": {
                                          "componentIdSource": "cell",
                                          "resourceIdsSource": "workbook",
                                          "templateIdSource": "static",
                                          "templateId": "Community-Workbooks/KeyVault/Overview",
                                          "typeSource": "workbook",
                                          "gallerySource": "workbook",
                                          "locationSource": "default"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "Subscription",
                                      "formatter": 5,
                                      "formatOptions": {}
                                    },
                                    {
                                      "columnMatch": "Name",
                                      "formatter": 5,
                                      "formatOptions": {}
                                    },
                                    {
                                      "columnMatch": "Segment",
                                      "formatter": 5,
                                      "formatOptions": {}
                                    },
                                    {
                                      "columnMatch": "Api hits",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "blue",
                                        "aggregation": "Sum"
                                      },
                                      "numberFormat": {
                                        "unit": 17,
                                        "options": {
                                          "style": "decimal",
                                          "useGrouping": false,
                                          "maximumFractionDigits": 1
                                        },
                                        "emptyValCustomText": "-"
                                      }
                                    },
                                    {
                                      "columnMatch": "Api hits Timeline",
                                      "formatter": 21,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "blue",
                                        "aggregation": "Sum"
                                      }
                                    },
                                    {
                                      "columnMatch": "Api hit failures",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "red",
                                        "aggregation": "Sum"
                                      },
                                      "numberFormat": {
                                        "unit": 17,
                                        "options": {
                                          "style": "decimal",
                                          "maximumFractionDigits": 1
                                        },
                                        "emptyValCustomText": "-"
                                      }
                                    },
                                    {
                                      "columnMatch": "Api hit failures Timeline",
                                      "formatter": 5,
                                      "formatOptions": {}
                                    },
                                    {
                                      "columnMatch": "microsoft.keyvault/vaults--ServiceApiLatency",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "gray",
                                        "aggregation": "Max"
                                      },
                                      "numberFormat": {
                                        "unit": 23,
                                        "options": {
                                          "style": "decimal",
                                          "maximumFractionDigits": 2
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.keyvault/vaults--ServiceApiLatency Timeline",
                                      "formatter": 5,
                                      "formatOptions": {}
                                    },
                                    {
                                      "columnMatch": "Saturation",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "min": 0,
                                        "max": 100,
                                        "palette": "greenRed",
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": ">",
                                            "thresholdValue": "75",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "is Empty",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          }
                                        ],
                                        "aggregation": "Average"
                                      },
                                      "numberFormat": {
                                        "unit": 1,
                                        "options": {
                                          "style": "decimal",
                                          "useGrouping": false,
                                          "maximumFractionDigits": 1
                                        },
                                        "emptyValCustomText": "0%"
                                      }
                                    },
                                    {
                                      "columnMatch": "Saturation Timeline",
                                      "formatter": 5,
                                      "formatOptions": {}
                                    },
                                    {
                                      "columnMatch": ".*\\/Total Service Api Hits$",
                                      "formatter": 1,
                                      "formatOptions": {}
                                    },
                                    {
                                      "columnMatch": "microsoft.keyvault/vaults--ServiceApiResult Timeline",
                                      "formatter": 5,
                                      "formatOptions": {}
                                    },
                                    {
                                      "columnMatch": "microsoft.keyvault/vaults--ServiceApiResult",
                                      "formatter": 1,
                                      "formatOptions": {},
                                      "numberFormat": {
                                        "unit": 0,
                                        "options": {
                                          "style": "decimal",
                                          "useGrouping": false
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "More Details",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "WorkbookTemplate",
                                        "workbookContext": null
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000,
                                  "filter": true,
                                  "hierarchySettings": {
                                    "treeType": 1,
                                    "groupBy": [
                                      "Subscription",
                                      "Name"
                                    ],
                                    "expandTopLevel": true,
                                    "finalBy": "Segment"
                                  },
                                  "sortBy": [
                                    {
                                      "itemKey": "$gen_heatmap_Api hit failures_6",
                                      "sortOrder": 2
                                    }
                                  ],
                                  "labelSettings": [
                                    {
                                      "columnId": "Subscription",
                                      "label": "Subscription"
                                    },
                                    {
                                      "columnId": "Name",
                                      "label": "Storage Name"
                                    },
                                    {
                                      "columnId": "Api hits",
                                      "label": "Requests"
                                    },
                                    {
                                      "columnId": "Api hits Timeline",
                                      "label": "Requests timeline"
                                    },
                                    {
                                      "columnId": "Api hit failures",
                                      "label": "Request failures"
                                    },
                                    {
                                      "columnId": "Api hit failures Timeline",
                                      "label": "Api hit failures Timeline"
                                    },
                                    {
                                      "columnId": "microsoft.keyvault/vaults--ServiceApiLatency",
                                      "label": "Average latency (worst rolled up)"
                                    },
                                    {
                                      "columnId": "microsoft.keyvault/vaults--ServiceApiLatency Timeline",
                                      "label": "Overall Service Api Latency (Average) Timeline"
                                    },
                                    {
                                      "columnId": "Saturation",
                                      "label": "Saturation"
                                    },
                                    {
                                      "columnId": "Saturation Timeline",
                                      "label": "Saturation Timeline"
                                    }
                                  ]
                                },
                                "sortBy": [
                                  {
                                    "itemKey": "$gen_heatmap_Api hit failures_6",
                                    "sortOrder": 2
                                  }
                                ],
                                "exportedParameters": [
                                  {
                                    "fieldName": "Name",
                                    "parameterName": "Vault",
                                    "parameterType": 5,
                                    "defaultValue": ""
                                  }
                                ],
                                "showExportToExcel": true
                              },
                              "conditionalVisibility": {
                                "parameterName": "selectedTab",
                                "comparison": "isEqualTo",
                                "value": "Overview"
                              },
                              "showPin": false,
                              "name": "Key vault overview metrics"
                            },
                            {
                              "type": 10,
                              "content": {
                                "chartId": "workbookaf596582-a211-4fb6-b8f4-2f6521cc554f",
                                "version": "MetricsItem/2.0",
                                "size": 3,
                                "chartType": 0,
                                "resourceType": "microsoft.keyvault/vaults",
                                "metricScope": 0,
                                "resourceParameter": "Resources",
                                "resourceIds": [
                                  "{Resources}"
                                ],
                                "timeContextFromParameter": "TimeRange",
                                "timeContext": {
                                  "durationMs": 2592000000
                                },
                                "metrics": [
                                  {
                                    "namespace": "microsoft.keyvault/vaults",
                                    "metric": "microsoft.keyvault/vaults--ServiceApiHit",
                                    "aggregation": 1
                                  },
                                  {
                                    "namespace": "microsoft.keyvault/vaults",
                                    "metric": "microsoft.keyvault/vaults--ServiceApiResult",
                                    "aggregation": 1,
                                    "columnName": "Successes",
                                    "filters": [
                                      {
                                        "key": "StatusCodeClass",
                                        "operator": 0,
                                        "values": [
                                          "2xx"
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "namespace": "microsoft.keyvault/vaults",
                                    "metric": "microsoft.keyvault/vaults--ServiceApiResult",
                                    "aggregation": 1,
                                    "columnName": "Authentication",
                                    "filters": [
                                      {
                                        "key": "StatusCode",
                                        "operator": 0,
                                        "values": [
                                          "401"
                                        ]
                                      },
                                      {
                                        "key": "StatusCode",
                                        "operator": 0,
                                        "values": [
                                          "403"
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "namespace": "microsoft.keyvault/vaults",
                                    "metric": "microsoft.keyvault/vaults--ServiceApiResult",
                                    "aggregation": 1,
                                    "columnName": "Throttling",
                                    "filters": [
                                      {
                                        "key": "StatusCode",
                                        "operator": 0,
                                        "values": [
                                          "429"
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "namespace": "microsoft.keyvault/vaults",
                                    "metric": "microsoft.keyvault/vaults--ServiceApiResult",
                                    "aggregation": 1,
                                    "columnName": "Failures",
                                    "filters": [
                                      {
                                        "key": "StatusCodeClass",
                                        "operator": 1,
                                        "values": [
                                          "2xx"
                                        ]
                                      },
                                      {
                                        "key": "StatusCode",
                                        "operator": 1,
                                        "values": [
                                          "401",
                                          "403",
                                          "429"
                                        ]
                                      }
                                    ]
                                  }
                                ],
                                "showExpandCollapseGrid": true,
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "$gen_group",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "insights",
                                        "showIcon": true,
                                        "workbookContext": {
                                          "componentIdSource": "cell",
                                          "resourceIdsSource": "workbook",
                                          "templateIdSource": "static",
                                          "templateId": "Community-Workbooks/KeyVault/Overview",
                                          "typeSource": "workbook",
                                          "gallerySource": "workbook",
                                          "locationSource": "default"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "Subscription",
                                      "formatter": 5,
                                      "formatOptions": {}
                                    },
                                    {
                                      "columnMatch": "Name",
                                      "formatter": 5,
                                      "formatOptions": {}
                                    },
                                    {
                                      "columnMatch": "microsoft.keyvault/vaults--ServiceApiHit",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "blue",
                                        "aggregation": "Sum"
                                      },
                                      "numberFormat": {
                                        "unit": 17,
                                        "options": {
                                          "style": "decimal",
                                          "useGrouping": false,
                                          "maximumFractionDigits": 1
                                        },
                                        "emptyValCustomText": "-"
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.keyvault/vaults--ServiceApiHit Timeline",
                                      "formatter": 21,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "blue",
                                        "aggregation": "Sum"
                                      }
                                    },
                                    {
                                      "columnMatch": "Successes",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "green",
                                        "aggregation": "Sum"
                                      },
                                      "numberFormat": {
                                        "unit": 0,
                                        "options": {
                                          "style": "decimal",
                                          "useGrouping": false,
                                          "maximumFractionDigits": 1
                                        },
                                        "emptyValCustomText": "-"
                                      }
                                    },
                                    {
                                      "columnMatch": "Successes Timeline",
                                      "formatter": 5,
                                      "formatOptions": {}
                                    },
                                    {
                                      "columnMatch": "Authentication",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "gray",
                                        "aggregation": "Sum"
                                      },
                                      "numberFormat": {
                                        "unit": 17,
                                        "options": {
                                          "style": "decimal",
                                          "useGrouping": false,
                                          "maximumFractionDigits": 1
                                        },
                                        "emptyValCustomText": "-"
                                      }
                                    },
                                    {
                                      "columnMatch": "Authentication Timeline",
                                      "formatter": 5,
                                      "formatOptions": {}
                                    },
                                    {
                                      "columnMatch": "Throttling",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "redBright",
                                        "aggregation": "Sum"
                                      },
                                      "numberFormat": {
                                        "unit": 0,
                                        "options": {
                                          "style": "decimal",
                                          "useGrouping": false,
                                          "maximumFractionDigits": 1
                                        },
                                        "emptyValCustomText": "-"
                                      }
                                    },
                                    {
                                      "columnMatch": "Throttling Timeline",
                                      "formatter": 5,
                                      "formatOptions": {}
                                    },
                                    {
                                      "columnMatch": "Failures",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "redDark",
                                        "aggregation": "Sum"
                                      },
                                      "numberFormat": {
                                        "unit": 17,
                                        "options": {
                                          "style": "decimal",
                                          "maximumFractionDigits": 1
                                        },
                                        "emptyValCustomText": "-"
                                      }
                                    },
                                    {
                                      "columnMatch": "Failures Timeline",
                                      "formatter": 5,
                                      "formatOptions": {}
                                    },
                                    {
                                      "columnMatch": "Authentication Error",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "gray",
                                        "aggregation": "Sum"
                                      },
                                      "numberFormat": {
                                        "unit": 17,
                                        "options": {
                                          "style": "decimal",
                                          "maximumSignificantDigits": 2
                                        },
                                        "emptyValCustomText": "-"
                                      }
                                    },
                                    {
                                      "columnMatch": "response",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "green",
                                        "aggregation": "Sum"
                                      },
                                      "numberFormat": {
                                        "unit": 17,
                                        "options": {
                                          "style": "decimal",
                                          "maximumSignificantDigits": 2
                                        },
                                        "emptyValCustomText": "-"
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.keyvault/vaults--ServiceApiResult",
                                      "formatter": 1,
                                      "formatOptions": {},
                                      "numberFormat": {
                                        "unit": 0,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000,
                                  "filter": true,
                                  "hierarchySettings": {
                                    "treeType": 1,
                                    "groupBy": [
                                      "Subscription"
                                    ],
                                    "expandTopLevel": true,
                                    "finalBy": "Name"
                                  },
                                  "sortBy": [
                                    {
                                      "itemKey": "$gen_heatmap_microsoft.keyvault/vaults--ServiceApiHit_3",
                                      "sortOrder": 2
                                    }
                                  ],
                                  "labelSettings": [
                                    {
                                      "columnId": "Subscription",
                                      "label": "Subscription"
                                    },
                                    {
                                      "columnId": "Name",
                                      "label": "Storage Name"
                                    },
                                    {
                                      "columnId": "microsoft.keyvault/vaults--ServiceApiHit",
                                      "label": "Total Service Api Hits (Sum)"
                                    },
                                    {
                                      "columnId": "microsoft.keyvault/vaults--ServiceApiHit Timeline",
                                      "label": "Total Service Api Hits Timeline"
                                    },
                                    {
                                      "columnId": "Successes",
                                      "label": "Successes"
                                    },
                                    {
                                      "columnId": "Successes Timeline",
                                      "label": "Successes Timeline"
                                    },
                                    {
                                      "columnId": "Authentication",
                                      "label": "Authentication Errors"
                                    },
                                    {
                                      "columnId": "Authentication Timeline",
                                      "label": "Authentication Timeline"
                                    },
                                    {
                                      "columnId": "Throttling",
                                      "label": "Throttling"
                                    },
                                    {
                                      "columnId": "Throttling Timeline",
                                      "label": "Throttling Timeline"
                                    },
                                    {
                                      "columnId": "Failures",
                                      "label": "Other Failures"
                                    },
                                    {
                                      "columnId": "Failures Timeline",
                                      "label": "Failures Timeline"
                                    }
                                  ]
                                },
                                "sortBy": [
                                  {
                                    "itemKey": "$gen_heatmap_microsoft.keyvault/vaults--ServiceApiHit_3",
                                    "sortOrder": 2
                                  }
                                ],
                                "exportedParameters": [
                                  {
                                    "fieldName": "Name",
                                    "parameterName": "Vault",
                                    "parameterType": 5
                                  }
                                ],
                                "showExportToExcel": true
                              },
                              "conditionalVisibility": {
                                "parameterName": "selectedTab",
                                "comparison": "isEqualTo",
                                "value": "Failures"
                              },
                              "showPin": false,
                              "name": "metric - 18"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.keyvault/vaults\"\r\n| project id,  enableSoftDelete = tostring(properties.enableSoftDelete), softDeleteRetentionInDays=tostring(properties.softDeleteRetentionInDays)",
                                "size": 3,
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "enableSoftDelete",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "true",
                                            "representation": "Resolved",
                                            "text": "Enabled"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "Sev2",
                                            "text": "Not Enabled"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "softDeleteRetentionInDays",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": ">=",
                                            "thresholdValue": "7",
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "is Empty",
                                            "representation": "Sev2",
                                            "text": "{0}Not Applicable"
                                          },
                                          {
                                            "operator": "<",
                                            "thresholdValue": "7",
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "1",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    }
                                  ],
                                  "filter": true,
                                  "sortBy": [
                                    {
                                      "itemKey": "$gen_link_id_0",
                                      "sortOrder": 1
                                    }
                                  ],
                                  "labelSettings": [
                                    {
                                      "columnId": "id",
                                      "label": "Storage Account"
                                    },
                                    {
                                      "columnId": "enableSoftDelete",
                                      "label": "Soft Delete"
                                    },
                                    {
                                      "columnId": "softDeleteRetentionInDays",
                                      "label": "Soft Delete Retention Days"
                                    }
                                  ]
                                },
                                "sortBy": [
                                  {
                                    "itemKey": "$gen_link_id_0",
                                    "sortOrder": 1
                                  }
                                ]
                              },
                              "conditionalVisibility": {
                                "parameterName": "selectedTab",
                                "comparison": "isEqualTo",
                                "value": "Retention"
                              },
                              "name": "query - 0"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "// Who is calling this KeyVault? \r\n// List of callers identified by their IP address with their request count.  \r\n// KeyVault diagnostic currently stores logs in AzureDiagnostics table which stores logs for multiple services. \r\n// Filter on ResourceProvider for logs specific to a service.\r\nAzureDiagnostics\r\n| where ResourceProvider ==\"MICROSOFT.KEYVAULT\"\r\n| summarize count() by CallerIPAddress",
                                "size": 3,
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/subscriptions",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "CallerIPAddress",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "count_",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": true,
                                  "size": "auto"
                                }
                              },
                              "conditionalVisibility": {
                                "parameterName": "selectedTab",
                                "comparison": "isEqualTo",
                                "value": "Users"
                              },
                              "name": "Who is acccessing Your Keyvault"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "// How active has this KeyVault been? \r\n// Line chart showing trend of KeyVault requests volume, per operation over time. \r\n// KeyVault diagnostic currently stores logs in AzureDiagnostics table which stores logs for multiple services. \r\n// Filter on ResourceProvider for logs specific to a service.\r\nAzureDiagnostics\r\n| where ResourceProvider ==\"MICROSOFT.KEYVAULT\" \r\n| summarize count() by  OperationName // Aggregate by hour\r\n| render timechart",
                                "size": 3,
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.resources/subscriptions",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "OperationName",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "count_",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  },
                                  "showBorder": true,
                                  "size": "auto"
                                }
                              },
                              "conditionalVisibility": {
                                "parameterName": "selectedTab",
                                "comparison": "isEqualTo",
                                "value": "Operations"
                              },
                              "name": "Key Vault Operations"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "// How fast is this KeyVault serving requests? \r\n// Line chart showing trend of request duration over time using different aggregations.  \r\nAzureDiagnostics\r\n| where ResourceProvider ==\"MICROSOFT.KEYVAULT\" \r\n| summarize avg(DurationMs) by requestUri_s // requestUri_s contains the URI of the request\r\n",
                                "size": 3,
                                "timeContext": {
                                  "durationMs": 86400000
                                },
                                "queryType": 0,
                                "resourceType": "microsoft.resources/subscriptions",
                                "crossComponentResources": [
                                  "{Resources}"
                                ],
                                "visualization": "tiles",
                                "gridSettings": {
                                  "labelSettings": [
                                    {
                                      "columnId": "requestUri_s",
                                      "label": "Key Vault URI"
                                    },
                                    {
                                      "columnId": "avg_DurationMs",
                                      "label": "Response in Mili Second"
                                    }
                                  ]
                                },
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "requestUri_s",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "avg_DurationMs",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  },
                                  "showBorder": true,
                                  "size": "full"
                                },
                                "graphSettings": {
                                  "type": 0,
                                  "topContent": {
                                    "columnMatch": "requestUri_s",
                                    "formatter": 1
                                  },
                                  "centerContent": {
                                    "columnMatch": "avg_DurationMs",
                                    "formatter": 1,
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                }
                              },
                              "conditionalVisibility": {
                                "parameterName": "selectedTab",
                                "comparison": "isEqualTo",
                                "value": "UriPerformance"
                              },
                              "name": "Key Vault URI Performance (ms)"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "Subscriptions",
                          "comparison": "isNotEqualTo",
                          "value": ""
                        },
                        "name": "Key Vault Resources"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "keyvault"
                  },
                  "name": "Key Vault "
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedoption",
              "comparison": "isEqualTo",
              "value": "storage"
            },
            "name": "Storage Dashboard"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "tabs",
                    "links": [
                      {
                        "id": "d5749b77-230f-45e3-89f5-be4c85ecfa36",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Overview",
                        "subTarget": "overview",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "d2568e3f-dddc-47d7-8bb1-afcbc94c0f97",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Inventory",
                        "subTarget": "inventory",
                        "style": "link"
                      },
                      {
                        "id": "acbbb580-1e5c-48e2-9ca3-dce39006771a",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Performance",
                        "subTarget": "performance",
                        "style": "link"
                      },
                      {
                        "id": "b63eb151-8b32-4397-9cf9-3615ecce83f6",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "DB without Hybrid Benifit",
                        "subTarget": "dbwithouthybridbenifit",
                        "style": "link"
                      }
                    ]
                  },
                  "name": "links - 0"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "5e8f8ef7-c57e-4c97-8356-67e34bdd1eb1",
                        "version": "KqlParameterItem/1.0",
                        "name": "Subscription",
                        "type": 6,
                        "isRequired": true,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "typeSettings": {
                          "additionalResourceOptions": [
                            "value::1",
                            "value::3",
                            "value::all"
                          ],
                          "includeAll": true,
                          "showDefault": false
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "defaultValue": "value::3"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isNotEqualTo",
                    "value": "dbwithouthybridbenifit"
                  },
                  "name": "parameters - 5"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type =~ 'microsoft.documentdb/databaseaccounts'\r\n        or type =~ 'microsoft.sql/servers/databases'\r\n        or type =~ 'microsoft.dbformysql/servers'\r\n        or type =~ 'microsoft.sql/servers'\r\n        or type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines'\r\n| extend type = case(\r\n              type =~ 'microsoft.documentdb/databaseaccounts', 'CosmosDB',\r\n              type =~ 'microsoft.sql/servers/databases', 'SQL DBs',\r\n              type =~ 'microsoft.dbformysql/servers', 'MySQL',\r\n              type =~ 'microsoft.sql/servers', 'SQL Servers',\r\n              type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines', 'SQL Virtual Machines',\r\n              \r\n              strcat(\"Not Translated: \", type))\r\n| where type !has \"Not Translated\"\r\n| summarize count() by type",
                          "size": 3,
                          "title": "Type Wise Database",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart"
                        },
                        "customWidth": "33",
                        "name": "query - 1"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "where type == \"microsoft.sql/servers/databases\"\r\n| extend GB = todouble(properties.maxSizeBytes) / (1024 * 1024 * 1024)\r\n| summarize DBCount=count() by GB\r\n| order by GB desc\r\n|extend ['Count (SQL Databases)']=DBCount\r\n| project GB=strcat(tostring(GB), \" GB\"), ['Count (SQL Databases)']",
                          "size": 3,
                          "title": "SQL DB by Max Size",
                          "noDataMessage": "No SQL DB In Account",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart",
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "GB",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count (SQL Databases)",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "33",
                        "name": "query - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "where type == \"microsoft.sql/servers/databases\"\r\n| summarize DBCount=count() by Tier=tostring(properties.currentSku.tier)\r\n| order by DBCount desc\r\n|extend ['Count (SQL Databases)']=DBCount\r\n| project Tier, ['Count (SQL Databases)']",
                          "size": 3,
                          "title": "SQL DB By Tier",
                          "noDataMessage": "No SQL DB in Account",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart"
                        },
                        "customWidth": "33",
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "overview"
                  },
                  "name": "Overview"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type =~ \"microsoft.sql/servers/databases\"\r\n| where kind notcontains \"system\"\r\n| extend sku_name = sku.name\r\n| extend sql_server = split(id,\"/\")[8]\r\n| project name,  sku_name, sql_server, kind, location, resourceGroup, subscriptionId\r\n",
                          "size": 4,
                          "title": "SQL PaaS Database",
                          "showExportToExcel": true,
                          "exportToExcelOptions": "all",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "name": "SQL DB"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type =~ 'microsoft.documentdb/databaseaccounts'\r\n         or type =~ 'microsoft.sql/servers/databases'\r\n         or type =~ 'microsoft.dbformysql/servers'\r\n         or type =~ 'microsoft.sql/servers'\r\n         or type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines'\r\n\r\n| extend type = case(\r\n             type =~ 'microsoft.documentdb/databaseaccounts', 'CosmosDB',\r\n             type =~ 'microsoft.sql/servers/databases', 'SQL DBs',\r\n             type =~ 'microsoft.dbformysql/servers', 'MySQL',\r\n             type =~ 'microsoft.sql/servers', 'SQL Servers',\r\n            type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines', 'SQL Virtual Machines',\r\n             strcat(\"Not Translated: \", type))\r\n| extend Sku = case(\r\n             type =~ 'CosmosDB', properties.databaseAccountOfferType,\r\n             type =~ 'SQL DBs', sku.name,\r\n             type =~ 'MySQL', sku.name,\r\n           \r\n             ' ')\r\n| extend Status = case(\r\n             type =~ 'CosmosDB', properties.provisioningState,\r\n             type =~ 'SQL DBs', properties.status,\r\n             type =~ 'MySQL', properties.userVisibleState,\r\n             ' ')\r\n| extend Endpoint = case(\r\n             type =~ 'MySQL', properties.fullyQualifiedDomainName,\r\n             type =~ 'SQL Servers', properties.fullyQualifiedDomainName,\r\n             type =~ 'CosmosDB', properties.documentEndpoint,\r\n             ' ')\r\n| extend maxSizeGB = todouble(case(\r\n             type =~ 'SQL DBs', properties.maxSizeBytes,\r\n             type =~ 'MySQL', properties.storageProfile.storageMB,\r\n             ' '))\r\n| extend maxSizeGB = iif(type has 'SQL DBs', maxSizeGB /1000 /1000, maxSizeGB)\r\n| extend Details = pack_all()\r\n| project Resource=id, resourceGroup, subscriptionId, type, Sku, Status, Endpoint, maxSizeGB",
                          "size": 3,
                          "title": "Database Inventory",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "filter": true,
                            "sortBy": [
                              {
                                "itemKey": "Status",
                                "sortOrder": 1
                              }
                            ],
                            "labelSettings": [
                              {
                                "columnId": "Resource",
                                "label": "Resource"
                              },
                              {
                                "columnId": "resourceGroup",
                                "label": "Resorce Group"
                              },
                              {
                                "columnId": "subscriptionId",
                                "label": "Subscription ID"
                              },
                              {
                                "columnId": "type",
                                "label": "Type"
                              },
                              {
                                "columnId": "Sku",
                                "label": "SKU"
                              },
                              {
                                "columnId": "Status",
                                "label": "Status"
                              },
                              {
                                "columnId": "Endpoint",
                                "label": "End Point"
                              },
                              {
                                "columnId": "maxSizeGB",
                                "label": "Max Size GB"
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "Status",
                              "sortOrder": 1
                            }
                          ]
                        },
                        "name": "query - 7"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "inventory"
                  },
                  "name": "Data Base List"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "parameters": [
                            {
                              "id": "5e8f8ef7-c57e-4c97-8356-67e34bdd1eb1",
                              "version": "KqlParameterItem/1.0",
                              "name": "Database",
                              "type": 5,
                              "isRequired": true,
                              "query": "Resources\r\n| where type =~ 'microsoft.sql/servers/databases'\r\n  or type =~ 'microsoft.sql/servers/databases'\r\n    | project databaseId = id, databaseName = name, elasticPoolId = tolower(tostring(properties.elasticPoolId))\r\n| join kind=leftouter (\r\n\tResources\r\n\t| where type =~ 'microsoft.sql/servers/elasticpools'\r\n\t| project elasticPoolId = tolower(id), elasticPoolName = name, elasticPoolState = properties.state)\r\n\ton elasticPoolId\r\n| project-away elasticPoolId1",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::1",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "id": "dc5810c5-94fa-48b3-92ae-c550fcd6e5ec",
                              "version": "KqlParameterItem/1.0",
                              "name": "TimeRange",
                              "label": "Time Range",
                              "type": 4,
                              "isRequired": true,
                              "value": {
                                "durationMs": 7776000000
                              },
                              "typeSettings": {
                                "selectableValues": [
                                  {
                                    "durationMs": 300000
                                  },
                                  {
                                    "durationMs": 900000
                                  },
                                  {
                                    "durationMs": 1800000
                                  },
                                  {
                                    "durationMs": 3600000
                                  },
                                  {
                                    "durationMs": 14400000
                                  },
                                  {
                                    "durationMs": 43200000
                                  },
                                  {
                                    "durationMs": 86400000
                                  },
                                  {
                                    "durationMs": 172800000
                                  },
                                  {
                                    "durationMs": 259200000
                                  },
                                  {
                                    "durationMs": 604800000
                                  },
                                  {
                                    "durationMs": 1209600000
                                  },
                                  {
                                    "durationMs": 2419200000
                                  },
                                  {
                                    "durationMs": 2592000000
                                  },
                                  {
                                    "durationMs": 5184000000
                                  },
                                  {
                                    "durationMs": 7776000000
                                  }
                                ]
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "name": "parameters - 5"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook4cd53e9f-58a2-475b-9f3e-b33b9a57b6a3",
                          "version": "MetricsItem/2.0",
                          "size": 1,
                          "chartType": 2,
                          "resourceType": "microsoft.sql/servers/databases",
                          "metricScope": 0,
                          "resourceParameter": "Database",
                          "resourceIds": [
                            "{Database}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 7776000000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.sql/servers/databases",
                              "metric": "microsoft.sql/servers/databases-Basic-cpu_percent",
                              "aggregation": 4,
                              "splitBy": null
                            }
                          ],
                          "title": "CPU Utilization",
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "25",
                        "name": "metric - 2"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook4cd53e9f-58a2-475b-9f3e-b33b9a57b6a3",
                          "version": "MetricsItem/2.0",
                          "size": 1,
                          "chartType": 2,
                          "resourceType": "microsoft.sql/servers/databases",
                          "metricScope": 0,
                          "resourceParameter": "Database",
                          "resourceIds": [
                            "{Database}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 7776000000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.sql/servers/databases",
                              "metric": "microsoft.sql/servers/databases-Basic-connection_failed",
                              "aggregation": 7,
                              "splitBy": null
                            }
                          ],
                          "title": "Failed Connection",
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "25",
                        "name": "metric - 2 - Copy"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook0826ffa7-d944-466f-89bc-663f87ac227f",
                          "version": "MetricsItem/2.0",
                          "size": 1,
                          "chartType": 2,
                          "resourceType": "microsoft.sql/servers/databases",
                          "metricScope": 0,
                          "resourceParameter": "Database",
                          "resourceIds": [
                            "{Database}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 7776000000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.sql/servers/databases",
                              "metric": "microsoft.sql/servers/databases-Basic-physical_data_read_percent",
                              "aggregation": 4,
                              "splitBy": null
                            }
                          ],
                          "title": "Data I/O Percentage",
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "25",
                        "name": "metric - 4"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook0826ffa7-d944-466f-89bc-663f87ac227f",
                          "version": "MetricsItem/2.0",
                          "size": 1,
                          "chartType": 2,
                          "resourceType": "microsoft.sql/servers/databases",
                          "metricScope": 0,
                          "resourceParameter": "Database",
                          "resourceIds": [
                            "{Database}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 7776000000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.sql/servers/databases",
                              "metric": "microsoft.sql/servers/databases-Basic-storage_percent",
                              "aggregation": 4,
                              "splitBy": null
                            }
                          ],
                          "title": "Data I/O Percentage",
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "25",
                        "name": "metric - 4 - Copy"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "performance"
                  },
                  "name": "Performance"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "4e6c0062-8388-48ed-9d51-87dce6012e0d",
                              "version": "KqlParameterItem/1.0",
                              "name": "Subscription",
                              "label": "Choose Subscription",
                              "type": 6,
                              "description": "Choose a subscription",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "includeAll": true,
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::3"
                            },
                            {
                              "id": "d32f4df4-51d9-4816-b3d2-a23e18ab65db",
                              "version": "KqlParameterItem/1.0",
                              "name": "Workspace",
                              "label": "Choose Workspace",
                              "type": 5,
                              "description": "Choose a LA Workspace",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "Resources\r\n| where type =~ \"Microsoft.operationalinsights/workspaces\"\r\n| summarize by id",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "value": [
                                "value::all"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Filter"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name | join ( resources | where type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines' and tostring(properties.['sqlServerLicenseType']) != 'AHUB'  | extend SQLID=id, VMName = name, VMRG = resourceGroup, VMLocation = location, LicenseType = tostring(properties.['sqlServerLicenseType']), OSType=tostring(properties.storageProfile.imageReference.offer), SQLAgentType = tostring(properties.['sqlManagement']), SQLVersion = tostring(properties.['sqlImageOffer']), SQLSKU=tostring(properties.['sqlImageSku'])) on subscriptionId \r\n    | order by id asc    \r\n    | project SQLID,VMName,VMRG, VMLocation, SQLVersion, SQLSKU, SQLAgentType, LicenseType, SubscriptionName\r\n    | where SQLSKU != \"Developer\" and SQLSKU != \"Express\"",
                          "size": 3,
                          "title": "DB without Azure Hybrid Benifit",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ]
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "dbwithouthybridbenifit"
                  },
                  "name": "DB Without Hybrid Benifit"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedoption",
              "comparison": "isEqualTo",
              "value": "database"
            },
            "name": "Database Dashboard"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "tabs",
                    "links": [
                      {
                        "id": "5e65113d-e7b6-4bb2-87e9-aaec919d3ea0",
                        "cellValue": "backuptab",
                        "linkTarget": "parameter",
                        "linkLabel": "Overview",
                        "subTarget": "overview",
                        "style": "link"
                      },
                      {
                        "id": "bd1774ef-e6c9-477a-a8e1-81b3adaa527b",
                        "cellValue": "backuptab",
                        "linkTarget": "parameter",
                        "linkLabel": "VM Without Backup",
                        "subTarget": "compliance",
                        "style": "link"
                      },
                      {
                        "id": "68293d35-d2c4-4f77-90b7-8b7a4807a2f0",
                        "cellValue": "backuptab",
                        "linkTarget": "parameter",
                        "linkLabel": "Status",
                        "subTarget": "status",
                        "style": "link"
                      },
                      {
                        "id": "f72ed743-babf-4a8b-a6c4-e7e3a839788b",
                        "cellValue": "backuptab",
                        "linkTarget": "parameter",
                        "linkLabel": "Jobs",
                        "subTarget": "jobs",
                        "style": "link"
                      },
                      {
                        "id": "25429552-0a51-4d10-afe9-9609b583cf30",
                        "cellValue": "backuptab",
                        "linkTarget": "parameter",
                        "linkLabel": "Items",
                        "subTarget": "items",
                        "style": "link"
                      },
                      {
                        "id": "ec00dc7e-1a89-4dc3-a8a0-368a67dc4156",
                        "cellValue": "backuptab",
                        "linkTarget": "parameter",
                        "linkLabel": "Policies",
                        "subTarget": "policies",
                        "style": "link"
                      },
                      {
                        "id": "83afb441-60d9-47ea-9f8e-7bca3884b1a9",
                        "cellValue": "backuptab",
                        "linkTarget": "parameter",
                        "linkLabel": "Snapshot",
                        "subTarget": "snapshot",
                        "style": "link"
                      },
                      {
                        "id": "5a41bd94-f073-4ba3-82be-652b7c741e93",
                        "cellValue": "backuptab",
                        "linkTarget": "parameter",
                        "linkLabel": "Vaults",
                        "subTarget": "vault",
                        "style": "link"
                      },
                      {
                        "id": "ab06c206-ec09-463f-8b1b-ae08459d9424",
                        "cellValue": "backuptab",
                        "linkTarget": "parameter",
                        "linkLabel": "Alerts",
                        "subTarget": "alerts",
                        "style": "link"
                      }
                    ]
                  },
                  "name": "links - 8"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "parameters": [
                            {
                              "id": "d1f42f81-eb8f-4653-a0ff-38564d7487b4",
                              "version": "KqlParameterItem/1.0",
                              "name": "Subscriptions",
                              "type": 6,
                              "description": "Subscriptions to filter the list of workspaces",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "value": [
                                "/subscriptions/b17d03eb-4598-4cc2-9046-83a94e7c56ee",
                                "/subscriptions/b661db5b-6c7e-435f-a989-6de3b26c40d3"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "includeAll": false,
                                "selectAllValue": ""
                              }
                            },
                            {
                              "id": "2373a24f-ad32-4909-a7f6-59b373dcde6c",
                              "version": "KqlParameterItem/1.0",
                              "name": "Workspaces",
                              "type": 5,
                              "description": "LA Workspaces configured in vault diagnostic settings",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "where type =~ 'microsoft.operationalinsights/workspaces' | project id",
                              "crossComponentResources": [
                                "{Subscriptions}"
                              ],
                              "value": [
                                "/subscriptions/b17d03eb-4598-4cc2-9046-83a94e7c56ee/resourceGroups/vpk-eun-pr-hub-cos-rg/providers/Microsoft.OperationalInsights/workspaces/vpk-eun-pr-hub-cos-la",
                                "/subscriptions/b17d03eb-4598-4cc2-9046-83a94e7c56ee/resourceGroups/vpk-eun-pr-hub-network-rg/providers/Microsoft.OperationalInsights/workspaces/vpk-eun-pr-la-hub-infra",
                                "/subscriptions/b17d03eb-4598-4cc2-9046-83a94e7c56ee/resourceGroups/vpk-eun-pr-spk-dmz-rg/providers/Microsoft.OperationalInsights/workspaces/vpk-eun-pr-la-spk-compute"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": []
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "id": "64dd748f-d528-4912-a3bf-4a503e0b17f6",
                              "version": "KqlParameterItem/1.0",
                              "name": "VaultsUsingAzureDiagnostics",
                              "type": 1,
                              "query": "// function Params - Report Filters\r\nlet RangeStart = startofday(ago(3d));\r\nlet RangeEnd = startofday(now());\r\nlet VaultSubscriptionList = \"*\";\r\nlet VaultLocationList = \"*\"; \r\nlet VaultList = \"*\";\r\nlet VaultTypeList = \"*\";\r\nlet ExcludeLegacyEvent_1 = false;\r\nlet ExcludeLegacyEvent_2 = true;\r\n// calling LA System Function\r\n_AzureBackup_GetVaults(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent_1) | distinct Id\r\n| join kind = leftanti ( \r\n// calling LA System Function\r\n_AzureBackup_GetVaults(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent_2) | distinct Id) on Id\r\n| count ",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            {
                              "id": "d894d309-7e5f-488e-afde-73796c84b711",
                              "version": "KqlParameterItem/1.0",
                              "name": "AzureStorageCutOffDate",
                              "type": 1,
                              "description": "Cut-off Date To Enable AzureStorage",
                              "isRequired": true,
                              "query": "{\"version\":\"1.0.0\",\"content\":\"\\\"5/14/2020, 12:00:00.000 AM\\\"\",\"transformers\":null}",
                              "isHiddenWhenLocked": true,
                              "queryType": 8
                            }
                          ],
                          "style": "pills",
                          "doNotRunWhenHidden": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "Overview-WorkspaceParameterBlock"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "parameters": [
                            {
                              "id": "8c4ae44c-fa9a-4498-aedc-736a56e64b43",
                              "version": "KqlParameterItem/1.0",
                              "name": "TimeRange",
                              "label": "Time Range",
                              "type": 4,
                              "description": "Time Range",
                              "value": {
                                "durationMs": 604800000
                              },
                              "typeSettings": {
                                "selectableValues": [
                                  {
                                    "durationMs": 259200000
                                  },
                                  {
                                    "durationMs": 604800000
                                  },
                                  {
                                    "durationMs": 1209600000
                                  },
                                  {
                                    "durationMs": 2419200000
                                  },
                                  {
                                    "durationMs": 2592000000
                                  },
                                  {
                                    "durationMs": 5184000000
                                  },
                                  {
                                    "durationMs": 7776000000
                                  }
                                ],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "TimeRange"
                            },
                            {
                              "id": "78c86854-fe3c-44c5-8ee3-23d4210827d1",
                              "version": "KqlParameterItem/1.0",
                              "name": "ExcludeLegacyEvent",
                              "label": "Exclude Legacy Table",
                              "type": 2,
                              "description": "Use this parameter to avoid querying data that is sent to the legacy Azure Diagnostics table. Excluding the legacy table improves query performance time. <a href=\"https://docs.microsoft.com/azure/backup/backup-azure-diagnostic-events#legacy-event\">Learn more </a>",
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    { \"value\":\"True\",  \"selected\":true},\r\n    { \"value\":\"False\"}\r\n]",
                              "value": "False"
                            }
                          ],
                          "style": "pills",
                          "doNotRunWhenHidden": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "36",
                        "name": "Overview-TimeRangeParameterBlock",
                        "styleSettings": {
                          "maxWidth": "100%"
                        }
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "8ce61d1d-e371-40bf-ad53-7ba78afb976f",
                              "version": "KqlParameterItem/1.0",
                              "name": "DatasourceType",
                              "label": "Backup Solution",
                              "type": 2,
                              "description": "Use to filter reports by backup solution",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "",
                              "delimiter": ",",
                              "value": [
                                "value::all"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "selectAllValue": "*",
                                "showDefault": false
                              },
                              "jsonData": "\r\n[    \r\n{ \"value\": \"Azure Backup Agent\", \t\t\t\t\t\t\"label\": \"Azure Backup Agent\" },\r\n{ \"value\": \"Azure Backup Server\", \t\t\t\"label\": \"Azure Backup Server\" },\r\n{ \"value\": \"Azure Storage (Azure Files) Backup\", \t\t\t\t\"label\": \"Azure Storage (Azure Files) Backup\" },\r\n{ \"value\": \"Azure Virtual Machine Backup\", \t\t\t\t\t\t\"label\": \"Azure Virtual Machine Backup\" },\r\n{ \"value\": \"DPM\", \t\t\t\t\t\t\"label\": \"DPM\" },\r\n{ \"value\": \"SAP HANA in Azure VM Backup\", \"label\": \"SAP HANA in Azure VM Backup\" },\r\n{ \"value\": \"SQL in Azure VM Backup\",     \"label\": \"SQL in Azure VM Backup\" }\r\n]"
                            },
                            {
                              "id": "678680e5-76b5-4db8-bbef-5f73942caf2e",
                              "version": "KqlParameterItem/1.0",
                              "name": "VaultSubscription",
                              "label": "Subscription Name",
                              "type": 6,
                              "description": "Subscription(s) under which the vault(s) exist",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "",
                              "delimiter": ",",
                              "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = \"*\";\r\nlet VaultLocationList = \"*\";\r\nlet VaultList = \"*\";\r\nlet VaultTypeList = \"*\";\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet Item_search =  \"*;*\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet DisplayAllFields = false;\r\n// calling LA System Function\r\n_AzureBackup_GetBackupInstances(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n// query to transform function output\r\n| distinct VaultSubscriptionId",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "value": [
                                "value::all"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "selectAllValue": "*",
                                "showDefault": false
                              },
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            {
                              "id": "2a83acc5-2123-476f-8a4c-da2fddf231a1",
                              "version": "KqlParameterItem/1.0",
                              "name": "VaultLocation",
                              "label": "Vault Location",
                              "type": 2,
                              "description": "Location(s) in which the vault(s) were created",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "",
                              "delimiter": ",",
                              "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = \"*\";\r\nlet VaultList = \"*\";\r\nlet VaultTypeList = \"*\";\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet Item_search =  \"*;*\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet DisplayAllFields = false;\r\n// calling LA System Function\r\n_AzureBackup_GetBackupInstances(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n// query to transform function output\r\n| distinct VaultLocation",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "value": [
                                "value::all"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "selectAllValue": "*",
                                "showDefault": false
                              },
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            {
                              "id": "fefd31fa-2774-43ca-8cc3-44d477c969f0",
                              "version": "KqlParameterItem/1.0",
                              "name": "VaultName",
                              "label": "Vault Name",
                              "type": 2,
                              "description": "Name(s) of the vault(s)",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "",
                              "delimiter": ",",
                              "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultList = \"*\";\r\nlet VaultTypeList = \"*\";\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\n// calling LA System Function\r\n_AzureBackup_GetVaults(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent)\r\n// query to transform function output\r\n| distinct Name ",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "value": [
                                "value::all"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "selectAllValue": "*",
                                "showDefault": false
                              },
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            }
                          ],
                          "style": "pills",
                          "doNotRunWhenHidden": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Overview-ReportParameterBlock"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "parameters": [
                            {
                              "id": "3c5a3e26-bce4-43d9-a22d-e963a0d734af",
                              "version": "KqlParameterItem/1.0",
                              "name": "ResourceGroupId",
                              "type": 1,
                              "query": "resources | where type==\"microsoft.operationalinsights/workspaces\" | project name, resourceGroupId=strcat(\"/subscriptions/\",subscriptionId,\"/resourceGroups/\",resourceGroup) | where \"{Workspaces}\" contains name | project resourceGroupId | take 1",
                              "crossComponentResources": [
                                "{Subscriptions}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "id": "897957ad-a946-4b3b-98f0-02008d30ff0f",
                              "version": "KqlParameterItem/1.0",
                              "name": "WorkspaceName",
                              "type": 1,
                              "query": "resources | where type==\"microsoft.operationalinsights/workspaces\" \r\n| project name, resourceGroupId=strcat(\"/subscriptions/\",subscriptionId,\"/resourceGroups/\",resourceGroup) \r\n| where \"{Workspaces}\" contains name \r\n| where \"{ResourceGroupId}\" has resourceGroupId\r\n| take 1\r\n",
                              "crossComponentResources": [
                                "{Subscriptions}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "WorkspaceResourceGroup",
                              "type": 1,
                              "query": "resources | where type==\"microsoft.operationalinsights/workspaces\" \r\n| project name, resourceGroupId=strcat(\"/subscriptions/\",subscriptionId,\"/resourceGroups/\",resourceGroup), resourceGroup, subscriptionId \r\n| where \"{WorkspaceName}\" has name \r\n| where \"{ResourceGroupId}\" has resourceGroupId\r\n| take 1\r\n| project resourceGroup\r\n",
                              "crossComponentResources": [
                                "{Subscriptions}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "id": "75065a95-e81f-470f-805e-427558ee0ea3"
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "WorkspaceSubscriptionId",
                              "type": 1,
                              "query": "resources | where type==\"microsoft.operationalinsights/workspaces\" \r\n| project name, resourceGroupId=strcat(\"/subscriptions/\",subscriptionId,\"/resourceGroups/\",resourceGroup), resourceGroup, subscriptionId \r\n| where \"{WorkspaceName}\" has name \r\n| where \"{ResourceGroupId}\" has resourceGroupId\r\n| take 1\r\n| project subscriptionId\r\n",
                              "crossComponentResources": [
                                "{Subscriptions}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "id": "2581aa73-ab5f-4f2c-82f1-1b4d0f9708ad"
                            },
                            {
                              "id": "5327529a-bd07-4305-bf65-4b36a3c787b9",
                              "version": "KqlParameterItem/1.0",
                              "name": "LogicApp_VaultSubscriptionList",
                              "type": 1,
                              "query": "let VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nprint VaultSubscriptionList",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            {
                              "id": "e404488a-5db7-42ba-9b44-996f1d8cd7b2",
                              "version": "KqlParameterItem/1.0",
                              "name": "LogicApp_VaultLocationList",
                              "type": 1,
                              "query": "let VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nprint VaultLocationList",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            {
                              "id": "8005c310-7839-42ff-a3a4-01e5a6c45223",
                              "version": "KqlParameterItem/1.0",
                              "name": "LogicApp_VaultList",
                              "type": 1,
                              "query": "let VaultList = todynamic( @\"{VaultName}\"); \r\nprint VaultList",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            {
                              "id": "2e3d4cd7-7393-4cc4-ab9e-793311eb291c",
                              "version": "KqlParameterItem/1.0",
                              "name": "LogicApp_DatasourceTypeList",
                              "type": 1,
                              "query": "let DatasourceTypeList = @\"{DatasourceType}\";\r\nprint DatasourceTypeList",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            {
                              "id": "376631ff-44ae-4824-b470-ac32d82cd4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "LogicApp_ExcludeLegacyEvent",
                              "type": 1,
                              "query": "let ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nprint ExcludeLegacyEvent",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            {
                              "id": "5d1a9bc1-34ab-491d-bfa6-f7fc8402f3dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "LogicApp_AggregationType",
                              "type": 1,
                              "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nprint AggregationType=iff(datetime_diff('day',RangeEnd,RangeStart)<=30,\"Daily\",iff(datetime_diff('day',RangeEnd,RangeStart)<=90,\"Weekly\",\"Monthly\"))\r\n\r\n\r\n\r\n\r\n\r\n",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            {
                              "id": "892dcb11-ee52-478b-aac2-10892fb837ae",
                              "version": "KqlParameterItem/1.0",
                              "name": "LogicApp_TimeRangeInDays",
                              "type": 1,
                              "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = startofday({TimeRange:end});\r\nprint TimeRangeInDays = datetime_diff('day',RangeEnd,RangeStart)\r\n\r\n",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            }
                          ],
                          "style": "above",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "60",
                        "conditionalVisibility": {
                          "parameterName": "Workspaces",
                          "comparison": "isNotEqualTo"
                        },
                        "name": "Overview-ReportParameterBlock - Copy",
                        "styleSettings": {
                          "maxWidth": "100%"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "<div style=\"text-align:left\"><span style=\"font-size:14px;font-weight:600;\">Key Parameters by Backup Solution </span> </div>"
                                    },
                                    "customWidth": "100",
                                    "conditionalVisibilities": [
                                      {
                                        "parameterName": "TabName",
                                        "comparison": "isEqualTo",
                                        "value": "Summary"
                                      },
                                      {
                                        "parameterName": "Workspaces",
                                        "comparison": "isNotEqualTo"
                                      },
                                      {
                                        "parameterName": "DatasourceType",
                                        "comparison": "isNotEqualTo"
                                      }
                                    ],
                                    "name": "Summary-GridTitle1",
                                    "styleSettings": {
                                      "margin": "0% 0% 0% 0%"
                                    }
                                  },
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList =  \"*\";\r\nlet Item_search =   \"*;*\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet DisplayAllFields = true;\r\nlet JobOperationList = \"*\";\r\nlet JobStatusList =  \"*\";\r\nlet JobFailureCodeList =  \"*\";\r\nlet ExcludeLog = True;\r\nlet BackupInstanceDetails = (){\r\n// calling LA System Function\r\n_AzureBackup_GetBackupInstances(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n// query to transform function output\r\n| summarize BackupInstances=count(UniqueId), CloudStorage=sum(VaultStore_StorageConsumptionInMBs)/(1024) by BackupSolution\r\n};\r\nlet JobSuccessPercentageTable = (){\r\n// calling LA System Function\r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n// query to transform function output\r\n| extend success=iff((Status == \"Completed\" or Status == \"CompletedWithWarnings\") , 1 , 0)\r\n| extend record = iff(UniqueId != \"\", 1, 0)  // to be used for total row count\r\n| summarize SuccessfulCount =sum(success), TotalCount=sum(record) by BackupSolution\r\n| extend JobSuccessPercentage = (SuccessfulCount*100)/todouble(TotalCount)\r\n| project-away SuccessfulCount, TotalCount\r\n};\r\nBackupInstanceDetails | join kind = leftouter (JobSuccessPercentageTable) on BackupSolution  | project-away BackupSolution1 | project BackupSolution, BackupInstances, JobSuccessPercentage=iff( (isnan( JobSuccessPercentage) or isinf( JobSuccessPercentage) or isempty( JobSuccessPercentage)), \"-\", strcat(tostring(round( JobSuccessPercentage,2)), \" %\")), CloudStorage",
                                      "size": 3,
                                      "noDataMessage": "No records found for the selected time range and scope",
                                      "showExportToExcel": true,
                                      "queryType": 0,
                                      "resourceType": "microsoft.operationalinsights/workspaces",
                                      "crossComponentResources": [
                                        "{Workspaces}"
                                      ],
                                      "gridSettings": {
                                        "formatters": [
                                          {
                                            "columnMatch": "BackupSolution",
                                            "formatter": 0,
                                            "tooltipFormat": {
                                              "tooltip": "Backup Solution"
                                            }
                                          },
                                          {
                                            "columnMatch": "BackupInstances",
                                            "formatter": 4,
                                            "formatOptions": {
                                              "min": 0,
                                              "palette": "blue",
                                              "customColumnWidthSetting": "25%"
                                            },
                                            "tooltipFormat": {
                                              "tooltip": "Number of backup instances backed up using the given backup solution, as of the end of the selected time range"
                                            }
                                          },
                                          {
                                            "columnMatch": "JobSuccessPercentage",
                                            "formatter": 1,
                                            "formatOptions": {
                                              "customColumnWidthSetting": "25%"
                                            },
                                            "numberFormat": {
                                              "unit": 1,
                                              "options": {
                                                "style": "decimal",
                                                "useGrouping": false,
                                                "maximumFractionDigits": 2
                                              }
                                            },
                                            "tooltipFormat": {
                                              "tooltip": "% of Jobs (that were triggered in the selected time range) that were successful for backup instances backed up using the given backup solution"
                                            }
                                          },
                                          {
                                            "columnMatch": "CloudStorage",
                                            "formatter": 4,
                                            "formatOptions": {
                                              "min": 0,
                                              "palette": "blue",
                                              "customColumnWidthSetting": "25%"
                                            },
                                            "numberFormat": {
                                              "unit": 0,
                                              "options": {
                                                "style": "decimal",
                                                "minimumFractionDigits": 2,
                                                "maximumFractionDigits": 2
                                              }
                                            },
                                            "tooltipFormat": {
                                              "tooltip": "Total cloud storage consumed by backup instances backed up by the given backup solution, as of the end of the selected time range"
                                            }
                                          }
                                        ],
                                        "labelSettings": [
                                          {
                                            "columnId": "BackupSolution",
                                            "label": "Backup Solution"
                                          },
                                          {
                                            "columnId": "BackupInstances",
                                            "label": "Backup Instances"
                                          },
                                          {
                                            "columnId": "JobSuccessPercentage",
                                            "label": "Job Success %"
                                          },
                                          {
                                            "columnId": "CloudStorage",
                                            "label": "Cloud Storage (GB)"
                                          }
                                        ]
                                      },
                                      "sortBy": []
                                    },
                                    "showPin": true,
                                    "name": "Summary-Grid",
                                    "styleSettings": {
                                      "margin": "-23px 0% 0% 0%"
                                    }
                                  },
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList =  \"*\";\r\nlet Item_search =   \"*;*\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet DisplayAllFields = false;\r\nlet JobOperationList = \"*\";\r\nlet JobStatusList =  \"*\";\r\nlet JobFailureCodeList =  \"*\";\r\nlet ExcludeLog = True;\r\nlet BillingGroupName = \"*\";\r\n(\r\n// calling LA System Function\r\n_AzureBackup_GetBackupInstances(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n| count | extend Dummy = 1\r\n) \r\n| join (\r\n// calling LA System Function\r\n_AzureBackup_GetBillingGroups(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, BillingGroupName) \r\n| summarize Sum_VaultStore_StorageConsumption_InGBs = sum(VaultStore_StorageConsumptionInMBs)/1024, sum_ProtectedInstanceCount = sum(todouble(parse_json(ExtendedProperties).ProtectedInstanceCount)) | extend Dummy = 1\r\n) on Dummy \r\n| join (\r\n// calling LA System Function\r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog) \r\n| summarize dcount(UniqueId,4) | extend Dummy = 1\r\n) on Dummy \r\n| extend  Key = pack_array( \"Backup Instances\", \"Protected Instances\",  \"Cloud Storage (GB)\", \"Jobs Created\"), Value = pack_array( Count, sum_ProtectedInstanceCount, Sum_VaultStore_StorageConsumption_InGBs, dcount_UniqueId), \r\nSubTitle = pack_array( \"\", \"\", \"\", \"\")\r\n| project Key, Value, SubTitle \r\n| mvexpand Key, Value, SubTitle",
                                      "size": 3,
                                      "noDataMessage": "No records found for the selected time range and scope",
                                      "queryType": 0,
                                      "resourceType": "microsoft.operationalinsights/workspaces",
                                      "crossComponentResources": [
                                        "{Workspaces}"
                                      ],
                                      "visualization": "tiles",
                                      "tileSettings": {
                                        "titleContent": {
                                          "columnMatch": "Key",
                                          "formatter": 1
                                        },
                                        "subtitleContent": {
                                          "columnMatch": "SubTitle",
                                          "formatter": 1
                                        },
                                        "leftContent": {
                                          "columnMatch": "Value",
                                          "formatter": 12,
                                          "formatOptions": {
                                            "palette": "auto"
                                          },
                                          "numberFormat": {
                                            "unit": 0,
                                            "options": {
                                              "style": "decimal",
                                              "maximumFractionDigits": 2
                                            }
                                          }
                                        },
                                        "showBorder": true
                                      }
                                    },
                                    "name": "Summary-Tiles",
                                    "styleSettings": {
                                      "margin": "0% 0% 0% -15px"
                                    }
                                  }
                                ]
                              },
                              "name": "group - 0"
                            }
                          ]
                        },
                        "conditionalVisibilities": [
                          {
                            "parameterName": "Workspaces",
                            "comparison": "isNotEqualTo"
                          },
                          {
                            "parameterName": "DatasourceType",
                            "comparison": "isNotEqualTo"
                          }
                        ],
                        "name": "summary-group"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "backuptab",
                    "comparison": "isEqualTo",
                    "value": "overview"
                  },
                  "name": "Overview"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "95a84318-4fcc-4b3c-a33a-5645586a6df1",
                              "version": "KqlParameterItem/1.0",
                              "name": "Subscription",
                              "label": "Choose Subscription",
                              "type": 6,
                              "description": "Choose a subscription",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "includeAll": true,
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::3"
                            },
                            {
                              "id": "3b98b685-0ea0-43b1-a924-c444969f8e97",
                              "version": "KqlParameterItem/1.0",
                              "name": "Workspace",
                              "label": "Choose Workspace",
                              "type": 5,
                              "description": "Choose a LA Workspace",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "Resources\r\n| where type =~ \"Microsoft.operationalinsights/workspaces\"\r\n| summarize by id",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::all",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "conditionalVisibility": {
                          "parameterName": "Tabname",
                          "comparison": "isNotEqualTo",
                          "value": "summary"
                        },
                        "name": "parameters - 1 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "RecoveryServicesResources \r\n| where type in~ ('Microsoft.RecoveryServices/vaults/backupFabrics/protectionContainers/protectedItems')\r\n| extend vaultName = case(type =~ 'microsoft.dataprotection/backupVaults/backupInstances',split(split(id, '/Microsoft.DataProtection/backupVaults/')[1],'/')[0],type =~ 'Microsoft.RecoveryServices/vaults/backupFabrics/protectionContainers/protectedItems',split(split(id, '/Microsoft.RecoveryServices/vaults/')[1],'/')[0],'--')\r\n| extend dataSourceType = case(type=~'Microsoft.RecoveryServices/vaults/backupFabrics/protectionContainers/protectedItems',properties.backupManagementType,type =~ 'microsoft.dataprotection/backupVaults/backupInstances',properties.dataSourceSetInfo.datasourceType,'--')\r\n| extend friendlyName = properties.friendlyName\r\n| extend dsResourceGroup = split(split(properties.dataSourceInfo.resourceID, '/resourceGroups/')[1],'/')[0]\r\n| extend dsSubscription = split(split(properties.dataSourceInfo.resourceID, '/subscriptions/')[1],'/')[0]\r\n| extend lastRestorePoint = properties.lastRecoveryPoint\r\n| extend primaryLocation = properties.dataSourceInfo.resourceLocation\r\n| extend policyName = case(type =~ 'Microsoft.RecoveryServices/vaults/backupFabrics/protectionContainers/protectedItems',properties.policyName, type =~ 'microsoft.dataprotection/backupVaults/backupInstances', properties.policyInfo.name, '--')\r\n| extend protectionState = properties.currentProtectionState\r\n| summarize c = count() \r\n| extend Item = \"VM Configured with Backup\",  Key = 1\r\n\r\n| union\r\n(\r\nResources\r\n| where type in~ ('microsoft.compute/virtualmachines','microsoft.classiccompute/virtualmachines') \r\n| extend resourceId=tolower(id) \r\n| join kind = leftouter ( RecoveryServicesResources\r\n| where type == \"microsoft.recoveryservices/vaults/backupfabrics/protectioncontainers/protecteditems\"\r\n| where properties.backupManagementType == \"AzureIaasVM\"\r\n| project resourceId = tolower(tostring(properties.sourceResourceId)), backupItemid = id, isBackedUp = isnotempty(id) ) on resourceId \r\n| extend isProtected = isnotempty(backupItemid)\r\n| where (isProtected == (0))\r\n| project id,name,resourceGroup,location,tags\r\n| summarize c = count() \r\n| extend Item = \"VM Not Configured with Backup\",  Key = 1\r\n)\r\n",
                          "size": 3,
                          "title": "VM Configred with Backup",
                          "noDataMessageStyle": 5,
                          "exportFieldName": "item",
                          "exportParameterName": "SelectedItem",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Item",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "c",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              }
                            },
                            "showBorder": true,
                            "size": "auto"
                          },
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "VM Configured with Backup",
                                "color": "green"
                              },
                              {
                                "seriesName": "VM Not Configured with Backup",
                                "color": "redBright"
                              }
                            ]
                          },
                          "textSettings": {
                            "style": "bignumber"
                          }
                        },
                        "customWidth": "30",
                        "name": "query - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "Resources\r\n| where type in~ ('microsoft.compute/virtualmachines','microsoft.classiccompute/virtualmachines') \r\n| extend resourceId=tolower(id) \r\n| join kind = leftouter ( RecoveryServicesResources\r\n| where type == \"microsoft.recoveryservices/vaults/backupfabrics/protectioncontainers/protecteditems\"\r\n| where properties.backupManagementType == \"AzureIaasVM\"\r\n| project resourceId = tolower(tostring(properties.sourceResourceId)), backupItemid = id, isBackedUp = isnotempty(id) ) on resourceId \r\n| extend isProtected = isnotempty(backupItemid)\r\n| where (isProtected == (0))\r\n| project id,resourceGroup,location",
                          "size": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "id",
                              "formatter": 13,
                              "formatOptions": {
                                "linkTarget": "Resource",
                                "showIcon": true
                              }
                            },
                            "leftContent": {
                              "columnMatch": "location",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "4",
                                    "text": "Not Enabled"
                                  }
                                ]
                              }
                            },
                            "showBorder": true
                          },
                          "graphSettings": {
                            "type": 2,
                            "topContent": {
                              "formatter": 13,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": false
                              }
                            },
                            "centerContent": {
                              "columnMatch": "id",
                              "formatter": 13,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": true
                              }
                            },
                            "nodeIdField": "location",
                            "sourceIdField": "id",
                            "targetIdField": "id",
                            "graphOrientation": 3,
                            "showOrientationToggles": false,
                            "nodeSize": null,
                            "staticNodeSize": 100,
                            "colorSettings": {
                              "nodeColorField": "id",
                              "type": 3,
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "orange"
                                }
                              ]
                            },
                            "hivesMargin": 5
                          },
                          "mapSettings": {
                            "locInfo": "AzureLoc",
                            "labelSettings": "location",
                            "locInfoColumn": "location"
                          }
                        },
                        "customWidth": "70",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "backuptab",
                    "comparison": "isEqualTo",
                    "value": "compliance"
                  },
                  "name": "Compliance"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "4d7d150c-138f-4c2f-9d50-c66c95882c07",
                              "version": "KqlParameterItem/1.0",
                              "name": "Subscription",
                              "label": "Choose Subscription",
                              "type": 6,
                              "description": "Choose a subscription",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "includeAll": true,
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::3"
                            },
                            {
                              "id": "a634aa80-e05b-458a-a4a8-8d86ccd0a6c4",
                              "version": "KqlParameterItem/1.0",
                              "name": "Workspace",
                              "label": "Choose Workspace",
                              "type": 5,
                              "description": "Choose a LA Workspace",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "Resources\r\n| where type =~ \"Microsoft.operationalinsights/workspaces\"\r\n| summarize by id",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "value": [
                                "/subscriptions/b661db5b-6c7e-435f-a989-6de3b26c40d3/resourceGroups/DefaultResourceGroup-WEU/providers/Microsoft.OperationalInsights/workspaces/DefaultWorkspace-b661db5b-6c7e-435f-a989-6de3b26c40d3-WEU",
                                "/subscriptions/b17d03eb-4598-4cc2-9046-83a94e7c56ee/resourceGroups/vpk-eun-pr-hub-cos-rg/providers/Microsoft.OperationalInsights/workspaces/vpk-eun-pr-hub-cos-la",
                                "/subscriptions/b17d03eb-4598-4cc2-9046-83a94e7c56ee/resourceGroups/vpk-eun-pr-hub-network-rg/providers/Microsoft.OperationalInsights/workspaces/vpk-eun-pr-la-hub-infra",
                                "/subscriptions/b17d03eb-4598-4cc2-9046-83a94e7c56ee/resourceGroups/vpk-eun-pr-spk-dmz-rg/providers/Microsoft.OperationalInsights/workspaces/vpk-eun-pr-la-spk-compute"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "id": "12ba2ca7-c49d-4394-ba62-251b69f05cc7",
                              "version": "KqlParameterItem/1.0",
                              "name": "VaultLocation",
                              "type": 2,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "Resources\r\n| where type == \"microsoft.recoveryservices/vaults\"\r\n| summarize by location",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ]
                              },
                              "defaultValue": "value::all",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "label": "Choose Vault Locaiton",
                              "value": [
                                "value::all"
                              ]
                            },
                            {
                              "id": "edfa92f5-78b2-4084-abec-40ac7e6b8504",
                              "version": "KqlParameterItem/1.0",
                              "name": "Vault",
                              "label": "Choose Vault",
                              "type": 5,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "Resources\r\n| where type == \"microsoft.recoveryservices/vaults\"\r\n| where location in ({VaultLocation}) or '*' in ({VaultLocation})\r\n| summarize by id = tolower(id)",
                              "crossComponentResources": [
                                "{Workspace}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ]
                              },
                              "defaultValue": "value::all",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "conditionalVisibility": {
                          "parameterName": "Tabname",
                          "comparison": "isNotEqualTo",
                          "value": "summary"
                        },
                        "name": "parameters - 1 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "recoveryservicesresources\r\n| where type == \"microsoft.recoveryservices/vaults/backupjobs\"\r\n| summarize count() by BackupState = tostring(properties.status)",
                          "size": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Vault}"
                          ],
                          "visualization": "piechart",
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "subscriptionId",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Completed",
                                "color": "green"
                              },
                              {
                                "seriesName": "InProgress",
                                "color": "yellow"
                              },
                              {
                                "seriesName": "Failed",
                                "color": "redBright"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "name": "query - 3"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "recoveryservicesresources\r\n| where type == \"microsoft.recoveryservices/vaults/backupjobs\"\r\n| where properties['status'] == \"Failed\"\r\n| project tostring(properties.entityFriendlyName)",
                          "size": 3,
                          "title": "Failed Backup",
                          "color": "blueDark",
                          "noDataMessage": "No Failed Backup",
                          "noDataMessageStyle": 3,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Vault}"
                          ],
                          "visualization": "tiles",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "properties_entityFriendlyName",
                                "formatter": 20,
                                "formatOptions": {
                                  "palette": "redDark"
                                }
                              }
                            ],
                            "labelSettings": [
                              {
                                "columnId": "properties_entityFriendlyName",
                                "label": "Failed Backup Details"
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "properties_entityFriendlyName",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "4",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            "showBorder": true,
                            "sortCriteriaField": "properties_entityFriendlyName",
                            "sortOrderField": 1,
                            "size": "full"
                          },
                          "graphSettings": {
                            "type": 2,
                            "topContent": {},
                            "centerContent": {
                              "columnMatch": "properties_entityFriendlyName",
                              "formatter": 13,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": true
                              }
                            },
                            "nodeIdField": "properties_entityFriendlyName",
                            "graphOrientation": 3,
                            "showOrientationToggles": false,
                            "nodeSize": null,
                            "staticNodeSize": 100,
                            "colorSettings": {
                              "nodeColorField": "properties_entityFriendlyName",
                              "type": 3,
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "red"
                                }
                              ]
                            },
                            "hivesMargin": 5
                          }
                        },
                        "name": "query - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "recoveryservicesresources \r\n| where type == \"microsoft.recoveryservices/vaults/backupjobs\" \r\n| where properties.status=='Failed'\r\n| project name = tostring(properties.entityFriendlyName),properties.status, startTime1 = properties.startTime ,properties.endTime, properties.duration, properties.dataSourceLocation,properties.dataSourceType, tostring(properties.errorDetails.recommendations), resourceGroup\r\n| sort by name ,resourceGroup, todatetime(startTime1) asc",
                          "size": 3,
                          "title": "VM Last Backup Status",
                          "noDataMessage": "No Failed Backup",
                          "noDataMessageStyle": 3,
                          "showExportToExcel": true,
                          "exportToExcelOptions": "all",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Vault}"
                          ],
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "properties_status",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Failed",
                                      "representation": "3",
                                      "text": "Backup Failed"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "backupMgmtType",
                                "formatter": 5
                              }
                            ],
                            "rowLimit": 10000,
                            "filter": true
                          }
                        },
                        "customWidth": "100",
                        "name": "VM Last Backup Status"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "backuptab",
                    "comparison": "isEqualTo",
                    "value": "status"
                  },
                  "name": "Backup Status Summary",
                  "styleSettings": {
                    "margin": "2px"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "d1f42f81-eb8f-4653-a0ff-38564d7487b4",
                              "version": "KqlParameterItem/1.0",
                              "name": "Subscriptions",
                              "type": 6,
                              "description": "Subscriptions to filter the list of workspaces",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "includeAll": false,
                                "selectAllValue": "",
                                "showDefault": false
                              },
                              "defaultValue": "value::3"
                            },
                            {
                              "id": "2373a24f-ad32-4909-a7f6-59b373dcde6c",
                              "version": "KqlParameterItem/1.0",
                              "name": "Workspaces",
                              "type": 5,
                              "description": "LA Workspaces configured in vault diagnostic settings",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "where type =~ 'microsoft.operationalinsights/workspaces' | project id",
                              "crossComponentResources": [
                                "{Subscriptions}"
                              ],
                              "value": [
                                "/subscriptions/b661db5b-6c7e-435f-a989-6de3b26c40d3/resourceGroups/DefaultResourceGroup-WEU/providers/Microsoft.OperationalInsights/workspaces/DefaultWorkspace-b661db5b-6c7e-435f-a989-6de3b26c40d3-WEU",
                                "/subscriptions/b661db5b-6c7e-435f-a989-6de3b26c40d3/resourceGroups/vpk-eun-pr-sec-sentinel-rg/providers/Microsoft.OperationalInsights/workspaces/vpk-eun-pr-sec-sentinel-la",
                                "/subscriptions/b17d03eb-4598-4cc2-9046-83a94e7c56ee/resourceGroups/vpk-eun-pr-hub-cos-rg/providers/Microsoft.OperationalInsights/workspaces/vpk-eun-pr-hub-cos-la",
                                "/subscriptions/b17d03eb-4598-4cc2-9046-83a94e7c56ee/resourceGroups/vpk-eun-pr-hub-network-rg/providers/Microsoft.OperationalInsights/workspaces/vpk-eun-pr-la-hub-infra",
                                "/subscriptions/b17d03eb-4598-4cc2-9046-83a94e7c56ee/resourceGroups/vpk-eun-pr-spk-dmz-rg/providers/Microsoft.OperationalInsights/workspaces/vpk-eun-pr-la-spk-compute"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": []
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "id": "64dd748f-d528-4912-a3bf-4a503e0b17f6",
                              "version": "KqlParameterItem/1.0",
                              "name": "VaultsUsingAzureDiagnostics",
                              "type": 1,
                              "query": "// function Params - Report Filters\r\nlet RangeStart = startofday(ago(3d));\r\nlet RangeEnd = startofday(now());\r\nlet VaultSubscriptionList = \"*\";\r\nlet VaultLocationList = \"*\"; \r\nlet VaultList = \"*\";\r\nlet VaultTypeList = \"*\";\r\nlet ExcludeLegacyEvent_1 = false;\r\nlet ExcludeLegacyEvent_2 = true;\r\n// calling LA System Function\r\n_AzureBackup_GetVaults(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent_1) | distinct Id\r\n| join kind = leftanti ( \r\n// calling LA System Function\r\n_AzureBackup_GetVaults(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent_2) | distinct Id) on Id\r\n| count ",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            {
                              "id": "d894d309-7e5f-488e-afde-73796c84b711",
                              "version": "KqlParameterItem/1.0",
                              "name": "AzureStorageCutOffDate",
                              "type": 1,
                              "description": "Cut-off Date To Enable AzureStorage",
                              "isRequired": true,
                              "query": "{\"version\":\"1.0.0\",\"content\":\"\\\"5/14/2020, 12:00:00.000 AM\\\"\",\"transformers\":null}",
                              "isHiddenWhenLocked": true,
                              "queryType": 8
                            }
                          ],
                          "style": "pills",
                          "doNotRunWhenHidden": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "Overview-WorkspaceParameterBlock"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "parameters": [
                            {
                              "id": "8c4ae44c-fa9a-4498-aedc-736a56e64b43",
                              "version": "KqlParameterItem/1.0",
                              "name": "TimeRange",
                              "label": "Time Range",
                              "type": 4,
                              "description": "Time Range",
                              "value": {
                                "durationMs": 604800000
                              },
                              "typeSettings": {
                                "selectableValues": [
                                  {
                                    "durationMs": 259200000
                                  },
                                  {
                                    "durationMs": 604800000
                                  },
                                  {
                                    "durationMs": 1209600000
                                  },
                                  {
                                    "durationMs": 2419200000
                                  },
                                  {
                                    "durationMs": 2592000000
                                  },
                                  {
                                    "durationMs": 5184000000
                                  },
                                  {
                                    "durationMs": 7776000000
                                  }
                                ],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "TimeRange"
                            },
                            {
                              "id": "78c86854-fe3c-44c5-8ee3-23d4210827d1",
                              "version": "KqlParameterItem/1.0",
                              "name": "ExcludeLegacyEvent",
                              "label": "Exclude Legacy Table",
                              "type": 2,
                              "description": "Use this parameter to avoid querying data that is sent to the legacy Azure Diagnostics table. Excluding the legacy table improves query performance time. <a href=\"https://docs.microsoft.com/azure/backup/backup-azure-diagnostic-events#legacy-event\">Learn more </a>",
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    { \"value\":\"True\",  \"selected\":true},\r\n    { \"value\":\"False\"}\r\n]",
                              "value": "False"
                            }
                          ],
                          "style": "pills",
                          "doNotRunWhenHidden": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "36",
                        "conditionalVisibility": {
                          "parameterName": "Workspaces",
                          "comparison": "isNotEqualTo"
                        },
                        "name": "Overview-TimeRangeParameterBlock",
                        "styleSettings": {
                          "maxWidth": "100%"
                        }
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "8ce61d1d-e371-40bf-ad53-7ba78afb976f",
                              "version": "KqlParameterItem/1.0",
                              "name": "DatasourceType",
                              "label": "Backup Solution",
                              "type": 2,
                              "description": "Use to filter reports by backup solution",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "",
                              "delimiter": ",",
                              "value": [
                                "value::all"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "selectAllValue": "*",
                                "showDefault": false
                              },
                              "jsonData": "\r\n[    \r\n{ \"value\": \"Azure Backup Agent\", \t\t\t\t\t\t\"label\": \"Azure Backup Agent\" },\r\n{ \"value\": \"Azure Backup Server\", \t\t\t\"label\": \"Azure Backup Server\" },\r\n{ \"value\": \"Azure Storage (Azure Files) Backup\", \t\t\t\t\"label\": \"Azure Storage (Azure Files) Backup\" },\r\n{ \"value\": \"Azure Virtual Machine Backup\", \t\t\t\t\t\t\"label\": \"Azure Virtual Machine Backup\" },\r\n{ \"value\": \"DPM\", \t\t\t\t\t\t\"label\": \"DPM\" },\r\n{ \"value\": \"SAP HANA in Azure VM Backup\", \"label\": \"SAP HANA in Azure VM Backup\" },\r\n{ \"value\": \"SQL in Azure VM Backup\",     \"label\": \"SQL in Azure VM Backup\" }\r\n]"
                            },
                            {
                              "id": "678680e5-76b5-4db8-bbef-5f73942caf2e",
                              "version": "KqlParameterItem/1.0",
                              "name": "VaultSubscription",
                              "label": "Subscription Name",
                              "type": 6,
                              "description": "Subscription(s) under which the vault(s) exist",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "",
                              "delimiter": ",",
                              "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = \"*\";\r\nlet VaultLocationList = \"*\";\r\nlet VaultList = \"*\";\r\nlet VaultTypeList = \"*\";\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet Item_search =  \"*;*\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet DisplayAllFields = false;\r\n// calling LA System Function\r\n_AzureBackup_GetBackupInstances(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n// query to transform function output\r\n| distinct VaultSubscriptionId",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "value": [
                                "value::all"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "selectAllValue": "*",
                                "showDefault": false
                              },
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            {
                              "id": "2a83acc5-2123-476f-8a4c-da2fddf231a1",
                              "version": "KqlParameterItem/1.0",
                              "name": "VaultLocation",
                              "label": "Vault Location",
                              "type": 2,
                              "description": "Location(s) in which the vault(s) were created",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "",
                              "delimiter": ",",
                              "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = \"*\";\r\nlet VaultList = \"*\";\r\nlet VaultTypeList = \"*\";\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet Item_search =  \"*;*\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet DisplayAllFields = false;\r\n// calling LA System Function\r\n_AzureBackup_GetBackupInstances(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n// query to transform function output\r\n| distinct VaultLocation",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "value": [
                                "value::all"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "selectAllValue": "*",
                                "showDefault": false
                              },
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            {
                              "id": "fefd31fa-2774-43ca-8cc3-44d477c969f0",
                              "version": "KqlParameterItem/1.0",
                              "name": "VaultName",
                              "label": "Vault Name",
                              "type": 2,
                              "description": "Name(s) of the vault(s)",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "",
                              "delimiter": ",",
                              "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultList = \"*\";\r\nlet VaultTypeList = \"*\";\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\n// calling LA System Function\r\n_AzureBackup_GetVaults(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent)\r\n// query to transform function output\r\n| distinct Name ",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "value": [
                                "value::all"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "selectAllValue": "*",
                                "showDefault": false
                              },
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            }
                          ],
                          "style": "pills",
                          "doNotRunWhenHidden": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "64",
                        "conditionalVisibility": {
                          "parameterName": "Workspaces",
                          "comparison": "isNotEqualTo"
                        },
                        "name": "Overview-ReportParameterBlock",
                        "styleSettings": {
                          "maxWidth": "100%"
                        }
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "parameters": [
                            {
                              "id": "3c5a3e26-bce4-43d9-a22d-e963a0d734af",
                              "version": "KqlParameterItem/1.0",
                              "name": "ResourceGroupId",
                              "type": 1,
                              "query": "resources | where type==\"microsoft.operationalinsights/workspaces\" | project name, resourceGroupId=strcat(\"/subscriptions/\",subscriptionId,\"/resourceGroups/\",resourceGroup) | where \"{Workspaces}\" contains name | project resourceGroupId | take 1",
                              "crossComponentResources": [
                                "{Subscriptions}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "id": "897957ad-a946-4b3b-98f0-02008d30ff0f",
                              "version": "KqlParameterItem/1.0",
                              "name": "WorkspaceName",
                              "type": 1,
                              "query": "resources | where type==\"microsoft.operationalinsights/workspaces\" \r\n| project name, resourceGroupId=strcat(\"/subscriptions/\",subscriptionId,\"/resourceGroups/\",resourceGroup) \r\n| where \"{Workspaces}\" contains name \r\n| where \"{ResourceGroupId}\" has resourceGroupId\r\n| take 1\r\n",
                              "crossComponentResources": [
                                "{Subscriptions}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "WorkspaceResourceGroup",
                              "type": 1,
                              "query": "resources | where type==\"microsoft.operationalinsights/workspaces\" \r\n| project name, resourceGroupId=strcat(\"/subscriptions/\",subscriptionId,\"/resourceGroups/\",resourceGroup), resourceGroup, subscriptionId \r\n| where \"{WorkspaceName}\" has name \r\n| where \"{ResourceGroupId}\" has resourceGroupId\r\n| take 1\r\n| project resourceGroup\r\n",
                              "crossComponentResources": [
                                "{Subscriptions}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "id": "75065a95-e81f-470f-805e-427558ee0ea3"
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "WorkspaceSubscriptionId",
                              "type": 1,
                              "query": "resources | where type==\"microsoft.operationalinsights/workspaces\" \r\n| project name, resourceGroupId=strcat(\"/subscriptions/\",subscriptionId,\"/resourceGroups/\",resourceGroup), resourceGroup, subscriptionId \r\n| where \"{WorkspaceName}\" has name \r\n| where \"{ResourceGroupId}\" has resourceGroupId\r\n| take 1\r\n| project subscriptionId\r\n",
                              "crossComponentResources": [
                                "{Subscriptions}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "id": "2581aa73-ab5f-4f2c-82f1-1b4d0f9708ad"
                            },
                            {
                              "id": "5327529a-bd07-4305-bf65-4b36a3c787b9",
                              "version": "KqlParameterItem/1.0",
                              "name": "LogicApp_VaultSubscriptionList",
                              "type": 1,
                              "query": "let VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nprint VaultSubscriptionList",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            {
                              "id": "e404488a-5db7-42ba-9b44-996f1d8cd7b2",
                              "version": "KqlParameterItem/1.0",
                              "name": "LogicApp_VaultLocationList",
                              "type": 1,
                              "query": "let VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nprint VaultLocationList",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            {
                              "id": "8005c310-7839-42ff-a3a4-01e5a6c45223",
                              "version": "KqlParameterItem/1.0",
                              "name": "LogicApp_VaultList",
                              "type": 1,
                              "query": "let VaultList = todynamic( @\"{VaultName}\"); \r\nprint VaultList",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            {
                              "id": "2e3d4cd7-7393-4cc4-ab9e-793311eb291c",
                              "version": "KqlParameterItem/1.0",
                              "name": "LogicApp_DatasourceTypeList",
                              "type": 1,
                              "query": "let DatasourceTypeList = @\"{DatasourceType}\";\r\nprint DatasourceTypeList",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            {
                              "id": "376631ff-44ae-4824-b470-ac32d82cd4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "LogicApp_ExcludeLegacyEvent",
                              "type": 1,
                              "query": "let ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nprint ExcludeLegacyEvent",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            {
                              "id": "5d1a9bc1-34ab-491d-bfa6-f7fc8402f3dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "LogicApp_AggregationType",
                              "type": 1,
                              "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nprint AggregationType=iff(datetime_diff('day',RangeEnd,RangeStart)<=30,\"Daily\",iff(datetime_diff('day',RangeEnd,RangeStart)<=90,\"Weekly\",\"Monthly\"))\r\n\r\n\r\n\r\n\r\n\r\n",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            {
                              "id": "892dcb11-ee52-478b-aac2-10892fb837ae",
                              "version": "KqlParameterItem/1.0",
                              "name": "LogicApp_TimeRangeInDays",
                              "type": 1,
                              "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = startofday({TimeRange:end});\r\nprint TimeRangeInDays = datetime_diff('day',RangeEnd,RangeStart)\r\n\r\n",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "60",
                        "conditionalVisibility": {
                          "parameterName": "Workspaces",
                          "comparison": "isNotEqualTo"
                        },
                        "name": "Overview-ReportParameterBlock - Copy",
                        "styleSettings": {
                          "maxWidth": "100%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "RecoveryServicesResources\r\n| where type == \"microsoft.recoveryservices/vaults/backupjobs\"\r\n| where properties.backupManagementType == \"AzureIaasVM\"\r\n| where todatetime(properties.startTime) {TimeRange}\r\n| where properties.status != \"InProgress\"\r\n| extend vaultId = tolower(replace(\"\\\\/backupJobs.*\",\"\",id))\r\n| extend SubText = \"Jobs\"\r\n| summarize c=count() by status = tostring(properties.status)\r\n| sort by status asc\r\n",
                          "size": 4,
                          "title": "By Status",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Completed",
                                "color": "green"
                              },
                              {
                                "seriesName": "Failed",
                                "color": "redBright"
                              },
                              {
                                "seriesName": "CompletedWithWarnings",
                                "label": "Completed With Warnings",
                                "color": "yellow"
                              }
                            ]
                          }
                        },
                        "customWidth": "50",
                        "name": "By Status"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "RecoveryServicesResources\r\n| where type == \"microsoft.recoveryservices/vaults/backupjobs\"\r\n| where properties.backupManagementType == \"AzureIaasVM\"\r\n| where todatetime(properties.startTime) {TimeRange}\r\n| where properties.status != \"InProgress\"\r\n| extend vaultId = tolower(replace(\"\\\\/backupJobs.*\",\"\",id))\r\n| extend SubText = \"Jobs\"\r\n| summarize c=count() by operation = tostring(properties.operation)\r\n| sort by operation asc",
                          "size": 4,
                          "title": "By Operation",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Backup",
                                "color": "green"
                              },
                              {
                                "seriesName": "DeleteBackupData",
                                "color": "red"
                              },
                              {
                                "seriesName": "ConfigureBackup",
                                "color": "blue"
                              },
                              {
                                "seriesName": "Restore",
                                "color": "greenDark"
                              },
                              {
                                "seriesName": "DisableBackup",
                                "color": "gray"
                              }
                            ]
                          }
                        },
                        "customWidth": "50",
                        "name": "By Operation"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 9,
                                    "content": {
                                      "version": "KqlParameterItem/1.0",
                                      "crossComponentResources": [
                                        "{Workspaces}"
                                      ],
                                      "parameters": [
                                        {
                                          "id": "24608a3f-634b-4f4f-87cc-998a00636eeb",
                                          "version": "KqlParameterItem/1.0",
                                          "name": "JobTab_SearchBackupInstanceOrDatasourceSet",
                                          "label": "Search Instance or Container",
                                          "type": 1,
                                          "description": "Use to search for a backup instance by name. <br/> To search for a specific instance in a container, use the syntax [container name];[instance name] <br/> To search for all instances in a container, use the syntax [container name];",
                                          "timeContext": {
                                            "durationMs": 604800000
                                          },
                                          "timeContextFromParameter": "TimeRange",
                                          "value": ""
                                        },
                                        {
                                          "id": "71c5a2f9-67e4-48d4-aec3-4c4116f04acd",
                                          "version": "KqlParameterItem/1.0",
                                          "name": "JobTab_JobOperation",
                                          "label": "Job Operation",
                                          "type": 2,
                                          "description": "Use to filter by Job Operation",
                                          "isRequired": true,
                                          "multiSelect": true,
                                          "quote": "",
                                          "delimiter": ",",
                                          "query": "// Function Params\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\nlet ProtectionInfoList = \"*\";\r\nlet Item_search =  @\"{JobTab_SearchBackupInstanceOrDatasourceSet}\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet JobOperationList = \"*\"; \r\nlet JobStatusList = \"*\";\r\nlet JobFailureCodeList = \"*\";\r\nlet ExcludeLog = true; \r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n| distinct OperationCategory",
                                          "crossComponentResources": [
                                            "{Workspaces}"
                                          ],
                                          "value": [
                                            "value::all"
                                          ],
                                          "typeSettings": {
                                            "additionalResourceOptions": [
                                              "value::all"
                                            ],
                                            "selectAllValue": "*",
                                            "showDefault": false
                                          },
                                          "timeContext": {
                                            "durationMs": 0
                                          },
                                          "timeContextFromParameter": "TimeRange",
                                          "queryType": 0,
                                          "resourceType": "microsoft.operationalinsights/workspaces"
                                        },
                                        {
                                          "id": "49be13b9-6869-4cb2-94e0-b122508d1efb",
                                          "version": "KqlParameterItem/1.0",
                                          "name": "JobTab_JobStatus",
                                          "label": "Job Status",
                                          "type": 2,
                                          "description": "Use to filter by Job Status",
                                          "isRequired": true,
                                          "multiSelect": true,
                                          "quote": "",
                                          "delimiter": ",",
                                          "value": [
                                            "value::all"
                                          ],
                                          "typeSettings": {
                                            "additionalResourceOptions": [
                                              "value::all"
                                            ],
                                            "selectAllValue": "*",
                                            "showDefault": false
                                          },
                                          "jsonData": "[\r\n    { \"value\":\"Completed\", \"label\":\"Succeeded\" },\r\n    { \"value\":\"Failed\", \"label\":\"Failed\"  },\r\n    { \"value\":\"CompletedWithWarnings\",   \"label\":\"SucceededWithWarnings\"  },\r\n    { \"value\":\"Cancelled\", \"label\":\"Cancelled\" }\r\n]",
                                          "timeContext": {
                                            "durationMs": 604800000
                                          },
                                          "timeContextFromParameter": "TimeRange"
                                        },
                                        {
                                          "id": "84fef06a-bc14-40e3-a6c5-68647b3f5474",
                                          "version": "KqlParameterItem/1.0",
                                          "name": "JobTab_JobFailureCode",
                                          "label": "Job Failure Code",
                                          "type": 2,
                                          "description": "Use to filter by Job Failure Code",
                                          "isRequired": true,
                                          "multiSelect": true,
                                          "quote": "",
                                          "delimiter": ",",
                                          "query": "// Function Params\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\nlet ProtectionInfoList = \"*\";\r\nlet Item_search =  @\"{JobTab_SearchBackupInstanceOrDatasourceSet}\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet JobOperationList = todynamic( @\"{JobTab_JobOperation}\"); \r\nlet JobStatusList = todynamic( @\"{JobTab_JobStatus}\");\r\nlet JobFailureCodeList = \"*\";\r\nlet ExcludeLog = true; \r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n| distinct ErrorTitle\r\n| where not (ErrorTitle == \"Success\" or ErrorTitle == \"\")",
                                          "crossComponentResources": [
                                            "{Workspaces}"
                                          ],
                                          "value": [
                                            "value::all"
                                          ],
                                          "typeSettings": {
                                            "additionalResourceOptions": [
                                              "value::all"
                                            ],
                                            "selectAllValue": "*",
                                            "showDefault": false
                                          },
                                          "timeContext": {
                                            "durationMs": 0
                                          },
                                          "timeContextFromParameter": "TimeRange",
                                          "queryType": 0,
                                          "resourceType": "microsoft.operationalinsights/workspaces"
                                        }
                                      ],
                                      "style": "pills",
                                      "doNotRunWhenHidden": true,
                                      "queryType": 0,
                                      "resourceType": "microsoft.operationalinsights/workspaces"
                                    },
                                    "conditionalVisibilities": [
                                      {
                                        "parameterName": "Workspaces",
                                        "comparison": "isNotEqualTo"
                                      },
                                      {
                                        "parameterName": "DatasourceType",
                                        "comparison": "isNotEqualTo"
                                      }
                                    ],
                                    "name": "JobDistribution-TopParameterBlock"
                                  },
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "________________________"
                                    },
                                    "conditionalVisibilities": [
                                      {
                                        "parameterName": "Workspaces",
                                        "comparison": "isNotEqualTo"
                                      },
                                      {
                                        "parameterName": "DatasourceType",
                                        "comparison": "isNotEqualTo"
                                      }
                                    ],
                                    "name": "JobDistribution-DividingLine1"
                                  },
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end})); \r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet Item_search =  @\"{JobTab_SearchBackupInstanceOrDatasourceSet}\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet JobOperationList = todynamic( @\"{JobTab_JobOperation}\"); \r\nlet JobStatusList = todynamic( @\"{JobTab_JobStatus}\");\r\nlet JobFailureCodeList = todynamic( @\"{JobTab_JobFailureCode}\");\r\nlet ExcludeLog = true; \r\n// query to transform function output\r\nlet LatestJobTable =  materialize(\r\n// calling LA System Function\r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n| summarize by JobStatus = Status, JobUniqueId = UniqueId); \r\nlet JobSuccessPercent = LatestJobTable\r\n| extend success=iff((JobStatus == \"Completed\" or JobStatus == \"CompletedWithWarnings\") , 1 , 0)\r\n| extend record = 1 // to be used for total row count\r\n| summarize SuccessfulCount =sum(success), TotalCount=sum(record)\r\n| extend JobSuccessPercentage = (SuccessfulCount*100)/todouble(TotalCount)\r\n| project JobSuccessPercentage = iff( (isnan(JobSuccessPercentage) or isinf(JobSuccessPercentage) or isempty(JobSuccessPercentage)), \"-\", tostring(JobSuccessPercentage)) \r\n| extend  Key = pack_array(\"Success %\"), Value = pack_array(JobSuccessPercentage), Row = pack_array(0)\r\n| project Key, Value, Row\r\n| mvexpand  Key, Value, Row; \r\nlet JobStatusEnum = datatable (JobStatus:string, statusOrder:int, CustomJobStatus:string)\r\n    [ \"Completed\", 1, \"Succeeded\",\r\n      \"CompletedWithWarnings\", 2, \"SucceededWithWarnings\",\r\n      \"Failed\", 3, \"Failed\",\r\n      \"Cancelled\", 4, \"Cancelled\"];\r\nlet JobStatusTable = JobStatusEnum\r\n| join kind= leftouter (LatestJobTable | summarize dcount(JobUniqueId, 4) by JobStatus) \r\non JobStatus\r\n| project  JobStatus = CustomJobStatus, JobCount = (iff(isempty(dcount_JobUniqueId), 0, dcount_JobUniqueId)), statusOrder\r\n| order by statusOrder asc\r\n| extend  Key = pack_array(JobStatus), Value = pack_array( JobCount), Row = pack_array(statusOrder)\r\n| project Key, Value, Row\r\n| mvexpand  Key, Value, Row;\r\nunion  JobStatusTable, JobSuccessPercent \r\n| order by toint(Row) asc",
                                      "size": 3,
                                      "noDataMessage": "No records found for the selected time range and scope",
                                      "timeContextFromParameter": "TimeRange",
                                      "queryType": 0,
                                      "resourceType": "microsoft.operationalinsights/workspaces",
                                      "crossComponentResources": [
                                        "{Workspaces}"
                                      ],
                                      "visualization": "tiles",
                                      "tileSettings": {
                                        "titleContent": {
                                          "columnMatch": "Key",
                                          "formatter": 1,
                                          "formatOptions": {
                                            "showIcon": true
                                          }
                                        },
                                        "subtitleContent": {
                                          "columnMatch": "SubTitle",
                                          "formatter": 1,
                                          "formatOptions": {
                                            "showIcon": true
                                          }
                                        },
                                        "leftContent": {
                                          "columnMatch": "Value",
                                          "formatter": 1,
                                          "formatOptions": {
                                            "showIcon": true
                                          },
                                          "numberFormat": {
                                            "unit": 0,
                                            "options": {
                                              "style": "decimal",
                                              "maximumFractionDigits": 2
                                            }
                                          }
                                        },
                                        "showBorder": true,
                                        "sortCriteriaField": "Key",
                                        "sortOrderField": 2
                                      }
                                    },
                                    "conditionalVisibilities": [
                                      {
                                        "parameterName": "Workspaces",
                                        "comparison": "isNotEqualTo"
                                      },
                                      {
                                        "parameterName": "DatasourceType",
                                        "comparison": "isNotEqualTo"
                                      }
                                    ],
                                    "name": "JobDistribution-Tiles",
                                    "styleSettings": {
                                      "margin": "-10px 0% 0% -15px"
                                    }
                                  },
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "_____________________________"
                                    },
                                    "conditionalVisibilities": [
                                      {
                                        "parameterName": "TabName",
                                        "comparison": "isEqualTo",
                                        "value": "JobDistribution"
                                      },
                                      {
                                        "parameterName": "Workspaces",
                                        "comparison": "isNotEqualTo"
                                      },
                                      {
                                        "parameterName": "DatasourceType",
                                        "comparison": "isNotEqualTo"
                                      }
                                    ],
                                    "name": "JobDistribution-DividingLine2"
                                  },
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "____________________________"
                                    },
                                    "conditionalVisibilities": [
                                      {
                                        "parameterName": "Workspaces",
                                        "comparison": "isNotEqualTo"
                                      },
                                      {
                                        "parameterName": "DatasourceType",
                                        "comparison": "isNotEqualTo"
                                      }
                                    ],
                                    "name": "JobDistribution-DividingLine3"
                                  },
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "<div style=\"text-align:left\"><span style=\"font-size:14px;font-weight:600;\">Distribution of Jobs in Period by Backup Item </span> </div>"
                                    },
                                    "conditionalVisibilities": [
                                      {
                                        "parameterName": "Workspaces",
                                        "comparison": "isNotEqualTo",
                                        "value": ""
                                      },
                                      {
                                        "parameterName": "DatasourceType",
                                        "comparison": "isNotEqualTo"
                                      }
                                    ],
                                    "name": "JobDistribution-Grid2Title",
                                    "styleSettings": {
                                      "margin": "0% 0% 10px 0%"
                                    }
                                  },
                                  {
                                    "type": 9,
                                    "content": {
                                      "version": "KqlParameterItem/1.0",
                                      "parameters": [
                                        {
                                          "id": "5dc2a074-b510-44f2-9530-cfcbd159b59c",
                                          "version": "KqlParameterItem/1.0",
                                          "name": "JobTab_SortBy",
                                          "label": "Sort By",
                                          "type": 2,
                                          "description": "Use to sort by a certain column",
                                          "isRequired": true,
                                          "typeSettings": {
                                            "additionalResourceOptions": [],
                                            "showDefault": false
                                          },
                                          "jsonData": "[{ \"value\": \"FailureCount\", \"label\": \"# Jobs Failed\" },\r\n{ \"value\": \"AvgDataTransferred\", \"label\": \"Avg data transferred (MB)\" }, \r\n{ \"value\": \"AvgJobDuration\", \"label\": \"Avg Job Duration (hrs)\" },\r\n{ \"value\": \"SuccessPercent\", \"label\": \"Job Success %\", \"selected\": \"true\" }]",
                                          "timeContext": {
                                            "durationMs": 0
                                          },
                                          "timeContextFromParameter": "TimeRange",
                                          "value": "AvgDataTransferred"
                                        },
                                        {
                                          "id": "df3cc03c-53f7-4523-a29b-e50bf1b6d922",
                                          "version": "KqlParameterItem/1.0",
                                          "name": "JobTab_Order",
                                          "label": "Order",
                                          "type": 2,
                                          "description": "Use to specify the sort order: Ascending/Descending",
                                          "isRequired": true,
                                          "typeSettings": {
                                            "additionalResourceOptions": [],
                                            "showDefault": false
                                          },
                                          "jsonData": "[\r\n    { \"value\":\"Ascending\", \"selected\":true},\r\n    { \"value\":\"Descending\"}\r\n]",
                                          "timeContext": {
                                            "durationMs": 0
                                          },
                                          "timeContextFromParameter": "TimeRange",
                                          "value": "Descending"
                                        },
                                        {
                                          "id": "2033073e-5e18-4e0f-a543-a03b98874d8d",
                                          "version": "KqlParameterItem/1.0",
                                          "name": "JobTab_RowsPerPage",
                                          "label": "Rows per Page",
                                          "type": 2,
                                          "description": "Number of rows to display in grid view",
                                          "isRequired": true,
                                          "typeSettings": {
                                            "additionalResourceOptions": [],
                                            "showDefault": false
                                          },
                                          "jsonData": "[\r\n    { \"value\":10, \"label\":\"10\", \"selected\":true  },\r\n    { \"value\":25, \"label\":\"25\" },\r\n    { \"value\":50, \"label\":\"50\" },\r\n    { \"value\":100, \"label\":\"100\" },\r\n    { \"value\":250, \"label\":\"250\" },\r\n    { \"value\":500, \"label\":\"500\" },\r\n    { \"value\":1000, \"label\":\"1000\" }\r\n]",
                                          "timeContext": {
                                            "durationMs": 0
                                          },
                                          "timeContextFromParameter": "TimeRange"
                                        },
                                        {
                                          "id": "356e4bfd-7e3d-4e48-89c0-b03efb72b9dc",
                                          "version": "KqlParameterItem/1.0",
                                          "name": "JobTab_Page",
                                          "label": "Page",
                                          "type": 2,
                                          "description": "Select Page Number",
                                          "isRequired": true,
                                          "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet Item_search =  @\"{JobTab_SearchBackupInstanceOrDatasourceSet}\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet JobOperationList = todynamic( @\"{JobTab_JobOperation}\"); \r\nlet JobStatusList = todynamic( @\"{JobTab_JobStatus}\");\r\nlet JobFailureCodeList = todynamic( @\"{JobTab_JobFailureCode}\");\r\nlet ExcludeLog = true; \r\nlet DisplayAllFields = false;\r\n// calling LA System Function\r\n_AzureBackup_GetBackupInstances(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n| summarize \r\nBackupInstanceFriendlyName = any(FriendlyName),  DatasourceSetFriendlyName = any(DatasourceSetFriendlyName),  DatasourceType = any(DatasourceType),  VaultResourceId = any(VaultResourceId), BackupInstanceId=any(Id), DatasourceResourceId=any(DatasourceResourceId) , DatasourceSetResourceId=any(DatasourceSetResourceId) by BackupInstanceUniqueId = UniqueId\r\n| join kind = leftouter(\r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n) on BackupInstanceUniqueId\r\n// query to transform function output\r\n| extend failed=iff(Status == \"Failed\" , 1 , 0)\r\n| extend record = iff(UniqueId != \"\", 1, 0)  // to be used for total row count\r\n| summarize FailureCount =sum(failed), TotalCount=sum(record), AvgDataTransferred =avg(DataTransferredInMBs), AvgJobDuration = avg(DurationInSecs)/3600, \r\nBackupItemFriendlyName = any(BackupInstanceFriendlyName), BackupInstance = any(BackupInstanceFriendlyName), Container = any(DatasourceSetFriendlyName),  DatasourceType = any(DatasourceType),  ResourceId = any(VaultResourceId), BackupInstanceId=any(BackupInstanceId), ResourceGroup=any(DatasourceResourceId) , AzureResource=any(DatasourceSetResourceId) by BackupInstanceUniqueId\r\n| summarize c=count()\r\n| project num = (c-1)/{JobTab_RowsPerPage} + 1\r\n| project nums = range(1,num,1), num\r\n| mvexpand nums\r\n| project nums = tostring(nums), num = strcat(tostring(nums),\" of \",tostring(num))",
                                          "crossComponentResources": [
                                            "{Workspaces}"
                                          ],
                                          "value": "1",
                                          "typeSettings": {
                                            "additionalResourceOptions": [],
                                            "showDefault": false
                                          },
                                          "queryType": 0,
                                          "resourceType": "microsoft.operationalinsights/workspaces"
                                        }
                                      ],
                                      "style": "pills",
                                      "doNotRunWhenHidden": true,
                                      "queryType": 0,
                                      "resourceType": "microsoft.operationalinsights/workspaces"
                                    },
                                    "customWidth": "90",
                                    "conditionalVisibilities": [
                                      {
                                        "parameterName": "Workspaces",
                                        "comparison": "isNotEqualTo"
                                      },
                                      {
                                        "parameterName": "DatasourceType",
                                        "comparison": "isNotEqualTo"
                                      }
                                    ],
                                    "name": "parameters - 7",
                                    "styleSettings": {
                                      "margin": "-23px 0% 0% 0%",
                                      "padding": "0% 0% 0% 0%"
                                    }
                                  },
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet Item_search =  @\"{JobTab_SearchBackupInstanceOrDatasourceSet}\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet JobOperationList = todynamic( @\"{JobTab_JobOperation}\"); \r\nlet JobStatusList = todynamic( @\"{JobTab_JobStatus}\");\r\nlet JobFailureCodeList = todynamic( @\"{JobTab_JobFailureCode}\");\r\nlet ExcludeLog = true; \r\nlet DisplayAllFields = false;\r\n// calling LA System Function\r\n_AzureBackup_GetBackupInstances(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n| summarize \r\nBackupInstanceFriendlyName = any(FriendlyName),  DatasourceSetFriendlyName = any(DatasourceSetFriendlyName),  DatasourceType = any(DatasourceType),  VaultResourceId = any(VaultResourceId), BackupInstanceId=any(Id), DatasourceResourceId=any(DatasourceResourceId) , DatasourceSetResourceId=any(DatasourceSetResourceId) by BackupInstanceUniqueId = UniqueId\r\n| join kind = leftouter(\r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n) on BackupInstanceUniqueId\r\n// query to transform function output\r\n| extend failed=iff(Status == \"Failed\" , 1 , 0)\r\n| extend record = iff(UniqueId != \"\", 1, 0)  // to be used for total row count\r\n| summarize FailureCount =sum(failed), TotalCount=sum(record), AvgDataTransferred =avg(DataTransferredInMBs), AvgJobDuration = avg(DurationInSecs)/3600, \r\nBackupItemFriendlyName = any(BackupInstanceFriendlyName), BackupInstance = any(BackupInstanceFriendlyName), Container = any(DatasourceSetFriendlyName),  DatasourceType = any(DatasourceType),  ResourceId = any(VaultResourceId), BackupInstanceId=any(BackupInstanceId), ResourceGroup=any(DatasourceResourceId) , AzureResource=any(DatasourceSetResourceId) by BackupInstanceUniqueId\r\n| extend SuccessPercent = ((TotalCount - FailureCount) *100)/todouble(TotalCount)\r\n| extend TempColumn = column_ifexists(tostring('{JobTab_SortBy}'), \"SuccessPercent\")\r\n| extend ColumnToBeSorted = iff(tostring('{JobTab_Order}') == \"Ascending\", todouble(TempColumn) - 90000000, 90000000 - todouble(TempColumn))\r\n| sort by ColumnToBeSorted asc nulls last, BackupInstanceUniqueId asc\r\n| extend row_num = row_number()\r\n| extend page_num = tostring(((row_num-1)/{JobTab_RowsPerPage} + 1))\r\n| where page_num has ('{JobTab_Page}') or '*' in ('{JobTab_Page}')\r\n| project BackupInstanceUniqueId, BackupInstance, BackupInstanceId, Container, ResourceGroup=iff(DatasourceType==\"Azure Backup Agent\" or DatasourceType==\"Azure Backup Server\" or DatasourceType==\"DPM\",\"(none)\",split(split(tostring(tolower(AzureResource)), '/resourcegroups/')[1],'/')[0]\r\n), JobsFailed=FailureCount, JobSuccessPercent=iff( (isnan(SuccessPercent) or isinf(SuccessPercent) or isempty(SuccessPercent)), \"-\", strcat(tostring(round(SuccessPercent,2)), \" %\")), AvgDataTransferred, AvgJobDuration, AzureResource ",
                                      "size": 3,
                                      "noDataMessage": "No records found for the selected time range and scope",
                                      "exportFieldName": "BackupInstanceUniqueId",
                                      "exportParameterName": "JobTab_SearchBackupInstanceUniqueId",
                                      "exportDefaultValue": "*",
                                      "showExportToExcel": true,
                                      "queryType": 0,
                                      "resourceType": "microsoft.operationalinsights/workspaces",
                                      "crossComponentResources": [
                                        "{Workspaces}"
                                      ],
                                      "gridSettings": {
                                        "formatters": [
                                          {
                                            "columnMatch": "BackupInstanceUniqueId",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "BackupInstance",
                                            "formatter": 16,
                                            "formatOptions": {
                                              "linkColumn": "BackupInstanceId",
                                              "linkTarget": "Resource",
                                              "showIcon": true,
                                              "customColumnWidthSetting": "15%"
                                            },
                                            "tooltipFormat": {
                                              "tooltip": "Name of the backup instance"
                                            }
                                          },
                                          {
                                            "columnMatch": "BackupInstanceId",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "Container",
                                            "formatter": 0,
                                            "formatOptions": {
                                              "customColumnWidthSetting": "15%"
                                            },
                                            "tooltipFormat": {
                                              "tooltip": "Protected container associated with the backup instance"
                                            }
                                          },
                                          {
                                            "columnMatch": "ResourceGroup",
                                            "formatter": 0,
                                            "formatOptions": {
                                              "customColumnWidthSetting": "15%"
                                            },
                                            "tooltipFormat": {
                                              "tooltip": "Resource group associated with the backup instance"
                                            }
                                          },
                                          {
                                            "columnMatch": "JobsFailed",
                                            "formatter": 4,
                                            "formatOptions": {
                                              "min": 0,
                                              "palette": "blue",
                                              "customColumnWidthSetting": "15%"
                                            },
                                            "tooltipFormat": {
                                              "tooltip": "Number of jobs (that were triggered in the selected time range) that failed for the given backup instance"
                                            }
                                          },
                                          {
                                            "columnMatch": "JobSuccessPercent",
                                            "formatter": 1,
                                            "formatOptions": {
                                              "customColumnWidthSetting": "15%"
                                            },
                                            "tooltipFormat": {
                                              "tooltip": "% of jobs (that were triggered in the selected time range) on the backup instance that were successful"
                                            }
                                          },
                                          {
                                            "columnMatch": "AvgDataTransferred",
                                            "formatter": 4,
                                            "formatOptions": {
                                              "min": 0,
                                              "palette": "blue",
                                              "customColumnWidthSetting": "15%"
                                            },
                                            "numberFormat": {
                                              "unit": 0,
                                              "options": {
                                                "style": "decimal",
                                                "minimumFractionDigits": 2,
                                                "maximumFractionDigits": 2
                                              }
                                            },
                                            "tooltipFormat": {
                                              "tooltip": "Avg data transferred by jobs (that were triggered in the selected time range) on the given backup instance"
                                            }
                                          },
                                          {
                                            "columnMatch": "AvgJobDuration",
                                            "formatter": 4,
                                            "formatOptions": {
                                              "min": 0,
                                              "palette": "blue",
                                              "customColumnWidthSetting": "15%"
                                            },
                                            "numberFormat": {
                                              "unit": 0,
                                              "options": {
                                                "style": "decimal",
                                                "useGrouping": false,
                                                "minimumFractionDigits": 2,
                                                "maximumFractionDigits": 2
                                              }
                                            },
                                            "tooltipFormat": {
                                              "tooltip": "Avg duration of jobs (that were triggered in the selected time range) on the backup instance"
                                            }
                                          },
                                          {
                                            "columnMatch": "AzureResource",
                                            "formatter": 0,
                                            "formatOptions": {
                                              "customColumnWidthSetting": "15%"
                                            },
                                            "tooltipFormat": {
                                              "tooltip": "Azure Resource associated with the backup instance. For Azure VM Backup, SQL in Azure VM backup and SAP database in Azure VM backup, the Azure Resource is the Azure VM. For Azure Files Share backup, the Azure Resource is the Azure Storage account. For on-premises backup instances, this field is blank."
                                            }
                                          }
                                        ],
                                        "filter": true,
                                        "labelSettings": [
                                          {
                                            "columnId": "BackupInstance",
                                            "label": "Backup Instance"
                                          },
                                          {
                                            "columnId": "ResourceGroup",
                                            "label": "Resource Group"
                                          },
                                          {
                                            "columnId": "JobsFailed",
                                            "label": "# Jobs Failed"
                                          },
                                          {
                                            "columnId": "JobSuccessPercent",
                                            "label": "Job Success %"
                                          },
                                          {
                                            "columnId": "AvgDataTransferred",
                                            "label": "Avg Data Transferred (MB)"
                                          },
                                          {
                                            "columnId": "AvgJobDuration",
                                            "label": "Avg Job Duration (hrs)"
                                          },
                                          {
                                            "columnId": "AzureResource",
                                            "label": "Azure Resource"
                                          }
                                        ]
                                      },
                                      "sortBy": []
                                    },
                                    "conditionalVisibilities": [
                                      {
                                        "parameterName": "DatasourceType",
                                        "comparison": "isNotEqualTo"
                                      },
                                      {
                                        "parameterName": "Workspaces",
                                        "comparison": "isNotEqualTo"
                                      }
                                    ],
                                    "showPin": false,
                                    "name": "JobDistribution-Grid1",
                                    "styleSettings": {
                                      "padding": "0% 0% 0% 0%"
                                    }
                                  },
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "<span style=\"font-size:12px;font-style:italic\"> Click on any row above to see details of all jobs for that backup item in the selected time range. </span>"
                                    },
                                    "conditionalVisibilities": [
                                      {
                                        "parameterName": "Workspaces",
                                        "comparison": "isNotEqualTo"
                                      },
                                      {
                                        "parameterName": "DatasourceType",
                                        "comparison": "isNotEqualTo"
                                      }
                                    ],
                                    "name": "JobDetailsPromptText"
                                  },
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "<div style=\"text-align:left\"><span style=\"font-size:14px;font-weight:600;\">List of Jobs in Period</span> </div>"
                                    },
                                    "conditionalVisibilities": [
                                      {
                                        "parameterName": "Workspaces",
                                        "comparison": "isNotEqualTo"
                                      },
                                      {
                                        "parameterName": "JobTab_SearchBackupInstanceUniqueId",
                                        "comparison": "isNotEqualTo",
                                        "value": "*"
                                      },
                                      {
                                        "parameterName": "DatasourceType",
                                        "comparison": "isNotEqualTo"
                                      }
                                    ],
                                    "name": "JobDetails-GridTitle",
                                    "styleSettings": {
                                      "margin": "0% 0% 10px 0%"
                                    }
                                  },
                                  {
                                    "type": 9,
                                    "content": {
                                      "version": "KqlParameterItem/1.0",
                                      "parameters": [
                                        {
                                          "id": "5dc2a074-b510-44f2-9530-cfcbd159b59c",
                                          "version": "KqlParameterItem/1.0",
                                          "name": "JobTab_SortBy_2",
                                          "label": "Sort By",
                                          "type": 2,
                                          "description": "Use to sort by a certain column",
                                          "isRequired": true,
                                          "value": "DurationInSecs",
                                          "typeSettings": {
                                            "additionalResourceOptions": [],
                                            "showDefault": false
                                          },
                                          "jsonData": "[{ \"value\": \"DurationInSecs\", \"label\": \"Job Duration (sec)\" },\r\n{ \"value\": \"DataTransferredInMBs\", \"label\": \"Data Transferred (MB)\", \"selected\": \"true\" }]",
                                          "timeContext": {
                                            "durationMs": 604800000
                                          },
                                          "timeContextFromParameter": "TimeRange"
                                        },
                                        {
                                          "id": "df3cc03c-53f7-4523-a29b-e50bf1b6d922",
                                          "version": "KqlParameterItem/1.0",
                                          "name": "JobTab_Order_2",
                                          "label": "Order",
                                          "type": 2,
                                          "description": "Use to specify the sort order: Ascending/Descending",
                                          "isRequired": true,
                                          "typeSettings": {
                                            "additionalResourceOptions": [],
                                            "showDefault": false
                                          },
                                          "jsonData": "[\r\n    { \"value\":\"Ascending\"},\r\n    { \"value\":\"Descending\", \"selected\":true}\r\n]",
                                          "timeContext": {
                                            "durationMs": 0
                                          },
                                          "timeContextFromParameter": "TimeRange"
                                        },
                                        {
                                          "id": "90453a1f-7fd0-45d4-a2ef-cd36b4a834e0",
                                          "version": "KqlParameterItem/1.0",
                                          "name": "JobTab_RowsPerPage_2",
                                          "label": "Rows per Page",
                                          "type": 2,
                                          "description": "Number of rows to display in grid view",
                                          "isRequired": true,
                                          "typeSettings": {
                                            "additionalResourceOptions": [],
                                            "showDefault": false
                                          },
                                          "jsonData": "[\r\n    { \"value\":10, \"label\":\"10\", \"selected\":true  },\r\n    { \"value\":25, \"label\":\"25\" },\r\n    { \"value\":50, \"label\":\"50\" },\r\n    { \"value\":100, \"label\":\"100\" },\r\n    { \"value\":250, \"label\":\"250\" },\r\n    { \"value\":500, \"label\":\"500\" },\r\n    { \"value\":1000, \"label\":\"1000\" }\r\n]",
                                          "timeContext": {
                                            "durationMs": 0
                                          },
                                          "timeContextFromParameter": "TimeRange"
                                        },
                                        {
                                          "id": "356e4bfd-7e3d-4e48-89c0-b03efb72b9dc",
                                          "version": "KqlParameterItem/1.0",
                                          "name": "JobTab_Page_2",
                                          "label": "Page",
                                          "type": 2,
                                          "description": "Select Page Number",
                                          "isRequired": true,
                                          "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet Item_search =  @\"{JobTab_SearchBackupInstanceOrDatasourceSet}\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet JobOperationList = todynamic( @\"{JobTab_JobOperation}\"); \r\nlet JobStatusList = todynamic( @\"{JobTab_JobStatus}\");\r\nlet JobFailureCodeList = todynamic( @\"{JobTab_JobFailureCode}\");\r\nlet ExcludeLog = true; \r\n// local Params\r\nlet BackupInstanceUniqueIdParam =  @\"{JobTab_SearchBackupInstanceUniqueId}\";\r\n// calling LA System Function\r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n// query to transform function output\r\n| where BackupInstanceUniqueId == (BackupInstanceUniqueIdParam) or '*' in (BackupInstanceUniqueIdParam)\r\n| summarize c=count()\r\n| project num = (c-1)/{JobTab_RowsPerPage_2} + 1\r\n| project nums = range(1,num,1), num\r\n| mvexpand nums\r\n| project nums = tostring(nums), num = strcat(tostring(nums),\" of \",tostring(num))",
                                          "crossComponentResources": [
                                            "{Workspaces}"
                                          ],
                                          "value": "1",
                                          "typeSettings": {
                                            "additionalResourceOptions": [],
                                            "showDefault": false
                                          },
                                          "queryType": 0,
                                          "resourceType": "microsoft.operationalinsights/workspaces"
                                        }
                                      ],
                                      "style": "pills",
                                      "doNotRunWhenHidden": true,
                                      "queryType": 0,
                                      "resourceType": "microsoft.operationalinsights/workspaces"
                                    },
                                    "customWidth": "90",
                                    "conditionalVisibilities": [
                                      {
                                        "parameterName": "Workspaces",
                                        "comparison": "isNotEqualTo"
                                      },
                                      {
                                        "parameterName": "JobTab_SearchBackupInstanceUniqueId",
                                        "comparison": "isNotEqualTo",
                                        "value": "*"
                                      },
                                      {
                                        "parameterName": "DatasourceType",
                                        "comparison": "isNotEqualTo"
                                      }
                                    ],
                                    "name": "JobDistribution-Grid2ParameterBlock",
                                    "styleSettings": {
                                      "margin": "-23px 0% 0% 0%",
                                      "padding": "0% 0% 0% 0%"
                                    }
                                  },
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet Item_search =  @\"{JobTab_SearchBackupInstanceOrDatasourceSet}\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet JobOperationList = todynamic( @\"{JobTab_JobOperation}\"); \r\nlet JobStatusList = todynamic( @\"{JobTab_JobStatus}\");\r\nlet JobFailureCodeList = todynamic( @\"{JobTab_JobFailureCode}\");\r\nlet ExcludeLog = true; \r\n// local Params\r\nlet BackupInstanceUniqueIdParam =  @\"{JobTab_SearchBackupInstanceUniqueId}\";\r\n// calling LA System Function\r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n// query to transform function output\r\n| where BackupInstanceUniqueId == (BackupInstanceUniqueIdParam) or '*' in (BackupInstanceUniqueIdParam)\r\n| extend TempColumn = column_ifexists(tostring('{JobTab_SortBy_2}'), \"DataTransferredInMBs\")\r\n| extend ColumnToBeSorted = iff(tostring('{JobTab_Order_2}') == \"Ascending\", todouble(TempColumn) - 90000000, 90000000 - todouble(TempColumn))\r\n| sort by ColumnToBeSorted asc nulls last, UniqueId asc\r\n| extend row_num = row_number()\r\n| extend page_num = tostring(((row_num-1)/{JobTab_RowsPerPage_2} + 1))\r\n| where page_num has ('{JobTab_Page_2}') or '*' in ('{JobTab_Page_2}')\r\n| project BackupInstance=BackupInstanceFriendlyName, BackupInstanceId, Container=DatasourceSetFriendlyName, ResourceGroup=iff(DatasourceType==\"Azure Backup Agent\" or DatasourceType==\"Azure Backup Server\" or DatasourceType==\"DPM\",\"(none)\",split(split(tostring(tolower(DatasourceSetResourceId)), '/resourcegroups/')[1],'/')[0]\r\n), OperationCategory, JobStatus=Status,  JobStartDateTime=StartTime, JobDuration=DurationInSecs/3600, ErrorTitle, DataTransferred=DataTransferredInMBs, AzureResource=DatasourceSetResourceId, DatasourceType ",
                                      "size": 3,
                                      "noDataMessage": "No records found for the selected time range and scope",
                                      "showExportToExcel": true,
                                      "queryType": 0,
                                      "resourceType": "microsoft.operationalinsights/workspaces",
                                      "crossComponentResources": [
                                        "{Workspaces}"
                                      ],
                                      "gridSettings": {
                                        "formatters": [
                                          {
                                            "columnMatch": "BackupInstance",
                                            "formatter": 16,
                                            "formatOptions": {
                                              "linkColumn": "BackupInstanceId",
                                              "linkTarget": "Resource",
                                              "showIcon": true
                                            },
                                            "tooltipFormat": {
                                              "tooltip": "Name of the backup instance"
                                            }
                                          },
                                          {
                                            "columnMatch": "BackupInstanceId",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "Container",
                                            "formatter": 0,
                                            "tooltipFormat": {
                                              "tooltip": "Protected Container associated with the backup instance"
                                            }
                                          },
                                          {
                                            "columnMatch": "ResourceGroup",
                                            "formatter": 0,
                                            "tooltipFormat": {
                                              "tooltip": "Resource group associated with the backup instance"
                                            }
                                          },
                                          {
                                            "columnMatch": "OperationCategory",
                                            "formatter": 0,
                                            "tooltipFormat": {
                                              "tooltip": "Operation Category"
                                            }
                                          },
                                          {
                                            "columnMatch": "JobStatus",
                                            "formatter": 0,
                                            "tooltipFormat": {
                                              "tooltip": "Job Status"
                                            }
                                          },
                                          {
                                            "columnMatch": "JobStartDateTime",
                                            "formatter": 6,
                                            "numberFormat": {
                                              "unit": 0,
                                              "options": {
                                                "style": "decimal",
                                                "useGrouping": false
                                              }
                                            },
                                            "dateFormat": {
                                              "showUtcTime": true,
                                              "formatName": "shortDateTimePattern"
                                            },
                                            "tooltipFormat": {
                                              "tooltip": "Start date and time of the Job"
                                            }
                                          },
                                          {
                                            "columnMatch": "JobDuration",
                                            "formatter": 4,
                                            "formatOptions": {
                                              "min": 0,
                                              "palette": "blue"
                                            },
                                            "numberFormat": {
                                              "unit": 0,
                                              "options": {
                                                "style": "decimal",
                                                "useGrouping": false,
                                                "minimumFractionDigits": 2,
                                                "maximumFractionDigits": 2
                                              }
                                            },
                                            "tooltipFormat": {
                                              "tooltip": "Job Duration"
                                            }
                                          },
                                          {
                                            "columnMatch": "ErrorTitle",
                                            "formatter": 0,
                                            "tooltipFormat": {
                                              "tooltip": "Job Failure Code"
                                            }
                                          },
                                          {
                                            "columnMatch": "DataTransferred",
                                            "formatter": 4,
                                            "formatOptions": {
                                              "min": 0,
                                              "palette": "blue"
                                            },
                                            "tooltipFormat": {
                                              "tooltip": "Amount of data transferred by the job"
                                            }
                                          },
                                          {
                                            "columnMatch": "AzureResource",
                                            "formatter": 0,
                                            "tooltipFormat": {
                                              "tooltip": "Azure Resource associated with the backup instance. For Azure VM Backup, SQL in Azure VM backup and SAP database in Azure VM backup, the Azure Resource is the Azure VM. For Azure Files Share backup, the Azure Resource is the Azure Storage account. For on-premises backup instances, this field is blank."
                                            }
                                          },
                                          {
                                            "columnMatch": "DatasourceType",
                                            "formatter": 0,
                                            "tooltipFormat": {
                                              "tooltip": "Datasource Type"
                                            }
                                          }
                                        ],
                                        "filter": true,
                                        "labelSettings": [
                                          {
                                            "columnId": "BackupInstance",
                                            "label": "Backup Instance"
                                          },
                                          {
                                            "columnId": "ResourceGroup",
                                            "label": "Resource Group"
                                          },
                                          {
                                            "columnId": "OperationCategory",
                                            "label": "Operation Category"
                                          },
                                          {
                                            "columnId": "JobStatus",
                                            "label": "Job Status"
                                          },
                                          {
                                            "columnId": "JobStartDateTime",
                                            "label": "Job Start Date Time"
                                          },
                                          {
                                            "columnId": "JobDuration",
                                            "label": "Job Duration (hrs)"
                                          },
                                          {
                                            "columnId": "ErrorTitle",
                                            "label": "Job Failure Code"
                                          },
                                          {
                                            "columnId": "DataTransferred",
                                            "label": "Data Transferred (MB)"
                                          },
                                          {
                                            "columnId": "AzureResource",
                                            "label": "Azure Resource"
                                          },
                                          {
                                            "columnId": "DatasourceType",
                                            "label": "Datasource Type"
                                          }
                                        ]
                                      }
                                    },
                                    "conditionalVisibilities": [
                                      {
                                        "parameterName": "Workspaces",
                                        "comparison": "isNotEqualTo"
                                      },
                                      {
                                        "parameterName": "JobTab_SearchBackupInstanceUniqueId",
                                        "comparison": "isNotEqualTo",
                                        "value": "*"
                                      },
                                      {
                                        "parameterName": "DatasourceType",
                                        "comparison": "isNotEqualTo"
                                      }
                                    ],
                                    "showPin": false,
                                    "name": "JobDistribution-Grid2"
                                  }
                                ]
                              },
                              "name": "group - 0"
                            }
                          ]
                        },
                        "conditionalVisibilities": [
                          {
                            "parameterName": "Workspaces",
                            "comparison": "isNotEqualTo"
                          },
                          {
                            "parameterName": "DatasourceType",
                            "comparison": "isNotEqualTo"
                          }
                        ],
                        "name": "jobs-group"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "backuptab",
                    "comparison": "isEqualTo",
                    "value": "jobs"
                  },
                  "name": "Backup Jobs"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "d83391c6-b749-47f9-8fae-3ed79dafe967",
                              "version": "KqlParameterItem/1.0",
                              "name": "Subscription",
                              "label": "Choose Subscription",
                              "type": 6,
                              "description": "Choose a subscription",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "includeAll": true,
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::3"
                            },
                            {
                              "id": "e5ec7b7e-171d-4d90-bc68-fb53f3444837",
                              "version": "KqlParameterItem/1.0",
                              "name": "Workspace",
                              "label": "Choose Workspace",
                              "type": 5,
                              "description": "Choose a LA Workspace",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "Resources\r\n| where type =~ \"Microsoft.operationalinsights/workspaces\"\r\n| summarize by id",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::1",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "value": [
                                "value::all"
                              ]
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "conditionalVisibility": {
                          "parameterName": "Tabname",
                          "comparison": "isNotEqualTo",
                          "value": "summary"
                        },
                        "name": "parameters - 1 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "RecoveryServicesResources\r\n| where type == \"microsoft.recoveryservices/vaults/backupfabrics/protectioncontainers/protecteditems\"\r\n| where properties.backupManagementType == \"AzureIaasVM\"\r\n| extend vaultId = tolower(replace(\"\\\\/backupFabrics.*\",\"\",id))\r\n| summarize c = count() \r\n| extend Item = \"Backup Items\", SubText = \"Total\", Key = 1",
                          "size": 4,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Item",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "c",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": true
                          }
                        },
                        "customWidth": "50",
                        "name": "Jobs"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "RecoveryServicesResources\r\n| where type == \"microsoft.recoveryservices/vaults/backupfabrics/protectioncontainers/protecteditems\"\r\n| where properties.backupManagementType == \"AzureIaasVM\"\r\n| extend vaultId = tolower(replace(\"\\\\/backupFabrics.*\",\"\",id))\r\n| extend ProtectionState = iff(tostring(properties.protectionState) == \"IRPending\", \"Initial Backup Pending\", iff(tostring(properties.protectionState) == \"Protected\", \"Actively Protected\", iff(tostring(properties.protectionState) == \"ProtectionStopped\", \"Protection Stopped\", \"Actively Protected\")))\r\n| summarize BackupItems = count() by ProtectionState\r\n| sort by ProtectionState asc",
                          "size": 4,
                          "title": "Protection State",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Actively Protected",
                                "color": "green"
                              }
                            ]
                          }
                        },
                        "customWidth": "50",
                        "name": "Protection State"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "RecoveryServicesResources\r\n| where type == \"microsoft.recoveryservices/vaults/backupfabrics/protectioncontainers/protecteditems\"\r\n| where properties.backupManagementType == \"AzureIaasVM\"\r\n| extend vaultId = tolower(replace(\"\\\\/backupFabrics.*\",\"\",id))\r\n| extend a = split(tolower(tostring(properties.containerName)),\";\")\r\n| extend a = iff(array_length(a) == 4, tostring(hash(strcat(tolower(subscriptionId), tostring(a[2]), tostring(a[3])))), tostring(hash(strcat(tolower(subscriptionId), tostring(a[1]), tostring(a[2])))))\r\n| project backupItemId = id,\r\n\t\t  Name = replace(\"iaasvmcontainer;\",\"\",replace(\"iaasvmcontainerv2;\",\"\",tolower(tostring(properties.containerName)))),\r\n          ProtectionState = iff(tostring(properties.protectionState) == \"IRPending\", \"Initial Backup Pending\", iff(tostring(properties.protectionState) == \"Protected\", \"Actively Protected\", iff(tostring(properties.protectionState) == \"ProtectionStopped\", \"Protection Stopped\", \"Actively Protected\"))),\r\n          \r\n\t\t  HealthCheck = tostring(properties.healthStatus),\r\n\t\t  LastBackup = iff(isempty(tostring(properties.lastBackupStatus)),\"Unknown\",tostring(properties.lastBackupStatus)), \r\n\t\t  LastBackupTime = properties.lastBackupTime,\r\n          LastRecoveryPoint = properties.lastRecoveryPoint,\r\n\t\t  backupItemHostId = properties.sourceResourceId,\r\n\t\t  Host = iff(tostring(properties.protectedItemType) contains \"classic\", \"Classic VM\", \"VM\"),\r\n\t\t  policyId = tolower(tostring(properties.policyId)),\r\n\t\t  VaultName = replace(\".*\\\\/vaults\\\\/\",\"\",replace(\"\\\\/backupFabrics.*\",\"\",id)),\r\n\t\t  vaultId = replace(\"\\\\/backupFabrics.*\",\"\",id)\r\n\r\n\r\n| project backupItemId,\r\n\t\t  Name,\r\n          Item = tostring(split(Name,\";\")[1]),\r\n          ResourceGroup = tostring(split(Name,\";\")[0]),\r\n       \t\t  HealthCheck,\r\n\t\t  LastBackup, \r\n\t\t  LastBackupTime = todatetime(LastBackupTime),\r\n          LastRecoveryPoint = todatetime(LastRecoveryPoint),\r\n    \r\n\t\t  \t\t  vaultId\r\n| sort by tolower(Item) asc, backupItemId asc\r\n",
                          "size": 3,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "table",
                          "gridSettings": {
                            "filter": true,
                            "sortBy": [
                              {
                                "itemKey": "LastBackup",
                                "sortOrder": 1
                              }
                            ],
                            "labelSettings": [
                              {
                                "columnId": "backupItemId",
                                "label": "Backup Item"
                              },
                              {
                                "columnId": "Name",
                                "label": "Name"
                              },
                              {
                                "columnId": "Item",
                                "label": "Item"
                              },
                              {
                                "columnId": "ResourceGroup",
                                "label": "Resource Group"
                              },
                              {
                                "columnId": "HealthCheck",
                                "label": "Helath Check"
                              },
                              {
                                "columnId": "LastBackup",
                                "label": "Last Backup"
                              },
                              {
                                "columnId": "LastBackupTime",
                                "label": "Last Backup Time"
                              },
                              {
                                "columnId": "LastRecoveryPoint",
                                "label": "Last Recovery Point"
                              },
                              {
                                "columnId": "vaultId",
                                "label": "Vault ID"
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "LastBackup",
                              "sortOrder": 1
                            }
                          ]
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "backuptab",
                    "comparison": "isEqualTo",
                    "value": "items"
                  },
                  "name": "items"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "0c3ce2df-14d5-4c33-a8f6-c3a321dec1e0",
                              "version": "KqlParameterItem/1.0",
                              "name": "Subscription",
                              "label": "Choose Subscription",
                              "type": 6,
                              "description": "Choose a subscription",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "includeAll": true,
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::3"
                            },
                            {
                              "id": "0a9109dd-ab5c-4cfb-9971-66c9152f48a8",
                              "version": "KqlParameterItem/1.0",
                              "name": "Workspace",
                              "label": "Choose Workspace",
                              "type": 5,
                              "description": "Choose a LA Workspace",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "Resources\r\n| where type =~ \"Microsoft.operationalinsights/workspaces\"\r\n| summarize by id",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::all",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "conditionalVisibility": {
                          "parameterName": "Tabname",
                          "comparison": "isNotEqualTo",
                          "value": "summary"
                        },
                        "name": "parameters - 1 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/snapshots\"\r\n| summarize c = count()\r\n| extend Item = \"Snapshot\",  Key = 2",
                          "size": 3,
                          "color": "green",
                          "noDataMessage": "vaultlist",
                          "exportParameterName": "displayeditems",
                          "exportDefaultValue": "vaultlist",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Item",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "c",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              }
                            },
                            "showBorder": true
                          }
                        },
                        "customWidth": "15",
                        "name": "snapshot"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/snapshots\"\r\n| project id  , location ,resourceGroup ,sku\r\n",
                          "size": 3,
                          "color": "green",
                          "noDataMessage": "vaultlist",
                          "exportParameterName": "displayeditems",
                          "exportDefaultValue": "vaultlist",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "table",
                          "gridSettings": {
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "id",
                                "label": "Snapshot Name"
                              },
                              {
                                "columnId": "location",
                                "label": "Location"
                              },
                              {
                                "columnId": "resourceGroup",
                                "label": "Resource Group"
                              },
                              {
                                "columnId": "sku",
                                "label": "SKU"
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Item",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "c",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              }
                            },
                            "showBorder": true
                          }
                        },
                        "name": "snapshot - List"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "backuptab",
                    "comparison": "isEqualTo",
                    "value": "snapshot"
                  },
                  "name": "Snapshot"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "4e6c0062-8388-48ed-9d51-87dce6012e0d",
                              "version": "KqlParameterItem/1.0",
                              "name": "Subscription",
                              "label": "Choose Subscription",
                              "type": 6,
                              "description": "Choose a subscription",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "includeAll": true,
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::3"
                            },
                            {
                              "id": "d32f4df4-51d9-4816-b3d2-a23e18ab65db",
                              "version": "KqlParameterItem/1.0",
                              "name": "Workspace",
                              "label": "Choose Workspace",
                              "type": 5,
                              "description": "Choose a LA Workspace",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "Resources\r\n| where type =~ \"Microsoft.operationalinsights/workspaces\"\r\n| summarize by id",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "value": [
                                "/subscriptions/b661db5b-6c7e-435f-a989-6de3b26c40d3/resourceGroups/DefaultResourceGroup-WEU/providers/Microsoft.OperationalInsights/workspaces/DefaultWorkspace-b661db5b-6c7e-435f-a989-6de3b26c40d3-WEU",
                                "/subscriptions/b17d03eb-4598-4cc2-9046-83a94e7c56ee/resourceGroups/vpk-eun-pr-spk-dmz-rg/providers/Microsoft.OperationalInsights/workspaces/vpk-eun-pr-la-spk-compute"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "conditionalVisibility": {
                          "parameterName": "Tabname",
                          "comparison": "isNotEqualTo",
                          "value": "summary"
                        },
                        "name": "parameters - 1 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.recoveryservices/vaults\"\r\n| summarize c = count()\r\n| extend Item = \"Recovery Vault\",  Key = 2",
                          "size": 3,
                          "color": "green",
                          "noDataMessage": "vaultlist",
                          "exportParameterName": "displayeditem",
                          "exportDefaultValue": "vaultlist",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Item",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "c",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              }
                            },
                            "showBorder": true
                          }
                        },
                        "customWidth": "15",
                        "name": "query - 4 - Copy"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.recoveryservices/vaults\"\r\n| project id , location, resourceGroup, sku",
                                "size": 3,
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "gridSettings": {
                                  "filter": true,
                                  "labelSettings": [
                                    {
                                      "columnId": "id",
                                      "label": "Vault Name"
                                    },
                                    {
                                      "columnId": "location",
                                      "label": "Location"
                                    },
                                    {
                                      "columnId": "resourceGroup",
                                      "label": "Resource Group"
                                    },
                                    {
                                      "columnId": "sku",
                                      "label": "SKU"
                                    }
                                  ]
                                }
                              },
                              "customWidth": "100",
                              "name": "query - 6"
                            }
                          ]
                        },
                        "name": "Recovery Vaults"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "backuptab",
                    "comparison": "isEqualTo",
                    "value": "vault"
                  },
                  "name": "Vault"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 11,
                        "content": {
                          "version": "LinkItem/1.0",
                          "style": "tabs",
                          "links": [
                            {
                              "id": "c510dd50-fbe9-439a-b092-6b6a1e60bc4d",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "Policies",
                              "subTarget": "policylist",
                              "style": "link"
                            },
                            {
                              "id": "c6bfae33-09e2-4b5d-8808-e45a5a369b69",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "Adhearance",
                              "subTarget": "adhearance",
                              "style": "link"
                            }
                          ]
                        },
                        "name": "links - 1"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "parameters": [
                            {
                              "id": "396c89aa-fd11-4736-8eb9-40c10a04be21",
                              "version": "KqlParameterItem/1.0",
                              "name": "AggregationType",
                              "type": 1,
                              "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nprint AggregationType=iff(datetime_diff('day',RangeEnd,RangeStart)<=30,\"Daily\",iff(datetime_diff('day',RangeEnd,RangeStart)<=90,\"Weekly\",\"Monthly\"))\r\n\r\n",
                              "crossComponentResources": [
                                "{Workspaces}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            }
                          ],
                          "style": "above",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "AggregationTypeParam"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "4e6c0062-8388-48ed-9d51-87dce6012e0d",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Subscription",
                                    "label": "Choose Subscription",
                                    "type": 6,
                                    "description": "Choose a subscription",
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "'",
                                    "delimiter": ",",
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::1",
                                        "value::3",
                                        "value::all"
                                      ],
                                      "includeAll": true,
                                      "showDefault": false
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "defaultValue": "value::3"
                                  },
                                  {
                                    "id": "d32f4df4-51d9-4816-b3d2-a23e18ab65db",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Workspace",
                                    "label": "Choose Workspace",
                                    "type": 5,
                                    "description": "Choose a LA Workspace",
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "'",
                                    "delimiter": ",",
                                    "query": "Resources\r\n| where type =~ \"Microsoft.operationalinsights/workspaces\"\r\n| summarize by id",
                                    "crossComponentResources": [
                                      "{Subscription}"
                                    ],
                                    "value": [
                                      "value::all"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::all"
                                      ],
                                      "showDefault": false
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "conditionalVisibility": {
                                "parameterName": "Tabname",
                                "comparison": "isNotEqualTo",
                                "value": "summary"
                              },
                              "name": "parameters - 1 - Copy"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "parameters": [
                                  {
                                    "id": "db5ab575-14f6-44d0-bbb9-71c59d0d86b2",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "PolicyName",
                                    "label": "Search Vault or Policy",
                                    "type": 1,
                                    "description": "Use to filter by Vault or Policy name. <br/> To filter for a specific policy in a specific vault use &lt;vault&gt;;&lt;policy&gt;",
                                    "timeContext": {
                                      "durationMs": 0
                                    },
                                    "timeContextFromParameter": "TimeRange"
                                  },
                                  {
                                    "id": "0588c964-1b62-424b-aef3-34f05435548a",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "HasProtectedItems",
                                    "label": "Has Protected Items?",
                                    "type": 2,
                                    "description": "Use to filter the results only for policies associated with one or more protected items",
                                    "isRequired": true,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    { \"value\":\"All\", \"label\":\"All\", \"selected\": true },\r\n    { \"value\":\"Yes\", \"label\":\"Yes\" },\r\n    { \"value\":\"No\", \"label\":\"No\" }\r\n]",
                                    "timeContext": {
                                      "durationMs": 0
                                    },
                                    "timeContextFromParameter": "TimeRange"
                                  },
                                  {
                                    "id": "2fd2f893-b2e3-44d8-9326-5f6b9564b3c4",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ScheduleFrequency",
                                    "label": "Schedule Frequency",
                                    "type": 2,
                                    "description": "Use to filter by Backup Frequency of the policy",
                                    "isRequired": true,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    { \"value\":\"All\", \"label\":\"All\", \"selected\": true },\r\n    { \"value\":\"Daily\", \"label\":\"Daily\" },\r\n    { \"value\":\"Weekly\", \"label\":\"Weekly\" }\r\n]",
                                    "timeContext": {
                                      "durationMs": 0
                                    },
                                    "timeContextFromParameter": "TimeRange"
                                  },
                                  {
                                    "id": "0b064ac9-d8fa-4985-83e7-8f41dca55f02",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "RetentionSchedule",
                                    "label": "Retention Type",
                                    "type": 2,
                                    "description": "Use to filter policies where selected Retention Type has been defined",
                                    "isRequired": true,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    { \"value\":\"1 == 1\", \"label\":\"All\", \"selected\": true },\r\n    { \"value\":\"isnotempty(DailyRetention)\", \"label\":\"Daily\" },\r\n    { \"value\":\"isnotempty(WeeklyRetention)\", \"label\":\"Weekly\" },\r\n    { \"value\":\"isnotempty(MonthlyRetention)\", \"label\":\"Monthly\" },\r\n    { \"value\":\"isnotempty(YearlyRetention)\", \"label\":\"Yearly\" }\r\n]",
                                    "timeContext": {
                                      "durationMs": 0
                                    },
                                    "timeContextFromParameter": "TimeRange"
                                  },
                                  {
                                    "id": "1d767e68-5daf-4741-afa5-1dd017d68ba2",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "SnapshotRetention",
                                    "type": 2,
                                    "description": "To filter by number of days the backup snapshot is retained for fast restores. Use zero to view rows with no snapshot retention.",
                                    "isRequired": true,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    { \"value\":\"All\", \"label\":\"All\", \"selected\": true },\r\n    { \"value\":\"0\", \"label\":\"0\" },\r\n    { \"value\":\"1\", \"label\":\"1\" },\r\n    { \"value\":\"2\", \"label\":\"2\" },\r\n    { \"value\":\"3\", \"label\":\"3\" },\r\n    { \"value\":\"4\", \"label\":\"4\" },\r\n    { \"value\":\"5\", \"label\":\"5\" }\r\n]",
                                    "timeContext": {
                                      "durationMs": 0
                                    },
                                    "timeContextFromParameter": "TimeRange",
                                    "label": "Snapshot Retention"
                                  }
                                ],
                                "style": "pills",
                                "doNotRunWhenHidden": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources"
                              },
                              "customWidth": "100",
                              "name": "PoliciesStandardParameterBlock",
                              "styleSettings": {
                                "margin": "-10px 0% 0% 0%"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "RecoveryServicesResources\r\n| where type == 'microsoft.recoveryservices/vaults/backuppolicies'\r\n| extend vaultName = case(type == 'microsoft.recoveryservices/vaults/backuppolicies', split(split(id, 'microsoft.recoveryservices/vaults/')[1],'/')[0],type == 'microsoft.recoveryservices/vaults/backuppolicies', split(split(id, 'microsoft.recoveryservices/vaults/')[1],'/')[0],'--')\r\n| extend datasourceType = case(type == 'microsoft.recoveryservices/vaults/backuppolicies', properties.backupManagementType,type == 'microsoft.dataprotection/backupVaults/backupPolicies',properties.datasourceTypes[0],'--')\r\n| project id,name,vaultName,resourceGroup,properties,datasourceType\r\n| where datasourceType == 'AzureIaasVM'\r\n| summarize c = count() \r\n| extend Item = \"Backup Policies\",  Key = 1",
                                "size": 3,
                                "noDataMessageStyle": 5,
                                "exportParameterName": "displayeditem",
                                "exportDefaultValue": "policylist",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Item",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "c",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    }
                                  },
                                  "showBorder": true,
                                  "size": "auto"
                                },
                                "textSettings": {
                                  "style": "bignumber"
                                }
                              },
                              "customWidth": "15",
                              "name": "Backup Policies"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "recoveryservicesresources\r\n| where type == \"microsoft.recoveryservices/vaults/backuppolicies\"\r\n| where properties.backupManagementType == \"AzureIaasVM\"\r\n| extend vaultId = tolower(replace(\"\\\\/backupPolicies.*\",\"\",id))\r\n| extend PolicyId = tolower(id)\r\n| join kind = leftouter\r\n(\r\n    recoveryservicesresources\r\n    | where type == \"microsoft.recoveryservices/vaults/backupfabrics/protectioncontainers/protecteditems\"\r\n\t| where properties.backupManagementType == \"AzureIaasVM\"\r\n    | summarize ProtectedItems = count() by PolicyId = tolower(tostring(properties.policyId))\r\n) on PolicyId\r\n| project id,\r\n          PolicyName = replace(\".*\\\\/backupPolicies\\\\/\",\"\",id),\r\n\t\t  vaultId,\r\n\t\t  VaultName = replace(\".*\\\\/vaults\\\\/\",\"\",vaultId),\r\n\t\t  ProtectedItems,\r\n          RunTime = strcat(tostring(properties.schedulePolicy.scheduleRunTimes[0]),\" \",iff(isempty(tostring(properties.timeZone)),\"UTC\",tostring(properties.timeZone))),\r\n          Frequency = tostring(properties.schedulePolicy.scheduleRunFrequency),\r\n          RunDays = tostring(properties.schedulePolicy.scheduleRunDays),\r\n \t      SnapshotRetention = iff(isempty(tostring(properties.instantRpRetentionRangeInDays)),\"2\",tostring(properties.instantRpRetentionRangeInDays)),\r\n          DailyRetention = tostring(properties.retentionPolicy.dailySchedule.retentionDuration.['count']),\r\n          WeeklyRetention = tostring(properties.retentionPolicy.weeklySchedule.retentionDuration.['count']),\r\n          MonthlyRetention = tostring(properties.retentionPolicy.monthlySchedule.retentionDuration.['count']),\r\n          YearlyRetention = tostring(properties.retentionPolicy.yearlySchedule.retentionDuration.['count']),\r\n\t\t  Daily = \"Daily\", Weekly = \"Weekly\", Monthly = \"Monthly\", Yearly = \"Yearly\"\r\n| where strcat(VaultName,\";\",PolicyName) contains (@\"{PolicyName}\")\r\n| where (isnull(ProtectedItems) and \"{HasProtectedItems}\" == \"No\") or (isnotnull(ProtectedItems) and \"{HasProtectedItems}\" == \"Yes\") or (strcat(tostring(ProtectedItems),\"{HasProtectedItems}\") contains \"All\") \r\n| where Frequency == \"{ScheduleFrequency}\" or strcat(Frequency,\"{ScheduleFrequency}\") contains \"All\"\r\n| where {RetentionSchedule}\r\n| where SnapshotRetention == \"{SnapshotRetention}\" or strcat(SnapshotRetention,\"{SnapshotRetention}\") contains \"All\" or (isempty(SnapshotRetention) and strcat(SnapshotRetention,\"{SnapshotRetention}\") contains \"0\")\r\n| project id, PolicyName, vaultId, ProtectedItems, RunTime, BackupFrequency = Frequency, RunDays, SnapshotRetention,\r\n          DailyRetention = iff(isnotempty(DailyRetention),strcat(DailyRetention,\" days \"),DailyRetention),\r\n\t\t  WeeklyRetention = iff(isnotempty(WeeklyRetention),strcat(WeeklyRetention,\" weeks \"),WeeklyRetention),\r\n\t\t  MonthlyRetention = iff(isnotempty(MonthlyRetention),strcat(MonthlyRetention,\" months \"),MonthlyRetention),\r\n\t\t  YearlyRetention = iff(isnotempty(YearlyRetention),strcat(YearlyRetention,\" years \"),YearlyRetention)\r\n| project id, PolicyName, vaultId, ProtectedItems, SnapshotRetention,\r\n          MaxRetention = iff(isempty(YearlyRetention),iff(isempty(MonthlyRetention),iff(isempty(WeeklyRetention),DailyRetention,WeeklyRetention),MonthlyRetention),YearlyRetention),\r\n\t\t  Retention = strcat(DailyRetention,WeeklyRetention,MonthlyRetention,YearlyRetention), BackupFrequency\r\n| sort by ProtectedItems desc, tolower(PolicyName) asc, id asc\r\n\r\n",
                                "size": 3,
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "gridSettings": {
                                  "filter": true,
                                  "labelSettings": [
                                    {
                                      "columnId": "id",
                                      "label": "Policy"
                                    },
                                    {
                                      "columnId": "PolicyName",
                                      "label": "Name"
                                    },
                                    {
                                      "columnId": "vaultId",
                                      "label": "Vault ID"
                                    },
                                    {
                                      "columnId": "ProtectedItems",
                                      "label": "Protection Status"
                                    },
                                    {
                                      "columnId": "SnapshotRetention",
                                      "label": "Snapshot Retention"
                                    },
                                    {
                                      "columnId": "MaxRetention",
                                      "label": "Max Retention"
                                    },
                                    {
                                      "columnId": "Retention",
                                      "label": "Retention"
                                    },
                                    {
                                      "columnId": "BackupFrequency",
                                      "label": "Backup Frequency"
                                    }
                                  ]
                                }
                              },
                              "customWidth": "100",
                              "name": "query - 5"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "policylist"
                        },
                        "name": "Policy List"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "d1f42f81-eb8f-4653-a0ff-38564d7487b4",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Subscriptions",
                                    "type": 6,
                                    "description": "Subscriptions to filter the list of workspaces",
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "'",
                                    "delimiter": ",",
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::1",
                                        "value::3",
                                        "value::all"
                                      ],
                                      "includeAll": false,
                                      "selectAllValue": "",
                                      "showDefault": false
                                    },
                                    "defaultValue": "value::3"
                                  },
                                  {
                                    "id": "2373a24f-ad32-4909-a7f6-59b373dcde6c",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Workspaces",
                                    "type": 5,
                                    "description": "LA Workspaces configured in vault diagnostic settings",
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "'",
                                    "delimiter": ",",
                                    "query": "where type =~ 'microsoft.operationalinsights/workspaces' | project id",
                                    "crossComponentResources": [
                                      "{Subscriptions}"
                                    ],
                                    "value": [
                                      "/subscriptions/b17d03eb-4598-4cc2-9046-83a94e7c56ee/resourceGroups/vpk-eun-pr-spk-dmz-rg/providers/Microsoft.OperationalInsights/workspaces/vpk-eun-pr-la-spk-compute",
                                      "/subscriptions/b17d03eb-4598-4cc2-9046-83a94e7c56ee/resourceGroups/vpk-eun-pr-hub-network-rg/providers/Microsoft.OperationalInsights/workspaces/vpk-eun-pr-la-hub-infra",
                                      "/subscriptions/b17d03eb-4598-4cc2-9046-83a94e7c56ee/resourceGroups/vpk-eun-pr-hub-cos-rg/providers/Microsoft.OperationalInsights/workspaces/vpk-eun-pr-hub-cos-la",
                                      "/subscriptions/b661db5b-6c7e-435f-a989-6de3b26c40d3/resourceGroups/DefaultResourceGroup-WEU/providers/Microsoft.OperationalInsights/workspaces/DefaultWorkspace-b661db5b-6c7e-435f-a989-6de3b26c40d3-WEU",
                                      "/subscriptions/b661db5b-6c7e-435f-a989-6de3b26c40d3/resourceGroups/vpk-eun-pr-sec-sentinel-rg/providers/Microsoft.OperationalInsights/workspaces/vpk-eun-pr-sec-sentinel-la"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources"
                                  },
                                  {
                                    "id": "64dd748f-d528-4912-a3bf-4a503e0b17f6",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "VaultsUsingAzureDiagnostics",
                                    "type": 1,
                                    "query": "// function Params - Report Filters\r\nlet RangeStart = startofday(ago(3d));\r\nlet RangeEnd = startofday(now());\r\nlet VaultSubscriptionList = \"*\";\r\nlet VaultLocationList = \"*\"; \r\nlet VaultList = \"*\";\r\nlet VaultTypeList = \"*\";\r\nlet ExcludeLegacyEvent_1 = false;\r\nlet ExcludeLegacyEvent_2 = true;\r\n// calling LA System Function\r\n_AzureBackup_GetVaults(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent_1) | distinct Id\r\n| join kind = leftanti ( \r\n// calling LA System Function\r\n_AzureBackup_GetVaults(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent_2) | distinct Id) on Id\r\n| count ",
                                    "crossComponentResources": [
                                      "{Workspaces}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.operationalinsights/workspaces"
                                  },
                                  {
                                    "id": "d894d309-7e5f-488e-afde-73796c84b711",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "AzureStorageCutOffDate",
                                    "type": 1,
                                    "description": "Cut-off Date To Enable AzureStorage",
                                    "isRequired": true,
                                    "query": "{\"version\":\"1.0.0\",\"content\":\"\\\"5/14/2020, 12:00:00.000 AM\\\"\",\"transformers\":null}",
                                    "isHiddenWhenLocked": true,
                                    "queryType": 8
                                  }
                                ],
                                "style": "pills",
                                "doNotRunWhenHidden": true,
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "customWidth": "50",
                              "name": "Overview-WorkspaceParameterBlock"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "crossComponentResources": [
                                  "{Workspaces}"
                                ],
                                "parameters": [
                                  {
                                    "id": "8c4ae44c-fa9a-4498-aedc-736a56e64b43",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TimeRange",
                                    "label": "Time Range",
                                    "type": 4,
                                    "description": "Time Range",
                                    "value": {
                                      "durationMs": 604800000
                                    },
                                    "typeSettings": {
                                      "selectableValues": [
                                        {
                                          "durationMs": 259200000
                                        },
                                        {
                                          "durationMs": 604800000
                                        },
                                        {
                                          "durationMs": 1209600000
                                        },
                                        {
                                          "durationMs": 2419200000
                                        },
                                        {
                                          "durationMs": 2592000000
                                        },
                                        {
                                          "durationMs": 5184000000
                                        },
                                        {
                                          "durationMs": 7776000000
                                        }
                                      ],
                                      "allowCustom": true
                                    },
                                    "timeContext": {
                                      "durationMs": 0
                                    },
                                    "timeContextFromParameter": "TimeRange"
                                  },
                                  {
                                    "id": "78c86854-fe3c-44c5-8ee3-23d4210827d1",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ExcludeLegacyEvent",
                                    "label": "Exclude Legacy Table",
                                    "type": 2,
                                    "description": "Use this parameter to avoid querying data that is sent to the legacy Azure Diagnostics table. Excluding the legacy table improves query performance time. <a href=\"https://docs.microsoft.com/azure/backup/backup-azure-diagnostic-events#legacy-event\">Learn more </a>",
                                    "isRequired": true,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    { \"value\":\"True\",  \"selected\":true},\r\n    { \"value\":\"False\"}\r\n]",
                                    "value": "False"
                                  }
                                ],
                                "style": "pills",
                                "doNotRunWhenHidden": true,
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "customWidth": "36",
                              "conditionalVisibility": {
                                "parameterName": "Workspaces",
                                "comparison": "isNotEqualTo"
                              },
                              "name": "Overview-TimeRangeParameterBlock",
                              "styleSettings": {
                                "maxWidth": "100%"
                              }
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "8ce61d1d-e371-40bf-ad53-7ba78afb976f",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "DatasourceType",
                                    "label": "Backup Solution",
                                    "type": 2,
                                    "description": "Use to filter reports by backup solution",
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "",
                                    "delimiter": ",",
                                    "value": [
                                      "value::all"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::all"
                                      ],
                                      "selectAllValue": "*",
                                      "showDefault": false
                                    },
                                    "jsonData": "\r\n[    \r\n{ \"value\": \"Azure Backup Agent\", \t\t\t\t\t\t\"label\": \"Azure Backup Agent\" },\r\n{ \"value\": \"Azure Backup Server\", \t\t\t\"label\": \"Azure Backup Server\" },\r\n{ \"value\": \"Azure Storage (Azure Files) Backup\", \t\t\t\t\"label\": \"Azure Storage (Azure Files) Backup\" },\r\n{ \"value\": \"Azure Virtual Machine Backup\", \t\t\t\t\t\t\"label\": \"Azure Virtual Machine Backup\" },\r\n{ \"value\": \"DPM\", \t\t\t\t\t\t\"label\": \"DPM\" },\r\n{ \"value\": \"SAP HANA in Azure VM Backup\", \"label\": \"SAP HANA in Azure VM Backup\" },\r\n{ \"value\": \"SQL in Azure VM Backup\",     \"label\": \"SQL in Azure VM Backup\" }\r\n]"
                                  },
                                  {
                                    "id": "678680e5-76b5-4db8-bbef-5f73942caf2e",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "VaultSubscription",
                                    "label": "Subscription Name",
                                    "type": 6,
                                    "description": "Subscription(s) under which the vault(s) exist",
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "",
                                    "delimiter": ",",
                                    "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = \"*\";\r\nlet VaultLocationList = \"*\";\r\nlet VaultList = \"*\";\r\nlet VaultTypeList = \"*\";\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet Item_search =  \"*;*\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet DisplayAllFields = false;\r\n// calling LA System Function\r\n_AzureBackup_GetBackupInstances(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n// query to transform function output\r\n| distinct VaultSubscriptionId",
                                    "crossComponentResources": [
                                      "{Workspaces}"
                                    ],
                                    "value": [
                                      "value::all"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::all"
                                      ],
                                      "selectAllValue": "*",
                                      "showDefault": false
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.operationalinsights/workspaces"
                                  },
                                  {
                                    "id": "2a83acc5-2123-476f-8a4c-da2fddf231a1",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "VaultLocation",
                                    "label": "Vault Location",
                                    "type": 2,
                                    "description": "Location(s) in which the vault(s) were created",
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "",
                                    "delimiter": ",",
                                    "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = \"*\";\r\nlet VaultList = \"*\";\r\nlet VaultTypeList = \"*\";\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet Item_search =  \"*;*\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet DisplayAllFields = false;\r\n// calling LA System Function\r\n_AzureBackup_GetBackupInstances(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n// query to transform function output\r\n| distinct VaultLocation",
                                    "crossComponentResources": [
                                      "{Workspaces}"
                                    ],
                                    "value": [
                                      "value::all"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::all"
                                      ],
                                      "selectAllValue": "*",
                                      "showDefault": false
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.operationalinsights/workspaces"
                                  },
                                  {
                                    "id": "fefd31fa-2774-43ca-8cc3-44d477c969f0",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "VaultName",
                                    "label": "Vault Name",
                                    "type": 2,
                                    "description": "Name(s) of the vault(s)",
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "",
                                    "delimiter": ",",
                                    "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultList = \"*\";\r\nlet VaultTypeList = \"*\";\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\n// calling LA System Function\r\n_AzureBackup_GetVaults(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent)\r\n// query to transform function output\r\n| distinct Name ",
                                    "crossComponentResources": [
                                      "{Workspaces}"
                                    ],
                                    "value": [
                                      "value::all"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::all"
                                      ],
                                      "selectAllValue": "*",
                                      "showDefault": false
                                    },
                                    "queryType": 0,
                                    "resourceType": "microsoft.operationalinsights/workspaces"
                                  }
                                ],
                                "style": "pills",
                                "doNotRunWhenHidden": true,
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "conditionalVisibility": {
                                "parameterName": "Workspaces",
                                "comparison": "isNotEqualTo"
                              },
                              "name": "Overview-ReportParameterBlock"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "crossComponentResources": [
                                  "{Workspaces}"
                                ],
                                "parameters": [
                                  {
                                    "id": "3c5a3e26-bce4-43d9-a22d-e963a0d734af",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ResourceGroupId",
                                    "type": 1,
                                    "query": "resources | where type==\"microsoft.operationalinsights/workspaces\" | project name, resourceGroupId=strcat(\"/subscriptions/\",subscriptionId,\"/resourceGroups/\",resourceGroup) | where \"{Workspaces}\" contains name | project resourceGroupId | take 1",
                                    "crossComponentResources": [
                                      "{Subscriptions}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources"
                                  },
                                  {
                                    "id": "897957ad-a946-4b3b-98f0-02008d30ff0f",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "WorkspaceName",
                                    "type": 1,
                                    "query": "resources | where type==\"microsoft.operationalinsights/workspaces\" \r\n| project name, resourceGroupId=strcat(\"/subscriptions/\",subscriptionId,\"/resourceGroups/\",resourceGroup) \r\n| where \"{Workspaces}\" contains name \r\n| where \"{ResourceGroupId}\" has resourceGroupId\r\n| take 1\r\n",
                                    "crossComponentResources": [
                                      "{Subscriptions}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources"
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "WorkspaceResourceGroup",
                                    "type": 1,
                                    "query": "resources | where type==\"microsoft.operationalinsights/workspaces\" \r\n| project name, resourceGroupId=strcat(\"/subscriptions/\",subscriptionId,\"/resourceGroups/\",resourceGroup), resourceGroup, subscriptionId \r\n| where \"{WorkspaceName}\" has name \r\n| where \"{ResourceGroupId}\" has resourceGroupId\r\n| take 1\r\n| project resourceGroup\r\n",
                                    "crossComponentResources": [
                                      "{Subscriptions}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources",
                                    "id": "75065a95-e81f-470f-805e-427558ee0ea3"
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "WorkspaceSubscriptionId",
                                    "type": 1,
                                    "query": "resources | where type==\"microsoft.operationalinsights/workspaces\" \r\n| project name, resourceGroupId=strcat(\"/subscriptions/\",subscriptionId,\"/resourceGroups/\",resourceGroup), resourceGroup, subscriptionId \r\n| where \"{WorkspaceName}\" has name \r\n| where \"{ResourceGroupId}\" has resourceGroupId\r\n| take 1\r\n| project subscriptionId\r\n",
                                    "crossComponentResources": [
                                      "{Subscriptions}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources",
                                    "id": "2581aa73-ab5f-4f2c-82f1-1b4d0f9708ad"
                                  },
                                  {
                                    "id": "5327529a-bd07-4305-bf65-4b36a3c787b9",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "LogicApp_VaultSubscriptionList",
                                    "type": 1,
                                    "query": "let VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nprint VaultSubscriptionList",
                                    "crossComponentResources": [
                                      "{Workspaces}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.operationalinsights/workspaces"
                                  },
                                  {
                                    "id": "e404488a-5db7-42ba-9b44-996f1d8cd7b2",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "LogicApp_VaultLocationList",
                                    "type": 1,
                                    "query": "let VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nprint VaultLocationList",
                                    "crossComponentResources": [
                                      "{Workspaces}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.operationalinsights/workspaces"
                                  },
                                  {
                                    "id": "8005c310-7839-42ff-a3a4-01e5a6c45223",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "LogicApp_VaultList",
                                    "type": 1,
                                    "query": "let VaultList = todynamic( @\"{VaultName}\"); \r\nprint VaultList",
                                    "crossComponentResources": [
                                      "{Workspaces}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.operationalinsights/workspaces"
                                  },
                                  {
                                    "id": "2e3d4cd7-7393-4cc4-ab9e-793311eb291c",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "LogicApp_DatasourceTypeList",
                                    "type": 1,
                                    "query": "let DatasourceTypeList = @\"{DatasourceType}\";\r\nprint DatasourceTypeList",
                                    "crossComponentResources": [
                                      "{Workspaces}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.operationalinsights/workspaces"
                                  },
                                  {
                                    "id": "376631ff-44ae-4824-b470-ac32d82cd4f2",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "LogicApp_ExcludeLegacyEvent",
                                    "type": 1,
                                    "query": "let ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nprint ExcludeLegacyEvent",
                                    "crossComponentResources": [
                                      "{Workspaces}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.operationalinsights/workspaces"
                                  },
                                  {
                                    "id": "5d1a9bc1-34ab-491d-bfa6-f7fc8402f3dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "LogicApp_AggregationType",
                                    "type": 1,
                                    "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nprint AggregationType=iff(datetime_diff('day',RangeEnd,RangeStart)<=30,\"Daily\",iff(datetime_diff('day',RangeEnd,RangeStart)<=90,\"Weekly\",\"Monthly\"))\r\n\r\n\r\n\r\n\r\n\r\n",
                                    "crossComponentResources": [
                                      "{Workspaces}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.operationalinsights/workspaces"
                                  },
                                  {
                                    "id": "892dcb11-ee52-478b-aac2-10892fb837ae",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "LogicApp_TimeRangeInDays",
                                    "type": 1,
                                    "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = startofday({TimeRange:end});\r\nprint TimeRangeInDays = datetime_diff('day',RangeEnd,RangeStart)\r\n\r\n",
                                    "crossComponentResources": [
                                      "{Workspaces}"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 0,
                                    "resourceType": "microsoft.operationalinsights/workspaces"
                                  }
                                ],
                                "style": "above",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "customWidth": "60",
                              "conditionalVisibility": {
                                "parameterName": "Workspaces",
                                "comparison": "isNotEqualTo"
                              },
                              "name": "Overview-ReportParameterBlock - Copy",
                              "styleSettings": {
                                "maxWidth": "100%"
                              }
                            },
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 12,
                                    "content": {
                                      "version": "NotebookGroup/1.0",
                                      "groupType": "editable",
                                      "items": [
                                        {
                                          "type": 11,
                                          "content": {
                                            "version": "LinkItem/1.0",
                                            "style": "tabs",
                                            "links": [
                                              {
                                                "id": "eb1c9bce-f681-4fd9-939c-9515f911494a",
                                                "cellValue": "PolicyAdherence_SubTab",
                                                "linkTarget": "parameter",
                                                "linkLabel": "Policy Adherence by Time Period",
                                                "subTarget": "Policy Adherence by Time Period",
                                                "preText": "Policy Adherence by Time Period",
                                                "style": "link"
                                              },
                                              {
                                                "id": "d641ca7e-8ca3-4ff9-a536-129243f877b6",
                                                "cellValue": "PolicyAdherence_SubTab",
                                                "linkTarget": "parameter",
                                                "linkLabel": "Policy Adherence by Backup Instance",
                                                "subTarget": "Policy Adherence by Backup Instance",
                                                "style": "link"
                                              }
                                            ]
                                          },
                                          "name": "PolicyAdherenceSubTabs"
                                        },
                                        {
                                          "type": 9,
                                          "content": {
                                            "version": "KqlParameterItem/1.0",
                                            "parameters": [
                                              {
                                                "id": "65975bbd-0ea1-4c4d-ae29-2adb4467ad3f",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherence_DailyOrWeeklyBackup",
                                                "label": "Display Data for",
                                                "type": 2,
                                                "description": "Use to filter for items with daily backup policy or weekly backup policy",
                                                "isRequired": true,
                                                "value": "Daily",
                                                "typeSettings": {
                                                  "additionalResourceOptions": [],
                                                  "showDefault": false
                                                },
                                                "jsonData": "[{ \"value\": \"Daily\", \"label\": \"Items backed up daily\" },\r\n{ \"value\": \"Weekly\", \"label\": \"Items backed up weekly\" }]",
                                                "timeContext": {
                                                  "durationMs": 86400000
                                                }
                                              }
                                            ],
                                            "style": "pills",
                                            "queryType": 0,
                                            "resourceType": "microsoft.operationalinsights/workspaces"
                                          },
                                          "name": "PolicyAdherence-PolicyTypeParameter"
                                        },
                                        {
                                          "type": 1,
                                          "content": {
                                            "json": "<div style=\"text-align:left\"><span style=\"font-size:14px;font-weight:600;\">Count of Backup Instances with atleast one successful backup every day </span> </div>"
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_DailyOrWeeklyBackup",
                                              "comparison": "isEqualTo",
                                              "value": "Daily"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Time Period"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByTimePeriod-DailyBackup-Grid1Title"
                                        },
                                        {
                                          "type": 1,
                                          "content": {
                                            "json": "The below grid is displayed in **Daily view** due to your time range selection. Backup Instances which have had **atleast one successful backup** on a given day fall under the second column in the below table. [Learn more](https://aka.ms/AzureBackupReportDailyBackupDailyView1)",
                                            "style": "info"
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "PolicyAdherence_DailyOrWeeklyBackup",
                                              "comparison": "isEqualTo",
                                              "value": "Daily"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Time Period"
                                            },
                                            {
                                              "parameterName": "AggregationType",
                                              "comparison": "isEqualTo",
                                              "value": "Daily"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByTimePeriod-DailyBackup-AggregationType-Daily-Text"
                                        },
                                        {
                                          "type": 1,
                                          "content": {
                                            "json": "The below grid is displayed in **Weekly view** due to your time range selection. Backup Instances which have had **atleast one successful backup** on every day in the given week fall under the second column in the below table. [Learn more](https://aka.ms/AzureBackupReportDailyBackupWeeklyView1)",
                                            "style": "info"
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "PolicyAdherence_DailyOrWeeklyBackup",
                                              "comparison": "isEqualTo",
                                              "value": "Daily"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Time Period"
                                            },
                                            {
                                              "parameterName": "AggregationType",
                                              "comparison": "isEqualTo",
                                              "value": "Weekly"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByTimePeriod-DailyBackup-AggregationType-Daily-Text - Copy"
                                        },
                                        {
                                          "type": 1,
                                          "content": {
                                            "json": "The below grid is displayed in **Monthly view** due to your time range selection. Backup Instances which have had **atleast one successful backup** on every day in the given month (28 days) fall under the second column in the below table. [Learn more](https://aka.ms/AzureBackupReportDailyBackupMonthlyView1)",
                                            "style": "info"
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "PolicyAdherence_DailyOrWeeklyBackup",
                                              "comparison": "isEqualTo",
                                              "value": "Daily"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Time Period"
                                            },
                                            {
                                              "parameterName": "AggregationType",
                                              "comparison": "isEqualTo",
                                              "value": "Monthly"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByTimePeriod-DailyBackup-AggregationType-Daily-Text - Copy - Copy"
                                        },
                                        {
                                          "type": 3,
                                          "content": {
                                            "version": "KqlItem/1.0",
                                            "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet DisplayAllFields = false;\r\nlet Item_search =  \"*;*\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet JobOperationList = \"Backup\"; \r\nlet JobStatusList = \"*\";\r\nlet JobFailureCodeList = \"*\";\r\nlet ExcludeLog = true; \r\n// Grid specific params\r\nlet bin_Value = iff(@\"{AggregationType}\" == \"Weekly\", 7d, iff(@\"{AggregationType}\" == \"Monthly\", 28d, 1d));\r\nlet sum_isJobSuccessInTheTimePeriod_Value = iff(@\"{AggregationType}\" == \"Weekly\", \"7\", iff(@\"{AggregationType}\" == \"Monthly\", \"28\", \"1\")); \r\nlet duration_Value = iff(@\"{AggregationType}\" == \"Weekly\", \"6.00:00:00\", iff(@\"{AggregationType}\" == \"Monthly\", \"27.00:00:00\", \"00.00:00:00\")); \r\nlet BackupInstanceWithDailyBackup = (){\r\n_AzureBackup_GetBackupInstances(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n| join kind = inner (\r\n// calling LA System Function\r\n_AzureBackup_GetPolicies(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList)\r\n) on $left.PolicyUniqueId == $right.UniqueId, $left.VaultResourceId == $right.VaultResourceId\r\n| where parse_json(ExtendedProperties).BackupFrequency == \"Daily\"\r\n};\r\n// Grid Logic\r\nlet JobInfo = ()\r\n{\r\n// calling LA System Function\r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n| join kind = inner (BackupInstanceWithDailyBackup) on $left.BackupInstanceUniqueId == $right.UniqueId\r\n| summarize jobCount =count(), jobSuccessCount = countif(Status == \"Completed\" or Status == \"CompletedWithWarnings\"), jobFailureCount = countif(Status == \"Failed\" or Status == \"Cancelled\") by BackupInstanceUniqueId, JobCreationDate = startofday(StartTime)\r\n};\r\nJobInfo\r\n| summarize by BackupInstanceUniqueId\r\n| extend Day = range(RangeEnd, RangeStart, -1d)\r\n| mv-expand Day\r\n| project BackupInstanceUniqueId, todatetime(Day)\r\n| join kind = leftouter \r\n( JobInfo\r\n) on BackupInstanceUniqueId, $left.Day == $right.JobCreationDate\r\n// calculating isJobSuccess in the timeperiod to determine if it is successfull throughout the timeperiod\r\n| project BackupInstanceUniqueId, Day, isJobSuccessInTheTimePeriod =iff(isnull(jobCount), 0, iff((jobSuccessCount > 1), 1, jobSuccessCount)), jobFailureCount\r\n| summarize max(Day), min(Day), sum(isJobSuccessInTheTimePeriod), sum(jobFailureCount) by BackupInstanceUniqueId, bin_at(Day, bin_Value, RangeEnd + 1d)\r\n//| where BackupInstanceUniqueId in (\"westus;1541146419693764636;iaasvmcontainerv2;arult-test;cvarshrbac\",\"southeastasia;7777938885731870052;iaasvmcontainerv2;trinadhkselfhostrg;databasevm8\")\r\n| project BackupInstanceUniqueId, Period = iff(@\"{AggregationType}\" == \"Weekly\" or @\"{AggregationType}\" == \"Monthly\", strcat(format_datetime(todatetime(min_Day),\"yyyy/MM/dd\"), \" - \", format_datetime(todatetime(max_Day),\"yyyy/MM/dd\")), format_datetime(todatetime(min_Day),\"yyyy/MM/dd\")), sum_isJobSuccessInTheTimePeriod, sum_jobFailureCount, duration = max_Day - min_Day, Day\r\n// Exclude partial week/month\r\n| where duration == duration_Value\r\n| summarize ItemsWithSuccessfulDailyBackup = countif(sum_isJobSuccessInTheTimePeriod == sum_isJobSuccessInTheTimePeriod_Value), ItemsWithoutSuccessfulDailyBackup = countif(sum_isJobSuccessInTheTimePeriod != sum_isJobSuccessInTheTimePeriod_Value), Day= (any(Day)), sum_jobFailureCount = any(sum_jobFailureCount) by BackupInstanceUniqueId, Period\r\n| summarize ItemsWithSuccessfulDailyBackup = sum(ItemsWithSuccessfulDailyBackup), ItemsWithoutSuccessfulDailyBackup = sum(ItemsWithoutSuccessfulDailyBackup), FailedBackupJobs = sum(sum_jobFailureCount), RangeStartValue = (any(Day)) by Period\r\n| sort by RangeStartValue desc | extend RangeEndValue = RangeStartValue + bin_Value - 1d | extend BackupJobsInPeriod=\"Click to view\"\r\n\r\n\r\n\r\n\r\n",
                                            "size": 3,
                                            "noDataMessage": "No records found for the selected scope and time range",
                                            "exportedParameters": [
                                              {
                                                "fieldName": "RangeEndValue",
                                                "parameterName": "RangeEndValue_PolicyAdherenceTimePeriod_DailyBackup",
                                                "parameterType": 1,
                                                "defaultValue": ""
                                              },
                                              {
                                                "fieldName": "RangeStartValue",
                                                "parameterName": "RangeStartValue_PolicyAdherenceTimePeriod_DailyBackup",
                                                "parameterType": 1,
                                                "defaultValue": "2000-01-01T00:00:00Z"
                                              }
                                            ],
                                            "showExportToExcel": true,
                                            "queryType": 0,
                                            "resourceType": "microsoft.operationalinsights/workspaces",
                                            "crossComponentResources": [
                                              "{Workspaces}"
                                            ],
                                            "gridSettings": {
                                              "formatters": [
                                                {
                                                  "columnMatch": "Period",
                                                  "formatter": 0,
                                                  "formatOptions": {
                                                    "customColumnWidthSetting": "20%"
                                                  },
                                                  "tooltipFormat": {
                                                    "tooltip": "Time Period in UTC"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "ItemsWithSuccessfulDailyBackup",
                                                  "formatter": 0,
                                                  "formatOptions": {
                                                    "customColumnWidthSetting": "20%"
                                                  },
                                                  "tooltipFormat": {
                                                    "tooltip": "Number of backup instances which had atleast one successful backup on all days in the selected time period"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "ItemsWithoutSuccessfulDailyBackup",
                                                  "formatter": 0,
                                                  "formatOptions": {
                                                    "customColumnWidthSetting": "20%"
                                                  },
                                                  "tooltipFormat": {
                                                    "tooltip": "Number of backup instances which did not have atleast one successful backup on all days in the selected time period"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "FailedBackupJobs",
                                                  "formatter": 0,
                                                  "formatOptions": {
                                                    "customColumnWidthSetting": "20%"
                                                  },
                                                  "tooltipFormat": {
                                                    "tooltip": "Number of failed backup jobs in the selected time period"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "RangeStartValue",
                                                  "formatter": 5
                                                },
                                                {
                                                  "columnMatch": "RangeEndValue",
                                                  "formatter": 5
                                                },
                                                {
                                                  "columnMatch": "BackupJobsInPeriod",
                                                  "formatter": 7,
                                                  "formatOptions": {
                                                    "linkTarget": "Url"
                                                  }
                                                }
                                              ],
                                              "filter": true,
                                              "labelSettings": [
                                                {
                                                  "columnId": "Period",
                                                  "label": "Period (UTC)"
                                                },
                                                {
                                                  "columnId": "ItemsWithSuccessfulDailyBackup",
                                                  "label": "# Items with successful daily backup"
                                                },
                                                {
                                                  "columnId": "ItemsWithoutSuccessfulDailyBackup",
                                                  "label": "# Items without successful daily backup"
                                                },
                                                {
                                                  "columnId": "FailedBackupJobs",
                                                  "label": "# Failed backup jobs"
                                                },
                                                {
                                                  "columnId": "BackupJobsInPeriod",
                                                  "label": "Backup Jobs In Period"
                                                }
                                              ]
                                            },
                                            "sortBy": []
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "PolicyAdherence_DailyOrWeeklyBackup",
                                              "comparison": "isEqualTo",
                                              "value": "Daily"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Time Period"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "showPin": false,
                                          "name": "PolicyAdherenceByTimePeriod-DailyBackup-Grid1"
                                        },
                                        {
                                          "type": 1,
                                          "content": {
                                            "json": "<div style=\"text-align:left\"><span style=\"font-size:14px;font-weight:600;\">Count of Backup Instances with atleast one successful backup every week </span> </div>"
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_DailyOrWeeklyBackup",
                                              "comparison": "isEqualTo",
                                              "value": "Weekly"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Time Period"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByTimePeriod-WeeklyBackup-Grid1Title"
                                        },
                                        {
                                          "type": 1,
                                          "content": {
                                            "json": "The below grid is displayed in **Weekly view** due to your time range selection. Backup Instances which have had **atleast one** successful backup in a given week fall under the second column in the below table. [Learn more](https://aka.ms/AzureBackupReportWeeklyBackupWeeklyView1)",
                                            "style": "info"
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "PolicyAdherence_DailyOrWeeklyBackup",
                                              "comparison": "isEqualTo",
                                              "value": "Weekly"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Time Period"
                                            },
                                            {
                                              "parameterName": "AggregationType",
                                              "comparison": "isNotEqualTo",
                                              "value": "Monthly"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByTimePeriod-WeeklyBackup-AggregationType-Weekly-Text"
                                        },
                                        {
                                          "type": 1,
                                          "content": {
                                            "json": "The below grid is displayed in **Monthly view** due to your time range selection. Backup Instances which have had **atleast one** successful backup in every week in a given month (28 days) fall under the second column in the below table. [Learn more](https://aka.ms/AzureBackupReportWeeklyBackupMonthlyView1)",
                                            "style": "info"
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "PolicyAdherence_DailyOrWeeklyBackup",
                                              "comparison": "isEqualTo",
                                              "value": "Weekly"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Time Period"
                                            },
                                            {
                                              "parameterName": "AggregationType",
                                              "comparison": "isEqualTo",
                                              "value": "Monthly"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByTimePeriod-WeeklyBackup-AggregationType-Weekly-Text - Copy"
                                        },
                                        {
                                          "type": 3,
                                          "content": {
                                            "version": "KqlItem/1.0",
                                            "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet DisplayAllFields = false;\r\nlet Item_search =  \"*;*\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\n// BackupJob\r\nlet JobOperationList = \"Backup\"; \r\nlet JobStatusList = \"*\";\r\nlet JobFailureCodeList = \"*\";\r\nlet ExcludeLog = true; \r\n// Grid specific params\r\nlet bin_Value =  iff(@\"{AggregationType}\" == \"Monthly\", 28d, 7d);\r\nlet sum_isJobSuccessInTheTimePeriod_Value = iff(@\"{AggregationType}\" == \"Monthly\", \"4\", \"1\"); \r\nlet duration_Value = iff(@\"{AggregationType}\" == \"Monthly\", \"27.00:00:00\", \"6.00:00:00\"); \r\nlet BackupInstanceWithWeeklyBackup = (){\r\n_AzureBackup_GetBackupInstances(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n| join kind = inner (\r\n// calling LA System Function\r\n_AzureBackup_GetPolicies(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList)\r\n) on $left.PolicyUniqueId == $right.UniqueId, $left.VaultResourceId == $right.VaultResourceId\r\n| where parse_json(ExtendedProperties).BackupFrequency == \"Weekly\"\r\n};\r\n// Grid Logic\r\nlet JobInfo = ()\r\n{\r\n// calling LA System Function\r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n| join kind = inner (BackupInstanceWithWeeklyBackup) on $left.BackupInstanceUniqueId == $right.UniqueId\r\n| summarize jobCount =count(), jobSuccessCount = countif(Status == \"Completed\" or Status == \"CompletedWithWarnings\"), jobFailureCount = countif(Status == \"Failed\" or Status == \"Cancelled\") by BackupInstanceUniqueId, JobCreationDate = startofday(StartTime)\r\n};\r\nJobInfo\r\n| summarize by BackupInstanceUniqueId\r\n| extend Day = range(RangeEnd, RangeStart, -1d)\r\n| mv-expand Day\r\n| project BackupInstanceUniqueId, todatetime(Day)\r\n| join kind = leftouter \r\n( JobInfo\r\n) on BackupInstanceUniqueId, $left.Day == $right.JobCreationDate\r\n// Create weekly buckets to check if SLA met\r\n| summarize max(Day), min(Day), sum(jobSuccessCount), sum(jobFailureCount) by BackupInstanceUniqueId, bin_at(Day, 7d, RangeEnd + 1d)\r\n| project BackupInstanceUniqueId, Day, sum_isJobSuccessInTheTimePeriod = iff(sum_jobSuccessCount > 1, 1, sum_jobSuccessCount), sum_jobFailureCount, max_Day, min_Day\r\n| summarize max_Day = max(max_Day), min_Day = min(min_Day), sum_isJobSuccessInTheTimePeriod = sum(sum_isJobSuccessInTheTimePeriod), sum_jobFailureCount = sum(sum_jobFailureCount) by BackupInstanceUniqueId, Day = bin_at(Day, bin_Value, RangeEnd + 1d)\r\n| project BackupInstanceUniqueId, Period = strcat(format_datetime(todatetime(min_Day),\"yyyy/MM/dd\"), \" - \", format_datetime(todatetime(max_Day),\"yyyy/MM/dd\")),  sum_isJobSuccessInTheTimePeriod, sum_jobFailureCount, duration = max_Day - min_Day, Day\r\n// Exclude partial week/month\r\n| where duration == duration_Value\r\n| summarize ItemsWithSuccessfulWeeklyBackup = countif(sum_isJobSuccessInTheTimePeriod == sum_isJobSuccessInTheTimePeriod_Value), ItemsWithoutSuccessfulWeeklyBackup = countif(sum_isJobSuccessInTheTimePeriod != sum_isJobSuccessInTheTimePeriod_Value), Day= (any(Day)), sum_jobFailureCount = any(sum_jobFailureCount) by BackupInstanceUniqueId, Period\r\n| summarize ItemsWithSuccessfulWeeklyBackup = sum(ItemsWithSuccessfulWeeklyBackup), ItemsWithoutSuccessfulWeeklyBackup = sum(ItemsWithoutSuccessfulWeeklyBackup), FailedBackupJobs = sum(sum_jobFailureCount), RangeStartValue = (any(Day)) by Period\r\n| sort by RangeStartValue desc | extend RangeEndValue = RangeStartValue + bin_Value - 1d | extend BackupJobsInPeriod=\"Click to view\"",
                                            "size": 3,
                                            "noDataMessage": "No records found for the selected scope and time range. Note that data for partial weeks is not displayed.",
                                            "exportedParameters": [
                                              {
                                                "fieldName": "RangeEndValue",
                                                "parameterName": "RangeEndValue_PolicyAdherenceTimePeriod_WeeklyBackup",
                                                "parameterType": 1,
                                                "defaultValue": ""
                                              },
                                              {
                                                "fieldName": "RangeStartValue",
                                                "parameterName": "RangeStartValue_PolicyAdherenceTimePeriod_WeeklyBackup",
                                                "parameterType": 1,
                                                "defaultValue": ""
                                              }
                                            ],
                                            "showExportToExcel": true,
                                            "queryType": 0,
                                            "resourceType": "microsoft.operationalinsights/workspaces",
                                            "crossComponentResources": [
                                              "{Workspaces}"
                                            ],
                                            "gridSettings": {
                                              "formatters": [
                                                {
                                                  "columnMatch": "Period",
                                                  "formatter": 0,
                                                  "formatOptions": {
                                                    "customColumnWidthSetting": "20%"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "FailedBackupJobs",
                                                  "formatter": 0,
                                                  "formatOptions": {
                                                    "customColumnWidthSetting": "20%"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "RangeStartValue",
                                                  "formatter": 5
                                                },
                                                {
                                                  "columnMatch": "RangeEndValue",
                                                  "formatter": 5
                                                },
                                                {
                                                  "columnMatch": "BackupJobsInPeriod",
                                                  "formatter": 7,
                                                  "formatOptions": {
                                                    "linkTarget": "Url"
                                                  }
                                                }
                                              ],
                                              "sortBy": [
                                                {
                                                  "itemKey": "Period",
                                                  "sortOrder": 2
                                                }
                                              ],
                                              "labelSettings": [
                                                {
                                                  "columnId": "Period",
                                                  "label": "Period (UTC)"
                                                },
                                                {
                                                  "columnId": "ItemsWithSuccessfulWeeklyBackup",
                                                  "label": "# Items with successful weekly backup"
                                                },
                                                {
                                                  "columnId": "ItemsWithoutSuccessfulWeeklyBackup",
                                                  "label": "# Items without successful weekly backup"
                                                },
                                                {
                                                  "columnId": "FailedBackupJobs",
                                                  "label": "# Failed backup jobs"
                                                },
                                                {
                                                  "columnId": "BackupJobsInPeriod",
                                                  "label": "Backup Jobs In Period"
                                                }
                                              ]
                                            },
                                            "sortBy": [
                                              {
                                                "itemKey": "Period",
                                                "sortOrder": 2
                                              }
                                            ]
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "PolicyAdherence_DailyOrWeeklyBackup",
                                              "comparison": "isEqualTo",
                                              "value": "Weekly"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Time Period"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "showPin": true,
                                          "name": "PolicyAdherenceByTimePeriod-WeeklyBackup-Grid1",
                                          "styleSettings": {
                                            "showBorder": true
                                          }
                                        },
                                        {
                                          "type": 1,
                                          "content": {
                                            "json": "<span style=\"font-size:12px;font-style:italic\"> Click on any row above to see details of all backup jobs that were triggered in the selected period. </span>"
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Time Period"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByTimePeriod-PromptText"
                                        },
                                        {
                                          "type": 1,
                                          "content": {
                                            "json": "<div style=\"text-align:left\"><span style=\"font-size:14px;font-weight:600;\">List of Backup Jobs in Period</span> </div>"
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "RangeEndValue_PolicyAdherenceTimePeriod_DailyBackup",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Time Period"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByTimePeriod-DailyBackup-Grid2Title"
                                        },
                                        {
                                          "type": 9,
                                          "content": {
                                            "version": "KqlParameterItem/1.0",
                                            "parameters": [
                                              {
                                                "id": "8db8c419-3938-44fb-98c1-38fec5488fbf",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherenceTab_SortBy_1a",
                                                "label": "Sort By",
                                                "type": 2,
                                                "description": "Use to sort by a certain column",
                                                "isRequired": true,
                                                "typeSettings": {
                                                  "additionalResourceOptions": [],
                                                  "showDefault": false
                                                },
                                                "jsonData": "[{ \"value\": \"DurationInSecs\", \"label\": \"Job Duration (hrs)\" },\r\n{ \"value\": \"DataTransferredInMBs\", \"label\": \"Data Transferred (MB)\", \"selected\": \"true\" }]",
                                                "timeContext": {
                                                  "durationMs": 604800000
                                                },
                                                "timeContextFromParameter": "TimeRange"
                                              },
                                              {
                                                "id": "bbe6281f-5a52-4c0e-8f6e-c2bef22742f4",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherenceTab_Order_1a",
                                                "label": "Order",
                                                "type": 2,
                                                "description": "Use to specify the sort order: Ascending/Descending",
                                                "isRequired": true,
                                                "typeSettings": {
                                                  "additionalResourceOptions": [],
                                                  "showDefault": false
                                                },
                                                "jsonData": "[\r\n    { \"value\":\"Ascending\"},\r\n    { \"value\":\"Descending\", \"selected\":true}\r\n]",
                                                "timeContext": {
                                                  "durationMs": 0
                                                },
                                                "timeContextFromParameter": "TimeRange"
                                              },
                                              {
                                                "id": "f95c204a-4472-489b-b92e-f0fd393cc236",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherenceTab_RowsPerPage_1a",
                                                "label": "Rows per Page",
                                                "type": 2,
                                                "description": "Number of rows to display in grid view",
                                                "isRequired": true,
                                                "typeSettings": {
                                                  "additionalResourceOptions": [],
                                                  "showDefault": false
                                                },
                                                "jsonData": "[\r\n    { \"value\":10, \"label\":\"10\", \"selected\":true  },\r\n    { \"value\":25, \"label\":\"25\" },\r\n    { \"value\":50, \"label\":\"50\" },\r\n    { \"value\":100, \"label\":\"100\" },\r\n    { \"value\":250, \"label\":\"250\" },\r\n    { \"value\":500, \"label\":\"500\" },\r\n    { \"value\":1000, \"label\":\"1000\" }\r\n]",
                                                "timeContext": {
                                                  "durationMs": 0
                                                },
                                                "timeContextFromParameter": "TimeRange"
                                              },
                                              {
                                                "id": "e9debeb6-ff52-4136-9fd8-ac9798b45bfe",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherenceTab_Page_1a",
                                                "label": "Page",
                                                "type": 2,
                                                "description": "Select Page Number",
                                                "isRequired": true,
                                                "query": "// function Params - Report Filters\r\nlet RangeStartValue_PolicyAdherenceTimePeriod_DailyBackup = @\"{RangeStartValue_PolicyAdherenceTimePeriod_DailyBackup}\";\r\nlet RangeEndValue_PolicyAdherenceTimePeriod_DailyBackup = @\"{RangeEndValue_PolicyAdherenceTimePeriod_DailyBackup}\";\r\n// function Params - Report Filters\r\nlet RangeStart = RangeStartValue_PolicyAdherenceTimePeriod_DailyBackup;\r\nlet RangeEnd = RangeEndValue_PolicyAdherenceTimePeriod_DailyBackup; \r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet DisplayAllFields = false;\r\nlet Item_search =  \"*;*\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet JobOperationList = \"Backup\"; \r\nlet JobStatusList = \"*\";\r\nlet JobFailureCodeList = \"*\";\r\nlet ExcludeLog = true; \r\nlet PolicyAdherence_DailyOrWeeklyBackup_Value = @\"{PolicyAdherence_DailyOrWeeklyBackup}\";\r\nlet BackupInstanceWithSelectedBackupFrequency = (){\r\n_AzureBackup_GetBackupInstances(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n| join kind = inner (\r\n// calling LA System Function\r\n_AzureBackup_GetPolicies(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList)\r\n) on $left.PolicyUniqueId == $right.UniqueId, $left.VaultResourceId == $right.VaultResourceId\r\n| where parse_json(ExtendedProperties).BackupFrequency == PolicyAdherence_DailyOrWeeklyBackup_Value\r\n};\r\n// calling LA System Function\r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n| join kind = inner (BackupInstanceWithSelectedBackupFrequency) on $left.BackupInstanceUniqueId == $right.UniqueId\r\n| summarize c=count()\r\n| project num = (c-1)/{PolicyAdherenceTab_RowsPerPage_1a} + 1\r\n| project nums = range(1,num,1), num\r\n| mvexpand nums\r\n| project nums = tostring(nums), num = strcat(tostring(nums),\" of \",tostring(num)) ",
                                                "crossComponentResources": [
                                                  "{Workspaces}"
                                                ],
                                                "value": "1",
                                                "typeSettings": {
                                                  "additionalResourceOptions": [],
                                                  "showDefault": false
                                                },
                                                "queryType": 0,
                                                "resourceType": "microsoft.operationalinsights/workspaces"
                                              }
                                            ],
                                            "style": "pills",
                                            "doNotRunWhenHidden": true,
                                            "queryType": 0,
                                            "resourceType": "microsoft.operationalinsights/workspaces"
                                          },
                                          "customWidth": "90",
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "RangeEndValue_PolicyAdherenceTimePeriod_DailyBackup",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Time Period"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByTimePeriod-DailyBackup-Grid2ParameterBlock",
                                          "styleSettings": {
                                            "padding": "0% 0% 0% 0%"
                                          }
                                        },
                                        {
                                          "type": 3,
                                          "content": {
                                            "version": "KqlItem/1.0",
                                            "query": "// function Params - Report Filters\r\nlet RangeStartValue_PolicyAdherenceTimePeriod_DailyBackup = @\"{RangeStartValue_PolicyAdherenceTimePeriod_DailyBackup}\";\r\nlet RangeEndValue_PolicyAdherenceTimePeriod_DailyBackup = @\"{RangeEndValue_PolicyAdherenceTimePeriod_DailyBackup}\";\r\n// function Params - Report Filters\r\nlet RangeStart = RangeStartValue_PolicyAdherenceTimePeriod_DailyBackup;\r\nlet RangeEnd = RangeEndValue_PolicyAdherenceTimePeriod_DailyBackup; \r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet DisplayAllFields = false;\r\nlet Item_search =  \"*;*\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet JobOperationList = \"Backup\"; \r\nlet JobStatusList = \"*\";\r\nlet JobFailureCodeList = \"*\";\r\nlet ExcludeLog = true; \r\nlet PolicyAdherence_DailyOrWeeklyBackup_Value = @\"{PolicyAdherence_DailyOrWeeklyBackup}\";\r\nlet BackupInstanceWithSelectedBackupFrequency = (){\r\n_AzureBackup_GetBackupInstances(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n| join kind = inner (\r\n// calling LA System Function\r\n_AzureBackup_GetPolicies(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList)\r\n) on $left.PolicyUniqueId == $right.UniqueId, $left.VaultResourceId == $right.VaultResourceId\r\n| where parse_json(ExtendedProperties).BackupFrequency == PolicyAdherence_DailyOrWeeklyBackup_Value\r\n};\r\n// calling LA System Function\r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n| join kind = inner (BackupInstanceWithSelectedBackupFrequency) on $left.BackupInstanceUniqueId == $right.UniqueId\r\n| extend TempColumn = column_ifexists(tostring('{PolicyAdherenceTab_SortBy_1a}'), \"DataTransferredInMBs\")\r\n| extend ColumnToBeSorted = iff(tostring('{PolicyAdherenceTab_Order_1a}') == \"Ascending\", todouble(TempColumn) - 90000000, 90000000 - todouble(TempColumn))\r\n| sort by ColumnToBeSorted asc nulls last, UniqueId asc\r\n| extend row_num = row_number()\r\n| extend page_num = tostring(((row_num-1)/{PolicyAdherenceTab_RowsPerPage_1a} + 1))\r\n| where page_num has ('{PolicyAdherenceTab_Page_1a}') or '*' in ('{PolicyAdherenceTab_Page_1a}')\r\n| project BackupInstance=BackupInstanceFriendlyName, BackupInstanceId, Container=DatasourceSetFriendlyName, ResourceGroup=iff(DatasourceType==\"Azure Backup Agent\" or DatasourceType==\"Azure Backup Server\" or DatasourceType==\"DPM\",\"(none)\",split(split(tostring(tolower(DatasourceSetResourceId)), '/resourcegroups/')[1],'/')[0]\r\n), OperationCategory, JobStatus=Status,  JobStartDateTime=StartTime, JobDuration=DurationInSecs/3600, ErrorTitle, DataTransferred=DataTransferredInMBs, AzureResource=DatasourceSetResourceId, DatasourceType \r\n\r\n\r\n",
                                            "size": 3,
                                            "showExportToExcel": true,
                                            "queryType": 0,
                                            "resourceType": "microsoft.operationalinsights/workspaces",
                                            "crossComponentResources": [
                                              "{Workspaces}"
                                            ],
                                            "gridSettings": {
                                              "formatters": [
                                                {
                                                  "columnMatch": "BackupInstance",
                                                  "formatter": 16,
                                                  "formatOptions": {
                                                    "linkColumn": "BackupInstanceId",
                                                    "linkTarget": "Resource",
                                                    "showIcon": true
                                                  },
                                                  "tooltipFormat": {
                                                    "tooltip": "Name of the backup instance"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "BackupInstanceId",
                                                  "formatter": 5
                                                },
                                                {
                                                  "columnMatch": "Container",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Protected Container associated with the backup instance"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "ResourceGroup",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Resource group associated with the backup instance"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "OperationCategory",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Operation Category"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "JobStatus",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Job Status"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "JobStartDateTime",
                                                  "formatter": 6,
                                                  "dateFormat": {
                                                    "showUtcTime": true,
                                                    "formatName": "shortDateTimePattern"
                                                  },
                                                  "tooltipFormat": {
                                                    "tooltip": "Start date and time of the Job"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "JobDuration",
                                                  "formatter": 4,
                                                  "formatOptions": {
                                                    "min": 0,
                                                    "palette": "blue"
                                                  },
                                                  "numberFormat": {
                                                    "unit": 0,
                                                    "options": {
                                                      "style": "decimal",
                                                      "useGrouping": false,
                                                      "maximumFractionDigits": 2
                                                    }
                                                  },
                                                  "tooltipFormat": {
                                                    "tooltip": "Job Duration"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "ErrorTitle",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Job Failure Code"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "DataTransferred",
                                                  "formatter": 4,
                                                  "formatOptions": {
                                                    "min": 0,
                                                    "palette": "blue"
                                                  },
                                                  "tooltipFormat": {
                                                    "tooltip": "Amount of data transferred by the job"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "AzureResource",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Azure Resource associated with the backup instance. For Azure VM Backup, SQL in Azure VM backup and SAP database in Azure VM backup, the Azure Resource is the Azure VM. For Azure Files Share backup, the Azure Resource is the Azure Storage account. For on-premises backup instances, this field is blank."
                                                  }
                                                },
                                                {
                                                  "columnMatch": "DatasourceType",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Datasource Type"
                                                  }
                                                }
                                              ],
                                              "filter": true,
                                              "labelSettings": [
                                                {
                                                  "columnId": "BackupInstance",
                                                  "label": "Backup Instance"
                                                },
                                                {
                                                  "columnId": "ResourceGroup",
                                                  "label": "Resource Group"
                                                },
                                                {
                                                  "columnId": "OperationCategory",
                                                  "label": "Operation Category"
                                                },
                                                {
                                                  "columnId": "JobStatus",
                                                  "label": "Job Status"
                                                },
                                                {
                                                  "columnId": "JobStartDateTime",
                                                  "label": "Job Start Date Time"
                                                },
                                                {
                                                  "columnId": "JobDuration",
                                                  "label": "Job Duration (hrs)"
                                                },
                                                {
                                                  "columnId": "ErrorTitle",
                                                  "label": "Job Failure Code"
                                                },
                                                {
                                                  "columnId": "DataTransferred",
                                                  "label": "Data Transferred (MB)"
                                                },
                                                {
                                                  "columnId": "AzureResource",
                                                  "label": "Azure Resource"
                                                },
                                                {
                                                  "columnId": "DatasourceType",
                                                  "label": "Datasource Type"
                                                }
                                              ]
                                            },
                                            "sortBy": []
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "RangeEndValue_PolicyAdherenceTimePeriod_DailyBackup",
                                              "comparison": "isNotEqualTo",
                                              "value": ""
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Time Period"
                                            }
                                          ],
                                          "showPin": false,
                                          "name": "PolicyAdherenceByTimePeriod-DailyBackup-Grid2"
                                        },
                                        {
                                          "type": 1,
                                          "content": {
                                            "json": "<div style=\"text-align:left\"><span style=\"font-size:14px;font-weight:600;\">List of Backup Jobs in Period </span> </div>"
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "RangeEndValue_PolicyAdherenceTimePeriod_WeeklyBackup",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Time Period"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByTimePeriod-WeeklyBackup-Grid2Title"
                                        },
                                        {
                                          "type": 9,
                                          "content": {
                                            "version": "KqlParameterItem/1.0",
                                            "parameters": [
                                              {
                                                "id": "4010e835-5e14-40f1-8232-885b3d81392a",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherenceTab_SortBy_1b",
                                                "label": "Sort By",
                                                "type": 2,
                                                "description": "Use to sort by a certain column",
                                                "isRequired": true,
                                                "value": "DurationInSecs",
                                                "typeSettings": {
                                                  "additionalResourceOptions": [],
                                                  "showDefault": false
                                                },
                                                "jsonData": "[{ \"value\": \"DurationInSecs\", \"label\": \"Job Duration (hrs)\" },\r\n{ \"value\": \"DataTransferredInMBs\", \"label\": \"Data Transferred (MB)\", \"selected\": \"true\" }]",
                                                "timeContext": {
                                                  "durationMs": 604800000
                                                },
                                                "timeContextFromParameter": "TimeRange"
                                              },
                                              {
                                                "id": "715e7892-2a1a-4579-806b-459c49e8abd5",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherenceTab_Order_1b",
                                                "label": "Order",
                                                "type": 2,
                                                "description": "Use to specify the sort order: Ascending/Descending",
                                                "isRequired": true,
                                                "typeSettings": {
                                                  "additionalResourceOptions": [],
                                                  "showDefault": false
                                                },
                                                "jsonData": "[\r\n    { \"value\":\"Ascending\"},\r\n    { \"value\":\"Descending\", \"selected\":true}\r\n]",
                                                "timeContext": {
                                                  "durationMs": 0
                                                },
                                                "timeContextFromParameter": "TimeRange"
                                              },
                                              {
                                                "id": "4ec2f27f-c475-4472-93d1-e2a4c12768db",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherenceTab_RowsPerPage_1b",
                                                "label": "Rows per Page",
                                                "type": 2,
                                                "description": "Number of rows to display in grid view",
                                                "isRequired": true,
                                                "typeSettings": {
                                                  "additionalResourceOptions": [],
                                                  "showDefault": false
                                                },
                                                "jsonData": "[\r\n    { \"value\":10, \"label\":\"10\", \"selected\":true  },\r\n    { \"value\":25, \"label\":\"25\" },\r\n    { \"value\":50, \"label\":\"50\" },\r\n    { \"value\":100, \"label\":\"100\" },\r\n    { \"value\":250, \"label\":\"250\" },\r\n    { \"value\":500, \"label\":\"500\" },\r\n    { \"value\":1000, \"label\":\"1000\" }\r\n]",
                                                "timeContext": {
                                                  "durationMs": 0
                                                },
                                                "timeContextFromParameter": "TimeRange"
                                              },
                                              {
                                                "id": "dfa947c5-2084-41c2-856b-44a485e40314",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherenceTab_Page_1b",
                                                "label": "Page",
                                                "type": 2,
                                                "description": "Select Page Number",
                                                "isRequired": true,
                                                "query": "// function Params - Report Filters\r\nlet RangeStartValue_PolicyAdherenceTimePeriod_WeeklyBackup = @\"{RangeStartValue_PolicyAdherenceTimePeriod_WeeklyBackup}\";\r\nlet RangeEndValue_PolicyAdherenceTimePeriod_WeeklyBackup = @\"{RangeEndValue_PolicyAdherenceTimePeriod_WeeklyBackup}\";\r\n// function Params - Report Filters\r\nlet RangeStart = RangeStartValue_PolicyAdherenceTimePeriod_WeeklyBackup;\r\nlet RangeEnd = RangeEndValue_PolicyAdherenceTimePeriod_WeeklyBackup;\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet DisplayAllFields = false;\r\nlet Item_search =  \"*;*\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet JobOperationList = \"Backup\"; \r\nlet JobStatusList = \"*\";\r\nlet JobFailureCodeList = \"*\";\r\nlet ExcludeLog = true; \r\nlet PolicyAdherence_DailyOrWeeklyBackup_Value = @\"{PolicyAdherence_DailyOrWeeklyBackup}\";\r\nlet BackupInstanceWithSelectedBackupFrequency = (){\r\n_AzureBackup_GetBackupInstances(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n| join kind = inner (\r\n// calling LA System Function\r\n_AzureBackup_GetPolicies(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList)\r\n) on $left.PolicyUniqueId == $right.UniqueId, $left.VaultResourceId == $right.VaultResourceId\r\n| where parse_json(ExtendedProperties).BackupFrequency == PolicyAdherence_DailyOrWeeklyBackup_Value\r\n};\r\n// calling LA System Function\r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n| join kind = inner (BackupInstanceWithSelectedBackupFrequency) on $left.BackupInstanceUniqueId == $right.UniqueId\r\n| summarize c=count()\r\n| project num = (c-1)/{PolicyAdherenceTab_RowsPerPage_1b} + 1\r\n| project nums = range(1,num,1), num\r\n| mvexpand nums\r\n| project nums = tostring(nums), num = strcat(tostring(nums),\" of \",tostring(num)) ",
                                                "crossComponentResources": [
                                                  "{Workspaces}"
                                                ],
                                                "value": "1",
                                                "typeSettings": {
                                                  "additionalResourceOptions": [],
                                                  "showDefault": false
                                                },
                                                "queryType": 0,
                                                "resourceType": "microsoft.operationalinsights/workspaces"
                                              }
                                            ],
                                            "style": "pills",
                                            "doNotRunWhenHidden": true,
                                            "queryType": 0,
                                            "resourceType": "microsoft.operationalinsights/workspaces"
                                          },
                                          "customWidth": "90",
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "RangeEndValue_PolicyAdherenceTimePeriod_WeeklyBackup",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Time Period"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByTimePeriod-WeeklyBackup-Grid2ParameterBlock",
                                          "styleSettings": {
                                            "padding": "0% 0% 0% 0%"
                                          }
                                        },
                                        {
                                          "type": 3,
                                          "content": {
                                            "version": "KqlItem/1.0",
                                            "query": "// function Params - Report Filters\r\nlet RangeStartValue_PolicyAdherenceTimePeriod_WeeklyBackup = @\"{RangeStartValue_PolicyAdherenceTimePeriod_WeeklyBackup}\";\r\nlet RangeEndValue_PolicyAdherenceTimePeriod_WeeklyBackup = @\"{RangeEndValue_PolicyAdherenceTimePeriod_WeeklyBackup}\";\r\n// function Params - Report Filters\r\nlet RangeStart = RangeStartValue_PolicyAdherenceTimePeriod_WeeklyBackup;\r\nlet RangeEnd = RangeEndValue_PolicyAdherenceTimePeriod_WeeklyBackup;\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet DisplayAllFields = false;\r\nlet Item_search =  \"*;*\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet JobOperationList = \"Backup\"; \r\nlet JobStatusList = \"*\";\r\nlet JobFailureCodeList = \"*\";\r\nlet ExcludeLog = true; \r\nlet PolicyAdherence_DailyOrWeeklyBackup_Value = @\"{PolicyAdherence_DailyOrWeeklyBackup}\";\r\nlet BackupInstanceWithSelectedBackupFrequency = (){\r\n_AzureBackup_GetBackupInstances(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n| join kind = inner (\r\n// calling LA System Function\r\n_AzureBackup_GetPolicies(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList)\r\n) on $left.PolicyUniqueId == $right.UniqueId, $left.VaultResourceId == $right.VaultResourceId\r\n| where parse_json(ExtendedProperties).BackupFrequency == PolicyAdherence_DailyOrWeeklyBackup_Value\r\n};\r\n// calling LA System Function\r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n| join kind = inner (BackupInstanceWithSelectedBackupFrequency) on $left.BackupInstanceUniqueId == $right.UniqueId\r\n| extend TempColumn = column_ifexists(tostring('{PolicyAdherenceTab_SortBy_1b}'), \"DataTransferredInMBs\")\r\n| extend ColumnToBeSorted = iff(tostring('{PolicyAdherenceTab_Order_1b}') == \"Ascending\", todouble(TempColumn) - 90000000, 90000000 - todouble(TempColumn))\r\n| sort by ColumnToBeSorted asc nulls last, UniqueId asc\r\n| extend row_num = row_number()\r\n| extend page_num = tostring(((row_num-1)/{PolicyAdherenceTab_RowsPerPage_1b} + 1))\r\n| where page_num has ('{PolicyAdherenceTab_Page_1b}') or '*' in ('{PolicyAdherenceTab_Page_1b}')\r\n| project BackupInstance=BackupInstanceFriendlyName, BackupInstanceId, Container=DatasourceSetFriendlyName, ResourceGroup=iff(DatasourceType==\"Azure Backup Agent\" or DatasourceType==\"Azure Backup Server\" or DatasourceType==\"DPM\",\"(none)\",split(split(tostring(tolower(DatasourceSetResourceId)), '/resourcegroups/')[1],'/')[0]\r\n), OperationCategory, JobStatus=Status,  JobStartDateTime=StartTime, JobDuration=DurationInSecs/3600, ErrorTitle, DataTransferred=DataTransferredInMBs, AzureResource=DatasourceSetResourceId, DatasourceType \r\n\r\n\r\n",
                                            "size": 3,
                                            "showExportToExcel": true,
                                            "queryType": 0,
                                            "resourceType": "microsoft.operationalinsights/workspaces",
                                            "crossComponentResources": [
                                              "{Workspaces}"
                                            ],
                                            "gridSettings": {
                                              "formatters": [
                                                {
                                                  "columnMatch": "BackupInstance",
                                                  "formatter": 16,
                                                  "formatOptions": {
                                                    "linkColumn": "BackupInstanceId",
                                                    "linkTarget": "Resource",
                                                    "showIcon": true
                                                  },
                                                  "tooltipFormat": {
                                                    "tooltip": "Name of the backup instance"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "BackupInstanceId",
                                                  "formatter": 5
                                                },
                                                {
                                                  "columnMatch": "Container",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Protected Container associated with the backup instance"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "ResourceGroup",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Resource group associated with the backup instance"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "OperationCategory",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Operation Category"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "JobStatus",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Job Status"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "JobStartDateTime",
                                                  "formatter": 6,
                                                  "numberFormat": {
                                                    "unit": 0,
                                                    "options": {
                                                      "style": "decimal"
                                                    }
                                                  },
                                                  "dateFormat": {
                                                    "showUtcTime": true,
                                                    "formatName": "shortDateTimePattern"
                                                  },
                                                  "tooltipFormat": {
                                                    "tooltip": "Start date and time of the Job"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "JobDuration",
                                                  "formatter": 4,
                                                  "formatOptions": {
                                                    "min": 0,
                                                    "palette": "blue"
                                                  },
                                                  "numberFormat": {
                                                    "unit": 0,
                                                    "options": {
                                                      "style": "decimal",
                                                      "maximumFractionDigits": 2
                                                    }
                                                  },
                                                  "tooltipFormat": {
                                                    "tooltip": "Job Duration"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "ErrorTitle",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Job Failure Code"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "DataTransferred",
                                                  "formatter": 4,
                                                  "formatOptions": {
                                                    "min": 0,
                                                    "palette": "blue"
                                                  },
                                                  "numberFormat": {
                                                    "unit": 0,
                                                    "options": {
                                                      "style": "decimal",
                                                      "maximumFractionDigits": 2
                                                    }
                                                  },
                                                  "tooltipFormat": {
                                                    "tooltip": "Amount of data transferred by the job"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "AzureResource",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Azure Resource associated with the backup instance. For Azure VM Backup, SQL in Azure VM backup and SAP database in Azure VM backup, the Azure Resource is the Azure VM. For Azure Files Share backup, the Azure Resource is the Azure Storage account. For on-premises backup instances, this field is blank."
                                                  }
                                                },
                                                {
                                                  "columnMatch": "DatasourceType",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Datasource Type"
                                                  }
                                                }
                                              ],
                                              "labelSettings": [
                                                {
                                                  "columnId": "BackupInstance",
                                                  "label": "Backup Instance"
                                                },
                                                {
                                                  "columnId": "ResourceGroup",
                                                  "label": "Resource Group"
                                                },
                                                {
                                                  "columnId": "OperationCategory",
                                                  "label": "Operation Category"
                                                },
                                                {
                                                  "columnId": "JobStatus",
                                                  "label": "Job Status"
                                                },
                                                {
                                                  "columnId": "JobStartDateTime",
                                                  "label": "Job Start Date Time"
                                                },
                                                {
                                                  "columnId": "JobDuration",
                                                  "label": "Job Duration (hrs)"
                                                },
                                                {
                                                  "columnId": "ErrorTitle",
                                                  "label": "Job Failure Code"
                                                },
                                                {
                                                  "columnId": "DataTransferred",
                                                  "label": "Data Transferred (MB)"
                                                },
                                                {
                                                  "columnId": "AzureResource",
                                                  "label": "Azure Resource"
                                                },
                                                {
                                                  "columnId": "DatasourceType",
                                                  "label": "Datasource Type"
                                                }
                                              ]
                                            },
                                            "sortBy": []
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "RangeEndValue_PolicyAdherenceTimePeriod_WeeklyBackup",
                                              "comparison": "isNotEqualTo",
                                              "value": ""
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Time Period"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "showPin": true,
                                          "name": "PolicyAdherenceByTimePeriod-WeeklyBackup-Grid2",
                                          "styleSettings": {
                                            "showBorder": true
                                          }
                                        },
                                        {
                                          "type": 1,
                                          "content": {
                                            "json": "<div style=\"text-align:left\"><span style=\"font-size:14px;font-weight:600;\">Policy Adherence details at Backup Instance level</span> </div>"
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Backup Instance"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByBackupInstance-Grid1Title"
                                        },
                                        {
                                          "type": 1,
                                          "content": {
                                            "json": "The below grid is displayed in **Daily view** due to your time range selection. Backup Instances which have had **atleast one successful backup** on a given day are marked green (compliant) for that day. [Learn more](https://aka.ms/AzureBackupReportDailyBackupDailyView2)",
                                            "style": "info"
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "PolicyAdherence_DailyOrWeeklyBackup",
                                              "comparison": "isEqualTo",
                                              "value": "Daily"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Backup Instance"
                                            },
                                            {
                                              "parameterName": "AggregationType",
                                              "comparison": "isEqualTo",
                                              "value": "Daily"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByBackupInstance-DailyBackup-AggregationType-Daily-Text"
                                        },
                                        {
                                          "type": 1,
                                          "content": {
                                            "json": "The below grid is displayed in **Weekly view** due to your time range selection. Backup Instances which have had **atleast one successful backup** on every day in a given week are marked green (compliant) for that day. [Learn more](https://aka.ms/AzureBackupReportDailyBackupWeeklyView2)",
                                            "style": "info"
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "PolicyAdherence_DailyOrWeeklyBackup",
                                              "comparison": "isEqualTo",
                                              "value": "Daily"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Backup Instance"
                                            },
                                            {
                                              "parameterName": "AggregationType",
                                              "comparison": "isEqualTo",
                                              "value": "Weekly"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByBackupInstance-DailyBackup-AggregationType-Daily-Text - Copy"
                                        },
                                        {
                                          "type": 1,
                                          "content": {
                                            "json": "The below grid is displayed in **Monthly view** due to your time range selection. Backup Instances which have had **atleast one successful backup** on every day in a given month (28 days) are marked green (compliant) for that day. [Learn more](https://aka.ms/AzureBackupReportDailyBackupMonthlyView2)",
                                            "style": "info"
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "PolicyAdherence_DailyOrWeeklyBackup",
                                              "comparison": "isEqualTo",
                                              "value": "Daily"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Backup Instance"
                                            },
                                            {
                                              "parameterName": "AggregationType",
                                              "comparison": "isEqualTo",
                                              "value": "Monthly"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByBackupInstance-DailyBackup-AggregationType-Daily-Text - Copy - Copy"
                                        },
                                        {
                                          "type": 9,
                                          "content": {
                                            "version": "KqlParameterItem/1.0",
                                            "crossComponentResources": [
                                              "{Workspaces}"
                                            ],
                                            "parameters": [
                                              {
                                                "id": "f25f4728-0548-4872-995b-009e36fae10e",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherenceTab_SearchBackupInstanceOrDatasourceSet_2b",
                                                "label": "Search Instance or Container",
                                                "type": 1,
                                                "description": "Use to search for a backup instance by name. <br/> To search for a specific instance in a container, use the syntax [container name];[instance name] <br/> To search for all instances in a container, use the syntax [container name];",
                                                "timeContext": {
                                                  "durationMs": 604800000
                                                },
                                                "timeContextFromParameter": "TimeRange",
                                                "value": ""
                                              },
                                              {
                                                "id": "8fcd9638-ffa1-4ab4-a10a-6ec84675e7d5",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherenceTab_RowsPerPage_2b",
                                                "label": "Rows per Page",
                                                "type": 2,
                                                "description": "Number of rows to display in grid view",
                                                "isRequired": true,
                                                "typeSettings": {
                                                  "additionalResourceOptions": [],
                                                  "showDefault": false
                                                },
                                                "jsonData": "[\r\n    { \"value\":10, \"label\":\"10\", \"selected\":true  },\r\n    { \"value\":25, \"label\":\"25\" },\r\n    { \"value\":50, \"label\":\"50\" },\r\n    { \"value\":100, \"label\":\"100\" },\r\n    { \"value\":250, \"label\":\"250\" },\r\n    { \"value\":500, \"label\":\"500\" },\r\n    { \"value\":1000, \"label\":\"1000\" }\r\n]",
                                                "timeContext": {
                                                  "durationMs": 0
                                                },
                                                "timeContextFromParameter": "TimeRange",
                                                "value": "25"
                                              },
                                              {
                                                "id": "8c69b14b-b995-44ea-baa8-3e812d381c96",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherenceTab_Page_2b",
                                                "label": "Page",
                                                "type": 2,
                                                "description": "Select Page Number",
                                                "isRequired": true,
                                                "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet DisplayAllFields = false;\r\nlet Item_search =  @\"{PolicyAdherenceTab_SearchBackupInstanceOrDatasourceSet_2b}\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet JobOperationList = \"Backup\"; \r\nlet JobStatusList = \"*\";\r\nlet JobFailureCodeList = \"*\";\r\nlet ExcludeLog = true; \r\n// Grid specific params\r\nlet bin_Value = iff(@\"{AggregationType}\" == \"Weekly\", 7d, iff(@\"{AggregationType}\" == \"Monthly\", 28d, 1d));\r\nlet sum_isJobSuccessInTheTimePeriod_Value = iff(@\"{AggregationType}\" == \"Weekly\", \"7\", iff(@\"{AggregationType}\" == \"Monthly\", \"28\", \"1\")); \r\nlet duration_Value = iff(@\"{AggregationType}\" == \"Weekly\", \"6.00:00:00\", iff(@\"{AggregationType}\" == \"Monthly\", \"27.00:00:00\", \"00.00:00:00\")); \r\nlet BackupInstanceWithDailyBackup = (){\r\n_AzureBackup_GetBackupInstances(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n| join kind = inner (\r\n// calling LA System Function\r\n_AzureBackup_GetPolicies(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList)\r\n) on $left.PolicyUniqueId == $right.UniqueId, $left.VaultResourceId == $right.VaultResourceId\r\n| where parse_json(ExtendedProperties).BackupFrequency == \"Daily\"\r\n};\r\n// Grid Logic\r\nlet JobInfo = ()\r\n{\r\n// calling LA System Function\r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n| join kind = inner (BackupInstanceWithDailyBackup) on $left.BackupInstanceUniqueId == $right.UniqueId\r\n| summarize jobCount = count(), jobSuccessCount = countif(Status == \"Completed\" or Status == \"CompletedWithWarnings\"), BackupInstanceFriendlyName = any(BackupInstanceFriendlyName), BackupSolution =  any(BackupSolution), DatasourceSetResourceId = any(DatasourceSetResourceId), DatasourceSetFriendlyName = any(DatasourceSetFriendlyName) by BackupInstanceUniqueId, JobCreationDate = startofday(StartTime)\r\n| project ResourceGroup=iff(BackupSolution ==\"Azure Backup Agent\" or BackupSolution ==\"Azure Backup Server\" or BackupSolution ==\"DPM\",\"(none)\",split(split(tostring(tolower(DatasourceSetResourceId)), '/resourcegroups/')[1],'/')[0]), jobCount, jobSuccessCount, BackupInstanceFriendlyName, BackupInstanceUniqueId, DatasourceSetFriendlyName, JobCreationDate\r\n};\r\nJobInfo\r\n| summarize by BackupInstanceUniqueId, BackupInstanceFriendlyName, DatasourceSetFriendlyName, ResourceGroup\r\n| extend Day = range(RangeEnd, RangeStart, -1d)\r\n| mv-expand Day\r\n| project BackupInstanceUniqueId, BackupInstanceFriendlyName, DatasourceSetFriendlyName, ResourceGroup, todatetime(Day)\r\n| join kind = leftouter \r\n( JobInfo\r\n) on BackupInstanceUniqueId, $left.Day == $right.JobCreationDate\r\n//| where BackupInstanceUniqueId == \"eastus;944400882857245004;iaasvmcontainerv2;azurefiles;afsaccount\"\r\n| sort by BackupInstanceUniqueId, Day desc\r\n| project BackupInstanceUniqueId, BackupInstanceFriendlyName, DatasourceSetFriendlyName, ResourceGroup, Day, jobTotalCountInTheTimePeriod = iff(isnull(jobCount), 0, jobCount), isJobSuccessInTheTimePeriod =iff(isnull(jobCount), 0, iff((jobSuccessCount > 1), 1, jobSuccessCount))\r\n| summarize max(Day), min(Day), sum(isJobSuccessInTheTimePeriod), BackupInstanceFriendlyName = any(BackupInstanceFriendlyName), DatasourceSetFriendlyName = any(DatasourceSetFriendlyName), ResourceGroup = any(ResourceGroup) by BackupInstanceUniqueId, bin_at(Day, bin_Value, RangeEnd + 1d)\r\n| project BackupInstanceUniqueId, BackupInstanceFriendlyName, DatasourceSetFriendlyName, ResourceGroup, Period = iff(@\"{AggregationType}\" == \"Weekly\" or @\"{AggregationType}\" == \"Monthly\", strcat(format_datetime(todatetime(min_Day),\"yyyy/MM/dd\"), \" - \", format_datetime(todatetime(max_Day),\"yyyy/MM/dd\")), format_datetime(todatetime(min_Day),\"yyyy/MM/dd\")), sum_isJobSuccessInTheTimePeriod, duration = max_Day - min_Day, Day\r\n// Exclude partial week/month\r\n| where duration == duration_Value\r\n| summarize sum_isJobSuccessInTheTimePeriod = countif(sum_isJobSuccessInTheTimePeriod == sum_isJobSuccessInTheTimePeriod_Value), Day= (any(Day)), BackupInstanceFriendlyName = any(BackupInstanceFriendlyName), DatasourceSetFriendlyName = any(DatasourceSetFriendlyName), ResourceGroup = any(ResourceGroup) by BackupInstanceUniqueId, Period\r\n| evaluate pivot(Period, any(sum_isJobSuccessInTheTimePeriod), BackupInstanceFriendlyName, BackupInstanceUniqueId, DatasourceSetFriendlyName, ResourceGroup)\r\n| summarize c=count()\r\n| project num = (c-1)/{PolicyAdherenceTab_RowsPerPage_2b} + 1\r\n| project nums = range(1,num,1), num\r\n| mvexpand nums\r\n| project nums = tostring(nums), num = strcat(tostring(nums),\" of \",tostring(num))",
                                                "crossComponentResources": [
                                                  "{Workspaces}"
                                                ],
                                                "value": "1",
                                                "typeSettings": {
                                                  "additionalResourceOptions": [],
                                                  "showDefault": false
                                                },
                                                "timeContext": {
                                                  "durationMs": 0
                                                },
                                                "timeContextFromParameter": "TimeRange",
                                                "queryType": 0,
                                                "resourceType": "microsoft.operationalinsights/workspaces"
                                              }
                                            ],
                                            "style": "pills",
                                            "doNotRunWhenHidden": true,
                                            "queryType": 0,
                                            "resourceType": "microsoft.operationalinsights/workspaces"
                                          },
                                          "customWidth": "90",
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Backup Instance"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_DailyOrWeeklyBackup",
                                              "comparison": "isEqualTo",
                                              "value": "Daily"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByBackupInstance-DailyBackup-Grid1ParameterBlock",
                                          "styleSettings": {
                                            "padding": "0% 0% 0% 0%"
                                          }
                                        },
                                        {
                                          "type": 3,
                                          "content": {
                                            "version": "KqlItem/1.0",
                                            "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet DisplayAllFields = false;\r\nlet Item_search =  @\"{PolicyAdherenceTab_SearchBackupInstanceOrDatasourceSet_2b}\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet JobOperationList = \"Backup\"; \r\nlet JobStatusList = \"*\";\r\nlet JobFailureCodeList = \"*\";\r\nlet ExcludeLog = true; \r\n// Grid specific params\r\nlet bin_Value = iff(@\"{AggregationType}\" == \"Weekly\", 7d, iff(@\"{AggregationType}\" == \"Monthly\", 28d, 1d));\r\nlet sum_isJobSuccessInTheTimePeriod_Value = iff(@\"{AggregationType}\" == \"Weekly\", \"7\", iff(@\"{AggregationType}\" == \"Monthly\", \"28\", \"1\")); \r\nlet duration_Value = iff(@\"{AggregationType}\" == \"Weekly\", \"6.00:00:00\", iff(@\"{AggregationType}\" == \"Monthly\", \"27.00:00:00\", \"00.00:00:00\")); \r\nlet BackupInstanceWithDailyBackup = (){\r\n_AzureBackup_GetBackupInstances(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n| join kind = inner (\r\n// calling LA System Function\r\n_AzureBackup_GetPolicies(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList)\r\n) on $left.PolicyUniqueId == $right.UniqueId, $left.VaultResourceId == $right.VaultResourceId\r\n| where parse_json(ExtendedProperties).BackupFrequency == \"Daily\"\r\n};\r\n// Grid Logic\r\nlet JobInfo = ()\r\n{\r\n// calling LA System Function\r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n| join kind = inner (BackupInstanceWithDailyBackup) on $left.BackupInstanceUniqueId == $right.UniqueId\r\n| summarize jobCount = count(), jobSuccessCount = countif(Status == \"Completed\" or Status == \"CompletedWithWarnings\"), BackupInstanceFriendlyName = any(BackupInstanceFriendlyName), BackupInstanceId=any(BackupInstanceId), BackupSolution =  any(BackupSolution), DatasourceSetResourceId = any(DatasourceSetResourceId), DatasourceSetFriendlyName = any(DatasourceSetFriendlyName) by BackupInstanceUniqueId, JobCreationDate = startofday(StartTime)\r\n| project ResourceGroup=iff(BackupSolution ==\"Azure Backup Agent\" or BackupSolution ==\"Azure Backup Server\" or BackupSolution ==\"DPM\",\"(none)\",split(split(tostring(tolower(DatasourceSetResourceId)), '/resourcegroups/')[1],'/')[0]), jobCount, jobSuccessCount, BackupInstanceFriendlyName, BackupInstanceUniqueId, DatasourceSetFriendlyName, JobCreationDate, BackupInstanceId\r\n};\r\nJobInfo\r\n| summarize by BackupInstanceUniqueId, BackupInstanceFriendlyName, DatasourceSetFriendlyName, ResourceGroup, BackupInstanceId\r\n| extend Day = range(RangeEnd, RangeStart, -1d)\r\n| mv-expand Day\r\n| project BackupInstanceUniqueId, BackupInstanceFriendlyName, BackupInstanceId, DatasourceSetFriendlyName, ResourceGroup, todatetime(Day)\r\n| join kind = leftouter \r\n( JobInfo\r\n) on BackupInstanceUniqueId, $left.Day == $right.JobCreationDate\r\n//| where BackupInstanceUniqueId == \"eastus;944400882857245004;iaasvmcontainerv2;azurefiles;afsaccount\"\r\n| sort by BackupInstanceUniqueId, Day desc\r\n| project BackupInstanceUniqueId, BackupInstanceId, BackupInstanceFriendlyName, DatasourceSetFriendlyName, ResourceGroup, Day, jobTotalCountInTheTimePeriod = iff(isnull(jobCount), 0, jobCount), isJobSuccessInTheTimePeriod =iff(isnull(jobCount), 0, iff((jobSuccessCount > 1), 1, jobSuccessCount))\r\n| summarize max(Day), min(Day), sum(isJobSuccessInTheTimePeriod), BackupInstanceFriendlyName = any(BackupInstanceFriendlyName),BackupInstanceId = any(BackupInstanceId), DatasourceSetFriendlyName = any(DatasourceSetFriendlyName), ResourceGroup = any(ResourceGroup) by BackupInstanceUniqueId, bin_at(Day, bin_Value, RangeEnd + 1d)\r\n| project BackupInstanceUniqueId, BackupInstanceId, BackupInstanceFriendlyName, DatasourceSetFriendlyName, ResourceGroup, Period = iff(@\"{AggregationType}\" == \"Weekly\" or @\"{AggregationType}\" == \"Monthly\", strcat(format_datetime(todatetime(min_Day),\"yyyy/MM/dd\"), \" - \", format_datetime(todatetime(max_Day),\"yyyy/MM/dd\")), format_datetime(todatetime(min_Day),\"yyyy/MM/dd\")), sum_isJobSuccessInTheTimePeriod, duration = max_Day - min_Day, Day\r\n// Exclude partial week/month\r\n| where duration == duration_Value\r\n| summarize sum_isJobSuccessInTheTimePeriod = countif(sum_isJobSuccessInTheTimePeriod == sum_isJobSuccessInTheTimePeriod_Value), Day= (any(Day)), BackupInstanceFriendlyName = any(BackupInstanceFriendlyName), BackupInstanceId = any(BackupInstanceId), DatasourceSetFriendlyName = any(DatasourceSetFriendlyName), ResourceGroup = any(ResourceGroup) by BackupInstanceUniqueId, Period\r\n| evaluate pivot(Period, any(sum_isJobSuccessInTheTimePeriod), BackupInstanceFriendlyName, BackupInstanceId, BackupInstanceUniqueId, DatasourceSetFriendlyName, ResourceGroup)\r\n| sort by BackupInstanceUniqueId asc\r\n| extend row_num = row_number()\r\n| extend page_num = tostring(((row_num-1)/{PolicyAdherenceTab_RowsPerPage_2b} + 1))\r\n| where page_num has ('{PolicyAdherenceTab_Page_2b}') or '*' in ('{PolicyAdherenceTab_Page_2b}')",
                                            "size": 3,
                                            "exportedParameters": [
                                              {
                                                "fieldName": "DatasourceSetFriendlyName",
                                                "parameterName": "PolicyAdherence_DailyBackup_DatasourceSetFriendlyName",
                                                "parameterType": 1
                                              },
                                              {
                                                "fieldName": "BackupInstanceFriendlyName",
                                                "parameterName": "PolicyAdherence_DailyBackup_BackupInstanceFriendlyName",
                                                "parameterType": 1
                                              }
                                            ],
                                            "showExportToExcel": true,
                                            "queryType": 0,
                                            "resourceType": "microsoft.operationalinsights/workspaces",
                                            "crossComponentResources": [
                                              "{Workspaces}"
                                            ],
                                            "gridSettings": {
                                              "formatters": [
                                                {
                                                  "columnMatch": "BackupInstanceFriendlyName",
                                                  "formatter": 16,
                                                  "formatOptions": {
                                                    "linkColumn": "BackupInstanceId",
                                                    "linkTarget": "Resource",
                                                    "showIcon": true
                                                  },
                                                  "tooltipFormat": {
                                                    "tooltip": "Name of the backup instance"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "BackupInstanceId",
                                                  "formatter": 5
                                                },
                                                {
                                                  "columnMatch": "BackupInstanceUniqueId",
                                                  "formatter": 5
                                                },
                                                {
                                                  "columnMatch": "DatasourceSetFriendlyName",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Protected Container associated with the backup instance"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "ResourceGroup",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Resource group associated with the backup instance"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "[0-9][0-9][0-9][0-9]/[0-9][0-9]/[0-9][0-9]|[0-9][0-9][0-9][0-9]/[0-9][0-9]/[0-9][0-9]-[0-9][0-9][0-9][0-9]/[0-9][0-9]/[0-9][0-9]",
                                                  "formatter": 18,
                                                  "formatOptions": {
                                                    "thresholdsOptions": "colors",
                                                    "thresholdsGrid": [
                                                      {
                                                        "operator": ">",
                                                        "thresholdValue": "0",
                                                        "representation": "green",
                                                        "text": "."
                                                      },
                                                      {
                                                        "operator": "Default",
                                                        "thresholdValue": null,
                                                        "representation": "redBright",
                                                        "text": "."
                                                      }
                                                    ]
                                                  }
                                                },
                                                {
                                                  "columnMatch": "row_num",
                                                  "formatter": 5
                                                },
                                                {
                                                  "columnMatch": "page_num",
                                                  "formatter": 5
                                                }
                                              ],
                                              "filter": true,
                                              "labelSettings": [
                                                {
                                                  "columnId": "BackupInstanceFriendlyName",
                                                  "label": "Backup Instance"
                                                },
                                                {
                                                  "columnId": "DatasourceSetFriendlyName",
                                                  "label": "Container"
                                                },
                                                {
                                                  "columnId": "ResourceGroup",
                                                  "label": "Resource Group"
                                                }
                                              ]
                                            }
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Backup Instance"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_DailyOrWeeklyBackup",
                                              "comparison": "isEqualTo",
                                              "value": "Daily"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "showPin": false,
                                          "name": "PolicyAdherenceByBackupInstance-DailyBackup-Grid1"
                                        },
                                        {
                                          "type": 1,
                                          "content": {
                                            "json": "The below grid is displayed in **Weekly view** due to your time range selection. Backup Instances which have had **atleast one** successful backup in a given week are marked green (compliant) for that week.  [Learn more](https://aka.ms/AzureBackupReportDailyBackupWeeklyView2)",
                                            "style": "info"
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "PolicyAdherence_DailyOrWeeklyBackup",
                                              "comparison": "isEqualTo",
                                              "value": "Weekly"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Backup Instance"
                                            },
                                            {
                                              "parameterName": "AggregationType",
                                              "comparison": "isNotEqualTo",
                                              "value": "Monthly"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByBackupInstance-WeeklyBackup-AggregationType-Weekly-Text"
                                        },
                                        {
                                          "type": 1,
                                          "content": {
                                            "json": "The below grid is displayed in **Monthly view** due to your time range selection. Backup Instances which have had **atleast one** successful backup in every week in a given month (28 days) are marked green (compliant) for that week.  [Learn more](https://aka.ms/AzureBackupReportWeeklyBackupMonthlyView2)",
                                            "style": "info"
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "PolicyAdherence_DailyOrWeeklyBackup",
                                              "comparison": "isEqualTo",
                                              "value": "Weekly"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Backup Instance"
                                            },
                                            {
                                              "parameterName": "AggregationType",
                                              "comparison": "isEqualTo",
                                              "value": "Monthly"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByBackupInstance-WeeklyBackup-AggregationType-Weekly-Text - Copy"
                                        },
                                        {
                                          "type": 9,
                                          "content": {
                                            "version": "KqlParameterItem/1.0",
                                            "crossComponentResources": [
                                              "{Workspaces}"
                                            ],
                                            "parameters": [
                                              {
                                                "id": "cb015b28-ef63-4003-8cdd-afc04992841a",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherenceTab_SearchBackupInstanceOrDatasourceSet_2c",
                                                "label": "Search Instance or Container",
                                                "type": 1,
                                                "description": "Use to search for a backup instance by name. <br/> To search for a specific instance in a container, use the syntax [container name];[instance name] <br/> To search for all instances in a container, use the syntax [container name];",
                                                "timeContext": {
                                                  "durationMs": 604800000
                                                },
                                                "timeContextFromParameter": "TimeRange"
                                              },
                                              {
                                                "id": "9597943f-e990-4c14-967d-36b971159676",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherenceTab_RowsPerPage_2c",
                                                "label": "Rows per Page",
                                                "type": 2,
                                                "description": "Number of rows to display in grid view",
                                                "isRequired": true,
                                                "typeSettings": {
                                                  "additionalResourceOptions": [],
                                                  "showDefault": false
                                                },
                                                "jsonData": "[\r\n    { \"value\":10, \"label\":\"10\", \"selected\":true  },\r\n    { \"value\":25, \"label\":\"25\" },\r\n    { \"value\":50, \"label\":\"50\" },\r\n    { \"value\":100, \"label\":\"100\" },\r\n    { \"value\":250, \"label\":\"250\" },\r\n    { \"value\":500, \"label\":\"500\" },\r\n    { \"value\":1000, \"label\":\"1000\" }\r\n]",
                                                "timeContext": {
                                                  "durationMs": 0
                                                },
                                                "timeContextFromParameter": "TimeRange"
                                              },
                                              {
                                                "id": "fbb06ba5-20eb-41d5-ad52-a0d883c83f48",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherenceTab_Page_2c",
                                                "label": "Page",
                                                "type": 2,
                                                "description": "Select Page Number",
                                                "isRequired": true,
                                                "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet DisplayAllFields = false;\r\nlet Item_search =  @\"{PolicyAdherenceTab_SearchBackupInstanceOrDatasourceSet_2c}\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\n// BackupJob\r\nlet JobOperationList = \"Backup\"; \r\nlet JobStatusList = \"*\";\r\nlet JobFailureCodeList = \"*\";\r\nlet ExcludeLog = true; \r\n// Grid specific params\r\nlet bin_Value =  iff(@\"{AggregationType}\" == \"Monthly\", 28d, 7d);\r\nlet sum_isJobSuccessInTheTimePeriod_Value = iff(@\"{AggregationType}\" == \"Monthly\", \"4\", \"1\"); \r\nlet duration_Value = iff(@\"{AggregationType}\" == \"Monthly\", \"27.00:00:00\", \"6.00:00:00\"); \r\nlet BackupInstanceWithWeeklyBackup = (){\r\n_AzureBackup_GetBackupInstances(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n| join kind = inner (\r\n// calling LA System Function\r\n_AzureBackup_GetPolicies(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList)\r\n) on $left.PolicyUniqueId == $right.UniqueId, $left.VaultResourceId == $right.VaultResourceId\r\n| where parse_json(ExtendedProperties).BackupFrequency == \"Weekly\"\r\n};\r\n// Grid Logic\r\nlet JobInfo = ()\r\n{\r\n// calling LA System Function\r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n| join kind = inner (BackupInstanceWithWeeklyBackup) on $left.BackupInstanceUniqueId == $right.UniqueId\r\n| summarize jobCount = count(), jobSuccessCount = countif(Status == \"Completed\" or Status == \"CompletedWithWarnings\"), BackupInstanceFriendlyName = any(BackupInstanceFriendlyName), BackupSolution =  any(BackupSolution), DatasourceSetResourceId = any(DatasourceSetResourceId), DatasourceSetFriendlyName = any(DatasourceSetFriendlyName) by BackupInstanceUniqueId, JobCreationDate = startofday(StartTime)\r\n| project ResourceGroup=iff(BackupSolution ==\"Azure Backup Agent\" or BackupSolution ==\"Azure Backup Server\" or BackupSolution ==\"DPM\",\"(none)\",split(split(tostring(tolower(DatasourceSetResourceId)), '/resourcegroups/')[1],'/')[0]), jobCount, jobSuccessCount, BackupInstanceFriendlyName, BackupInstanceUniqueId, DatasourceSetFriendlyName, JobCreationDate\r\n};\r\nJobInfo\r\n| summarize by BackupInstanceUniqueId, BackupInstanceFriendlyName, DatasourceSetFriendlyName, ResourceGroup\r\n| extend Day = range(RangeEnd, RangeStart, -1d)\r\n| mv-expand Day\r\n| project BackupInstanceUniqueId, BackupInstanceFriendlyName, DatasourceSetFriendlyName, ResourceGroup, todatetime(Day)\r\n| join kind = leftouter \r\n( JobInfo\r\n) on BackupInstanceUniqueId, $left.Day == $right.JobCreationDate\r\n| sort by BackupInstanceUniqueId, Day desc\r\n// Create weekly buckets to check if SLA met\r\n| summarize max(Day), min(Day), sum(jobSuccessCount), BackupInstanceFriendlyName = any(BackupInstanceFriendlyName), DatasourceSetFriendlyName = any(DatasourceSetFriendlyName), ResourceGroup = any(ResourceGroup) by BackupInstanceUniqueId, bin_at(Day, 7d, RangeEnd + 1d)\r\n| project BackupInstanceUniqueId, BackupInstanceFriendlyName, DatasourceSetFriendlyName, ResourceGroup, Day, sum_isJobSuccessInTheTimePeriod = iff(sum_jobSuccessCount > 1, 1, sum_jobSuccessCount), max_Day, min_Day\r\n| summarize max_Day = max(max_Day), min_Day = min(min_Day), sum_isJobSuccessInTheTimePeriod = sum(sum_isJobSuccessInTheTimePeriod), BackupInstanceFriendlyName = any(BackupInstanceFriendlyName), DatasourceSetFriendlyName = any(DatasourceSetFriendlyName), ResourceGroup = any(ResourceGroup) by BackupInstanceUniqueId, Day = bin_at(Day, bin_Value, RangeEnd + 1d)\r\n| project BackupInstanceUniqueId, BackupInstanceFriendlyName, DatasourceSetFriendlyName, ResourceGroup, Period =  strcat(format_datetime(todatetime(min_Day),\"yyyy/MM/dd\"), \" - \", format_datetime(todatetime(max_Day),\"yyyy/MM/dd\")), sum_isJobSuccessInTheTimePeriod, duration = max_Day - min_Day, Day\r\n// Exclude partial week/month\r\n| where duration == duration_Value\r\n| summarize sum_isJobSuccessInTheTimePeriod = countif(sum_isJobSuccessInTheTimePeriod == sum_isJobSuccessInTheTimePeriod_Value), Day= (any(Day)), BackupInstanceFriendlyName = any(BackupInstanceFriendlyName), DatasourceSetFriendlyName = any(DatasourceSetFriendlyName), ResourceGroup = any(ResourceGroup) by BackupInstanceUniqueId, Period\r\n| evaluate pivot(Period, any(sum_isJobSuccessInTheTimePeriod), BackupInstanceFriendlyName, BackupInstanceUniqueId, DatasourceSetFriendlyName, ResourceGroup)\r\n| summarize c=count()\r\n| project num = (c-1)/{PolicyAdherenceTab_RowsPerPage_2b} + 1\r\n| project nums = range(1,num,1), num\r\n| mvexpand nums\r\n| project nums = tostring(nums), num = strcat(tostring(nums),\" of \",tostring(num))",
                                                "crossComponentResources": [
                                                  "{Workspaces}"
                                                ],
                                                "value": "1",
                                                "typeSettings": {
                                                  "additionalResourceOptions": [],
                                                  "showDefault": false
                                                },
                                                "timeContext": {
                                                  "durationMs": 0
                                                },
                                                "timeContextFromParameter": "TimeRange",
                                                "queryType": 0,
                                                "resourceType": "microsoft.operationalinsights/workspaces"
                                              }
                                            ],
                                            "style": "pills",
                                            "doNotRunWhenHidden": true,
                                            "queryType": 0,
                                            "resourceType": "microsoft.operationalinsights/workspaces"
                                          },
                                          "customWidth": "90",
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Backup Instance"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_DailyOrWeeklyBackup",
                                              "comparison": "isEqualTo",
                                              "value": "Weekly"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByBackupInstance-WeeklyBackup-Grid1ParameterBlock",
                                          "styleSettings": {
                                            "padding": "0% 0% 0% 0%"
                                          }
                                        },
                                        {
                                          "type": 3,
                                          "content": {
                                            "version": "KqlItem/1.0",
                                            "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet DisplayAllFields = false;\r\nlet Item_search =  @\"{PolicyAdherenceTab_SearchBackupInstanceOrDatasourceSet_2c}\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\n// BackupJob\r\nlet JobOperationList = \"Backup\"; \r\nlet JobStatusList = \"*\";\r\nlet JobFailureCodeList = \"*\";\r\nlet ExcludeLog = true; \r\n// Grid specific params\r\nlet bin_Value =  iff(@\"{AggregationType}\" == \"Monthly\", 28d, 7d);\r\nlet sum_isJobSuccessInTheTimePeriod_Value = iff(@\"{AggregationType}\" == \"Monthly\", \"4\", \"1\"); \r\nlet duration_Value = iff(@\"{AggregationType}\" == \"Monthly\", \"27.00:00:00\", \"6.00:00:00\"); \r\nlet BackupInstanceWithWeeklyBackup = (){\r\n_AzureBackup_GetBackupInstances(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n| join kind = inner (\r\n// calling LA System Function\r\n_AzureBackup_GetPolicies(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList)\r\n) on $left.PolicyUniqueId == $right.UniqueId, $left.VaultResourceId == $right.VaultResourceId\r\n| where parse_json(ExtendedProperties).BackupFrequency == \"Weekly\"\r\n};\r\n// Grid Logic\r\nlet JobInfo = ()\r\n{\r\n// calling LA System Function\r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n| join kind = inner (BackupInstanceWithWeeklyBackup) on $left.BackupInstanceUniqueId == $right.UniqueId\r\n| summarize jobCount = count(), jobSuccessCount = countif(Status == \"Completed\" or Status == \"CompletedWithWarnings\"), BackupInstanceFriendlyName = any(BackupInstanceFriendlyName), BackupInstanceId = any(BackupInstanceId), BackupSolution =  any(BackupSolution), DatasourceSetResourceId = any(DatasourceSetResourceId), DatasourceSetFriendlyName = any(DatasourceSetFriendlyName) by BackupInstanceUniqueId, JobCreationDate = startofday(StartTime)\r\n| project ResourceGroup=iff(BackupSolution ==\"Azure Backup Agent\" or BackupSolution ==\"Azure Backup Server\" or BackupSolution ==\"DPM\",\"(none)\",split(split(tostring(tolower(DatasourceSetResourceId)), '/resourcegroups/')[1],'/')[0]), jobCount, jobSuccessCount, BackupInstanceFriendlyName, BackupInstanceUniqueId, DatasourceSetFriendlyName, JobCreationDate, BackupInstanceId\r\n};\r\nJobInfo\r\n| summarize by BackupInstanceUniqueId, BackupInstanceFriendlyName, DatasourceSetFriendlyName, ResourceGroup, BackupInstanceId\r\n| extend Day = range(RangeEnd, RangeStart, -1d)\r\n| mv-expand Day\r\n| project BackupInstanceUniqueId, BackupInstanceId, BackupInstanceFriendlyName, DatasourceSetFriendlyName, ResourceGroup, todatetime(Day)\r\n| join kind = leftouter \r\n( JobInfo\r\n) on BackupInstanceUniqueId, $left.Day == $right.JobCreationDate\r\n| sort by BackupInstanceUniqueId, Day desc\r\n// Create weekly buckets to check if SLA met\r\n| summarize max(Day), min(Day), sum(jobSuccessCount), BackupInstanceFriendlyName = any(BackupInstanceFriendlyName),BackupInstanceId = any(BackupInstanceId), DatasourceSetFriendlyName = any(DatasourceSetFriendlyName), ResourceGroup = any(ResourceGroup) by BackupInstanceUniqueId, bin_at(Day, 7d, RangeEnd + 1d)\r\n| project BackupInstanceUniqueId, BackupInstanceId, BackupInstanceFriendlyName, DatasourceSetFriendlyName, ResourceGroup, Day, sum_isJobSuccessInTheTimePeriod = iff(sum_jobSuccessCount > 1, 1, sum_jobSuccessCount), max_Day, min_Day\r\n| summarize max_Day = max(max_Day), min_Day = min(min_Day), sum_isJobSuccessInTheTimePeriod = sum(sum_isJobSuccessInTheTimePeriod), BackupInstanceFriendlyName = any(BackupInstanceFriendlyName), BackupInstanceId = any(BackupInstanceId), DatasourceSetFriendlyName = any(DatasourceSetFriendlyName), ResourceGroup = any(ResourceGroup) by BackupInstanceUniqueId, Day = bin_at(Day, bin_Value, RangeEnd + 1d)\r\n| project BackupInstanceUniqueId, BackupInstanceId, BackupInstanceFriendlyName, DatasourceSetFriendlyName, ResourceGroup, Period =  strcat(format_datetime(todatetime(min_Day),\"yyyy/MM/dd\"), \" - \", format_datetime(todatetime(max_Day),\"yyyy/MM/dd\")), sum_isJobSuccessInTheTimePeriod, duration = max_Day - min_Day, Day\r\n// Exclude partial week/month\r\n| where duration == duration_Value\r\n| summarize sum_isJobSuccessInTheTimePeriod = countif(sum_isJobSuccessInTheTimePeriod == sum_isJobSuccessInTheTimePeriod_Value), Day= (any(Day)), BackupInstanceFriendlyName = any(BackupInstanceFriendlyName), BackupInstanceId = any(BackupInstanceId), DatasourceSetFriendlyName = any(DatasourceSetFriendlyName), ResourceGroup = any(ResourceGroup) by BackupInstanceUniqueId, Period\r\n| evaluate pivot(Period, any(sum_isJobSuccessInTheTimePeriod), BackupInstanceFriendlyName, BackupInstanceId, BackupInstanceUniqueId, DatasourceSetFriendlyName, ResourceGroup)\r\n| sort by BackupInstanceUniqueId asc\r\n| extend row_num = row_number()\r\n| extend page_num = tostring(((row_num-1)/{PolicyAdherenceTab_RowsPerPage_2c} + 1))\r\n| where page_num has ('{PolicyAdherenceTab_Page_2c}') or '*' in ('{PolicyAdherenceTab_Page_2c}') | project-away row_num, page_num\r\n",
                                            "size": 3,
                                            "noDataMessage": "No records found for the selected scope and time range. Note that data for partial weeks is not displayed.",
                                            "exportedParameters": [
                                              {
                                                "fieldName": "DatasourceSetFriendlyName",
                                                "parameterName": "PolicyAdherence_WeeklyBackup_DatasourceSetFriendlyName",
                                                "parameterType": 1
                                              },
                                              {
                                                "fieldName": "BackupInstanceFriendlyName",
                                                "parameterName": "PolicyAdherence_WeeklyBackup_BackupInstanceFriendlyName",
                                                "parameterType": 1
                                              }
                                            ],
                                            "showExportToExcel": true,
                                            "queryType": 0,
                                            "resourceType": "microsoft.operationalinsights/workspaces",
                                            "crossComponentResources": [
                                              "{Workspaces}"
                                            ],
                                            "gridSettings": {
                                              "formatters": [
                                                {
                                                  "columnMatch": "BackupInstanceFriendlyName",
                                                  "formatter": 16,
                                                  "formatOptions": {
                                                    "linkColumn": "BackupInstanceId",
                                                    "linkTarget": "Resource",
                                                    "showIcon": true
                                                  },
                                                  "tooltipFormat": {
                                                    "tooltip": "Name of the backup instance"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "BackupInstanceId",
                                                  "formatter": 5
                                                },
                                                {
                                                  "columnMatch": "BackupInstanceUniqueId",
                                                  "formatter": 5
                                                },
                                                {
                                                  "columnMatch": "DatasourceSetFriendlyName",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Protected Container associated with the backup instance"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "ResourceGroup",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Resource group associated with the backup instance"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "[0-9][0-9][0-9][0-9]/[0-9][0-9]/[0-9][0-9]|[0-9][0-9][0-9][0-9]/[0-9][0-9]/[0-9][0-9] - [0-9][0-9][0-9][0-9]/[0-9][0-9]/[0-9][0-9]",
                                                  "formatter": 18,
                                                  "formatOptions": {
                                                    "thresholdsOptions": "colors",
                                                    "thresholdsGrid": [
                                                      {
                                                        "operator": ">",
                                                        "thresholdValue": "0",
                                                        "representation": "green",
                                                        "text": "."
                                                      },
                                                      {
                                                        "operator": "Default",
                                                        "thresholdValue": null,
                                                        "representation": "redBright",
                                                        "text": "."
                                                      }
                                                    ]
                                                  }
                                                }
                                              ],
                                              "labelSettings": [
                                                {
                                                  "columnId": "BackupInstanceFriendlyName",
                                                  "label": "Backup Instance"
                                                },
                                                {
                                                  "columnId": "DatasourceSetFriendlyName",
                                                  "label": "Container"
                                                },
                                                {
                                                  "columnId": "ResourceGroup",
                                                  "label": "Resource Group"
                                                }
                                              ]
                                            },
                                            "sortBy": []
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Backup Instance"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_DailyOrWeeklyBackup",
                                              "comparison": "isEqualTo",
                                              "value": "Weekly"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "showPin": true,
                                          "name": "PolicyAdherenceByBackupInstance-WeeklyBackup-Grid1",
                                          "styleSettings": {
                                            "showBorder": true
                                          }
                                        },
                                        {
                                          "type": 1,
                                          "content": {
                                            "json": "<span style=\"font-size:12px;font-style:italic\"> Click on any row above to see details of all backup jobs that were triggered in the selected period for the given backup instance. </span>"
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Backup Instance"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByBackupInstance-PromptText"
                                        },
                                        {
                                          "type": 1,
                                          "content": {
                                            "json": "<div style=\"text-align:left\"><span style=\"font-size:14px;font-weight:600;\">List of Backup Jobs in Period</span> </div>"
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Backup Instance"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_DailyBackup_BackupInstanceFriendlyName",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByBackupInstance-Grid2Title"
                                        },
                                        {
                                          "type": 9,
                                          "content": {
                                            "version": "KqlParameterItem/1.0",
                                            "parameters": [
                                              {
                                                "id": "0a8a7ff6-2849-46e2-8b52-4750eed51a8b",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherenceTab_SortBy_2a",
                                                "label": "Sort By",
                                                "type": 2,
                                                "description": "Use to sort by a certain column",
                                                "isRequired": true,
                                                "typeSettings": {
                                                  "additionalResourceOptions": [],
                                                  "showDefault": false
                                                },
                                                "jsonData": "[{ \"value\": \"DurationInSecs\", \"label\": \"Job Duration (hrs)\" },\r\n{ \"value\": \"DataTransferredInMBs\", \"label\": \"Data Transferred (MB)\", \"selected\": \"true\" }]",
                                                "timeContext": {
                                                  "durationMs": 604800000
                                                },
                                                "timeContextFromParameter": "TimeRange"
                                              },
                                              {
                                                "id": "941ce741-3f2f-44fe-bd1b-f44d2d7abc0d",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherenceTab_Order_2a",
                                                "label": "Order",
                                                "type": 2,
                                                "description": "Use to specify the sort order: Ascending/Descending",
                                                "isRequired": true,
                                                "typeSettings": {
                                                  "additionalResourceOptions": [],
                                                  "showDefault": false
                                                },
                                                "jsonData": "[\r\n    { \"value\":\"Ascending\"},\r\n    { \"value\":\"Descending\", \"selected\":true}\r\n]",
                                                "timeContext": {
                                                  "durationMs": 0
                                                },
                                                "timeContextFromParameter": "TimeRange"
                                              },
                                              {
                                                "id": "7e9d2fe4-d0bd-4c29-81f0-823dda4337d5",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherenceTab_RowsPerPage_2a",
                                                "label": "Rows per Page",
                                                "type": 2,
                                                "description": "Number of rows to display in grid view",
                                                "isRequired": true,
                                                "typeSettings": {
                                                  "additionalResourceOptions": [],
                                                  "showDefault": false
                                                },
                                                "jsonData": "[\r\n    { \"value\":10, \"label\":\"10\", \"selected\":true  },\r\n    { \"value\":25, \"label\":\"25\" },\r\n    { \"value\":50, \"label\":\"50\" },\r\n    { \"value\":100, \"label\":\"100\" },\r\n    { \"value\":250, \"label\":\"250\" },\r\n    { \"value\":500, \"label\":\"500\" },\r\n    { \"value\":1000, \"label\":\"1000\" }\r\n]",
                                                "timeContext": {
                                                  "durationMs": 0
                                                },
                                                "timeContextFromParameter": "TimeRange"
                                              },
                                              {
                                                "id": "fa53c49c-3992-4413-bd0e-fb639de3e0e9",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherenceTab_Page_2a",
                                                "label": "Page",
                                                "type": 2,
                                                "description": "Select Page Number",
                                                "isRequired": true,
                                                "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet DisplayAllFields = false;\r\nlet BackupInstanceName = @\"{PolicyAdherence_DailyBackup_BackupInstanceFriendlyName}\";\r\nlet DatasourceSetName = @\"{PolicyAdherence_DailyBackup_DatasourceSetFriendlyName}\";\r\nlet JobOperationList = \"Backup\";\r\nlet JobStatusList = \"*\";\r\nlet JobFailureCodeList = \"*\";\r\nlet ExcludeLog = true; \r\nlet PolicyAdherence_DailyOrWeeklyBackup_Value = @\"{PolicyAdherence_DailyOrWeeklyBackup}\";\r\nlet BackupInstanceWithSelectedBackupFrequency = (){\r\n_AzureBackup_GetBackupInstances(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n| join kind = inner (\r\n// calling LA System Function\r\n_AzureBackup_GetPolicies(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList)\r\n) on $left.PolicyUniqueId == $right.UniqueId, $left.VaultResourceId == $right.VaultResourceId\r\n| where parse_json(ExtendedProperties).BackupFrequency == PolicyAdherence_DailyOrWeeklyBackup_Value\r\n};\r\n// calling LA System Function\r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n| join kind = inner (BackupInstanceWithSelectedBackupFrequency) on $left.BackupInstanceUniqueId == $right.UniqueId\r\n| summarize c=count()\r\n| project num = (c-1)/{PolicyAdherenceTab_RowsPerPage_2a} + 1\r\n| project nums = range(1,num,1), num\r\n| mvexpand nums\r\n| project nums = tostring(nums), num = strcat(tostring(nums),\" of \",tostring(num)) ",
                                                "crossComponentResources": [
                                                  "{Workspaces}"
                                                ],
                                                "value": "1",
                                                "typeSettings": {
                                                  "additionalResourceOptions": [],
                                                  "showDefault": false
                                                },
                                                "queryType": 0,
                                                "resourceType": "microsoft.operationalinsights/workspaces"
                                              }
                                            ],
                                            "style": "pills",
                                            "doNotRunWhenHidden": true,
                                            "queryType": 0,
                                            "resourceType": "microsoft.operationalinsights/workspaces"
                                          },
                                          "customWidth": "90",
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "PolicyAdherence_DailyBackup_BackupInstanceFriendlyName",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByBackupInstance-DailyBackup-Grid2ParameterBlock",
                                          "styleSettings": {
                                            "padding": "0% 0% 0% 0%"
                                          }
                                        },
                                        {
                                          "type": 3,
                                          "content": {
                                            "version": "KqlItem/1.0",
                                            "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet DisplayAllFields = false;\r\nlet BackupInstanceName = @\"{PolicyAdherence_DailyBackup_BackupInstanceFriendlyName}\";\r\nlet DatasourceSetName = @\"{PolicyAdherence_DailyBackup_DatasourceSetFriendlyName}\";\r\nlet JobOperationList = \"Backup\"; \r\nlet JobStatusList = \"*\";\r\nlet JobFailureCodeList = \"*\";\r\nlet ExcludeLog = true; \r\nlet PolicyAdherence_DailyOrWeeklyBackup_Value = @\"{PolicyAdherence_DailyOrWeeklyBackup}\";\r\nlet BackupInstanceWithSelectedBackupFrequency = (){\r\n_AzureBackup_GetBackupInstances(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n| join kind = inner (\r\n// calling LA System Function\r\n_AzureBackup_GetPolicies(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList)\r\n) on $left.PolicyUniqueId == $right.UniqueId, $left.VaultResourceId == $right.VaultResourceId\r\n| where parse_json(ExtendedProperties).BackupFrequency == PolicyAdherence_DailyOrWeeklyBackup_Value\r\n};\r\n// calling LA System Function\r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n| join kind = inner (BackupInstanceWithSelectedBackupFrequency) on $left.BackupInstanceUniqueId == $right.UniqueId\r\n| extend TempColumn = column_ifexists(tostring('{PolicyAdherenceTab_SortBy_2a}'), \"DataTransferredInMBs\")\r\n| extend ColumnToBeSorted = iff(tostring('{PolicyAdherenceTab_Order_2a}') == \"Ascending\", todouble(TempColumn) - 90000000, 90000000 - todouble(TempColumn))\r\n| sort by ColumnToBeSorted asc nulls last, UniqueId asc\r\n| extend row_num = row_number()\r\n| extend page_num = tostring(((row_num-1)/{PolicyAdherenceTab_RowsPerPage_2a} + 1))\r\n| where page_num has ('{PolicyAdherenceTab_Page_2a}') or '*' in ('{PolicyAdherenceTab_Page_2a}')\r\n| project BackupInstance=BackupInstanceFriendlyName, BackupInstanceId, Container=DatasourceSetFriendlyName, ResourceGroup=iff(DatasourceType==\"Azure Backup Agent\" or DatasourceType==\"Azure Backup Server\" or DatasourceType==\"DPM\",\"(none)\",split(split(tostring(tolower(DatasourceSetResourceId)), '/resourcegroups/')[1],'/')[0]\r\n), OperationCategory, JobStatus=Status,  JobStartDateTime=StartTime, JobDuration=DurationInSecs/3600, ErrorTitle, DataTransferred=DataTransferredInMBs, AzureResource=DatasourceSetResourceId, DatasourceType \r\n",
                                            "size": 3,
                                            "showExportToExcel": true,
                                            "queryType": 0,
                                            "resourceType": "microsoft.operationalinsights/workspaces",
                                            "crossComponentResources": [
                                              "{Workspaces}"
                                            ],
                                            "gridSettings": {
                                              "formatters": [
                                                {
                                                  "columnMatch": "BackupInstance",
                                                  "formatter": 16,
                                                  "formatOptions": {
                                                    "linkColumn": "BackupInstanceId",
                                                    "linkTarget": "Resource",
                                                    "showIcon": true
                                                  },
                                                  "tooltipFormat": {
                                                    "tooltip": "Name of the backup instance"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "BackupInstanceId",
                                                  "formatter": 5
                                                },
                                                {
                                                  "columnMatch": "Container",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Protected Container associated with the backup instance"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "ResourceGroup",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Resource group associated with the backup instance"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "OperationCategory",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Operation Category"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "JobStatus",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Job Status"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "JobStartDateTime",
                                                  "formatter": 6,
                                                  "dateFormat": {
                                                    "showUtcTime": true,
                                                    "formatName": "shortDateTimePattern"
                                                  },
                                                  "tooltipFormat": {
                                                    "tooltip": "Start date and time of the Job"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "JobDuration",
                                                  "formatter": 4,
                                                  "formatOptions": {
                                                    "min": 0,
                                                    "palette": "blue"
                                                  },
                                                  "numberFormat": {
                                                    "unit": 0,
                                                    "options": {
                                                      "style": "decimal",
                                                      "maximumFractionDigits": 2
                                                    }
                                                  },
                                                  "tooltipFormat": {
                                                    "tooltip": "Job Duration"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "ErrorTitle",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Job Failure Code"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "DataTransferred",
                                                  "formatter": 4,
                                                  "formatOptions": {
                                                    "min": 0,
                                                    "palette": "blue"
                                                  },
                                                  "numberFormat": {
                                                    "unit": 0,
                                                    "options": {
                                                      "style": "decimal",
                                                      "maximumFractionDigits": 2
                                                    }
                                                  },
                                                  "tooltipFormat": {
                                                    "tooltip": "Amount of data transferred by the job"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "AzureResource",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Azure Resource associated with the backup instance. For Azure VM Backup, SQL in Azure VM backup and SAP database in Azure VM backup, the Azure Resource is the Azure VM. For Azure Files Share backup, the Azure Resource is the Azure Storage account. For on-premises backup instances, this field is blank."
                                                  }
                                                },
                                                {
                                                  "columnMatch": "DatasourceType",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Datasource Type"
                                                  }
                                                }
                                              ],
                                              "filter": true,
                                              "labelSettings": [
                                                {
                                                  "columnId": "OperationCategory",
                                                  "label": "Operation Category"
                                                },
                                                {
                                                  "columnId": "ErrorTitle",
                                                  "label": "Error Title"
                                                },
                                                {
                                                  "columnId": "DatasourceType",
                                                  "label": "Datasource Type"
                                                }
                                              ]
                                            },
                                            "sortBy": []
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "PolicyAdherence_DailyBackup_BackupInstanceFriendlyName",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "showPin": false,
                                          "name": "PolicyAdherenceByBackupInstance-DailyBackup-Grid2"
                                        },
                                        {
                                          "type": 1,
                                          "content": {
                                            "json": "<div style=\"text-align:left\"><span style=\"font-size:14px;font-weight:600;\">List of Backup Jobs in Period</span> </div>"
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "PolicyAdherence_SubTab",
                                              "comparison": "isEqualTo",
                                              "value": "Policy Adherence by Backup Instance"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "PolicyAdherence_WeeklyBackup_BackupInstanceFriendlyName",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByBackupInstance-WeeklyBackup-Grid2Title"
                                        },
                                        {
                                          "type": 9,
                                          "content": {
                                            "version": "KqlParameterItem/1.0",
                                            "parameters": [
                                              {
                                                "id": "1d337e2a-8cf3-48b1-ab33-e94e0dd62b46",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherenceTab_SortBy_2d",
                                                "label": "Sort By",
                                                "type": 2,
                                                "description": "Use to sort by a certain column",
                                                "isRequired": true,
                                                "typeSettings": {
                                                  "additionalResourceOptions": [],
                                                  "showDefault": false
                                                },
                                                "jsonData": "[{ \"value\": \"DurationInSecs\", \"label\": \"Job Duration (hrs)\" },\r\n{ \"value\": \"DataTransferredInMBs\", \"label\": \"Data Transferred (MB)\", \"selected\": \"true\" }]",
                                                "timeContext": {
                                                  "durationMs": 604800000
                                                },
                                                "timeContextFromParameter": "TimeRange"
                                              },
                                              {
                                                "id": "5b6194ab-e6fe-4e97-8ab5-2d2a5f35dbc9",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherenceTab_Order_2d",
                                                "label": "Order",
                                                "type": 2,
                                                "description": "Use to specify the sort order: Ascending/Descending",
                                                "isRequired": true,
                                                "typeSettings": {
                                                  "additionalResourceOptions": [],
                                                  "showDefault": false
                                                },
                                                "jsonData": "[\r\n    { \"value\":\"Ascending\"},\r\n    { \"value\":\"Descending\", \"selected\":true}\r\n]",
                                                "timeContext": {
                                                  "durationMs": 0
                                                },
                                                "timeContextFromParameter": "TimeRange"
                                              },
                                              {
                                                "id": "f0dade2b-e0c3-4dc9-8fe2-cdeff6773082",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherenceTab_RowsPerPage_2d",
                                                "label": "Rows per Page",
                                                "type": 2,
                                                "description": "Number of rows to display in grid view",
                                                "isRequired": true,
                                                "typeSettings": {
                                                  "additionalResourceOptions": [],
                                                  "showDefault": false
                                                },
                                                "jsonData": "[\r\n    { \"value\":10, \"label\":\"10\", \"selected\":true  },\r\n    { \"value\":25, \"label\":\"25\" },\r\n    { \"value\":50, \"label\":\"50\" },\r\n    { \"value\":100, \"label\":\"100\" },\r\n    { \"value\":250, \"label\":\"250\" },\r\n    { \"value\":500, \"label\":\"500\" },\r\n    { \"value\":1000, \"label\":\"1000\" }\r\n]",
                                                "timeContext": {
                                                  "durationMs": 0
                                                },
                                                "timeContextFromParameter": "TimeRange"
                                              },
                                              {
                                                "id": "7357c97e-59fd-4df0-a979-560063c13c0c",
                                                "version": "KqlParameterItem/1.0",
                                                "name": "PolicyAdherenceTab_Page_2d",
                                                "label": "Page",
                                                "type": 2,
                                                "description": "Select Page Number",
                                                "isRequired": true,
                                                "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet DisplayAllFields = false;\r\nlet BackupInstanceName = @\"{PolicyAdherence_WeeklyBackup_BackupInstanceFriendlyName}\";\r\nlet DatasourceSetName = @\"{PolicyAdherence_WeeklyBackup_DatasourceSetFriendlyName}\";\r\nlet JobOperationList = \"Backup\"; \r\nlet JobStatusList = \"*\";\r\nlet JobFailureCodeList = \"*\";\r\nlet ExcludeLog = true; \r\nlet PolicyAdherence_DailyOrWeeklyBackup_Value = @\"{PolicyAdherence_DailyOrWeeklyBackup}\";\r\nlet BackupInstanceWithSelectedBackupFrequency = (){\r\n_AzureBackup_GetBackupInstances(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n| join kind = inner (\r\n// calling LA System Function\r\n_AzureBackup_GetPolicies(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList)\r\n) on $left.PolicyUniqueId == $right.UniqueId, $left.VaultResourceId == $right.VaultResourceId\r\n| where parse_json(ExtendedProperties).BackupFrequency == PolicyAdherence_DailyOrWeeklyBackup_Value\r\n};\r\n// calling LA System Function\r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n| join kind = inner (BackupInstanceWithSelectedBackupFrequency) on $left.BackupInstanceUniqueId == $right.UniqueId\r\n| summarize c=count()\r\n| project num = (c-1)/{PolicyAdherenceTab_RowsPerPage_2d} + 1\r\n| project nums = range(1,num,1), num\r\n| mvexpand nums\r\n| project nums = tostring(nums), num = strcat(tostring(nums),\" of \",tostring(num)) ",
                                                "crossComponentResources": [
                                                  "{Workspaces}"
                                                ],
                                                "value": "1",
                                                "typeSettings": {
                                                  "additionalResourceOptions": [],
                                                  "showDefault": false
                                                },
                                                "queryType": 0,
                                                "resourceType": "microsoft.operationalinsights/workspaces"
                                              }
                                            ],
                                            "style": "pills",
                                            "doNotRunWhenHidden": true,
                                            "queryType": 0,
                                            "resourceType": "microsoft.operationalinsights/workspaces"
                                          },
                                          "customWidth": "90",
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "PolicyAdherence_WeeklyBackup_BackupInstanceFriendlyName",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "name": "PolicyAdherenceByBackupInstance-WeeklyBackup-Grid2ParameterBlock",
                                          "styleSettings": {
                                            "padding": "0% 0% 0% 0%"
                                          }
                                        },
                                        {
                                          "type": 3,
                                          "content": {
                                            "version": "KqlItem/1.0",
                                            "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet DisplayAllFields = false;\r\nlet BackupInstanceName = @\"{PolicyAdherence_WeeklyBackup_BackupInstanceFriendlyName}\";\r\nlet DatasourceSetName = @\"{PolicyAdherence_WeeklyBackup_DatasourceSetFriendlyName}\";\r\nlet JobOperationList = \"Backup\"; \r\nlet JobStatusList = \"*\";\r\nlet JobFailureCodeList = \"*\";\r\nlet ExcludeLog = true; \r\nlet PolicyAdherence_DailyOrWeeklyBackup_Value = @\"{PolicyAdherence_DailyOrWeeklyBackup}\";\r\nlet BackupInstanceWithSelectedBackupFrequency = (){\r\n_AzureBackup_GetBackupInstances(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, ProtectionInfoList, DatasourceSetName, BackupInstanceName, DisplayAllFields)\r\n| join kind = inner (\r\n// calling LA System Function\r\n_AzureBackup_GetPolicies(RangeEnd, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList)\r\n) on $left.PolicyUniqueId == $right.UniqueId, $left.VaultResourceId == $right.VaultResourceId\r\n| where parse_json(ExtendedProperties).BackupFrequency == PolicyAdherence_DailyOrWeeklyBackup_Value\r\n};\r\n// calling LA System Function\r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n| join kind = inner (BackupInstanceWithSelectedBackupFrequency) on $left.BackupInstanceUniqueId == $right.UniqueId\r\n| extend TempColumn = column_ifexists(tostring('{PolicyAdherenceTab_SortBy_2d}'), \"DataTransferredInMBs\")\r\n| extend ColumnToBeSorted = iff(tostring('{PolicyAdherenceTab_Order_2d}') == \"Ascending\", todouble(TempColumn) - 90000000, 90000000 - todouble(TempColumn))\r\n| sort by ColumnToBeSorted asc nulls last, UniqueId asc\r\n| extend row_num = row_number()\r\n| extend page_num = tostring(((row_num-1)/{PolicyAdherenceTab_RowsPerPage_2d} + 1))\r\n| where page_num has ('{PolicyAdherenceTab_Page_2d}') or '*' in ('{PolicyAdherenceTab_Page_2d}')\r\n| project BackupInstance=BackupInstanceFriendlyName, BackupInstanceId, Container=DatasourceSetFriendlyName, ResourceGroup=iff(DatasourceType==\"Azure Backup Agent\" or DatasourceType==\"Azure Backup Server\" or DatasourceType==\"DPM\",\"(none)\",split(split(tostring(tolower(DatasourceSetResourceId)), '/resourcegroups/')[1],'/')[0]\r\n), OperationCategory, JobStatus=Status,  JobStartDateTime=StartTime, JobDuration=DurationInSecs/3600, ErrorTitle, DataTransferred=DataTransferredInMBs, AzureResource=DatasourceSetResourceId, DatasourceType \r\n",
                                            "size": 3,
                                            "showExportToExcel": true,
                                            "queryType": 0,
                                            "resourceType": "microsoft.operationalinsights/workspaces",
                                            "crossComponentResources": [
                                              "{Workspaces}"
                                            ],
                                            "gridSettings": {
                                              "formatters": [
                                                {
                                                  "columnMatch": "BackupInstance",
                                                  "formatter": 16,
                                                  "formatOptions": {
                                                    "linkColumn": "BackupInstanceId",
                                                    "linkTarget": "Resource",
                                                    "showIcon": true
                                                  },
                                                  "tooltipFormat": {
                                                    "tooltip": "Name of the backup instance"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "BackupInstanceId",
                                                  "formatter": 5
                                                },
                                                {
                                                  "columnMatch": "Container",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Protected Container associated with the backup instance"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "ResourceGroup",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Resource group associated with the backup instance"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "OperationCategory",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Operation Category"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "JobStatus",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Job Status"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "JobStartDateTime",
                                                  "formatter": 6,
                                                  "dateFormat": {
                                                    "showUtcTime": true,
                                                    "formatName": "shortDateTimePattern"
                                                  },
                                                  "tooltipFormat": {
                                                    "tooltip": "Start date and time of the Job"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "JobDuration",
                                                  "formatter": 4,
                                                  "formatOptions": {
                                                    "min": 0,
                                                    "palette": "blue"
                                                  },
                                                  "numberFormat": {
                                                    "unit": 0,
                                                    "options": {
                                                      "style": "decimal",
                                                      "maximumFractionDigits": 2
                                                    }
                                                  },
                                                  "tooltipFormat": {
                                                    "tooltip": "Job Duration"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "ErrorTitle",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Job Failure Code"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "DataTransferred",
                                                  "formatter": 4,
                                                  "formatOptions": {
                                                    "min": 0,
                                                    "palette": "blue"
                                                  },
                                                  "numberFormat": {
                                                    "unit": 0,
                                                    "options": {
                                                      "style": "decimal",
                                                      "maximumSignificantDigits": 2
                                                    }
                                                  },
                                                  "tooltipFormat": {
                                                    "tooltip": "Amount of data transferred by the job"
                                                  }
                                                },
                                                {
                                                  "columnMatch": "AzureResource",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Azure Resource associated with the backup instance. For Azure VM Backup, SQL in Azure VM backup and SAP database in Azure VM backup, the Azure Resource is the Azure VM. For Azure Files Share backup, the Azure Resource is the Azure Storage account. For on-premises backup instances, this field is blank."
                                                  }
                                                },
                                                {
                                                  "columnMatch": "DatasourceType",
                                                  "formatter": 0,
                                                  "tooltipFormat": {
                                                    "tooltip": "Datasource Type"
                                                  }
                                                }
                                              ],
                                              "labelSettings": [
                                                {
                                                  "columnId": "BackupInstance",
                                                  "label": "Backup Instance"
                                                },
                                                {
                                                  "columnId": "ResourceGroup",
                                                  "label": "Resource Group"
                                                },
                                                {
                                                  "columnId": "OperationCategory",
                                                  "label": "Operation Category"
                                                },
                                                {
                                                  "columnId": "JobStatus",
                                                  "label": "Job Status"
                                                },
                                                {
                                                  "columnId": "JobStartDateTime",
                                                  "label": "Job Start Date Time"
                                                },
                                                {
                                                  "columnId": "JobDuration",
                                                  "label": "Job Duration (hrs)"
                                                },
                                                {
                                                  "columnId": "ErrorTitle",
                                                  "label": "Job Failure Code"
                                                },
                                                {
                                                  "columnId": "DataTransferred",
                                                  "label": "Data Transferred"
                                                },
                                                {
                                                  "columnId": "AzureResource",
                                                  "label": "Azure Resource"
                                                },
                                                {
                                                  "columnId": "DatasourceType",
                                                  "label": "Datasource Type"
                                                }
                                              ]
                                            },
                                            "sortBy": []
                                          },
                                          "conditionalVisibilities": [
                                            {
                                              "parameterName": "PolicyAdherence_WeeklyBackup_BackupInstanceFriendlyName",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "Workspaces",
                                              "comparison": "isNotEqualTo"
                                            },
                                            {
                                              "parameterName": "DatasourceType",
                                              "comparison": "isNotEqualTo"
                                            }
                                          ],
                                          "showPin": true,
                                          "name": "PolicyAdherenceByBackupInstance-WeeklyBackup-Grid2",
                                          "styleSettings": {
                                            "showBorder": true
                                          }
                                        }
                                      ]
                                    },
                                    "name": "group - 0"
                                  }
                                ]
                              },
                              "name": "PolicyAdherence-group"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "adhearance"
                        },
                        "name": "Adhearance"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "backuptab",
                    "comparison": "isEqualTo",
                    "value": "policies"
                  },
                  "name": "Backup Policies"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "d83391c6-b749-47f9-8fae-3ed79dafe967",
                              "version": "KqlParameterItem/1.0",
                              "name": "Subscription",
                              "label": "Choose Subscription",
                              "type": 6,
                              "description": "Choose a subscription",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "includeAll": true,
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::3"
                            },
                            {
                              "id": "e5ec7b7e-171d-4d90-bc68-fb53f3444837",
                              "version": "KqlParameterItem/1.0",
                              "name": "Workspace",
                              "label": "Choose Workspace",
                              "type": 5,
                              "description": "Choose a LA Workspace",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "Resources\r\n| where type =~ \"Microsoft.operationalinsights/workspaces\"\r\n| summarize by id",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::all",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "id": "2ab526a9-2062-46bb-835a-4db33f003ae5",
                              "version": "KqlParameterItem/1.0",
                              "name": "TimeRange",
                              "label": "Time Range",
                              "type": 4,
                              "value": {
                                "durationMs": 7776000000
                              },
                              "typeSettings": {
                                "selectableValues": [
                                  {
                                    "durationMs": 300000
                                  },
                                  {
                                    "durationMs": 900000
                                  },
                                  {
                                    "durationMs": 1800000
                                  },
                                  {
                                    "durationMs": 3600000
                                  },
                                  {
                                    "durationMs": 14400000
                                  },
                                  {
                                    "durationMs": 43200000
                                  },
                                  {
                                    "durationMs": 86400000
                                  },
                                  {
                                    "durationMs": 172800000
                                  },
                                  {
                                    "durationMs": 259200000
                                  },
                                  {
                                    "durationMs": 604800000
                                  },
                                  {
                                    "durationMs": 1209600000
                                  },
                                  {
                                    "durationMs": 2419200000
                                  },
                                  {
                                    "durationMs": 2592000000
                                  },
                                  {
                                    "durationMs": 5184000000
                                  },
                                  {
                                    "durationMs": 7776000000
                                  }
                                ]
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "conditionalVisibility": {
                          "parameterName": "Tabname",
                          "comparison": "isNotEqualTo",
                          "value": "summary"
                        },
                        "name": "parameters - 1 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "RecoveryServicesResources\r\n| where type == \"microsoft.recoveryservices/vaults/alerts\"\r\n| where properties.sourceType == \"IaaSVM\"\r\n| where todatetime(properties.initialOccurrenceTime) {TimeRange}\r\n| extend vaultId = tolower(replace(\"\\\\/alerts.*\",\"\",id))\r\n| extend Items = \"Backup Alerts\", SubText = \"Total\"\r\n| summarize c = count()\r\n| extend Item = \"Backup Alerts\", SubText = \"Total\", Key = 3",
                          "size": 4,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Item",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "c",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": true
                          }
                        },
                        "name": "Jobs"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "RecoveryServicesResources\r\n| where type == \"microsoft.recoveryservices/vaults/alerts\"\r\n| where properties.sourceType == \"IaaSVM\"\r\n| where todatetime(properties.initialOccurrenceTime) {TimeRange}\r\n| extend vaultId = tolower(replace(\"\\\\/alerts.*\",\"\",id))\r\n\r\n| extend SubText = \"Alerts\", severity = iff(tolong(properties.severity) == 1, \"Critical\", iff(tolong(properties.severity) == 2, \"Warining\", \"Info\"))\r\n| summarize c=count() by severity\r\n| sort by severity\r\n",
                          "size": 4,
                          "title": "By Severity",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Critical",
                                "color": "redBright"
                              },
                              {
                                "seriesName": "Warning",
                                "color": "orange"
                              },
                              {
                                "seriesName": "Info",
                                "color": "lightBlue"
                              }
                            ]
                          }
                        },
                        "customWidth": "50",
                        "name": "By Severity"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "RecoveryServicesResources\r\n| where type == \"microsoft.recoveryservices/vaults/alerts\"\r\n| where properties.sourceType == \"IaaSVM\"\r\n| where todatetime(properties.initialOccurrenceTime) {TimeRange}\r\n| extend vaultId = tolower(replace(\"\\\\/alerts.*\",\"\",id))\r\n| extend SubText = \"Alerts\", severity = iff(tolong(properties.severity) == 1, \"Critical\", iff(tolong(properties.severity) == 2, \"Warining\", \"Info\"))\r\n\r\n| summarize c=count() by AlertName = tostring(properties.alertTitle)\r\n| sort by AlertName\r\n",
                          "size": 4,
                          "title": "By Type",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Delete Backup Data",
                                "label": "Delete Backup Data",
                                "color": "redBright"
                              },
                              {
                                "seriesName": "Backup failure",
                                "label": "Backup failure",
                                "color": "orange"
                              },
                              {
                                "seriesName": "Restore failure",
                                "color": "lightBlue"
                              },
                              {
                                "seriesName": "Backup completed with warnings",
                                "color": "green"
                              }
                            ]
                          }
                        },
                        "customWidth": "50",
                        "name": "By Type"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "RecoveryServicesResources\r\n| where type == \"microsoft.recoveryservices/vaults/alerts\"\r\n| where properties.sourceType == \"IaaSVM\"\r\n| where todatetime(properties.initialOccurrenceTime) {TimeRange}\r\n| extend vaultId = tolower(replace(\"\\\\/alerts.*\",\"\",id))\r\n| project backupItemId = strcat(vaultId,\"/backupFabrics/Azure/protectionContainers/IaasVMContainer;\",tostring(properties.firstLevelContainerId),\"/protectedItems/VM;\",tostring(properties.firstLevelContainerId)),\r\n          Item = tostring(split(tostring(properties.firstLevelContainerId),\";\")[2]),\r\n          ResourceGroup = tostring(split(tostring(properties.firstLevelContainerId),\";\")[1]),\r\n\t\t  HostHash = hash(tolower(strcat(subscriptionId, tostring(split(tostring(properties.firstLevelContainerId),\";\")[1]), tostring(split(tostring(properties.firstLevelContainerId),\";\")[2])))),\r\n          alertId = id, \r\n\t\t  backupItemHostId = strcat(\r\n\t\t  replace(\"\\\\/resourcegroups.*\",\"\",tolower(id)),\"/resourceGroups/\",tostring(split(tostring(properties.firstLevelContainerId),\";\")[1]),\r\n\t\t  \"/providers/Microsoft.\",\r\n\t\t  iff(tostring(properties.firstLevelContainerId) contains \"iaasvmcontainerv2;\", \"Compute/virtualMachines/\", \"ClassicCompute/virtualMachines/\"),             tostring(split(tostring(properties.firstLevelContainerId),\";\")[2])\r\n\t\t  ),\r\n\t\t  AlertName = tostring(properties.alertTitle),\r\n          CreationTime = todatetime(properties.initialOccurrenceTime),\r\n\t\t  Duration = replace(\"\\\\..*\",\"\",tostring(properties.duration)),\r\n\t\t  Severity = iff(tolong(properties.severity) == 1, \"Critical\", iff(tolong(properties.severity) == 2, \"Warining\", \"Info\")),\r\n\t\t  Status = iff(tolong(properties.status) == 1, \"Active\", \"Resolved\"),\r\n\t\t  ResolutionTime = todatetime(properties.resolutionTime),\r\n\t\t  vaultId\r\n| project backupItemId, Item, ResourceGroup, alertId, AlertName, CreationTime, Duration, Severity, Status, vaultId\r\n| sort by Item asc, alertId asc\r\n",
                          "size": 0,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "contains",
                                      "thresholdValue": "Critical",
                                      "representation": "4",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "contains",
                                      "thresholdValue": "Warning",
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "contains",
                                      "thresholdValue": "info",
                                      "representation": "1",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "more",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Status",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "contains",
                                      "thresholdValue": "Active",
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "contains",
                                      "thresholdValue": "Resolved",
                                      "representation": "Close",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "more",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ]
                          }
                        },
                        "name": "query - 4"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "backuptab",
                    "comparison": "isEqualTo",
                    "value": "alerts"
                  },
                  "name": "Alerts"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "// function Params - Report Filters\r\nlet RangeStart = startofday({TimeRange:start});\r\nlet RangeEnd = iff(startofday({TimeRange:end}) == startofday(now()) ,startofday({TimeRange:end}) - 1d , startofday({TimeRange:end}));\r\nlet VaultSubscriptionList = todynamic( replace(\"/subscriptions/\", \"\", @\"{VaultSubscription}\"));\r\nlet VaultLocationList = todynamic( @\"{VaultLocation}\"); \r\nlet VaultTypeList = \"*\";\r\nlet VaultList = todynamic( @\"{VaultName}\");\r\nlet ExcludeLegacyEvent = @\"{ExcludeLegacyEvent}\";\r\nlet BackupSolutionList = @\"{DatasourceType}\";\r\n// function Params - other Filters\r\nlet ProtectionInfoList = \"*\";\r\nlet Item_search =  @\"{JobTab_SearchBackupInstanceOrDatasourceSet}\";\r\nlet ItemArray = split(Item_search, \";\");\r\nlet ItemArray_length = array_length(ItemArray);\r\nlet BackupInstanceName = iff(ItemArray_length == 2, ItemArray[1], ItemArray[0] );\r\nlet DatasourceSetName = iff(ItemArray_length == 2, ItemArray[0], \"\");\r\nlet JobOperationList = todynamic( @\"{JobTab_JobOperation}\"); \r\nlet JobStatusList = todynamic( @\"{JobTab_JobStatus}\");\r\nlet JobFailureCodeList = todynamic( @\"{JobTab_JobFailureCode}\");\r\nlet ExcludeLog = true; \r\n// local Params\r\nlet BackupInstanceUniqueIdParam =  @\"{JobTab_SearchBackupInstanceUniqueId}\";\r\n// calling LA System Function\r\n_AzureBackup_GetJobs(RangeStart, RangeEnd, VaultSubscriptionList, VaultLocationList, VaultList, VaultTypeList, ExcludeLegacyEvent, BackupSolutionList, JobOperationList, JobStatusList, JobFailureCodeList, DatasourceSetName, BackupInstanceName, ExcludeLog)\r\n// query to transform function output\r\n| where BackupInstanceUniqueId == (BackupInstanceUniqueIdParam) or '*' in (BackupInstanceUniqueIdParam)\r\n| extend TempColumn = column_ifexists(tostring('{JobTab_SortBy_2}'), \"DataTransferredInMBs\")\r\n| extend ColumnToBeSorted = iff(tostring('{JobTab_Order_2}') == \"Ascending\", todouble(TempColumn) - 90000000, 90000000 - todouble(TempColumn))\r\n| sort by ColumnToBeSorted asc nulls last, UniqueId asc\r\n| extend row_num = row_number()\r\n| extend page_num = tostring(((row_num-1)/{JobTab_RowsPerPage_2} + 1))\r\n| where page_num has ('{JobTab_Page_2}') or '*' in ('{JobTab_Page_2}')\r\n| project BackupInstance=BackupInstanceFriendlyName, BackupInstanceId, Container=DatasourceSetFriendlyName, ResourceGroup=iff(DatasourceType==\"Azure Backup Agent\" or DatasourceType==\"Azure Backup Server\" or DatasourceType==\"DPM\",\"(none)\",split(split(tostring(tolower(DatasourceSetResourceId)), '/resourcegroups/')[1],'/')[0]\r\n), OperationCategory, JobStatus=Status,  JobStartDateTime=StartTime, JobDuration=DurationInSecs/3600, ErrorTitle, DataTransferred=DataTransferredInMBs, AzureResource=DatasourceSetResourceId, DatasourceType ",
                    "size": 3,
                    "noDataMessage": "No records found for the selected time range and scope",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspaces}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "BackupInstance",
                          "formatter": 16,
                          "formatOptions": {
                            "linkColumn": "BackupInstanceId",
                            "linkTarget": "Resource",
                            "showIcon": true
                          },
                          "tooltipFormat": {
                            "tooltip": "Name of the backup instance"
                          }
                        },
                        {
                          "columnMatch": "BackupInstanceId",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Container",
                          "formatter": 0,
                          "tooltipFormat": {
                            "tooltip": "Protected Container associated with the backup instance"
                          }
                        },
                        {
                          "columnMatch": "ResourceGroup",
                          "formatter": 0,
                          "tooltipFormat": {
                            "tooltip": "Resource group associated with the backup instance"
                          }
                        },
                        {
                          "columnMatch": "OperationCategory",
                          "formatter": 0,
                          "tooltipFormat": {
                            "tooltip": "Operation Category"
                          }
                        },
                        {
                          "columnMatch": "JobStatus",
                          "formatter": 0,
                          "tooltipFormat": {
                            "tooltip": "Job Status"
                          }
                        },
                        {
                          "columnMatch": "JobStartDateTime",
                          "formatter": 6,
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "useGrouping": false
                            }
                          },
                          "dateFormat": {
                            "showUtcTime": true,
                            "formatName": "shortDateTimePattern"
                          },
                          "tooltipFormat": {
                            "tooltip": "Start date and time of the Job"
                          }
                        },
                        {
                          "columnMatch": "JobDuration",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "palette": "blue"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "useGrouping": false,
                              "minimumFractionDigits": 2,
                              "maximumFractionDigits": 2
                            }
                          },
                          "tooltipFormat": {
                            "tooltip": "Job Duration"
                          }
                        },
                        {
                          "columnMatch": "ErrorTitle",
                          "formatter": 0,
                          "tooltipFormat": {
                            "tooltip": "Job Failure Code"
                          }
                        },
                        {
                          "columnMatch": "DataTransferred",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "palette": "blue"
                          },
                          "tooltipFormat": {
                            "tooltip": "Amount of data transferred by the job"
                          }
                        },
                        {
                          "columnMatch": "AzureResource",
                          "formatter": 0,
                          "tooltipFormat": {
                            "tooltip": "Azure Resource associated with the backup instance. For Azure VM Backup, SQL in Azure VM backup and SAP database in Azure VM backup, the Azure Resource is the Azure VM. For Azure Files Share backup, the Azure Resource is the Azure Storage account. For on-premises backup instances, this field is blank."
                          }
                        },
                        {
                          "columnMatch": "DatasourceType",
                          "formatter": 0,
                          "tooltipFormat": {
                            "tooltip": "Datasource Type"
                          }
                        }
                      ],
                      "labelSettings": [
                        {
                          "columnId": "BackupInstance",
                          "label": "Backup Instance"
                        },
                        {
                          "columnId": "ResourceGroup",
                          "label": "Resource Group"
                        },
                        {
                          "columnId": "OperationCategory",
                          "label": "Operation Category"
                        },
                        {
                          "columnId": "JobStatus",
                          "label": "Job Status"
                        },
                        {
                          "columnId": "JobStartDateTime",
                          "label": "Job Start Date Time"
                        },
                        {
                          "columnId": "JobDuration",
                          "label": "Job Duration (hrs)"
                        },
                        {
                          "columnId": "ErrorTitle",
                          "label": "Job Failure Code"
                        },
                        {
                          "columnId": "DataTransferred",
                          "label": "Data Transferred (MB)"
                        },
                        {
                          "columnId": "AzureResource",
                          "label": "Azure Resource"
                        },
                        {
                          "columnId": "DatasourceType",
                          "label": "Datasource Type"
                        }
                      ]
                    }
                  },
                  "conditionalVisibilities": [
                    {
                      "parameterName": "TabName",
                      "comparison": "isEqualTo",
                      "value": "JobDistribution"
                    },
                    {
                      "parameterName": "Workspaces",
                      "comparison": "isNotEqualTo"
                    },
                    {
                      "parameterName": "JobTab_SearchBackupInstanceUniqueId",
                      "comparison": "isNotEqualTo",
                      "value": "*"
                    },
                    {
                      "parameterName": "DatasourceType",
                      "comparison": "isNotEqualTo"
                    }
                  ],
                  "showPin": true,
                  "name": "JobDistribution-Grid2",
                  "styleSettings": {
                    "margin": "-30px 0% 0% 0%",
                    "padding": "0% 0% -20px 0%",
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedoption",
              "comparison": "isEqualTo",
              "value": "backup"
            },
            "name": "Backup Dashboard"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "tabs",
                    "links": [
                      {
                        "id": "5e65113d-e7b6-4bb2-87e9-aaec919d3ea0",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Overview",
                        "subTarget": "overview",
                        "style": "link"
                      },
                      {
                        "id": "51e5f689-2f65-4166-8dd8-bf1394004b3a",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "VM View",
                        "subTarget": "vmview",
                        "style": "link"
                      },
                      {
                        "id": "68293d35-d2c4-4f77-90b7-8b7a4807a2f0",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Severity View",
                        "subTarget": "severityview",
                        "style": "link"
                      },
                      {
                        "id": "f74ae523-02e0-4ddb-b5a1-718adfe11122",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Category View",
                        "subTarget": "categoryview",
                        "style": "link"
                      },
                      {
                        "id": "ebc153ff-839e-4ace-9b13-ce0c4c444a27",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Roll-up",
                        "subTarget": "rollups",
                        "style": "link"
                      }
                    ]
                  },
                  "name": "links - 8"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "98654cb6-dc42-4501-970d-59148d55a438",
                              "version": "KqlParameterItem/1.0",
                              "name": "Subscription",
                              "label": "Choose a subscription",
                              "type": 6,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "includeAll": true,
                                "showDefault": false
                              },
                              "defaultValue": "value::3"
                            },
                            {
                              "id": "275e7403-ff7a-45cb-97c5-8d6ed2846758",
                              "version": "KqlParameterItem/1.0",
                              "name": "Workspace",
                              "label": "Choose a workspace",
                              "type": 5,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "Resources\r\n| where type =~ \"Microsoft.operationalinsights/workspaces\"\r\n| summarize by id",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "defaultValue": "value::all",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "value": [
                                "value::all"
                              ]
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "conditionalVisibilities": [
                          {
                            "parameterName": "submenu",
                            "comparison": "isNotEqualTo",
                            "value": "categoryview"
                          },
                          {
                            "parameterName": "submenu",
                            "comparison": "isNotEqualTo",
                            "value": "vmview"
                          }
                        ],
                        "name": "parameters - 1 - Copy - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "securityresources\r\n| where type == \"microsoft.security/assessments\"\r\n| where name == \"4ab6e3c5-74dd-8b35-9ab9-f61b30875b27\"\r\n| project state = tostring(properties.status.code)\r\n| summarize ResourcesCount = count() by tostring(state)",
                          "size": 1,
                          "title": "Count of resources by health",
                          "noDataMessage": "No unhealthy resources found",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "piechart",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "state",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "==",
                                    "thresholdValue": "Unhealthy",
                                    "representation": "4",
                                    "text": ""
                                  },
                                  {
                                    "operator": "==",
                                    "thresholdValue": "NotApplicable",
                                    "representation": "cancelled"
                                  },
                                  {
                                    "operator": "==",
                                    "thresholdValue": "Healthy",
                                    "representation": "success"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "Normal",
                                    "text": "{0}{1}"
                                  }
                                ],
                                "compositeBarSettings": {
                                  "labelText": "",
                                  "columnSettings": [
                                    {
                                      "columnName": "state",
                                      "color": "blue"
                                    }
                                  ]
                                }
                              }
                            },
                            "rightContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "none",
                                "compositeBarSettings": {
                                  "labelText": "",
                                  "columnSettings": []
                                }
                              }
                            },
                            "showBorder": true,
                            "size": "auto"
                          },
                          "graphSettings": {
                            "type": 0,
                            "topContent": {
                              "columnMatch": "state",
                              "formatter": 1
                            },
                            "centerContent": {
                              "columnMatch": "count_",
                              "formatter": 1,
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Unhealthy",
                                "color": "red"
                              },
                              {
                                "seriesName": "Healthy",
                                "color": "green"
                              },
                              {
                                "seriesName": "NotApplicable",
                                "label": "Not Applicable",
                                "color": "gray"
                              }
                            ]
                          },
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "sizeSettings": "count_",
                            "sizeAggregation": "Sum",
                            "legendMetric": "count_",
                            "legendAggregation": "Sum",
                            "itemColorSettings": {
                              "type": "heatmap",
                              "colorAggregation": "Sum",
                              "nodeColorField": "count_",
                              "heatmapPalette": "greenRed"
                            }
                          }
                        },
                        "customWidth": "33",
                        "name": "ResourceHealth"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "securityresources\r\n| where type == \"microsoft.security/assessments\"\r\n| where name == \"4ab6e3c5-74dd-8b35-9ab9-f61b30875b27\"\r\n| extend ResourceId = extract(\"^(.+)/providers/Microsoft.Security/assessments/.+$\",1,id)\r\n| project state = tostring(properties.status.code), ResourceId = tolower(tostring(ResourceId))\r\n| where state == \"Unhealthy\"\r\n| join kind=inner (\r\n    securityresources \r\n    | where type == \"microsoft.security/assessments/subassessments\"\r\n| extend Name = extract(\".*assessments/(.+?)/.*\",1,  id) \r\n| where Name == \"4ab6e3c5-74dd-8b35-9ab9-f61b30875b27\" \r\n| extend State = tostring(properties.status.code), ResourceId = tolower(tostring(properties.resourceDetails.id)), OsType = tostring(properties.additionalData.data.OsType)) on ResourceId\r\n| summarize UnhelathyMachinesByOperatingSystemCount = dcount(ResourceId) by OsType",
                          "size": 1,
                          "title": "Count of unhealthy machines by operating system",
                          "noDataMessage": "No unhealthy resources found",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "piechart",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "OsType",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": false,
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": true
                          },
                          "graphSettings": {
                            "type": 0,
                            "topContent": {
                              "columnMatch": "OsType",
                              "formatter": 1
                            },
                            "centerContent": {
                              "columnMatch": "count_",
                              "formatter": 1,
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "33",
                        "name": "OS"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id), severity = tostring(properties.status.severity)\r\n| where assessmentKey == \"4ab6e3c5-74dd-8b35-9ab9-f61b30875b27\" and properties.status.code == \"Unhealthy\"\r\n| summarize AssessmentsCount = count() by severity",
                          "size": 1,
                          "title": "Count of missing updates by severity",
                          "noDataMessage": "No unhealthy resources found",
                          "exportFieldName": "label",
                          "exportParameterName": "selectedSeverity",
                          "exportDefaultValue": "All",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "piechart",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "severity",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": true
                          },
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Medium",
                                "color": "yellow"
                              },
                              {
                                "seriesName": "High",
                                "color": "redBright"
                              },
                              {
                                "seriesName": "Low",
                                "color": "blueDark"
                              }
                            ]
                          }
                        },
                        "customWidth": "33",
                        "name": "Severity"
                      }
                    ],
                    "exportParameters": true
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "overview"
                  },
                  "name": "Overview"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "parameters": [
                            {
                              "id": "b0177105-7244-40a2-a13b-7f9cc63ff869",
                              "version": "KqlParameterItem/1.0",
                              "name": "Subscription",
                              "label": "Choose a subscription",
                              "type": 6,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "includeAll": true,
                                "showDefault": false
                              },
                              "defaultValue": "value::3",
                              "value": [
                                "value::all"
                              ]
                            },
                            {
                              "id": "13ee56e1-4099-4af5-b7b1-1669b1acfa6a",
                              "version": "KqlParameterItem/1.0",
                              "name": "Workspace",
                              "label": "Choose a workspace",
                              "type": 5,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "Resources\r\n| where type =~ \"Microsoft.operationalinsights/workspaces\"\r\n| summarize by id",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "defaultValue": "value::all",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "value": [
                                "value::all"
                              ]
                            },
                            {
                              "id": "7bd0f21c-30f8-44e1-9e91-f9e87118bea9",
                              "version": "KqlParameterItem/1.0",
                              "name": "VirtualMachines",
                              "label": "Virtual Machines",
                              "type": 5,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "where type =~ 'microsoft.compute/virtualmachines'\r\n\t| order by name asc\r\n\t| extend Rank = row_number()\r\n\t| project value = id, label = id, selected = Rank <= 25",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::5",
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::5",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "value": [
                                "value::all"
                              ]
                            },
                            {
                              "id": "920babe0-e044-45a5-bbfe-cc6ddfb12679",
                              "version": "KqlParameterItem/1.0",
                              "name": "TimeRange",
                              "label": "Time Range",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [
                                  {
                                    "durationMs": 300000
                                  },
                                  {
                                    "durationMs": 900000
                                  },
                                  {
                                    "durationMs": 1800000
                                  },
                                  {
                                    "durationMs": 3600000
                                  },
                                  {
                                    "durationMs": 14400000
                                  },
                                  {
                                    "durationMs": 43200000
                                  },
                                  {
                                    "durationMs": 86400000
                                  },
                                  {
                                    "durationMs": 172800000
                                  },
                                  {
                                    "durationMs": 259200000
                                  },
                                  {
                                    "durationMs": 604800000
                                  },
                                  {
                                    "durationMs": 1209600000
                                  },
                                  {
                                    "durationMs": 2419200000
                                  },
                                  {
                                    "durationMs": 2592000000
                                  },
                                  {
                                    "durationMs": 5184000000
                                  },
                                  {
                                    "durationMs": 7776000000
                                  }
                                ]
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "value": {
                                "durationMs": 172800000
                              }
                            },
                            {
                              "id": "1cece63d-effc-4422-b1e1-43bfd5a87891",
                              "version": "KqlParameterItem/1.0",
                              "name": "Message",
                              "type": 1,
                              "query": "where type == 'microsoft.compute/virtualmachines' \r\n| summarize Selected = countif(id in ({VirtualMachines:value})), Total = count()\r\n| project Message = strcat('# ', Selected, ' / ', Total)",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "isHiddenWhenLocked": true,
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            }
                          ],
                          "style": "pills",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "vmview"
                        },
                        "name": "parameters - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "Update\r\n| where TimeGenerated>ago(5h)\r\n| summarize hint.strategy=partitioned arg_max(TimeGenerated, UpdateState, Classification) by Computer, SourceComputerId, Product, ProductArch, _ResourceId\r\n| where UpdateState=~\"Needed\"\r\n| project Product, ProductArch, Classification, Computer, _ResourceId\r\n| summarize count() by _ResourceId",
                                "size": 0,
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "table",
                                "graphSettings": {
                                  "type": 2,
                                  "topContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 1
                                  },
                                  "centerContent": {
                                    "columnMatch": "count_",
                                    "formatter": 1,
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  },
                                  "nodeIdField": "Computer",
                                  "graphOrientation": 3,
                                  "showOrientationToggles": false,
                                  "nodeSize": null,
                                  "staticNodeSize": 100,
                                  "colorSettings": {
                                    "nodeColorField": "count_",
                                    "type": 4,
                                    "heatmapPalette": "greenRed",
                                    "heatmapMin": 0,
                                    "heatmapMax": 5,
                                    "emptyValueColor": "green"
                                  },
                                  "hivesMargin": 5
                                }
                              },
                              "conditionalVisibility": {
                                "parameterName": "Tabname",
                                "comparison": "isEqualTo",
                                "value": "AlwaysHide"
                              },
                              "name": "Number of Patches"
                            },
                            {
                              "type": 10,
                              "content": {
                                "chartId": "workbook2932b309-c598-450d-bcd3-c0acbf6b821a",
                                "version": "MetricsItem/2.0",
                                "size": 0,
                                "chartType": 0,
                                "resourceType": "microsoft.compute/virtualmachines",
                                "metricScope": 0,
                                "resourceParameter": "VirtualMachines",
                                "resourceIds": [
                                  "{VirtualMachines}"
                                ],
                                "timeContextFromParameter": "TimeRange",
                                "timeContext": {
                                  "durationMs": 172800000
                                },
                                "metrics": [
                                  {
                                    "namespace": "microsoft.compute/virtualmachines",
                                    "metric": "microsoft.compute/virtualmachines--Percentage CPU",
                                    "aggregation": 4
                                  }
                                ],
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Subscription",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Name",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource"
                                      }
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Percentage CPU Timeline",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "microsoft.compute/virtualmachines--Percentage CPU",
                                      "formatter": 1,
                                      "numberFormat": {
                                        "unit": 1,
                                        "options": null
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000,
                                  "labelSettings": [
                                    {
                                      "columnId": "Subscription",
                                      "label": "Subscription"
                                    },
                                    {
                                      "columnId": "Name",
                                      "label": "Storage Name"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Percentage CPU",
                                      "label": "Percentage CPU (Average)"
                                    },
                                    {
                                      "columnId": "microsoft.compute/virtualmachines--Percentage CPU Timeline",
                                      "label": "Percentage CPU Timeline"
                                    }
                                  ]
                                }
                              },
                              "conditionalVisibility": {
                                "parameterName": "Tab Name",
                                "comparison": "isEqualTo",
                                "value": "AlwaysHide"
                              },
                              "name": "Virtual Machine List"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"c5b3741f-00a8-46fd-8e7d-8b6e2d0010f8\",\"mergeType\":\"leftouter\",\"leftTable\":\"Virtual Machine List\",\"rightTable\":\"Number of Patches\",\"leftColumn\":\"Name\",\"rightColumn\":\"_ResourceId\"}],\"projectRename\":[{\"originalName\":\"[Virtual Machine List].Subscription\",\"mergedName\":\"Subscription Name\",\"fromId\":\"c5b3741f-00a8-46fd-8e7d-8b6e2d0010f8\"},{\"originalName\":\"[Virtual Machine List].Name\",\"mergedName\":\"Virtual Machine Name\",\"fromId\":\"c5b3741f-00a8-46fd-8e7d-8b6e2d0010f8\"},{\"originalName\":\"[Number of Patches].count_\",\"mergedName\":\"Number Of Patches\",\"fromId\":\"c5b3741f-00a8-46fd-8e7d-8b6e2d0010f8\"},{\"originalName\":\"[VM List].microsoft.compute/virtualmachines--Percentage CPU\"},{\"originalName\":\"[VM List].microsoft.compute/virtualmachines--Percentage CPU Timeline\"},{\"originalName\":\"[num of patches]._ResourceId\"},{\"originalName\":\"[Virtual Machine List].microsoft.compute/virtualmachines--Percentage CPU Timeline\"},{\"originalName\":\"[Virtual Machine List].microsoft.compute/virtualmachines--Percentage CPU\"},{\"originalName\":\"[Number of Patches]._ResourceId\"}]}",
                                "size": 3,
                                "queryType": 7,
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Virtual Machine Name",
                                    "formatter": 13,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  "leftContent": {
                                    "columnMatch": "Number Of Patches",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "0",
                                          "representation": "success",
                                          "text": "Patched"
                                        },
                                        {
                                          "operator": ">",
                                          "thresholdValue": "0",
                                          "representation": "4",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "success",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "secondaryContent": {
                                    "columnMatch": "Subscription Name",
                                    "formatter": 13,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  "showBorder": true
                                },
                                "graphSettings": {
                                  "type": 2,
                                  "topContent": {
                                    "columnMatch": "Virtual Machine Name",
                                    "formatter": 13,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": false
                                    }
                                  },
                                  "centerContent": {
                                    "columnMatch": "Number Of Patches",
                                    "formatter": 1,
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal"
                                      },
                                      "emptyValCustomText": "0"
                                    }
                                  },
                                  "nodeIdField": "Virtual Machine Name",
                                  "graphOrientation": 3,
                                  "showOrientationToggles": false,
                                  "nodeSize": null,
                                  "staticNodeSize": 100,
                                  "colorSettings": {
                                    "nodeColorField": "Number Of Patches",
                                    "type": 4,
                                    "heatmapPalette": "greenRed",
                                    "heatmapMin": 0,
                                    "heatmapMax": 1,
                                    "emptyValueColor": "green"
                                  },
                                  "hivesMargin": 2
                                }
                              },
                              "showPin": false,
                              "name": "query - 2"
                            }
                          ]
                        },
                        "name": "group - 4"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "vmview"
                  },
                  "name": "VM View"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "1e65ffa8-e67c-485e-b1cf-61c68c8b5b99",
                              "version": "KqlParameterItem/1.0",
                              "name": "Subscription",
                              "label": "Choose a subscription",
                              "type": 6,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "includeAll": true,
                                "showDefault": false
                              },
                              "defaultValue": "value::3"
                            },
                            {
                              "id": "2c9624c5-0da1-468e-b756-b716f327dd37",
                              "version": "KqlParameterItem/1.0",
                              "name": "Workspace",
                              "label": "Choose a workspace",
                              "type": 5,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "Resources\r\n| where type =~ \"Microsoft.operationalinsights/workspaces\"\r\n| summarize by id",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "defaultValue": "value::all",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "value": [
                                "value::all"
                              ]
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "conditionalVisibilities": [
                          {
                            "parameterName": "submenu",
                            "comparison": "isNotEqualTo",
                            "value": "categoryview"
                          },
                          {
                            "parameterName": "submenu",
                            "comparison": "isNotEqualTo",
                            "value": "vmview"
                          }
                        ],
                        "name": "parameters - 1 - Copy - Copy - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"4ab6e3c5-74dd-8b35-9ab9-f61b30875b27\" and properties.status.code == 'Unhealthy'\r\n| project Resource = iif(isempty(properties.resourceDetails.id),strcat(split(properties.resourceDetails.workspaceId, '/')[8]), properties.resourceDetails.id), subscriptionId, severity = tostring(parse_json(properties).status.severity), status = tostring(parse_json(properties).status.code), description = tostring(parse_json(properties).displayName), VulnId = tostring(parse_json(properties).id), resourceGroup = substring(id, 0, indexof(id, '/providers'))\r\n| summarize dcount(VulnId) by Resource, severity, VulnId, description\r\n| summarize  sevH=countif(severity=='High'), sevM=countif(severity=='Medium'), sevL=countif(severity=='Low') ,Total = count(dcount_VulnId) by Resource\r\n| order by sevH desc",
                          "size": 3,
                          "title": "Missing Patches Count",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "table",
                          "gridSettings": {
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "Resource",
                                "label": "VM"
                              },
                              {
                                "columnId": "sevH",
                                "label": "High"
                              },
                              {
                                "columnId": "sevM",
                                "label": "Medium"
                              },
                              {
                                "columnId": "sevL",
                                "label": "Low"
                              }
                            ]
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 8"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"4ab6e3c5-74dd-8b35-9ab9-f61b30875b27\"\r\n| project   Severity = tostring(properties.status.severity),\r\n            Resource = iif(isempty(properties.resourceDetails.id),strcat(split(properties.resourceDetails.workspaceId, '/')[8]), properties.resourceDetails.id),\r\n            ResourceGroup = toupper(substring(id, 0, indexof(id, '/providers'))),\r\n            Category = tostring(properties.category),\r\n\t\t\tSource = tostring(properties.resourceDetails.source),\r\n\t\t\tDescription = tostring(properties.description),\r\n            \t\tOsType = tostring(properties.additionalData.data.OsType),\r\n\t\t\tOperatingSystem = tostring(properties.additionalData.data.OperatingSystem)\r\n\t\r\n\t\t\t\r\n\t\t\t\r\n            \r\n            \r\n         \r\n| order by Severity asc",
                          "size": 3,
                          "title": "Detailed View",
                          "noDataMessage": "No unhealthy resources found",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "$gen_group",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20ch"
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Resource",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "OpenBlade",
                                  "linkIsContextBlade": false,
                                  "showIcon": true,
                                  "bladeOpenContext": {
                                    "bladeName": "GenericResourceHealthDetailsBlade",
                                    "extensionName": "Microsoft_Azure_Security",
                                    "bladeParameters": [
                                      {
                                        "name": "resourceId",
                                        "source": "cell",
                                        "value": "%2Fsubscriptions%2F3b5bc982-20bc-4b59-b1ca-f8488bb86736%2FresourceGroups%2Fdemo%2Fproviders%2FMicrosoft.HybridCompute%2Fmachines%2FW2019"
                                      }
                                    ]
                                  },
                                  "customColumnWidthSetting": "20ch"
                                }
                              },
                              {
                                "columnMatch": "ResourceGroup",
                                "formatter": 14,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true,
                                  "customColumnWidthSetting": "25ch"
                                }
                              },
                              {
                                "columnMatch": "Category",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20ch"
                                }
                              },
                              {
                                "columnMatch": "Source",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "15ch"
                                }
                              },
                              {
                                "columnMatch": "OperatingSystem",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "25ch"
                                }
                              },
                              {
                                "columnMatch": "$gen_group",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "20ch"
                                }
                              },
                              {
                                "columnMatch": "Remediation",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "RemediationSteps",
                                "formatter": 11,
                                "formatOptions": {
                                  "linkColumn": "Remediation",
                                  "linkTarget": "Url"
                                },
                                "tooltipFormat": {
                                  "tooltip": "Click to view remediation steps"
                                }
                              },
                              {
                                "columnMatch": "Code",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Healthy",
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Unhealthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "resourceGroup",
                                "formatter": 14,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              }
                            ],
                            "rowLimit": 1000,
                            "filter": true,
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "Severity"
                              ],
                              "expandTopLevel": false
                            },
                            "labelSettings": [
                              {
                                "columnId": "ResourceGroup",
                                "label": "Resource group"
                              },
                              {
                                "columnId": "OsType",
                                "label": "OS type"
                              },
                              {
                                "columnId": "OperatingSystem",
                                "label": "Operating system"
                              }
                            ]
                          },
                          "sortBy": []
                        },
                        "name": "Missing Patches"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "severityview"
                  },
                  "name": "Severity View"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "3e4ace9f-1452-466b-a63c-d3b99f77d802",
                              "version": "KqlParameterItem/1.0",
                              "name": "Subscription",
                              "label": "Choose a subscription",
                              "type": 6,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "includeAll": true,
                                "showDefault": false
                              },
                              "defaultValue": "value::3"
                            },
                            {
                              "id": "759baa3c-3e3e-4d85-9935-fd7bf3e4cacb",
                              "version": "KqlParameterItem/1.0",
                              "name": "Workspace",
                              "label": "Choose a workspace",
                              "type": 5,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "Resources\r\n| where type =~ \"Microsoft.operationalinsights/workspaces\"\r\n| summarize by id",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "defaultValue": "value::all",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "value": [
                                "value::all"
                              ]
                            },
                            {
                              "id": "ab447ded-30a6-4ece-8730-323f730a7c56",
                              "version": "KqlParameterItem/1.0",
                              "name": "TimeRange",
                              "label": "Time Range",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [
                                  {
                                    "durationMs": 300000
                                  },
                                  {
                                    "durationMs": 900000
                                  },
                                  {
                                    "durationMs": 1800000
                                  },
                                  {
                                    "durationMs": 3600000
                                  },
                                  {
                                    "durationMs": 14400000
                                  },
                                  {
                                    "durationMs": 43200000
                                  },
                                  {
                                    "durationMs": 86400000
                                  },
                                  {
                                    "durationMs": 172800000
                                  },
                                  {
                                    "durationMs": 259200000
                                  },
                                  {
                                    "durationMs": 604800000
                                  },
                                  {
                                    "durationMs": 1209600000
                                  },
                                  {
                                    "durationMs": 2419200000
                                  },
                                  {
                                    "durationMs": 2592000000
                                  },
                                  {
                                    "durationMs": 5184000000
                                  },
                                  {
                                    "durationMs": 7776000000
                                  }
                                ]
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "value": {
                                "durationMs": 172800000
                              }
                            },
                            {
                              "id": "293412ac-973c-411d-8654-3e7b3fe72de4",
                              "version": "KqlParameterItem/1.0",
                              "name": "Message",
                              "type": 1,
                              "query": "where type == 'microsoft.compute/virtualmachines' \r\n| summarize Selected = countif(id in ({VirtualMachines:value})), Total = count()\r\n| project Message = strcat('# ', Selected, ' / ', Total)",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "isHiddenWhenLocked": true,
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "categoryview"
                        },
                        "name": "parameters - 1 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Summary of updates available across machines \r\n// Count of updates available under various categories for each machine. \r\n// To create an alert for this query, click '+ New alert rule'\r\nUpdateSummary \r\n| where TimeGenerated>ago(14h) \r\n| summarize by ResourceId, CriticalUpdatesMissing, SecurityUpdatesMissing, OtherUpdatesMissing, TotalUpdatesMissing",
                          "size": 0,
                          "title": "Missing Update Counts",
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "ResourceId",
                                "label": "VM"
                              },
                              {
                                "columnId": "CriticalUpdatesMissing",
                                "label": "Critical"
                              },
                              {
                                "columnId": "SecurityUpdatesMissing",
                                "label": "Security"
                              },
                              {
                                "columnId": "OtherUpdatesMissing",
                                "label": "Other"
                              },
                              {
                                "columnId": "TotalUpdatesMissing",
                                "label": "Total"
                              }
                            ]
                          }
                        },
                        "name": "Category View"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Missing security or critical updates \r\n// Count how many security or other critical updates are missing. \r\n// To create an alert for this query, click '+ New alert rule'\r\nUpdate\r\n| where Classification in (\"Security Updates\", \"Critical Updates\")\r\n| where UpdateState == 'Needed' and Optional == false and Approved == true\r\n| summarize count() by _ResourceId,  Computer, Classification , Title ,TimeGenerated , UpdateState ,Product,ResourceType,ComputerEnvironment , MSRCSeverity,KBID,RevisionNumber\r\n",
                          "size": 0,
                          "title": "Missing Security/Critical Updates",
                          "noDataMessageStyle": 3,
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "filter": true,
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "Computer"
                              ]
                            },
                            "sortBy": [
                              {
                                "itemKey": "Classification",
                                "sortOrder": 1
                              }
                            ],
                            "labelSettings": [
                              {
                                "columnId": "_ResourceId",
                                "label": "VM"
                              },
                              {
                                "columnId": "Computer",
                                "label": "VM"
                              },
                              {
                                "columnId": "Classification",
                                "label": "Classificaiton"
                              },
                              {
                                "columnId": "Title",
                                "label": "Title"
                              },
                              {
                                "columnId": "TimeGenerated",
                                "label": "Time Generated"
                              },
                              {
                                "columnId": "UpdateState",
                                "label": "Status"
                              },
                              {
                                "columnId": "ComputerEnvironment",
                                "label": "Computer Environment"
                              },
                              {
                                "columnId": "MSRCSeverity",
                                "label": "MSRC Severity"
                              },
                              {
                                "columnId": "KBID",
                                "label": "KBID"
                              },
                              {
                                "columnId": "RevisionNumber",
                                "label": "Revision Number"
                              },
                              {
                                "columnId": "count_",
                                "label": "Count"
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "Classification",
                              "sortOrder": 1
                            }
                          ]
                        },
                        "name": "Critical Missing Update"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "categoryview"
                  },
                  "name": "Category View"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "224a20ce-12ee-42c8-b03d-1b453aff4c86",
                              "version": "KqlParameterItem/1.0",
                              "name": "Subscription",
                              "label": "Choose a subscription",
                              "type": 6,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "includeAll": true,
                                "showDefault": false
                              },
                              "defaultValue": "value::3"
                            },
                            {
                              "id": "19871115-a243-48c5-8310-d929439c4837",
                              "version": "KqlParameterItem/1.0",
                              "name": "Workspace",
                              "label": "Choose a workspace",
                              "type": 5,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "Resources\r\n| where type =~ \"Microsoft.operationalinsights/workspaces\"\r\n| summarize by id",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "defaultValue": "value::all",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "value": [
                                "value::all"
                              ]
                            },
                            {
                              "id": "c0fa03bb-0f65-40aa-90be-af04a00889fa",
                              "version": "KqlParameterItem/1.0",
                              "name": "TimeRange",
                              "label": "Time Range",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [
                                  {
                                    "durationMs": 300000
                                  },
                                  {
                                    "durationMs": 900000
                                  },
                                  {
                                    "durationMs": 1800000
                                  },
                                  {
                                    "durationMs": 3600000
                                  },
                                  {
                                    "durationMs": 14400000
                                  },
                                  {
                                    "durationMs": 43200000
                                  },
                                  {
                                    "durationMs": 86400000
                                  },
                                  {
                                    "durationMs": 172800000
                                  },
                                  {
                                    "durationMs": 259200000
                                  },
                                  {
                                    "durationMs": 604800000
                                  },
                                  {
                                    "durationMs": 1209600000
                                  },
                                  {
                                    "durationMs": 2419200000
                                  },
                                  {
                                    "durationMs": 2592000000
                                  },
                                  {
                                    "durationMs": 5184000000
                                  },
                                  {
                                    "durationMs": 7776000000
                                  }
                                ]
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "value": {
                                "durationMs": 3600000
                              }
                            },
                            {
                              "id": "ca18cbe3-f792-41d1-9f8d-2c260eb1ed9b",
                              "version": "KqlParameterItem/1.0",
                              "name": "Message",
                              "type": 1,
                              "query": "where type == 'microsoft.compute/virtualmachines' \r\n| summarize Selected = countif(id in ({VirtualMachines:value})), Total = count()\r\n| project Message = strcat('# ', Selected, ' / ', Total)",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "isHiddenWhenLocked": true,
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "rollups"
                        },
                        "name": "parameters - 1 - Copy - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "Update\r\n| where OSType != \"Linux\" and Optional == \"false\" and Classification == \"Update Rollups\" and UpdateState == \"Needed\" \r\n| project TimeGenerated, Computer, Title, KBID, Classification, MSRCSeverity, PublishedDate, _ResourceId\r\n| sort by TimeGenerated desc\r\n| summarize c = count()\r\n| extend Item = \"Missing Rollups\",  Key = 1\r\n",
                          "size": 3,
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Item",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "c",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": true,
                            "size": "auto"
                          }
                        },
                        "name": "Rollups"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Missing update rollups \r\n// All computers with missing update rollups. \r\n// To create an alert for this query, click '+ New alert rule'\r\nUpdate\r\n| where OSType != \"Linux\" and Optional == \"false\" and Classification == \"Update Rollups\" and UpdateState == \"Needed\" \r\n| project TimeGenerated, _ResourceId,Computer, Title, KBID, Classification, MSRCSeverity, PublishedDate\r\n| sort by TimeGenerated desc",
                          "size": 3,
                          "title": "Detailed View",
                          "noDataMessageStyle": 3,
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "filter": true,
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "Computer"
                              ]
                            },
                            "sortBy": [
                              {
                                "itemKey": "Classification",
                                "sortOrder": 1
                              }
                            ],
                            "labelSettings": [
                              {
                                "columnId": "TimeGenerated",
                                "label": "Time Generated"
                              },
                              {
                                "columnId": "_ResourceId",
                                "label": "VM"
                              },
                              {
                                "columnId": "Computer",
                                "label": "Hostname"
                              },
                              {
                                "columnId": "Classification",
                                "label": "Classificaiton"
                              },
                              {
                                "columnId": "MSRCSeverity",
                                "label": "MSRC Severity"
                              },
                              {
                                "columnId": "PublishedDate",
                                "label": "Published Date"
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "Classification",
                              "sortOrder": 1
                            }
                          ]
                        },
                        "name": "Critical Missing Update"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "rollups"
                  },
                  "name": "Rollups"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedoption",
              "comparison": "isEqualTo",
              "value": "patching"
            },
            "name": "Patching Dashboard"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "tabs",
                    "links": [
                      {
                        "id": "d5749b77-230f-45e3-89f5-be4c85ecfa36",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Security Score",
                        "subTarget": "securityscore",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "7ef3a846-67a4-4458-b430-b19d4d03e181",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Compliance",
                        "subTarget": "compliance",
                        "style": "link"
                      },
                      {
                        "id": "ce03af67-e481-49ee-8178-453cfa5f8a27",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Protection",
                        "subTarget": "protection",
                        "style": "link"
                      },
                      {
                        "id": "140662d1-ea7b-4a37-b0a6-3c6ff240e27c",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Defender Coverage",
                        "subTarget": "defendercoverage",
                        "style": "link"
                      },
                      {
                        "id": "8229f566-8833-49f0-8f23-fa1aa550659b",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Threat Protection",
                        "subTarget": "threatprotection",
                        "style": "link"
                      },
                      {
                        "id": "8dae093a-4092-4bd6-b41c-cab5156efd55",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Vulnerabilities",
                        "subTarget": "vulnerabilities",
                        "style": "link"
                      },
                      {
                        "id": "bf9746de-002f-4986-a4de-a3429cac0998",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "IAM",
                        "subTarget": "iam",
                        "style": "link"
                      },
                      {
                        "id": "76346c17-eb4a-4569-9888-1d4ca3d43e51",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Publically Exposed Resources",
                        "subTarget": "publicexpo",
                        "style": "link"
                      }
                    ]
                  },
                  "name": "links - 0"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "5e8f8ef7-c57e-4c97-8356-67e34bdd1eb1",
                        "version": "KqlParameterItem/1.0",
                        "name": "Subscription",
                        "type": 6,
                        "isRequired": true,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "typeSettings": {
                          "additionalResourceOptions": [
                            "value::1",
                            "value::3",
                            "value::all"
                          ],
                          "includeAll": true,
                          "showDefault": false
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "defaultValue": "value::3"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "conditionalVisibilities": [
                    {
                      "parameterName": "submenu",
                      "comparison": "isNotEqualTo",
                      "value": "compliance"
                    },
                    {
                      "parameterName": "submenu",
                      "comparison": "isNotEqualTo",
                      "value": "threatprotection"
                    },
                    {
                      "parameterName": "submenu",
                      "comparison": "isNotEqualTo",
                      "value": "vulnerabilities"
                    },
                    {
                      "parameterName": "submenu",
                      "comparison": "isNotEqualTo",
                      "value": "iam"
                    }
                  ],
                  "name": "parameters - 5"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "securityresources\r\n| where type =~ 'microsoft.security/securescores'\r\n| where properties.score.current > 0 and properties.environment == 'Azure' and name != 'scoreGraceExcluded'\r\n| extend scoreXweight = todouble(properties.score.percentage) * todouble(properties.weight)\r\n| summarize topi = sum(scoreXweight), bottomi = sum(todouble(properties.weight))\r\n| extend securescore = 100*(topi/bottomi)\r\n| extend Item = \"Overall Security Score\",  Key = 1",
                          "size": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "value::all"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Item",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "securescore",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 0
                                }
                              }
                            },
                            "showBorder": true,
                            "size": "auto"
                          }
                        },
                        "name": "query - 0"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "Security Score of Subscription",
                          "style": "info"
                        },
                        "name": "text - 3"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "securityresources\r\n| where type == \"microsoft.security/securescores\"\r\n| extend subscriptionSecureScore = round(100 * bin((todouble(properties.score.current))/ todouble(properties.score.max), 0.001))\r\n| where subscriptionSecureScore > 0\r\n| project subscriptionId, subscriptionSecureScore\r\n| order by subscriptionSecureScore asc",
                          "size": 3,
                          "aggregation": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "subscriptionId",
                              "formatter": 15,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": true
                              }
                            },
                            "leftContent": {
                              "columnMatch": "subscriptionSecureScore",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": true
                          }
                        },
                        "customWidth": "100",
                        "name": "query - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "Security Score Per Control",
                          "style": "info"
                        },
                        "name": "text - 4"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/securescores/securescorecontrols'\r\n| extend SecureControl = properties.displayName, unhealthy = properties.unhealthyResourceCount, currentscore = properties.score.current, maxscore = properties.score.max, subscriptionId\r\n| project subscriptionId, SecureControl , unhealthy, currentscore, maxscore",
                          "size": 0,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "subscriptionId",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              }
                            ],
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "subscriptionId",
                                "label": "Subscription"
                              },
                              {
                                "columnId": "SecureControl",
                                "label": "Control"
                              },
                              {
                                "columnId": "unhealthy",
                                "label": "Unhealthy"
                              },
                              {
                                "columnId": "currentscore",
                                "label": "Current Score"
                              },
                              {
                                "columnId": "maxscore",
                                "label": "Max Score"
                              }
                            ]
                          },
                          "tileSettings": {
                            "showBorder": false
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "securityscore"
                  },
                  "name": "Security Score"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "5e8f8ef7-c57e-4c97-8356-67e34bdd1eb1",
                              "version": "KqlParameterItem/1.0",
                              "name": "Subscription",
                              "type": 6,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "value": [
                                "value::3"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "includeAll": true,
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::3"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 5"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "PolicyResources\r\n| where type == 'microsoft.policyinsights/policystates'\r\n| extend complianceState = tostring(properties.complianceState)\r\n| summarize count() by complianceState",
                          "size": 4,
                          "title": "Resource Compliance Status",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart",
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "complianceState",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "Resource Compliance Status"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "PolicyResources\r\n| where type =~ 'Microsoft.PolicyInsights/PolicyStates'\r\n| extend complianceState = tostring(properties.complianceState)\r\n| extend\r\n\tresourceId = tostring(properties.resourceId),\r\n\tresourceType = tolower(tostring(properties.resourceType)),\r\n\tpolicyAssignmentId = tostring(properties.policyAssignmentId),\r\n\tpolicyDefinitionId = tostring(properties.policyDefinitionId),\r\n\tpolicyDefinitionReferenceId = tostring(properties.policyDefinitionReferenceId),\r\n\tstateWeight = iff(complianceState == 'NonCompliant', int(300), iff(complianceState == 'Compliant', int(200), iff(complianceState == 'Conflict', int(100), iff(complianceState == 'Exempt', int(50), int(0)))))\r\n| summarize max(stateWeight) by resourceId, resourceType\r\n| summarize counts = count() by resourceType, max_stateWeight\r\n| summarize overallStateWeight = max(max_stateWeight),\r\n\r\nnonCompliantCount = sumif(counts, max_stateWeight == 300),\r\ncompliantCount = sumif(counts, max_stateWeight == 200),\r\nconflictCount = sumif(counts, max_stateWeight == 100),\r\nexemptCount = sumif(counts, max_stateWeight == 50) by resourceType\r\n| extend totalResources = todouble(nonCompliantCount + compliantCount + conflictCount + exemptCount)\r\n| extend compliancePercentage = iff(totalResources == 0, todouble(100), 100 * todouble(compliantCount + exemptCount) / totalResources)\r\n| project resourceType,\r\noverAllComplianceState = iff(overallStateWeight == 300, 'noncompliant', iff(overallStateWeight == 200, 'compliant', iff(overallStateWeight == 100, 'conflict', iff(overallStateWeight == 50, 'exempt', 'notstarted')))),\r\ncompliancePercentage,\r\ncompliantCount,\r\nnonCompliantCount,\r\nconflictCount,\r\nexemptCount\r\n",
                          "size": 3,
                          "title": "Resource Wise Compliance Status",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "overAllComplianceState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "compliant",
                                      "representation": "success",
                                      "text": ""
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "noncompliant",
                                      "representation": "4",
                                      "text": ""
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "unknown",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "compliancePercentage",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "max": 100,
                                  "palette": "redGreen"
                                }
                              }
                            ],
                            "rowLimit": 1000,
                            "filter": true,
                            "sortBy": [
                              {
                                "itemKey": "$gen_heatmap_compliancePercentage_2",
                                "sortOrder": 2
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "$gen_heatmap_compliancePercentage_2",
                              "sortOrder": 2
                            }
                          ]
                        },
                        "name": "query - 7"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"Azure Security Benchmark\"\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0 or properties.assessmentType == \"MicrosoftManaged\"\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = tostring(properties.state)\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = iff(isnull(id1) or isempty(id1), id, id1)\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws' and isnotempty(tostring(properties1.resourceDetails.ConnectorId)), properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(resourceSource =~ \"aws\" and isnotempty(tostring(properties1.resourceDetails.ConnectorId)), tostring(properties1.additionalData.ResourceType), iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\")))\r\n    | extend resourceName = tostring(regexResourceId[2])\r\n    | extend recommendationName = name\r\n    | extend recommendationDisplayName = tostring(iff(isnull(properties1.displayName) or isempty(properties1.displayName), properties.description, properties1.displayName))\r\n    | extend description = tostring(properties1.metadata.description)\r\n    | extend remediationSteps = tostring(properties1.metadata.remediationDescription)\r\n    | extend severity = tostring(properties1.metadata.severity)\r\n    | extend azurePortalRecommendationLink = tostring(properties1.links.azurePortal)\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | mvexpand statusPerInitiative = properties1.statusPerInitiative\r\n                | extend expectedInitiative = statusPerInitiative.policyInitiativeName =~ \"ASC Default\"\r\n                | summarize arg_max(expectedInitiative, *) by complianceControlId, recommendationId\r\n                | extend state = iff(expectedInitiative, tolower(statusPerInitiative.assessmentStatus.code), tolower(properties1.status.code))\r\n                | extend notApplicableReason = iff(expectedInitiative, tostring(statusPerInitiative.assessmentStatus.cause), tostring(properties1.status.cause))\r\n                | project-away expectedInitiative\r\n    | project complianceStandardId, complianceControlId, complianceState, subscriptionId, resourceGroup = resourceGroup1 ,resourceType, resourceName, resourceId, recommendationId, recommendationDisplayName, description, remediationSteps, severity, state,  azurePortalRecommendationLink\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId == \"Azure Security Benchmark\"\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n    | project-away controlId\r\n    | distinct *\r\n    | order by complianceControlId asc, recommendationId asc",
                          "size": 3,
                          "title": "Compliance Level",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "rowLimit": 1000,
                            "filter": true,
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "complianceState"
                              ]
                            }
                          }
                        },
                        "name": "query - 11"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "compliance"
                  },
                  "name": "Compliance"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "securityresources\r\n| where type =~ 'microsoft.security/securescores'\r\n| where properties.score.current > 0 and properties.environment == 'Azure' and name != 'scoreGraceExcluded'\r\n| extend scoreXweight = todouble(properties.score.percentage) * todouble(properties.weight)\r\n| summarize topi = sum(scoreXweight), bottomi = sum(todouble(properties.weight))\r\n| extend securescore = 100*(topi/bottomi)\r\n| extend Item = \"Security Secure\",  Key = 1",
                          "size": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Item",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "securescore",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 0
                                }
                              }
                            },
                            "showBorder": true,
                            "size": "auto"
                          }
                        },
                        "name": "query - 0"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "This graph shows all resources that appear under recommendations that fall into a Tactic. A single resource may or not have three different states (healthy, unhealthy, not applicable) at the same time depending on the recommendations that audited it.",
                          "style": "success"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "securityresources \r\n    | where type == \"microsoft.security/assessments\" \r\n    | extend tactic = properties.metadata.tactics\r\n    | extend healthState = properties.status.code\r\n    | where isnotnull(tactic)\r\n    | mvexpand tactic\r\n    | project id, tactic, healthState\r\n    | summarize Total=count(healthState), Healthy=countif(healthState=='Healthy'), Unhealthy=countif(healthState=='Unhealthy'), NotApplicable=countif(healthState=='NotApplicable') by tostring(tactic)\r\n    | sort by Total desc",
                          "size": 2,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "tactic",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "30ch"
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Healthy",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Unhealthy",
                                        "color": "redBright"
                                      },
                                      {
                                        "columnName": "NotApplicable",
                                        "color": "gray"
                                      }
                                    ]
                                  },
                                  "customColumnWidthSetting": "30ch"
                                }
                              },
                              {
                                "columnMatch": "Healthy",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Unhealthy",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "NotApplicable",
                                "formatter": 5
                              }
                            ],
                            "rowLimit": 1000,
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "tactic",
                                "label": "Tactic"
                              },
                              {
                                "columnId": "Total",
                                "label": "Total"
                              }
                            ]
                          }
                        },
                        "customWidth": "50",
                        "name": "techniques"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "securityresources \r\n    | where type == \"microsoft.security/assessments\" \r\n    | extend techniques = properties.metadata.techniques\r\n    | extend healthState = properties.status.code\r\n    | where isnotnull(techniques)\r\n    | mvexpand techniques\r\n    | project id, techniques, healthState\r\n    | summarize Total=count(healthState), Healthy=countif(healthState=='Healthy'), Unhealthy=countif(healthState=='Unhealthy'), NotApplicable=countif(healthState=='NotApplicable') by tostring(techniques)\r\n    | sort by Total desc",
                          "size": 2,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Healthy",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Unhealthy",
                                        "color": "redBright"
                                      },
                                      {
                                        "columnName": "NotApplicable",
                                        "color": "gray"
                                      }
                                    ]
                                  },
                                  "customColumnWidthSetting": "30ch"
                                }
                              },
                              {
                                "columnMatch": "Healthy",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Unhealthy",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "NotApplicable",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "tactic",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "30ch"
                                }
                              }
                            ],
                            "rowLimit": 1000,
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "techniques",
                                "label": "Techniques"
                              },
                              {
                                "columnId": "Total",
                                "label": "Total"
                              }
                            ]
                          }
                        },
                        "customWidth": "50",
                        "name": "techniques",
                        "styleSettings": {
                          "margin": "30"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "The number of unhealthy resources may differ from the Health Overview by Tactics/Techniques Tabs according to the Techniques that you select in this page and this is an expected behavior. ",
                                "style": "info"
                              },
                              "conditionalVisibility": {
                                "parameterName": "ShowHelp",
                                "comparison": "isEqualTo",
                                "value": "Yes"
                              },
                              "name": "text - 5"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "99a3e735-2ce4-4721-b8a9-79b12f6f3f2a",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Techniques",
                                    "type": 2,
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "'",
                                    "delimiter": ",",
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::all"
                                      ],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    { \"value\":\"Active Scanning\", \"label\":\"Active Scanning\", \"group\":\"Reconnaissance\" },\r\n    { \"value\":\"Gather Victim Network Information\", \"label\":\"Gather Victim Network Information\", \"group\":\"Reconnaissance\" },\r\n    { \"value\":\"Search Victim-Owned Websites\", \"label\":\"Search Victim-Owned Websites\", \"group\":\"Reconnaissance\" },\r\n    { \"value\":\"Obtain Capabilities\", \"label\":\"Obtain Capabilities\", \"group\":\"Resource Development\" },\r\n    { \"value\":\"Compromise Infrastructure\", \"label\":\"Compromise Infrastructure\", \"group\":\"Resource Development\" },\r\n    { \"value\":\"Brute Force\", \"label\":\"Brute Force\", \"group\":\"Initial Access\" },\r\n    { \"value\":\"Drive-by Compromise\", \"label\":\"Drive-by Compromise\", \"group\":\"Initial Access\" },\r\n    { \"value\":\"Exploit Public-Facing Application\", \"label\":\"Exploit Public-Facing Application\", \"group\":\"Initial Access\" },\r\n    { \"value\":\"Exploitation of Remote Services\", \"label\":\"Exploitation of Remote Services\", \"group\":\"Initial Access\" },\r\n    { \"value\":\"External Remote Services\", \"label\":\"External Remote Services\", \"group\":\"Initial Access\" },\r\n    { \"value\":\"Network Sniffing\", \"label\":\"Network Sniffing\", \"group\":\"Initial Access\" },\r\n    { \"value\":\"Phishing\", \"label\":\"Phishing\", \"group\":\"Initial Access\" },\r\n    { \"value\":\"Supply Chain Compromise\", \"label\":\"Supply Chain Compromise\", \"group\":\"Initial Access\" },\r\n    { \"value\":\"Trusted Relationship\", \"label\":\"Trusted Relationship\", \"group\":\"Initial Access\" },\r\n    { \"value\":\"Valid Accounts\", \"label\":\"Valid Accounts\", \"group\":\"Initial Access\" },\r\n    { \"value\":\"Command and Scripting Interpreter\", \"label\":\"Command and Scripting Interpreter\", \"group\":\"Execution\" },\r\n    { \"value\":\"Exploitation for Client Execution\", \"label\":\"Exploitation for Client Execution\", \"group\":\"Execution\" },\r\n    { \"value\":\"Inter-Process Communication\", \"label\":\"Inter-Process Communication\", \"group\":\"Execution\" },\r\n    { \"value\":\"Scheduled Task/Job\", \"label\":\"Scheduled Task/Job\", \"group\":\"Execution\" },\r\n    { \"value\":\"Software Deployment Tools\", \"label\":\"Software Deployment Tools\", \"group\":\"Execution\" },\r\n    { \"value\":\"User Execution\", \"label\":\"User Execution\", \"group\":\"Execution\" },\r\n    { \"value\":\"Windows Management Instrumentation\", \"label\":\"Windows Management Instrumentation\", \"group\":\"Execution\" },\r\n    { \"value\":\"Account Manipulation\", \"label\":\"Account Manipulation\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Boot or Logon Autostart Execution\", \"label\":\"Boot or Logon Autostart Execution\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Compromise Client Software Binary\", \"label\":\"Compromise Client Software Binary\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Create Account\", \"label\":\"Create Account\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Create or Modify System Process\", \"label\":\"Create or Modify System Process\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Event Triggered Execution\", \"label\":\"Event Triggered Execution\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Hijack Execution Flow\", \"label\":\"Hijack Execution Flow\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Implant Container Image\", \"label\":\"Implant Container Image\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Modify Authentication Process\", \"label\":\"Modify Authentication Process\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Office Application Startup\", \"label\":\"Office Application Startup\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Pre-OS Boot\", \"label\":\"Pre-OS Boot\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Server Software Component\", \"label\":\"Server Software Component\", \"group\":\"Persistence\" },\r\n    { \"value\":\"SQL Stored Procedures\", \"label\":\"SQL Stored Procedures\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Valid Accounts\", \"label\":\"Valid Accounts\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Abuse Elevation Control Mechanism\", \"label\":\"Abuse Elevation Control Mechanism\", \"group\":\"Privilege Escalation\" },\r\n    { \"value\":\"Boot or Logon Initialization Scripts\", \"label\":\"Boot or Logon Initialization Scripts\", \"group\":\"Privilege Escalation\" },\r\n    { \"value\":\"Event Triggered Execution\", \"label\":\"Event Triggered Execution\", \"group\":\"Privilege Escalation\" },\r\n    { \"value\":\"Exploitation for Privilege Escalation\", \"label\":\"Exploitation for Privilege Escalation\", \"group\":\"Privilege Escalation\" },\r\n    { \"value\":\"Access Token Manipulation\", \"label\":\"Access Token Manipulation\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Deobfuscate/Decode Files or Information\", \"label\":\"Deobfuscate/Decode Files or Information\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Exploit Public-Facing Application\", \"label\":\"Exploit Public-Facing Application\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Exploitation for Defense Evasion\", \"label\":\"Exploitation for Defense Evasion\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"File and Directory Permissions Modification\", \"label\":\"File and Directory Permissions Modification\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Hide Artifacts\", \"label\":\"Hide Artifacts\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Hijack Execution Flow\", \"label\":\"Hijack Execution Flow\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Impair Defenses\", \"label\":\"Impair Defenses\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Indicator Removal on Host\", \"label\":\"Indicator Removal on Host\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Indirect Command Execution\", \"label\":\"Indirect Command Execution\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Masquerading\", \"label\":\"Masquerading\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Modify Registry\", \"label\":\"Modify Registry\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Obuscated Files or Information\", \"label\":\"Obuscated Files or Information\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Obfuscated Files or Information\", \"label\":\"Obfuscated Files or Information\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Pre-OS Boot\", \"label\":\"Pre-OS Boot\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Process Injection\", \"label\":\"Process Injection\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Server Software Component\", \"label\":\"Server Software Component\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Signed Binary Proxy Execution\", \"label\":\"Signed Binary Proxy Execution\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Subvert Trust Controls\", \"label\":\"Subvert Trust Controls\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Brute Force\", \"label\":\"Brute Force\", \"group\":\"Credential Access\" },\r\n    { \"value\":\"Credentials from Password Stores\", \"label\":\"Credentials from Password Stores\", \"group\":\"Credential Access\" },\r\n    { \"value\":\"Exploitation for Credential Access\", \"label\":\"Exploitation for Credential Access\", \"group\":\"Credential Access\" },\r\n    { \"value\":\"Input Capture\", \"label\":\"Input Capture\", \"group\":\"Credential Access\" },\r\n    { \"value\":\"Man-in-the-Middle\", \"label\":\"Man-in-the-Middle\", \"group\":\"Credential Access\" },\r\n    { \"value\":\"Modify Authentication Process\", \"label\":\"Modify Authentication Process\", \"group\":\"Credential Access\" },\r\n    { \"value\":\"Network Sniffing\", \"label\":\"Network Sniffing\", \"group\":\"Credential Access\" },\r\n    { \"value\":\"OS Credential Dumping\", \"label\":\"OS Credential Dumping\", \"group\":\"Credential Access\" },\r\n    { \"value\":\"Steal or Forge Kerberos Tickets\", \"label\":\"Steal or Forge Kerberos Tickets\", \"group\":\"Credential Access\" },\r\n    { \"value\":\"Unsecured Credentials\", \"label\":\"Unsecured Credentials\", \"group\":\"Credential Access\" },\r\n    { \"value\":\"Account Discovery\", \"label\":\"Account Discovery\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Cloud Infrastructure Discovery\", \"label\":\"Cloud Infrastructure Discovery\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Cloud Service Dashboard\", \"label\":\"Cloud Service Dashboard\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Cloud Service Discovery\", \"label\":\"Cloud Service Discovery\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Container and Resource Discovery\", \"label\":\"Container and Resource Discovery\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Domain Trust Discovery\", \"label\":\"Domain Trust Discovery\", \"group\":\"Discovery\" },\r\n    { \"value\":\"File and Directory Discovery\", \"label\":\"File and Directory Discovery\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Network Service Scanning\", \"label\":\"Network Service Scanning\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Network Sniffing\", \"label\":\"Network Sniffing\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Permission Groups Discovery\", \"label\":\"Permission Groups Discovery\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Process Discovery\", \"label\":\"Process Discovery\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Query Registry\", \"label\":\"Query Registry\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Remote System Discovery\", \"label\":\"Remote System Discovery\", \"group\":\"Discovery\" },\r\n    { \"value\":\"System Information Discovery\", \"label\":\"System Information Discovery\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Exploitation of Remote Services\", \"label\":\"Exploitation of Remote Services\", \"group\":\"Lateral Movement\" },\r\n    { \"value\":\"Lateral Tool Transfer\", \"label\":\"Lateral Tool Transfer\", \"group\":\"Lateral Movement\" },\r\n    { \"value\":\"Remote Service Session Hijacking\", \"label\":\"Remote Service Session Hijacking\", \"group\":\"Lateral Movement\" },\r\n    { \"value\":\"Remote Services\", \"label\":\"Remote Services\", \"group\":\"Lateral Movement\" },\r\n    { \"value\":\"Taint Shared Content\", \"label\":\"Taint Shared Content\", \"group\":\"Lateral Movement\" },\r\n    { \"value\":\"Audio Capture\", \"label\":\"Audio Capture\", \"group\":\"Collection\" },\r\n    { \"value\":\"Data from Cloud Storage Object\", \"label\":\"Data from Cloud Storage Object\", \"group\":\"Collection\" },\r\n    { \"value\":\"Data from Configuration Repository\", \"label\":\"Data from Configuration Repository\", \"group\":\"Collection\" },\r\n    { \"value\":\"Data from Information Repositories\", \"label\":\"Data from Information Repositories\", \"group\":\"Collection\" },\r\n    { \"value\":\"Data from Local System\", \"label\":\"Data from Local System\", \"group\":\"Collection\" },\r\n    { \"value\":\"Data Staged\", \"label\":\"Data Staged\", \"group\":\"Collection\" },\r\n    { \"value\":\"Man-in-the-Middle\", \"label\":\"Man-in-the-Middle\", \"group\":\"Collection\" },\r\n    { \"value\":\"Screen Capture\", \"label\":\"Screen Capture\", \"group\":\"Collection\" },\r\n    { \"value\":\"Application Layer Protocol\", \"label\":\"Application Layer Protocol\", \"group\":\"Command and Control\" },\r\n    { \"value\":\"Dynamic Resolution\", \"label\":\"Dynamic Resolution\", \"group\":\"Command and Control\" },\r\n    { \"value\":\"Fallback Channels\", \"label\":\"Fallback Channels\", \"group\":\"Command and Control\" },\r\n    { \"value\":\"Ingress Tool Transfer\", \"label\":\"Ingress Tool Transfer\", \"group\":\"Command and Control\" },\r\n    { \"value\":\"Non-Application Layer Protocol\", \"label\":\"Non-Application Layer Protocol\", \"group\":\"Command and Control\" },\r\n    { \"value\":\"Non-Standard Port\", \"label\":\"Non-Standard Port\", \"group\":\"Command and Control\" },\r\n    { \"value\":\"Protocol Tunneling\", \"label\":\"Protocol Tunneling\", \"group\":\"Command and Control\" },\r\n    { \"value\":\"Proxy\", \"label\":\"Proxy\", \"group\":\"Command and Control\" },\r\n    { \"value\":\"Remote Access Software\", \"label\":\"Remote Access Software\", \"group\":\"Command and Control\" },\r\n    { \"value\":\"Traffic Signaling\", \"label\":\"Traffic Signaling\", \"group\":\"Command and Control\" },\r\n    { \"value\":\"Exfiltration Over Alternative Protocol\", \"label\":\"Exfiltration Over Alternative Protocol\", \"group\":\"Exfiltration\" },\r\n    { \"value\":\"Transfer Data to Cloud Account\", \"label\":\"Transfer Data to Cloud Account\", \"group\":\"Exfiltration\" },\r\n    { \"value\":\"Data Destruction\", \"label\":\"Data Destruction\", \"group\":\"Impact\" },\r\n    { \"value\":\"Data Encrypted for Impact\", \"label\":\"Data Encrypted for Impact\", \"group\":\"Impact\" },\r\n    { \"value\":\"Data Manipulation\", \"label\":\"Data Manipulation\", \"group\":\"Impact\" },\r\n    { \"value\":\"Defacement\", \"label\":\"Defacement\", \"group\":\"Impact\" },\r\n    { \"value\":\"Disk Wipe\", \"label\":\"Disk Wipe\", \"group\":\"Impact\" },\r\n    { \"value\":\"Endpoint Denial of Service\", \"label\":\"Endpoint Denial of Service\", \"group\":\"Impact\" },\r\n    { \"value\":\"Network Denial of Service\", \"label\":\"Network Denial of Service\", \"group\":\"Impact\" },\r\n    { \"value\":\"Resource Hijacking\", \"label\":\"Resource Hijacking\", \"group\":\"Impact\" },\r\n    { \"value\":\"Service Stop\", \"label\":\"Service Stop\", \"group\":\"Impact\" }\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "defaultValue": "value::all"
                                  },
                                  {
                                    "id": "6913fc40-d43b-42f4-a995-358523326a2e",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Status",
                                    "type": 2,
                                    "multiSelect": true,
                                    "quote": "'",
                                    "delimiter": ",",
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::all"
                                      ],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n{\"value\": \"Healthy\", \"label\":\"Healthy\"},\r\n{\"value\": \"Unhealthy\", \"label\":\"Unhealthy\", \"selected\":true},\r\n{\"value\": \"NotApplicable\", \"label\":\"Not Applicable\"}\r\n]\r\n    \r\n ",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "defaultValue": "value::all"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "parameters - 23"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "4c6e30dc-8fb1-41e8-8607-6c1efd95ca1b",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TechniquesDrilldownFilter",
                                    "type": 1,
                                    "criteriaData": [
                                      {
                                        "criteriaContext": {
                                          "leftOperand": "Techniques",
                                          "operator": "isNotNull",
                                          "rightValType": "param",
                                          "resultValType": "static",
                                          "resultVal": "value in ({Techniques})"
                                        }
                                      },
                                      {
                                        "criteriaContext": {
                                          "operator": "Default",
                                          "resultValType": "static",
                                          "resultVal": "true"
                                        }
                                      }
                                    ],
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "dc29ac1c-40b5-4921-9b39-de824deeaf16",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "HealthDrillDownFilter",
                                    "type": 1,
                                    "criteriaData": [
                                      {
                                        "criteriaContext": {
                                          "leftOperand": "Status",
                                          "operator": "isNotNull",
                                          "rightValType": "param",
                                          "resultValType": "static",
                                          "resultVal": "healthState in ({Status})"
                                        }
                                      },
                                      {
                                        "criteriaContext": {
                                          "operator": "Default",
                                          "resultValType": "static",
                                          "resultVal": "true"
                                        }
                                      }
                                    ],
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "conditionalVisibility": {
                                "parameterName": "DebugVisible",
                                "comparison": "isEqualTo",
                                "value": "true"
                              },
                              "name": "parameters - 2"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "{\"version\":\"1.0.0\",\"content\":\"[\\r\\n    { \\\"value\\\":\\\"Active Scanning\\\", \\\"label\\\":\\\"Active Scanning\\\", \\\"group\\\":\\\"Reconnaissance\\\" },\\r\\n    { \\\"value\\\":\\\"Gather Victim Network Information\\\", \\\"label\\\":\\\"Gather Victim Network Information\\\", \\\"group\\\":\\\"Reconnaissance\\\" },\\r\\n    { \\\"value\\\":\\\"Search Victim-Owned Websites\\\", \\\"label\\\":\\\"Search Victim-Owned Websites\\\", \\\"group\\\":\\\"Reconnaissance\\\" },\\r\\n    { \\\"value\\\":\\\"Obtain Capabilities\\\", \\\"label\\\":\\\"Obtain Capabilities\\\", \\\"group\\\":\\\"Resource Development\\\" },\\r\\n    { \\\"value\\\":\\\"Compromise Infrastructure\\\", \\\"label\\\":\\\"Compromise Infrastructure\\\", \\\"group\\\":\\\"Resource Development\\\" },\\r\\n    { \\\"value\\\":\\\"Brute Force\\\", \\\"label\\\":\\\"Brute Force\\\", \\\"group\\\":\\\"Initial Access\\\" },\\r\\n    { \\\"value\\\":\\\"Drive-by Compromise\\\", \\\"label\\\":\\\"Drive-by Compromise\\\", \\\"group\\\":\\\"Initial Access\\\" },\\r\\n    { \\\"value\\\":\\\"Exploit Public-Facing Application\\\", \\\"label\\\":\\\"Exploit Public-Facing Application\\\", \\\"group\\\":\\\"Initial Access\\\" },\\r\\n    { \\\"value\\\":\\\"Exploitation of Remote Services\\\", \\\"label\\\":\\\"Exploitation of Remote Services\\\", \\\"group\\\":\\\"Initial Access\\\" },\\r\\n    { \\\"value\\\":\\\"External Remote Services\\\", \\\"label\\\":\\\"External Remote Services\\\", \\\"group\\\":\\\"Initial Access\\\" },\\r\\n    { \\\"value\\\":\\\"Network Sniffing\\\", \\\"label\\\":\\\"Network Sniffing\\\", \\\"group\\\":\\\"Initial Access\\\" },\\r\\n    { \\\"value\\\":\\\"Phishing\\\", \\\"label\\\":\\\"Phishing\\\", \\\"group\\\":\\\"Initial Access\\\" },\\r\\n    { \\\"value\\\":\\\"Supply Chain Compromise\\\", \\\"label\\\":\\\"Supply Chain Compromise\\\", \\\"group\\\":\\\"Initial Access\\\" },\\r\\n    { \\\"value\\\":\\\"Trusted Relationship\\\", \\\"label\\\":\\\"Trusted Relationship\\\", \\\"group\\\":\\\"Initial Access\\\" },\\r\\n    { \\\"value\\\":\\\"Valid Accounts\\\", \\\"label\\\":\\\"Valid Accounts\\\", \\\"group\\\":\\\"Initial Access\\\" },\\r\\n    { \\\"value\\\":\\\"Command and Scripting Interpreter\\\", \\\"label\\\":\\\"Command and Scripting Interpreter\\\", \\\"group\\\":\\\"Execution\\\" },\\r\\n    { \\\"value\\\":\\\"Exploitation for Client Execution\\\", \\\"label\\\":\\\"Exploitation for Client Execution\\\", \\\"group\\\":\\\"Execution\\\" },\\r\\n    { \\\"value\\\":\\\"Inter-Process Communication\\\", \\\"label\\\":\\\"Inter-Process Communication\\\", \\\"group\\\":\\\"Execution\\\" },\\r\\n    { \\\"value\\\":\\\"Scheduled Task/Job\\\", \\\"label\\\":\\\"Scheduled Task/Job\\\", \\\"group\\\":\\\"Execution\\\" },\\r\\n    { \\\"value\\\":\\\"Software Deployment Tools\\\", \\\"label\\\":\\\"Software Deployment Tools\\\", \\\"group\\\":\\\"Execution\\\" },\\r\\n    { \\\"value\\\":\\\"User Execution\\\", \\\"label\\\":\\\"User Execution\\\", \\\"group\\\":\\\"Execution\\\" },\\r\\n    { \\\"value\\\":\\\"Windows Management Instrumentation\\\", \\\"label\\\":\\\"Windows Management Instrumentation\\\", \\\"group\\\":\\\"Execution\\\" },\\r\\n    { \\\"value\\\":\\\"Account Manipulation\\\", \\\"label\\\":\\\"Account Manipulation\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Boot or Logon Autostart Execution\\\", \\\"label\\\":\\\"Boot or Logon Autostart Execution\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Compromise Client Software Binary\\\", \\\"label\\\":\\\"Compromise Client Software Binary\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Create Account\\\", \\\"label\\\":\\\"Create Account\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Create or Modify System Process\\\", \\\"label\\\":\\\"Create or Modify System Process\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Event Triggered Execution\\\", \\\"label\\\":\\\"Event Triggered Execution\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Hijack Execution Flow\\\", \\\"label\\\":\\\"Hijack Execution Flow\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Implant Container Image\\\", \\\"label\\\":\\\"Implant Container Image\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Modify Authentication Process\\\", \\\"label\\\":\\\"Modify Authentication Process\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Office Application Startup\\\", \\\"label\\\":\\\"Office Application Startup\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Pre-OS Boot\\\", \\\"label\\\":\\\"Pre-OS Boot\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Server Software Component\\\", \\\"label\\\":\\\"Server Software Component\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"SQL Stored Procedures\\\", \\\"label\\\":\\\"SQL Stored Procedures\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Valid Accounts\\\", \\\"label\\\":\\\"Valid Accounts\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Abuse Elevation Control Mechanism\\\", \\\"label\\\":\\\"Abuse Elevation Control Mechanism\\\", \\\"group\\\":\\\"Privilege Escalation\\\" },\\r\\n    { \\\"value\\\":\\\"Boot or Logon Initialization Scripts\\\", \\\"label\\\":\\\"Boot or Logon Initialization Scripts\\\", \\\"group\\\":\\\"Privilege Escalation\\\" },\\r\\n    { \\\"value\\\":\\\"Event Triggered Execution\\\", \\\"label\\\":\\\"Event Triggered Execution\\\", \\\"group\\\":\\\"Privilege Escalation\\\" },\\r\\n    { \\\"value\\\":\\\"Exploitation for Privilege Escalation\\\", \\\"label\\\":\\\"Exploitation for Privilege Escalation\\\", \\\"group\\\":\\\"Privilege Escalation\\\" },\\r\\n    { \\\"value\\\":\\\"Access Token Manipulation\\\", \\\"label\\\":\\\"Access Token Manipulation\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Deobfuscate/Decode Files or Information\\\", \\\"label\\\":\\\"Deobfuscate/Decode Files or Information\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Exploit Public-Facing Application\\\", \\\"label\\\":\\\"Exploit Public-Facing Application\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Exploitation for Defense Evasion\\\", \\\"label\\\":\\\"Exploitation for Defense Evasion\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"File and Directory Permissions Modification\\\", \\\"label\\\":\\\"File and Directory Permissions Modification\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Hide Artifacts\\\", \\\"label\\\":\\\"Hide Artifacts\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Hijack Execution Flow\\\", \\\"label\\\":\\\"Hijack Execution Flow\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Impair Defenses\\\", \\\"label\\\":\\\"Impair Defenses\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Indicator Removal on Host\\\", \\\"label\\\":\\\"Indicator Removal on Host\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Indirect Command Execution\\\", \\\"label\\\":\\\"Indirect Command Execution\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Masquerading\\\", \\\"label\\\":\\\"Masquerading\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Modify Registry\\\", \\\"label\\\":\\\"Modify Registry\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Obuscated Files or Information\\\", \\\"label\\\":\\\"Obuscated Files or Information\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Obfuscated Files or Information\\\", \\\"label\\\":\\\"Obfuscated Files or Information\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Pre-OS Boot\\\", \\\"label\\\":\\\"Pre-OS Boot\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Process Injection\\\", \\\"label\\\":\\\"Process Injection\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Server Software Component\\\", \\\"label\\\":\\\"Server Software Component\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Signed Binary Proxy Execution\\\", \\\"label\\\":\\\"Signed Binary Proxy Execution\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Subvert Trust Controls\\\", \\\"label\\\":\\\"Subvert Trust Controls\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Brute Force\\\", \\\"label\\\":\\\"Brute Force\\\", \\\"group\\\":\\\"Credential Access\\\" },\\r\\n    { \\\"value\\\":\\\"Credentials from Password Stores\\\", \\\"label\\\":\\\"Credentials from Password Stores\\\", \\\"group\\\":\\\"Credential Access\\\" },\\r\\n    { \\\"value\\\":\\\"Exploitation for Credential Access\\\", \\\"label\\\":\\\"Exploitation for Credential Access\\\", \\\"group\\\":\\\"Credential Access\\\" },\\r\\n    { \\\"value\\\":\\\"Input Capture\\\", \\\"label\\\":\\\"Input Capture\\\", \\\"group\\\":\\\"Credential Access\\\" },\\r\\n    { \\\"value\\\":\\\"Man-in-the-Middle\\\", \\\"label\\\":\\\"Man-in-the-Middle\\\", \\\"group\\\":\\\"Credential Access\\\" },\\r\\n    { \\\"value\\\":\\\"Modify Authentication Process\\\", \\\"label\\\":\\\"Modify Authentication Process\\\", \\\"group\\\":\\\"Credential Access\\\" },\\r\\n    { \\\"value\\\":\\\"Network Sniffing\\\", \\\"label\\\":\\\"Network Sniffing\\\", \\\"group\\\":\\\"Credential Access\\\" },\\r\\n    { \\\"value\\\":\\\"OS Credential Dumping\\\", \\\"label\\\":\\\"OS Credential Dumping\\\", \\\"group\\\":\\\"Credential Access\\\" },\\r\\n    { \\\"value\\\":\\\"Steal or Forge Kerberos Tickets\\\", \\\"label\\\":\\\"Steal or Forge Kerberos Tickets\\\", \\\"group\\\":\\\"Credential Access\\\" },\\r\\n    { \\\"value\\\":\\\"Unsecured Credentials\\\", \\\"label\\\":\\\"Unsecured Credentials\\\", \\\"group\\\":\\\"Credential Access\\\" },\\r\\n    { \\\"value\\\":\\\"Account Discovery\\\", \\\"label\\\":\\\"Account Discovery\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Cloud Infrastructure Discovery\\\", \\\"label\\\":\\\"Cloud Infrastructure Discovery\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Cloud Service Dashboard\\\", \\\"label\\\":\\\"Cloud Service Dashboard\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Cloud Service Discovery\\\", \\\"label\\\":\\\"Cloud Service Discovery\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Container and Resource Discovery\\\", \\\"label\\\":\\\"Container and Resource Discovery\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Domain Trust Discovery\\\", \\\"label\\\":\\\"Domain Trust Discovery\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"File and Directory Discovery\\\", \\\"label\\\":\\\"File and Directory Discovery\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Network Service Scanning\\\", \\\"label\\\":\\\"Network Service Scanning\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Network Sniffing\\\", \\\"label\\\":\\\"Network Sniffing\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Permission Groups Discovery\\\", \\\"label\\\":\\\"Permission Groups Discovery\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Process Discovery\\\", \\\"label\\\":\\\"Process Discovery\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Query Registry\\\", \\\"label\\\":\\\"Query Registry\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Remote System Discovery\\\", \\\"label\\\":\\\"Remote System Discovery\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"System Information Discovery\\\", \\\"label\\\":\\\"System Information Discovery\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Exploitation of Remote Services\\\", \\\"label\\\":\\\"Exploitation of Remote Services\\\", \\\"group\\\":\\\"Lateral Movement\\\" },\\r\\n    { \\\"value\\\":\\\"Lateral Tool Transfer\\\", \\\"label\\\":\\\"Lateral Tool Transfer\\\", \\\"group\\\":\\\"Lateral Movement\\\" },\\r\\n    { \\\"value\\\":\\\"Remote Service Session Hijacking\\\", \\\"label\\\":\\\"Remote Service Session Hijacking\\\", \\\"group\\\":\\\"Lateral Movement\\\" },\\r\\n    { \\\"value\\\":\\\"Remote Services\\\", \\\"label\\\":\\\"Remote Services\\\", \\\"group\\\":\\\"Lateral Movement\\\" },\\r\\n    { \\\"value\\\":\\\"Taint Shared Content\\\", \\\"label\\\":\\\"Taint Shared Content\\\", \\\"group\\\":\\\"Lateral Movement\\\" },\\r\\n    { \\\"value\\\":\\\"Audio Capture\\\", \\\"label\\\":\\\"Audio Capture\\\", \\\"group\\\":\\\"Collection\\\" },\\r\\n    { \\\"value\\\":\\\"Data from Cloud Storage Object\\\", \\\"label\\\":\\\"Data from Cloud Storage Object\\\", \\\"group\\\":\\\"Collection\\\" },\\r\\n    { \\\"value\\\":\\\"Data from Configuration Repository\\\", \\\"label\\\":\\\"Data from Configuration Repository\\\", \\\"group\\\":\\\"Collection\\\" },\\r\\n    { \\\"value\\\":\\\"Data from Information Repositories\\\", \\\"label\\\":\\\"Data from Information Repositories\\\", \\\"group\\\":\\\"Collection\\\" },\\r\\n    { \\\"value\\\":\\\"Data from Local System\\\", \\\"label\\\":\\\"Data from Local System\\\", \\\"group\\\":\\\"Collection\\\" },\\r\\n    { \\\"value\\\":\\\"Data Staged\\\", \\\"label\\\":\\\"Data Staged\\\", \\\"group\\\":\\\"Collection\\\" },\\r\\n    { \\\"value\\\":\\\"Man-in-the-Middle\\\", \\\"label\\\":\\\"Man-in-the-Middle\\\", \\\"group\\\":\\\"Collection\\\" },\\r\\n    { \\\"value\\\":\\\"Screen Capture\\\", \\\"label\\\":\\\"Screen Capture\\\", \\\"group\\\":\\\"Collection\\\" },\\r\\n    { \\\"value\\\":\\\"Application Layer Protocol\\\", \\\"label\\\":\\\"Application Layer Protocol\\\", \\\"group\\\":\\\"Command and Control\\\" },\\r\\n    { \\\"value\\\":\\\"Dynamic Resolution\\\", \\\"label\\\":\\\"Dynamic Resolution\\\", \\\"group\\\":\\\"Command and Control\\\" },\\r\\n    { \\\"value\\\":\\\"Fallback Channels\\\", \\\"label\\\":\\\"Fallback Channels\\\", \\\"group\\\":\\\"Command and Control\\\" },\\r\\n    { \\\"value\\\":\\\"Ingress Tool Transfer\\\", \\\"label\\\":\\\"Ingress Tool Transfer\\\", \\\"group\\\":\\\"Command and Control\\\" },\\r\\n    { \\\"value\\\":\\\"Non-Application Layer Protocol\\\", \\\"label\\\":\\\"Non-Application Layer Protocol\\\", \\\"group\\\":\\\"Command and Control\\\" },\\r\\n    { \\\"value\\\":\\\"Non-Standard Port\\\", \\\"label\\\":\\\"Non-Standard Port\\\", \\\"group\\\":\\\"Command and Control\\\" },\\r\\n    { \\\"value\\\":\\\"Protocol Tunneling\\\", \\\"label\\\":\\\"Protocol Tunneling\\\", \\\"group\\\":\\\"Command and Control\\\" },\\r\\n    { \\\"value\\\":\\\"Proxy\\\", \\\"label\\\":\\\"Proxy\\\", \\\"group\\\":\\\"Command and Control\\\" },\\r\\n    { \\\"value\\\":\\\"Remote Access Software\\\", \\\"label\\\":\\\"Remote Access Software\\\", \\\"group\\\":\\\"Command and Control\\\" },\\r\\n    { \\\"value\\\":\\\"Traffic Signaling\\\", \\\"label\\\":\\\"Traffic Signaling\\\", \\\"group\\\":\\\"Command and Control\\\" },\\r\\n    { \\\"value\\\":\\\"Exfiltration Over Alternative Protocol\\\", \\\"label\\\":\\\"Exfiltration Over Alternative Protocol\\\", \\\"group\\\":\\\"Exfiltration\\\" },\\r\\n    { \\\"value\\\":\\\"Transfer Data to Cloud Account\\\", \\\"label\\\":\\\"Transfer Data to Cloud Account\\\", \\\"group\\\":\\\"Exfiltration\\\" },\\r\\n    { \\\"value\\\":\\\"Data Destruction\\\", \\\"label\\\":\\\"Data Destruction\\\", \\\"group\\\":\\\"Impact\\\" },\\r\\n    { \\\"value\\\":\\\"Data Encrypted for Impact\\\", \\\"label\\\":\\\"Data Encrypted for Impact\\\", \\\"group\\\":\\\"Impact\\\" },\\r\\n    { \\\"value\\\":\\\"Data Manipulation\\\", \\\"label\\\":\\\"Data Manipulation\\\", \\\"group\\\":\\\"Impact\\\" },\\r\\n    { \\\"value\\\":\\\"Defacement\\\", \\\"label\\\":\\\"Defacement\\\", \\\"group\\\":\\\"Impact\\\" },\\r\\n    { \\\"value\\\":\\\"Disk Wipe\\\", \\\"label\\\":\\\"Disk Wipe\\\", \\\"group\\\":\\\"Impact\\\" },\\r\\n    { \\\"value\\\":\\\"Endpoint Denial of Service\\\", \\\"label\\\":\\\"Endpoint Denial of Service\\\", \\\"group\\\":\\\"Impact\\\" },\\r\\n    { \\\"value\\\":\\\"Network Denial of Service\\\", \\\"label\\\":\\\"Network Denial of Service\\\", \\\"group\\\":\\\"Impact\\\" },\\r\\n    { \\\"value\\\":\\\"Resource Hijacking\\\", \\\"label\\\":\\\"Resource Hijacking\\\", \\\"group\\\":\\\"Impact\\\" },\\r\\n    { \\\"value\\\":\\\"Service Stop\\\", \\\"label\\\":\\\"Service Stop\\\", \\\"group\\\":\\\"Impact\\\" }\\r\\n]\",\"transformers\":null}",
                                "size": 4,
                                "queryType": 8
                              },
                              "customWidth": "50",
                              "conditionalVisibility": {
                                "parameterName": "debugVisible",
                                "comparison": "isEqualTo",
                                "value": "true"
                              },
                              "name": "JSON Tactics and Techniques List"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "securityresources \r\n    | where type == \"microsoft.security/assessments\" \r\n    | extend value = properties.metadata.techniques \r\n    | extend healthState = properties.status.code \r\n    | mvexpand value\r\n    | where {TechniquesDrilldownFilter} and {HealthDrillDownFilter}\r\n    | extend url = strcat(\"https://\", properties.links.azurePortal)\r\n    | project value, properties.resourceDetails.Id, healthState, properties.metadata.displayName, url\r\n\r\n",
                                "size": 4,
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "value",
                                      "formatter": 1
                                    },
                                    {
                                      "columnMatch": "properties_resourceDetails_Id",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkColumn": "properties_resourceDetails_Id",
                                        "linkTarget": "Resource",
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "healthState",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "NotApplicable",
                                            "representation": "more",
                                            "text": "Not Applicable"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Unhealthy",
                                            "representation": "2",
                                            "text": "Unhealthy"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Healthy",
                                            "representation": "success",
                                            "text": "Healthy"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "Blank",
                                            "text": ""
                                          }
                                        ],
                                        "aggregation": "Average"
                                      },
                                      "numberFormat": {
                                        "unit": 0,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "properties_metadata_displayName",
                                      "formatter": 1
                                    },
                                    {
                                      "columnMatch": "url",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "Url",
                                        "linkLabel": "Go to recommendation",
                                        "linkIsContextBlade": false
                                      }
                                    },
                                    {
                                      "columnMatch": "techniques",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "tactic",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "customColumnWidthSetting": "30ch"
                                      }
                                    },
                                    {
                                      "columnMatch": "resourceGroup",
                                      "formatter": 14,
                                      "formatOptions": {
                                        "linkTarget": null,
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Total",
                                      "formatter": 22,
                                      "formatOptions": {
                                        "compositeBarSettings": {
                                          "labelText": "",
                                          "columnSettings": [
                                            {
                                              "columnName": "Healthy",
                                              "color": "green"
                                            },
                                            {
                                              "columnName": "Unhealthy",
                                              "color": "redBright"
                                            },
                                            {
                                              "columnName": "NotApplicable",
                                              "color": "gray"
                                            }
                                          ]
                                        },
                                        "customColumnWidthSetting": "30ch"
                                      }
                                    },
                                    {
                                      "columnMatch": "Healthy",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Unhealthy",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "NotApplicable",
                                      "formatter": 5
                                    }
                                  ],
                                  "rowLimit": 10000,
                                  "labelSettings": [
                                    {
                                      "columnId": "value",
                                      "label": "Tactic"
                                    },
                                    {
                                      "columnId": "properties_resourceDetails_Id",
                                      "label": "Resource"
                                    },
                                    {
                                      "columnId": "healthState",
                                      "label": "Health State"
                                    },
                                    {
                                      "columnId": "properties_metadata_displayName",
                                      "label": "Recommendation"
                                    }
                                  ]
                                },
                                "sortBy": []
                              },
                              "customWidth": "50",
                              "conditionalVisibility": {
                                "parameterName": "debugVisible",
                                "comparison": "isEqualTo",
                                "value": "true"
                              },
                              "name": "ARG Techniques Query Recommendations"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"1f7cfea7-b6b6-46bc-897b-d794b9e96041\",\"mergeType\":\"inner\",\"leftTable\":\"ARG Techniques Query Recommendations\",\"rightTable\":\"JSON Tactics and Techniques List\",\"leftColumn\":\"value\",\"rightColumn\":\"value\"}],\"projectRename\":[{\"originalName\":\"[ARG Techniques Query Recommendations].value\",\"mergedName\":\"Tactic\",\"fromId\":\"1f7cfea7-b6b6-46bc-897b-d794b9e96041\"},{\"originalName\":\"[ARG Techniques Query Recommendations].properties_resourceDetails_Id\",\"mergedName\":\"Resource\",\"fromId\":\"1f7cfea7-b6b6-46bc-897b-d794b9e96041\"},{\"originalName\":\"[ARG Techniques Query Recommendations].healthState\",\"mergedName\":\"Health State\",\"fromId\":\"1f7cfea7-b6b6-46bc-897b-d794b9e96041\"},{\"originalName\":\"[ARG Techniques Query Recommendations].properties_metadata_displayName\",\"mergedName\":\"Recommendation\",\"fromId\":\"1f7cfea7-b6b6-46bc-897b-d794b9e96041\"},{\"originalName\":\"[ARG Techniques Query Recommendations].url\",\"mergedName\":\"url\",\"fromId\":\"1f7cfea7-b6b6-46bc-897b-d794b9e96041\"},{\"originalName\":\"[JSON Tactics and Techniques List].value\",\"mergedName\":\"value\",\"fromId\":\"1f7cfea7-b6b6-46bc-897b-d794b9e96041\"},{\"originalName\":\"[JSON Tactics and Techniques List].label\",\"mergedName\":\"label\",\"fromId\":\"1f7cfea7-b6b6-46bc-897b-d794b9e96041\"},{\"originalName\":\"[JSON Tactics and Techniques List].group\",\"mergedName\":\"group\",\"fromId\":\"1f7cfea7-b6b6-46bc-897b-d794b9e96041\"},{\"originalName\":\"[JSON Tactics and Techniques List].label\"},{\"originalName\":\"[JSON Tactics and Techniques List].value\"}]}",
                                "size": 3,
                                "showExportToExcel": true,
                                "queryType": 7,
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Tactic",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Resource",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": null,
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Health State",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Healthy",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Unhealthy",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "NotApplicable",
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "unknown",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "Recommendation",
                                      "formatter": 1
                                    },
                                    {
                                      "columnMatch": "url",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "Url",
                                        "linkLabel": "Go to recommendation"
                                      }
                                    },
                                    {
                                      "columnMatch": "value",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "label",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "group",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Technique",
                                      "formatter": 5
                                    }
                                  ],
                                  "rowLimit": 10000,
                                  "filter": true,
                                  "hierarchySettings": {
                                    "treeType": 1,
                                    "groupBy": [
                                      "group",
                                      "value"
                                    ]
                                  },
                                  "labelSettings": [
                                    {
                                      "columnId": "url",
                                      "label": "URL"
                                    },
                                    {
                                      "columnId": "group",
                                      "label": "Tactics and Techniques"
                                    }
                                  ]
                                }
                              },
                              "showPin": false,
                              "name": "Recommendations Mapped"
                            }
                          ]
                        },
                        "name": "RecommendationsByTechniqueGroup"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "protection"
                  },
                  "name": "Protection"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "securityresources\n| where type =~ \"microsoft.security/pricings\"\n| extend pricingTier = properties.pricingTier, subPlan = properties.subPlan\n| extend planSet = pack(name, level = case(isnotempty(subPlan),subPlan,pricingTier))\n| summarize defenderPlans = make_bag(planSet) by subscriptionId\n| project subscriptionId,\n    VirtualMachines = defenderPlans.VirtualMachines,\n    AppServices = defenderPlans.AppServices,\n    SqlServers = defenderPlans.SqlServers,\n    SqlServerVirtualMachines = defenderPlans.SqlServerVirtualMachines,\n    OpenSourceRelationalDatabases = defenderPlans.OpenSourceRelationalDatabases,\n    CosmosDB = defenderPlans.CosmosDbs,\n    StorageAccounts = defenderPlans.StorageAccounts,\n    Containers = defenderPlans.Containers,\n    KeyVaults = defenderPlans.KeyVaults,\n    Arm = defenderPlans.Arm,\n    DNS = defenderPlans.Dns,\n    KubernetesService = defenderPlans.KubernetesService,\n    ContainerRegistry = defenderPlans.ContainerRegistry\n| summarize totalSubs = count(), Servers = countif(VirtualMachines == \"P1\" or VirtualMachines == \"P2\"),\n    AppSrv = countif(AppServices == \"Standard\"),\n    SqlServers = countif(SqlServers == \"Standard\"),\n    SqlServerVirtualMachines = countif(SqlServerVirtualMachines == \"Standard\"),\n    OpenSourceRelationalDatabases = countif(OpenSourceRelationalDatabases == \"Standard\"),\n    CosmosDB = countif(CosmosDB == \"Standard\"),\n    StorageAccounts = countif(StorageAccounts == \"Standard\"),\n    Containers = countif(Containers == \"Standard\"),\n    KeyVaults = countif(KeyVaults == \"Standard\"),\n    Arm = countif(Arm == \"Standard\"),\n    DNS = countif(DNS == \"Standard\"),\n    KubernetesService = countif(KubernetesService == \"Standard\"),\n    ContainerRegistry = countif(ContainerRegistry == \"Standard\")",
                          "size": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "table",
                          "tileSettings": {
                            "showBorder": false
                          },
                          "graphSettings": {
                            "type": 0
                          }
                        },
                        "customWidth": "20",
                        "conditionalVisibility": {
                          "parameterName": "blank",
                          "comparison": "isNotEqualTo"
                        },
                        "name": "Azure numbers"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"17975ef8-d504-4965-a0ca-3e25f6c5203c\",\"mergeType\":\"table\",\"leftTable\":\"Azure numbers\"}],\"projectRename\":[{\"originalName\":\"[Azure numbers].totalSubs\",\"mergedName\":\"totalSubs\",\"fromId\":\"17975ef8-d504-4965-a0ca-3e25f6c5203c\"},{\"originalName\":\"[Azure numbers].Servers\",\"mergedName\":\"Servers\",\"fromId\":\"17975ef8-d504-4965-a0ca-3e25f6c5203c\"},{\"originalName\":\"[Azure numbers].AppSrv\",\"mergedName\":\"AppSrv\",\"fromId\":\"17975ef8-d504-4965-a0ca-3e25f6c5203c\"},{\"originalName\":\"[Azure numbers].SqlServers\",\"mergedName\":\"SqlServers\",\"fromId\":\"17975ef8-d504-4965-a0ca-3e25f6c5203c\"},{\"originalName\":\"[Azure numbers].SqlServerVirtualMachines\",\"mergedName\":\"SqlServerVirtualMachines\",\"fromId\":\"17975ef8-d504-4965-a0ca-3e25f6c5203c\"},{\"originalName\":\"[Azure numbers].OpenSourceRelationalDatabases\",\"mergedName\":\"OpenSourceRelationalDatabases\",\"fromId\":\"17975ef8-d504-4965-a0ca-3e25f6c5203c\"},{\"originalName\":\"[Azure numbers].CosmosDB\",\"mergedName\":\"CosmosDB\",\"fromId\":\"17975ef8-d504-4965-a0ca-3e25f6c5203c\"},{\"originalName\":\"[Azure numbers].StorageAccounts\",\"mergedName\":\"StorageAccounts\",\"fromId\":\"17975ef8-d504-4965-a0ca-3e25f6c5203c\"},{\"originalName\":\"[Azure numbers].Containers\",\"mergedName\":\"Containers\",\"fromId\":\"17975ef8-d504-4965-a0ca-3e25f6c5203c\"},{\"originalName\":\"[Azure numbers].KeyVaults\",\"mergedName\":\"KeyVaults\",\"fromId\":\"17975ef8-d504-4965-a0ca-3e25f6c5203c\"},{\"originalName\":\"[Azure numbers].Arm\",\"mergedName\":\"Arm\",\"fromId\":\"17975ef8-d504-4965-a0ca-3e25f6c5203c\"},{\"originalName\":\"[Azure numbers].DNS\",\"mergedName\":\"DNS\",\"fromId\":\"17975ef8-d504-4965-a0ca-3e25f6c5203c\"},{\"originalName\":\"[Azure numbers].KubernetesService\",\"mergedName\":\"KubernetesService\",\"fromId\":\"17975ef8-d504-4965-a0ca-3e25f6c5203c\"},{\"originalName\":\"[Azure numbers].ContainerRegistry\",\"mergedName\":\"ContainerRegistry\",\"fromId\":\"17975ef8-d504-4965-a0ca-3e25f6c5203c\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Servers1\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"Servers\\\"]/[\\\"totalSubs\\\"]*100\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"AppSrv1\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"AppSrv\\\"]/[\\\"totalSubs\\\"]*100\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"SQL1\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"SqlServers\\\"]/[\\\"totalSubs\\\"]*100\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"SQL Server on machines\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"SqlServerVirtualMachines\\\"]/[\\\"totalSubs\\\"]*100\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Open-source relational DBs\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"OpenSourceRelationalDatabases\\\"]/[\\\"totalSubs\\\"]*100\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Cosmos DB\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"CosmosDB\\\"]/[\\\"totalSubs\\\"]*100\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Storage1\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"StorageAccounts\\\"]/[\\\"totalSubs\\\"]*100\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Containers1\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"Containers\\\"]/[\\\"totalSubs\\\"]*100\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Key Vaults\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"KeyVaults\\\"]/[\\\"totalSubs\\\"]*100\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Resource Manager\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"Arm\\\"]/[\\\"totalSubs\\\"]*100\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"DNS1\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"DNS\\\"]/[\\\"totalSubs\\\"]*100\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"K8s (deprecated)\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"KubernetesService\\\"]/[\\\"totalSubs\\\"]*100\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Container Registry (deprecated)\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"ContainerRegistry\\\"]/[\\\"totalSubs\\\"]*100\"}}]}]}",
                          "size": 3,
                          "title": "Relative coverage across Azure subscriptions",
                          "queryType": 7,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "totalSubs",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Servers",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "AppSrv",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "SqlServers",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "SqlServerVirtualMachines",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "OpenSourceRelationalDatabases",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "CosmosDB",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "StorageAccounts",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Containers",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "KeyVaults",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Arm",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "DNS",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "KubernetesService",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "ContainerRegistry",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Servers1",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "max": 100,
                                  "palette": "lightBlue"
                                },
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 1
                                  }
                                }
                              },
                              {
                                "columnMatch": "AppSrv1",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "max": 100,
                                  "palette": "lightBlue"
                                },
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 1
                                  }
                                }
                              },
                              {
                                "columnMatch": "SQL1",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "max": 100,
                                  "palette": "lightBlue"
                                },
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 1
                                  }
                                }
                              },
                              {
                                "columnMatch": "SQL Server on machines",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "max": 100,
                                  "palette": "lightBlue"
                                },
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 1
                                  }
                                }
                              },
                              {
                                "columnMatch": "Open-source relational DBs",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "max": 100,
                                  "palette": "lightBlue"
                                },
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 1
                                  }
                                }
                              },
                              {
                                "columnMatch": "Cosmos DB",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "max": 100,
                                  "palette": "lightBlue"
                                },
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 1
                                  }
                                }
                              },
                              {
                                "columnMatch": "Storage1",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "max": 100,
                                  "palette": "lightBlue"
                                },
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 1
                                  }
                                }
                              },
                              {
                                "columnMatch": "Containers1",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "max": 100,
                                  "palette": "lightBlue"
                                },
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 1
                                  }
                                }
                              },
                              {
                                "columnMatch": "Key Vaults",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "max": 100,
                                  "palette": "lightBlue"
                                },
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 1
                                  }
                                }
                              },
                              {
                                "columnMatch": "Resource Manager",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "max": 100,
                                  "palette": "lightBlue"
                                },
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 1
                                  }
                                }
                              },
                              {
                                "columnMatch": "DNS1",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "max": 100,
                                  "palette": "lightBlue"
                                },
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 1
                                  }
                                }
                              },
                              {
                                "columnMatch": "K8s (deprecated)",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "max": 100,
                                  "palette": "lightBlue"
                                },
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 1
                                  }
                                }
                              },
                              {
                                "columnMatch": "Container Registry (deprecated)",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "max": 100,
                                  "palette": "lightBlue"
                                },
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 1
                                  }
                                }
                              }
                            ],
                            "rowLimit": 2,
                            "labelSettings": [
                              {
                                "columnId": "Servers1",
                                "label": "Servers"
                              },
                              {
                                "columnId": "AppSrv1",
                                "label": "App Services"
                              },
                              {
                                "columnId": "SQL1",
                                "label": "SQL"
                              },
                              {
                                "columnId": "Storage1",
                                "label": "Storage"
                              },
                              {
                                "columnId": "Containers1",
                                "label": "Containers"
                              },
                              {
                                "columnId": "DNS1",
                                "label": "DNS"
                              }
                            ]
                          }
                        },
                        "showPin": false,
                        "name": "Azure percentage"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "securityresources\n| where type =~ \"microsoft.security/pricings\"\n| extend pricingTier = properties.pricingTier, subPlan = properties.subPlan\n| extend planSet = pack(name, level = case(isnotempty(subPlan),subPlan,pricingTier))\n| summarize defenderPlans = make_bag(planSet) by subscriptionId\n| project subscriptionId,\n    VirtualMachines = defenderPlans.VirtualMachines,\n    AppServices = defenderPlans.AppServices,\n    SqlServers = defenderPlans.SqlServers,\n    SqlServerVirtualMachines = defenderPlans.SqlServerVirtualMachines,\n    OpenSourceRelationalDatabases = defenderPlans.OpenSourceRelationalDatabases,\n    CosmosDB = defenderPlans.CosmosDbs,\n    StorageAccounts = defenderPlans.StorageAccounts,\n    Containers = defenderPlans.Containers,\n    KeyVaults = defenderPlans.KeyVaults,\n    Arm = defenderPlans.Arm,\n    DNS = defenderPlans.Dns,\n    KubernetesService = defenderPlans.KubernetesService,\n    ContainerRegistry = defenderPlans.ContainerRegistry",
                          "size": 3,
                          "title": "Absolute coverage across Azure subscriptions",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "subscriptionId",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "showIcon": true,
                                  "customColumnWidthSetting": "50ch"
                                }
                              },
                              {
                                "columnMatch": "VirtualMachines",
                                "formatter": 18,
                                "formatOptions": {
                                  "linkColumn": "subscriptionId",
                                  "linkTarget": "OpenBlade",
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "P1",
                                      "representation": "lightBlue",
                                      "text": "Plan 1 on"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "P2",
                                      "representation": "lightBlue",
                                      "text": "Plan 2 on"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "off"
                                    }
                                  ],
                                  "bladeOpenContext": {
                                    "bladeName": "PolicyPricingWithBundlesBlade",
                                    "extensionName": "Microsoft_Azure_Security",
                                    "bladeParameters": [
                                      {
                                        "name": "subscriptionId",
                                        "source": "column",
                                        "value": "subscriptionId"
                                      }
                                    ]
                                  },
                                  "customColumnWidthSetting": "12.5ch"
                                }
                              },
                              {
                                "columnMatch": "AppServices",
                                "formatter": 18,
                                "formatOptions": {
                                  "linkColumn": "subscriptionId",
                                  "linkTarget": "OpenBlade",
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Standard",
                                      "representation": "lightBlue",
                                      "text": "on"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "off"
                                    }
                                  ],
                                  "bladeOpenContext": {
                                    "bladeName": "PolicyPricingWithBundlesBlade",
                                    "extensionName": "Microsoft_Azure_Security",
                                    "bladeParameters": [
                                      {
                                        "name": "subscriptionId",
                                        "source": "column",
                                        "value": "subscriptionId"
                                      }
                                    ]
                                  },
                                  "customColumnWidthSetting": "16ch"
                                }
                              },
                              {
                                "columnMatch": "SqlServers",
                                "formatter": 18,
                                "formatOptions": {
                                  "linkColumn": "subscriptionId",
                                  "linkTarget": "OpenBlade",
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Standard",
                                      "representation": "lightBlue",
                                      "text": "on"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "off"
                                    }
                                  ],
                                  "bladeOpenContext": {
                                    "bladeName": "PolicyPricingWithBundlesBlade",
                                    "extensionName": "Microsoft_Azure_Security",
                                    "bladeParameters": [
                                      {
                                        "name": "subscriptionId",
                                        "source": "column",
                                        "value": "subscriptionId"
                                      }
                                    ]
                                  },
                                  "customColumnWidthSetting": "10ch"
                                }
                              },
                              {
                                "columnMatch": "SqlServerVirtualMachines",
                                "formatter": 18,
                                "formatOptions": {
                                  "linkColumn": "subscriptionId",
                                  "linkTarget": "OpenBlade",
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Standard",
                                      "representation": "lightBlue",
                                      "text": "on"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "off"
                                    }
                                  ],
                                  "bladeOpenContext": {
                                    "bladeName": "PolicyPricingWithBundlesBlade",
                                    "extensionName": "Microsoft_Azure_Security",
                                    "bladeParameters": [
                                      {
                                        "name": "subscriptionId",
                                        "source": "column",
                                        "value": "subscriptionId"
                                      }
                                    ]
                                  },
                                  "customColumnWidthSetting": "26ch"
                                }
                              },
                              {
                                "columnMatch": "OpenSourceRelationalDatabases",
                                "formatter": 18,
                                "formatOptions": {
                                  "linkColumn": "subscriptionId",
                                  "linkTarget": "OpenBlade",
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Standard",
                                      "representation": "lightBlue",
                                      "text": "on"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "off"
                                    }
                                  ],
                                  "bladeOpenContext": {
                                    "bladeName": "PolicyPricingWithBundlesBlade",
                                    "extensionName": "Microsoft_Azure_Security",
                                    "bladeParameters": [
                                      {
                                        "name": "subscriptionId",
                                        "source": "column",
                                        "value": "subscriptionId"
                                      }
                                    ]
                                  },
                                  "customColumnWidthSetting": "29ch"
                                }
                              },
                              {
                                "columnMatch": "CosmosDB",
                                "formatter": 18,
                                "formatOptions": {
                                  "linkColumn": "subscriptionId",
                                  "linkTarget": "OpenBlade",
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Standard",
                                      "representation": "lightBlue",
                                      "text": "on"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "off"
                                    }
                                  ],
                                  "bladeOpenContext": {
                                    "bladeName": "PolicyPricingWithBundlesBlade",
                                    "extensionName": "Microsoft_Azure_Security",
                                    "bladeParameters": [
                                      {
                                        "name": "subscriptionId",
                                        "source": "column",
                                        "value": "subscriptionId"
                                      }
                                    ]
                                  },
                                  "customColumnWidthSetting": "15.5ch"
                                }
                              },
                              {
                                "columnMatch": "StorageAccounts",
                                "formatter": 18,
                                "formatOptions": {
                                  "linkColumn": "subscriptionId",
                                  "linkTarget": "OpenBlade",
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Standard",
                                      "representation": "lightBlue",
                                      "text": "on"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "off"
                                    }
                                  ],
                                  "bladeOpenContext": {
                                    "bladeName": "PolicyPricingWithBundlesBlade",
                                    "extensionName": "Microsoft_Azure_Security",
                                    "bladeParameters": [
                                      {
                                        "name": "subscriptionId",
                                        "source": "column",
                                        "value": "subscriptionId"
                                      }
                                    ]
                                  },
                                  "customColumnWidthSetting": "12ch"
                                }
                              },
                              {
                                "columnMatch": "Containers",
                                "formatter": 18,
                                "formatOptions": {
                                  "linkColumn": "subscriptionId",
                                  "linkTarget": "OpenBlade",
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Standard",
                                      "representation": "lightBlue",
                                      "text": "on"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "off"
                                    }
                                  ],
                                  "bladeOpenContext": {
                                    "bladeName": "PolicyPricingWithBundlesBlade",
                                    "extensionName": "Microsoft_Azure_Security",
                                    "bladeParameters": [
                                      {
                                        "name": "subscriptionId",
                                        "source": "column",
                                        "value": "subscriptionId"
                                      }
                                    ]
                                  },
                                  "customColumnWidthSetting": "15ch"
                                }
                              },
                              {
                                "columnMatch": "KeyVaults",
                                "formatter": 18,
                                "formatOptions": {
                                  "linkColumn": "subscriptionId",
                                  "linkTarget": "OpenBlade",
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Standard",
                                      "representation": "lightBlue",
                                      "text": "on"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "off"
                                    }
                                  ],
                                  "bladeOpenContext": {
                                    "bladeName": "PolicyPricingWithBundlesBlade",
                                    "extensionName": "Microsoft_Azure_Security",
                                    "bladeParameters": [
                                      {
                                        "name": "subscriptionId",
                                        "source": "column",
                                        "value": "subscriptionId"
                                      }
                                    ]
                                  },
                                  "customColumnWidthSetting": "14.7ch"
                                }
                              },
                              {
                                "columnMatch": "Arm",
                                "formatter": 18,
                                "formatOptions": {
                                  "linkColumn": "subscriptionId",
                                  "linkTarget": "OpenBlade",
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Standard",
                                      "representation": "lightBlue",
                                      "text": "on"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "off"
                                    }
                                  ],
                                  "bladeOpenContext": {
                                    "bladeName": "PolicyPricingWithBundlesBlade",
                                    "extensionName": "Microsoft_Azure_Security",
                                    "bladeParameters": [
                                      {
                                        "name": "subscriptionId",
                                        "source": "column",
                                        "value": "subscriptionId"
                                      }
                                    ]
                                  },
                                  "customColumnWidthSetting": "21ch"
                                }
                              },
                              {
                                "columnMatch": "DNS",
                                "formatter": 18,
                                "formatOptions": {
                                  "linkColumn": "subscriptionId",
                                  "linkTarget": "OpenBlade",
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Standard",
                                      "representation": "lightBlue",
                                      "text": "on"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "off"
                                    }
                                  ],
                                  "bladeOpenContext": {
                                    "bladeName": "PolicyPricingWithBundlesBlade",
                                    "extensionName": "Microsoft_Azure_Security",
                                    "bladeParameters": [
                                      {
                                        "name": "subscriptionId",
                                        "source": "column",
                                        "value": "subscriptionId"
                                      }
                                    ]
                                  },
                                  "customColumnWidthSetting": "10.7ch"
                                }
                              },
                              {
                                "columnMatch": "KubernetesService",
                                "formatter": 18,
                                "formatOptions": {
                                  "linkColumn": "subscriptionId",
                                  "linkTarget": "OpenBlade",
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Standard",
                                      "representation": "lightBlue",
                                      "text": "on"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "off"
                                    }
                                  ],
                                  "bladeOpenContext": {
                                    "bladeName": "PolicyPricingWithBundlesBlade",
                                    "extensionName": "Microsoft_Azure_Security",
                                    "bladeParameters": [
                                      {
                                        "name": "subscriptionId",
                                        "source": "column",
                                        "value": "subscriptionId"
                                      }
                                    ]
                                  },
                                  "customColumnWidthSetting": "19.7ch"
                                }
                              },
                              {
                                "columnMatch": "ContainerRegistry",
                                "formatter": 18,
                                "formatOptions": {
                                  "linkColumn": "subscriptionId",
                                  "linkTarget": "OpenBlade",
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Standard",
                                      "representation": "lightBlue",
                                      "text": "on"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "off"
                                    }
                                  ],
                                  "bladeOpenContext": {
                                    "bladeName": "PolicyPricingWithBundlesBlade",
                                    "extensionName": "Microsoft_Azure_Security",
                                    "bladeParameters": [
                                      {
                                        "name": "subscriptionId",
                                        "source": "column",
                                        "value": "subscriptionId"
                                      }
                                    ]
                                  },
                                  "customColumnWidthSetting": "32ch"
                                }
                              },
                              {
                                "columnMatch": "subscriptionName",
                                "formatter": 5,
                                "formatOptions": {
                                  "linkTarget": "Resource"
                                }
                              }
                            ],
                            "rowLimit": 10000,
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "subscriptionId",
                                "label": "Subscription Name"
                              },
                              {
                                "columnId": "VirtualMachines",
                                "label": "Servers"
                              },
                              {
                                "columnId": "AppServices",
                                "label": "App Services"
                              },
                              {
                                "columnId": "SqlServers",
                                "label": "SQL"
                              },
                              {
                                "columnId": "SqlServerVirtualMachines",
                                "label": "SQL Server on machines"
                              },
                              {
                                "columnId": "OpenSourceRelationalDatabases",
                                "label": "Open-source relational DBs"
                              },
                              {
                                "columnId": "CosmosDB",
                                "label": "Cosmos DB"
                              },
                              {
                                "columnId": "StorageAccounts",
                                "label": "Storage"
                              },
                              {
                                "columnId": "Containers",
                                "label": "Containers"
                              },
                              {
                                "columnId": "KeyVaults",
                                "label": "Key Vaults"
                              },
                              {
                                "columnId": "Arm",
                                "label": "Resource Manager"
                              },
                              {
                                "columnId": "DNS",
                                "label": "DNS"
                              },
                              {
                                "columnId": "KubernetesService",
                                "label": "K8s (deprecated)"
                              },
                              {
                                "columnId": "ContainerRegistry",
                                "label": "Container Registry (deprecated)"
                              }
                            ]
                          },
                          "sortBy": []
                        },
                        "name": "queryAzure"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "defendercoverage"
                  },
                  "name": "Defender Coverage"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "5e8f8ef7-c57e-4c97-8356-67e34bdd1eb1",
                              "version": "KqlParameterItem/1.0",
                              "name": "Subscription",
                              "type": 6,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "includeAll": true,
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::3"
                            },
                            {
                              "id": "83a271ad-ff79-46af-9ffe-69ed2552904b",
                              "version": "KqlParameterItem/1.0",
                              "name": "TimeRange",
                              "label": "Time Range",
                              "type": 4,
                              "value": {
                                "durationMs": 259200000
                              },
                              "typeSettings": {
                                "selectableValues": [
                                  {
                                    "durationMs": 300000
                                  },
                                  {
                                    "durationMs": 900000
                                  },
                                  {
                                    "durationMs": 1800000
                                  },
                                  {
                                    "durationMs": 3600000
                                  },
                                  {
                                    "durationMs": 14400000
                                  },
                                  {
                                    "durationMs": 43200000
                                  },
                                  {
                                    "durationMs": 86400000
                                  },
                                  {
                                    "durationMs": 172800000
                                  },
                                  {
                                    "durationMs": 259200000
                                  },
                                  {
                                    "durationMs": 604800000
                                  },
                                  {
                                    "durationMs": 1209600000
                                  },
                                  {
                                    "durationMs": 2419200000
                                  },
                                  {
                                    "durationMs": 2592000000
                                  },
                                  {
                                    "durationMs": 5184000000
                                  },
                                  {
                                    "durationMs": 7776000000
                                  }
                                ]
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "parameters - 5"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Malware detection \r\n// Malware detected grouped by threat. \r\n// To create an alert for this query, click '+ New alert rule'\r\nProtectionStatus\r\n| where ThreatStatus != \"No threats detected\" \r\n| summarize AggregatedValue = count() by Threat, Computer, _ResourceId\r\n| summarize c = count()\r\n| extend Item = \"VM's with Detected Threats\",  Key = 1",
                          "size": 3,
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.resources/subscriptions",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Item"
                            },
                            "leftContent": {
                              "columnMatch": "c",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              }
                            },
                            "showBorder": false,
                            "size": "auto"
                          }
                        },
                        "customWidth": "20",
                        "name": "query - 6 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Malware detection \r\n// Malware detected grouped by threat. \r\n// To create an alert for this query, click '+ New alert rule'\r\nProtectionStatus\r\n| where ThreatStatus != \"No threats detected\" \r\n| summarize AggregatedValue = count() by Threat,  _ResourceId",
                          "size": 3,
                          "title": "Count of Detected Threats",
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.resources/subscriptions",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "_ResourceId",
                              "formatter": 13,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": true
                              }
                            },
                            "leftContent": {
                              "columnMatch": "AggregatedValue",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": true,
                            "size": "auto"
                          }
                        },
                        "name": "query - 6"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Malware detection \r\n// Malware detected grouped by threat. \r\n// To create an alert for this query, click '+ New alert rule'\r\nProtectionStatus\r\n| where ThreatStatus != \"No threats detected\" \r\n|project ResourceId, DeviceName,ComputerIP_Hidden,OSName,ThreatStatusRank,ThreatStatus,ProtectionStatusRank,ProtectionStatus,ProtectionStatusDetails,TypeofProtection,TimeGenerated ,ScanDate,ResourceGroup",
                          "size": 3,
                          "title": "Detailed View",
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.resources/subscriptions",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "rowLimit": 1000,
                            "filter": true,
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "TypeofProtection"
                              ]
                            },
                            "labelSettings": [
                              {
                                "columnId": "ResourceId",
                                "label": "VM Name"
                              },
                              {
                                "columnId": "DeviceName",
                                "label": "Host Name"
                              },
                              {
                                "columnId": "ComputerIP_Hidden",
                                "label": "Computer IP"
                              },
                              {
                                "columnId": "OSName",
                                "label": "OS"
                              },
                              {
                                "columnId": "ThreatStatusRank",
                                "label": "Threat Status Rank"
                              },
                              {
                                "columnId": "ThreatStatus",
                                "label": "Threat Status"
                              },
                              {
                                "columnId": "ProtectionStatusRank",
                                "label": "Protection Status Rank"
                              },
                              {
                                "columnId": "ProtectionStatus",
                                "label": "Protection Status "
                              },
                              {
                                "columnId": "ProtectionStatusDetails",
                                "label": "Protection Status Details"
                              },
                              {
                                "columnId": "TypeofProtection",
                                "label": "Type"
                              },
                              {
                                "columnId": "TimeGenerated",
                                "label": "Time Generated"
                              },
                              {
                                "columnId": "ScanDate",
                                "label": "Scaned Date"
                              },
                              {
                                "columnId": "ResourceGroup",
                                "label": "Resource Group"
                              }
                            ]
                          }
                        },
                        "name": "query - 6 - Copy"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "threatprotection"
                  },
                  "name": "Threat Protection"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 11,
                        "content": {
                          "version": "LinkItem/1.0",
                          "style": "tabs",
                          "links": [
                            {
                              "id": "d5749b77-230f-45e3-89f5-be4c85ecfa36",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "Vartual Machines",
                              "subTarget": "vmvulnerabilities",
                              "preText": "",
                              "style": "link"
                            },
                            {
                              "id": "d2568e3f-dddc-47d7-8bb1-afcbc94c0f97",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "Database",
                              "subTarget": "dbvulnerabilities",
                              "style": "link"
                            }
                          ]
                        },
                        "name": "links - 0"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "VM Vulnerabilties",
                          "items": [
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "5e8f8ef7-c57e-4c97-8356-67e34bdd1eb1",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Subscription",
                                    "type": 6,
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "'",
                                    "delimiter": ",",
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::1",
                                        "value::3",
                                        "value::all"
                                      ],
                                      "includeAll": true,
                                      "showDefault": false
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "defaultValue": "value::3"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "parameters - 5"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"1195afff-c881-495e-9bc5-1486211ae03f\"\r\n| project ResourceType=tostring(split(id,\"/\").[6]), ResourceName=tostring(properties.resourceDetails.id)\r\n| summarize Count=dcount(ResourceName) by ResourceType",
                                "size": 4,
                                "title": "Unhealthy machines",
                                "noDataMessage": "No unhealthy machines found",
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "ResourceType",
                                      "formatter": 16,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Count",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "4",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    }
                                  ],
                                  "filter": true
                                },
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "ResourceType",
                                    "formatter": 7,
                                    "formatOptions": {
                                      "linkTarget": "Resource"
                                    }
                                  },
                                  "leftContent": {
                                    "columnMatch": "count",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": true,
                                  "sortCriteriaField": "ResourceType",
                                  "sortOrderField": 1,
                                  "size": "auto"
                                },
                                "graphSettings": {
                                  "type": 0,
                                  "topContent": {
                                    "columnMatch": "ResourceType",
                                    "formatter": 1
                                  },
                                  "centerContent": {
                                    "columnMatch": "count",
                                    "formatter": 1,
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                },
                                "chartSettings": {
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "High",
                                      "color": "red"
                                    },
                                    {
                                      "color": "orange"
                                    }
                                  ]
                                },
                                "mapSettings": {
                                  "locInfo": "LatLong",
                                  "sizeSettings": "count",
                                  "sizeAggregation": "Sum",
                                  "legendMetric": "count",
                                  "legendAggregation": "Sum",
                                  "itemColorSettings": {
                                    "type": "heatmap",
                                    "colorAggregation": "Sum",
                                    "nodeColorField": "count",
                                    "heatmapPalette": "greenRed"
                                  }
                                }
                              },
                              "customWidth": "40",
                              "name": "Overview-VMCount"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"1195afff-c881-495e-9bc5-1486211ae03f\"\r\n| extend VulId = tostring(properties.id), Severity = tostring(properties.status.severity), Status = tostring(properties.status.code)\r\n| where Status == 'Unhealthy'\r\n| summarize Count = dcount(VulId) by Severity",
                                "size": 4,
                                "title": "Distinct vulnerabilities by severity",
                                "noDataMessage": "No unhealthy machines found",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "piechart",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "ResourceType",
                                      "formatter": 16,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Count",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "4",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    }
                                  ]
                                },
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "Column1",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "IncidentCount",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                },
                                "chartSettings": {
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "High",
                                      "color": "redBright"
                                    },
                                    {
                                      "seriesName": "Medium",
                                      "color": "yellow"
                                    },
                                    {
                                      "seriesName": "Low",
                                      "color": "blueDark"
                                    }
                                  ]
                                }
                              },
                              "customWidth": "60",
                              "name": "Overview-ServersPie"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"1195afff-c881-495e-9bc5-1486211ae03f\"\r\n| extend Category = tostring(properties.category), Status = tostring(properties.status.code)\r\n| where Status == 'Unhealthy'\r\n| summarize count() by tostring(Category)",
                                "size": 3,
                                "title": "Vulnerabilities by category",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "tiles",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "$gen_group",
                                      "formatter": 14,
                                      "formatOptions": {
                                        "linkTarget": null,
                                        "showIcon": true,
                                        "customColumnWidthSetting": "25ch"
                                      }
                                    },
                                    {
                                      "columnMatch": "ResourceGroup",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Resource",
                                      "formatter": 0,
                                      "formatOptions": {
                                        "customColumnWidthSetting": "20ch"
                                      }
                                    },
                                    {
                                      "columnMatch": "Total",
                                      "formatter": 1,
                                      "formatOptions": {
                                        "customColumnWidthSetting": "10ch"
                                      }
                                    },
                                    {
                                      "columnMatch": "sevH",
                                      "formatter": 4,
                                      "formatOptions": {
                                        "palette": "red",
                                        "customColumnWidthSetting": "10ch"
                                      }
                                    },
                                    {
                                      "columnMatch": "sevM",
                                      "formatter": 4,
                                      "formatOptions": {
                                        "palette": "orange",
                                        "customColumnWidthSetting": "10ch"
                                      }
                                    },
                                    {
                                      "columnMatch": "sevL",
                                      "formatter": 4,
                                      "formatOptions": {
                                        "palette": "blueDark",
                                        "customColumnWidthSetting": "10ch"
                                      }
                                    },
                                    {
                                      "columnMatch": "patchAvailable",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "pending",
                                            "text": "{0}{1}"
                                          }
                                        ],
                                        "compositeBarSettings": {
                                          "labelText": "",
                                          "columnSettings": []
                                        },
                                        "customColumnWidthSetting": "10ch"
                                      }
                                    },
                                    {
                                      "columnMatch": "CVEcount",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "4",
                                            "text": "{0}{1}"
                                          }
                                        ],
                                        "customColumnWidthSetting": "10ch"
                                      }
                                    }
                                  ],
                                  "hierarchySettings": {
                                    "treeType": 1,
                                    "groupBy": [
                                      "ResourceGroup"
                                    ],
                                    "expandTopLevel": true
                                  }
                                },
                                "sortBy": [],
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Category",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "count_",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false,
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": true
                                }
                              },
                              "name": "MachinesCategoryTiles"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"1195afff-c881-495e-9bc5-1486211ae03f\"\r\n| project Resource = tostring(properties.resourceDetails.id), subscriptionId, Severity = tostring(properties.status.severity), Status = tostring(properties.status.code), VulnId = tostring(properties.id)\r\n| where Status == 'Unhealthy'\r\n| summarize dcount(VulnId) by Resource, Severity, VulnId\r\n| summarize Total=count(Severity), sevH=countif(Severity=='High'), sevM=countif(Severity=='Medium'), sevL=countif(Severity=='Low') by Resource\r\n| order by sevH desc",
                                "size": 1,
                                "title": "Vulnerabilities by severity per machine",
                                "noDataMessage": "No unhealthy machines found",
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Resource",
                                      "formatter": 0,
                                      "formatOptions": {
                                        "customColumnWidthSetting": "22ch"
                                      },
                                      "tooltipFormat": {
                                        "tooltip": "[\"Total\"] fndings in total"
                                      }
                                    },
                                    {
                                      "columnMatch": "sevH",
                                      "formatter": 4,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "redBright",
                                        "compositeBarSettings": {
                                          "labelText": "",
                                          "columnSettings": []
                                        },
                                        "customColumnWidthSetting": "15ch"
                                      }
                                    },
                                    {
                                      "columnMatch": "sevM",
                                      "formatter": 4,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "yellow",
                                        "customColumnWidthSetting": "15ch"
                                      }
                                    },
                                    {
                                      "columnMatch": "sevL",
                                      "formatter": 4,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "blueDark",
                                        "customColumnWidthSetting": "15ch"
                                      }
                                    }
                                  ],
                                  "rowLimit": 500,
                                  "filter": true,
                                  "labelSettings": [
                                    {
                                      "columnId": "sevH",
                                      "label": "High"
                                    },
                                    {
                                      "columnId": "sevM",
                                      "label": "Medium"
                                    },
                                    {
                                      "columnId": "sevL",
                                      "label": "Low"
                                    }
                                  ]
                                },
                                "sortBy": []
                              },
                              "customWidth": "44",
                              "name": "Overview - ServerTable"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"1195afff-c881-495e-9bc5-1486211ae03f\"\r\n | project Resource = tolower(extract(\"([\\\\s\\\\S]*?)(/providers/Microsoft.Security.*)\",1,id)), ResourceGroup = trim_end(\"/\",extract(\".*resourceGroups/(.+?)/\",0,id)), ResourceType = tolower(split(id,\"/\").[6]), subscriptionId, severity = tostring(parse_json(properties).status.severity), status = tostring(parse_json(properties).status.code), VulnId = tostring(parse_json(properties).id), description = tostring(parse_json(properties).displayName), patchable = parse_json(properties.additionalData).patchable, cve = parse_json(properties.additionalData).cve\r\n | where status == 'Unhealthy'\r\n | summarize dcount(VulnId) by ResourceGroup, Resource, severity, VulnId, description, tostring(patchable), tostring(cve)\r\n | summarize Total = count(dcount_VulnId), sevH=countif(severity=='High'), sevM=countif(severity=='Medium'), sevL=countif(severity=='Low'), patchAvailable = countif(patchable=='true'), CVEcount =countif(cve!='[]') by ResourceGroup, Resource\r\n | order by sevH desc",
                                "size": 0,
                                "title": "Overview",
                                "exportFieldName": "Resource",
                                "exportParameterName": "selectedServer",
                                "exportDefaultValue": "All",
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "$gen_group",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkColumn": "Resource",
                                        "linkTarget": "Resource",
                                        "showIcon": true,
                                        "customColumnWidthSetting": "30ch"
                                      }
                                    },
                                    {
                                      "columnMatch": "ResourceGroup",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Resource",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "customColumnWidthSetting": "20ch"
                                      }
                                    },
                                    {
                                      "columnMatch": "Total",
                                      "formatter": 1,
                                      "formatOptions": {
                                        "customColumnWidthSetting": "10ch"
                                      }
                                    },
                                    {
                                      "columnMatch": "sevH",
                                      "formatter": 4,
                                      "formatOptions": {
                                        "palette": "redBright",
                                        "customColumnWidthSetting": "12ch"
                                      }
                                    },
                                    {
                                      "columnMatch": "sevM",
                                      "formatter": 4,
                                      "formatOptions": {
                                        "palette": "yellow",
                                        "customColumnWidthSetting": "13ch"
                                      }
                                    },
                                    {
                                      "columnMatch": "sevL",
                                      "formatter": 4,
                                      "formatOptions": {
                                        "palette": "blueDark",
                                        "customColumnWidthSetting": "10ch"
                                      }
                                    },
                                    {
                                      "columnMatch": "patchAvailable",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "pending",
                                            "text": "{0}{1}"
                                          }
                                        ],
                                        "compositeBarSettings": {
                                          "labelText": "",
                                          "columnSettings": []
                                        },
                                        "customColumnWidthSetting": "20ch"
                                      }
                                    },
                                    {
                                      "columnMatch": "CVEcount",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "4",
                                            "text": "{0}{1}"
                                          }
                                        ],
                                        "customColumnWidthSetting": "10ch"
                                      }
                                    }
                                  ],
                                  "rowLimit": 1000,
                                  "filter": true,
                                  "hierarchySettings": {
                                    "treeType": 1,
                                    "groupBy": [
                                      "ResourceGroup"
                                    ],
                                    "expandTopLevel": true,
                                    "finalBy": "Resource"
                                  },
                                  "labelSettings": [
                                    {
                                      "columnId": "ResourceGroup",
                                      "label": "Resource group"
                                    },
                                    {
                                      "columnId": "sevH",
                                      "label": "High"
                                    },
                                    {
                                      "columnId": "sevM",
                                      "label": "Medium"
                                    },
                                    {
                                      "columnId": "sevL",
                                      "label": "Low"
                                    },
                                    {
                                      "columnId": "patchAvailable",
                                      "label": "Available patches"
                                    },
                                    {
                                      "columnId": "CVEcount",
                                      "label": "CVEs"
                                    }
                                  ]
                                },
                                "sortBy": []
                              },
                              "customWidth": "56",
                              "name": "MachinesSummary"
                            },
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"1195afff-c881-495e-9bc5-1486211ae03f\"\r\n| project Resource = tolower(extract(\"([\\\\s\\\\S]*?)(/providers/Microsoft.Security.*)\",1,id)), ResourceGroup = trim_end(\"/\",extract(\".*resourceGroups/(.+?)/\",0,id)), ResourceType = tolower(split(id,\"/\").[6]), subscriptionId, Severity = tostring(parse_json(properties).status.severity), Status = tostring(parse_json(properties).status.code), VulnId = tostring(parse_json(properties).id), Description = tostring(parse_json(properties).displayName), Patchable = parse_json(properties.additionalData).patchable, CVE = properties.additionalData.cve, Category = tostring(properties.category), TimeGenerated = tostring(properties.timeGenerated), Remediation = tostring(properties.remediation), Impact = tostring(properties.impact), Threat = tostring(properties.additionalData.threat)\r\n| where Status == 'Unhealthy'\r\n| where '{selectedServer}' == 'All' or Resource == '{selectedServer}'\r\n| project Severity, VulnId, Description, tostring(Patchable), Category, Resource, ResourceGroup, CVE, TimeGenerated, Remediation, Impact, Threat\r\n| mv-expand CveExpand = split (CVE, \"},\") to typeof(string)\r\n| parse CveExpand with * '\"title\":\"' singleCve '\"' *\r\n| summarize CVEs = tostring(make_list(singleCve)) by Severity, VulnId, Description, tostring(Patchable), Category, Resource, ResourceGroup, TimeGenerated, Threat, Impact, Remediation",
                                      "size": 3,
                                      "title": "Use the search box to filter vulnerabilities by resource, resource group, CVE, severity, etc.",
                                      "showExportToExcel": true,
                                      "queryType": 1,
                                      "resourceType": "microsoft.resourcegraph/resources",
                                      "crossComponentResources": [
                                        "{Subscription}"
                                      ],
                                      "gridSettings": {
                                        "formatters": [
                                          {
                                            "columnMatch": "Severity",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "VulnId",
                                            "formatter": 5
                                          },
                                          {
                                            "columnMatch": "Resource",
                                            "formatter": 0,
                                            "formatOptions": {
                                              "customColumnWidthSetting": "25ch"
                                            }
                                          },
                                          {
                                            "columnMatch": "TimeGenerated",
                                            "formatter": 6,
                                            "formatOptions": {
                                              "customColumnWidthSetting": "25ch"
                                            }
                                          },
                                          {
                                            "columnMatch": "Remediation",
                                            "formatter": 7,
                                            "formatOptions": {
                                              "linkTarget": "GenericDetails",
                                              "linkIsContextBlade": true
                                            }
                                          }
                                        ],
                                        "rowLimit": 1000,
                                        "filter": true,
                                        "hierarchySettings": {
                                          "treeType": 1,
                                          "groupBy": [
                                            "Severity"
                                          ],
                                          "finalBy": "VulnId"
                                        }
                                      },
                                      "sortBy": []
                                    },
                                    "name": "Servers - FullListTable"
                                  }
                                ]
                              },
                              "name": "VulnerabilitiesView"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "vmvulnerabilities"
                        },
                        "name": "VM Vulnerabilities"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "5e8f8ef7-c57e-4c97-8356-67e34bdd1eb1",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Subscription",
                                    "type": 6,
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "'",
                                    "delimiter": ",",
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::1",
                                        "value::3",
                                        "value::all"
                                      ],
                                      "includeAll": true,
                                      "showDefault": false
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "defaultValue": "value::3"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "parameters - 5"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "securityresources\r\n | where type == \"microsoft.security/assessments/subassessments\"\r\n | extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n | where assessmentKey == \"f97aa83c-9b63-4f9a-99f6-b22c4398f936\" or assessmentKey == \"82e20e14-edc5-4373-bfc4-f13121257c37\"\r\n | project subassessmentKey=name, parse_json(properties) \r\n | extend VulnId = tostring(properties.id), description = tostring(properties.displayName), Severity = tostring(properties.status.severity), Status = tostring(properties.status.code)\r\n | where Status == 'Unhealthy'\r\n | summarize dcount(VulnId) by Severity",
                                "size": 4,
                                "title": "Distinct SQL vulnerabilities by severity",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "High",
                                      "color": "red"
                                    },
                                    {
                                      "color": "orange"
                                    }
                                  ]
                                }
                              },
                              "customWidth": "25",
                              "name": "query - 0"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "securityresources\r\n | where type == \"microsoft.security/assessments\"\r\n | where name == \"f97aa83c-9b63-4f9a-99f6-b22c4398f936\" or name == \"82e20e14-edc5-4373-bfc4-f13121257c37\"\r\n | project ResourceType=tolower(split(id,\"/\").[6]), resourceName=tolower(split(id,\"/\").[8])\r\n | summarize Count=dcount(resourceName) by ResourceType",
                                "size": 3,
                                "title": "Unhealthy SQL resources by type",
                                "noDataMessage": "No unhealthy SQL resources found",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "ResourceType",
                                      "formatter": 16,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Count",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "4",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    }
                                  ]
                                },
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "Column1",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "IncidentCount",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "25",
                              "name": "Unhealthy SQL resources by type"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"f97aa83c-9b63-4f9a-99f6-b22c4398f936\" or assessmentKey == \"82e20e14-edc5-4373-bfc4-f13121257c37\"\r\n | project Resource = tolower(extract(\"([\\\\s\\\\S]*?)(/providers/Microsoft.Security.*)\",1,id)), Severity = tostring(parse_json(properties).status.severity), Status = tostring(parse_json(properties).status.code), VulnId = tostring(parse_json(properties).id), Database = parse_json(properties.resourceDetails).id\r\n | where Status == 'Unhealthy'\r\n | summarize dcount(VulnId) by Resource, Severity, VulnId, tostring(Database)\r\n | summarize Total = count(dcount_VulnId), sevH=countif(Severity=='High'), sevM=countif(Severity=='Medium'), sevL=countif(Severity=='Low') by Resource, Database\r\n | order by sevH desc",
                                "size": 3,
                                "title": "Vulnerable databases per server",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "$gen_group",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": null,
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Resource",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Database",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "sevH",
                                      "formatter": 4,
                                      "formatOptions": {
                                        "palette": "redBright"
                                      }
                                    },
                                    {
                                      "columnMatch": "sevM",
                                      "formatter": 4,
                                      "formatOptions": {
                                        "palette": "yellow",
                                        "customColumnWidthSetting": "15ch"
                                      }
                                    },
                                    {
                                      "columnMatch": "sevL",
                                      "formatter": 4,
                                      "formatOptions": {
                                        "palette": "blueDark"
                                      }
                                    }
                                  ],
                                  "rowLimit": 1000,
                                  "hierarchySettings": {
                                    "treeType": 1,
                                    "groupBy": [
                                      "Resource"
                                    ],
                                    "expandTopLevel": true,
                                    "finalBy": "Database"
                                  },
                                  "labelSettings": [
                                    {
                                      "columnId": "sevH",
                                      "label": "High"
                                    },
                                    {
                                      "columnId": "sevM",
                                      "label": "Medium"
                                    },
                                    {
                                      "columnId": "sevL",
                                      "label": "Low"
                                    }
                                  ]
                                },
                                "sortBy": []
                              },
                              "customWidth": "50",
                              "name": "Vulnerable databases per server"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "List of Vulnerable DB",
                                "style": "warning"
                              },
                              "name": "text - 5"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "d2a731c6-cfc4-43da-8886-ff60a47623a1",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "GroupBy",
                                    "label": "Group by",
                                    "type": 2,
                                    "isRequired": true,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    { \"value\":\"resource\", \"label\":\"Resource\", \"selected\":true },\r\n    { \"value\":\"severity\", \"label\":\"Severity\" },\r\n    { \"value\":\"category\", \"label\":\"Category\" },\r\n    { \"value\":\"benchmark\", \"label\":\"Benchmark\" }\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "value": "severity"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Grouping"
                            },
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"f97aa83c-9b63-4f9a-99f6-b22c4398f936\" or assessmentKey == \"82e20e14-edc5-4373-bfc4-f13121257c37\"\r\n | project Resource = tolower(extract(\"([\\\\s\\\\S]*?)(/providers/Microsoft.Security.*)\",1,id)), ResourceGroup = trim_end(\"/\",extract(\".*resourceGroups/(.+?)/\",0,id)), ResourceType = tolower(split(id,\"/\").[6]), subscriptionId, Severity = tostring(parse_json(properties).status.severity), status = tostring(parse_json(properties).status.code), VulnId = tostring(parse_json(properties).id), Description = tostring(parse_json(properties).displayName), Category = tostring(properties.category), TimeGenerated = tostring(properties.timeGenerated), Remediation = tostring(properties.remediation), Impact = tostring(properties.impact), Database = parse_json(properties.resourceDetails).id, Benchmarks = parse_json(properties.additionalData).benchmarks\r\n | mvexpand Benchmarks\r\n | extend Benchmark = parse_json(Benchmarks).benchmark \r\n | where status == 'Unhealthy'\r\n | project Severity, VulnId, Description, Category, Resource, Database, ResourceGroup, TimeGenerated, tostring(Benchmark), Remediation, Impact",
                                      "size": 3,
                                      "title": "Grouped by benchmark | Use the search box to filter vulnerabilities by resource, resource group, severity, etc.",
                                      "showExportToExcel": true,
                                      "queryType": 1,
                                      "resourceType": "microsoft.resourcegraph/resources",
                                      "crossComponentResources": [
                                        "{Subscription}"
                                      ],
                                      "gridSettings": {
                                        "formatters": [
                                          {
                                            "columnMatch": "$gen_group",
                                            "formatter": 13,
                                            "formatOptions": {
                                              "linkTarget": null,
                                              "showIcon": true
                                            }
                                          },
                                          {
                                            "columnMatch": "Database",
                                            "formatter": 13,
                                            "formatOptions": {
                                              "linkTarget": null,
                                              "showIcon": true
                                            }
                                          },
                                          {
                                            "columnMatch": "TimeGenerated",
                                            "formatter": 6
                                          }
                                        ],
                                        "rowLimit": 1000,
                                        "filter": true,
                                        "hierarchySettings": {
                                          "treeType": 1,
                                          "groupBy": [
                                            "Benchmark"
                                          ],
                                          "expandTopLevel": false
                                        },
                                        "labelSettings": [
                                          {
                                            "columnId": "ResourceGroup",
                                            "label": "Resource group"
                                          },
                                          {
                                            "columnId": "TimeGenerated",
                                            "label": "Time generated"
                                          }
                                        ]
                                      }
                                    },
                                    "conditionalVisibility": {
                                      "parameterName": "GroupBy",
                                      "comparison": "isEqualTo",
                                      "value": "benchmark"
                                    },
                                    "name": "GroupByBenchmark"
                                  },
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"f97aa83c-9b63-4f9a-99f6-b22c4398f936\" or assessmentKey == \"82e20e14-edc5-4373-bfc4-f13121257c37\"\r\n | project Resource = tolower(extract(\"([\\\\s\\\\S]*?)(/providers/Microsoft.Security.*)\",1,id)), ResourceGroup = trim_end(\"/\",extract(\".*resourceGroups/(.+?)/\",0,id)), ResourceType = tolower(split(id,\"/\").[6]), subscriptionId, Severity = tostring(parse_json(properties).status.severity), status = tostring(parse_json(properties).status.code), VulnId = tostring(parse_json(properties).id), Description = tostring(parse_json(properties).displayName), Category = tostring(properties.category), TimeGenerated = tostring(properties.timeGenerated), Remediation = tostring(properties.remediation), Impact = tostring(properties.impact), Database = parse_json(properties.resourceDetails).id\r\n | where status == 'Unhealthy'\r\n\r\n | project Severity, VulnId, Description, Category, Resource, Database, ResourceGroup, TimeGenerated, Remediation, Impact",
                                      "size": 3,
                                      "title": "Grouped by resource | Use the search box to filter vulnerabilities by resource, resource group, severity, etc.",
                                      "showExportToExcel": true,
                                      "queryType": 1,
                                      "resourceType": "microsoft.resourcegraph/resources",
                                      "crossComponentResources": [
                                        "{Subscription}"
                                      ],
                                      "gridSettings": {
                                        "formatters": [
                                          {
                                            "columnMatch": "$gen_group",
                                            "formatter": 13,
                                            "formatOptions": {
                                              "linkTarget": null,
                                              "showIcon": true
                                            }
                                          },
                                          {
                                            "columnMatch": "Database",
                                            "formatter": 13,
                                            "formatOptions": {
                                              "linkTarget": null,
                                              "showIcon": true
                                            }
                                          },
                                          {
                                            "columnMatch": "TimeGenerated",
                                            "formatter": 6
                                          }
                                        ],
                                        "rowLimit": 1000,
                                        "filter": true,
                                        "hierarchySettings": {
                                          "treeType": 1,
                                          "groupBy": [
                                            "Resource"
                                          ],
                                          "expandTopLevel": false
                                        },
                                        "labelSettings": [
                                          {
                                            "columnId": "ResourceGroup",
                                            "label": "Resource group"
                                          },
                                          {
                                            "columnId": "TimeGenerated",
                                            "label": "Time generated"
                                          }
                                        ]
                                      }
                                    },
                                    "conditionalVisibility": {
                                      "parameterName": "GroupBy",
                                      "comparison": "isEqualTo",
                                      "value": "resource"
                                    },
                                    "name": "GroupByResource"
                                  },
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"f97aa83c-9b63-4f9a-99f6-b22c4398f936\" or assessmentKey == \"82e20e14-edc5-4373-bfc4-f13121257c37\"\r\n | project Resource = tolower(extract(\"([\\\\s\\\\S]*?)(/providers/Microsoft.Security.*)\",1,id)), ResourceGroup = trim_end(\"/\",extract(\".*resourceGroups/(.+?)/\",0,id)), ResourceType = tolower(split(id,\"/\").[6]), subscriptionId, Severity = tostring(parse_json(properties).status.severity), status = tostring(parse_json(properties).status.code), VulnId = tostring(parse_json(properties).id), Description = tostring(parse_json(properties).displayName), Category = tostring(properties.category), TimeGenerated = tostring(properties.timeGenerated), Remediation = tostring(properties.remediation), Impact = tostring(properties.impact), Database = parse_json(properties.resourceDetails).id\r\n | where status == 'Unhealthy'\r\n\r\n | project Severity, VulnId, Description, Category, Resource, Database, ResourceGroup, TimeGenerated, Remediation, Impact",
                                      "size": 3,
                                      "title": "Grouped by severity | Use the search box to filter vulnerabilities by resource, resource group, severity, etc.",
                                      "showExportToExcel": true,
                                      "queryType": 1,
                                      "resourceType": "microsoft.resourcegraph/resources",
                                      "crossComponentResources": [
                                        "{Subscription}"
                                      ],
                                      "gridSettings": {
                                        "formatters": [
                                          {
                                            "columnMatch": "$gen_group",
                                            "formatter": 0,
                                            "formatOptions": {
                                              "customColumnWidthSetting": "20ch"
                                            }
                                          },
                                          {
                                            "columnMatch": "Database",
                                            "formatter": 13,
                                            "formatOptions": {
                                              "linkTarget": null,
                                              "showIcon": true
                                            }
                                          },
                                          {
                                            "columnMatch": "TimeGenerated",
                                            "formatter": 6
                                          }
                                        ],
                                        "rowLimit": 1000,
                                        "filter": true,
                                        "hierarchySettings": {
                                          "treeType": 1,
                                          "groupBy": [
                                            "Severity"
                                          ],
                                          "expandTopLevel": false
                                        },
                                        "labelSettings": [
                                          {
                                            "columnId": "ResourceGroup",
                                            "label": "Resource group"
                                          },
                                          {
                                            "columnId": "TimeGenerated",
                                            "label": "Time generated"
                                          }
                                        ]
                                      }
                                    },
                                    "conditionalVisibility": {
                                      "parameterName": "GroupBy",
                                      "comparison": "isEqualTo",
                                      "value": "severity"
                                    },
                                    "name": "GroupBySeverity"
                                  },
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"f97aa83c-9b63-4f9a-99f6-b22c4398f936\" or assessmentKey == \"82e20e14-edc5-4373-bfc4-f13121257c37\"\r\n | project Resource = tolower(extract(\"([\\\\s\\\\S]*?)(/providers/Microsoft.Security.*)\",1,id)), ResourceGroup = trim_end(\"/\",extract(\".*resourceGroups/(.+?)/\",0,id)), ResourceType = tolower(split(id,\"/\").[6]), subscriptionId, Severity = tostring(parse_json(properties).status.severity), status = tostring(parse_json(properties).status.code), VulnId = tostring(parse_json(properties).id), Description = tostring(parse_json(properties).displayName), Category = tostring(properties.category), TimeGenerated = tostring(properties.timeGenerated), Remediation = tostring(properties.remediation), Impact = tostring(properties.impact), Database = parse_json(properties.resourceDetails).id, Benchmarks = parse_json(properties.additionalData).benchmarks\r\n | mvexpand Benchmarks\r\n | extend Benchmark = parse_json(Benchmarks).benchmark \r\n | where status == 'Unhealthy'\r\n\r\n | project Severity, VulnId, Description, Category, Resource, Database, ResourceGroup, TimeGenerated, tostring(Benchmark), Remediation, Impact",
                                      "size": 3,
                                      "title": "Grouped by category | Use the search box to filter vulnerabilities by resource, resource group, severity, etc.",
                                      "showExportToExcel": true,
                                      "queryType": 1,
                                      "resourceType": "microsoft.resourcegraph/resources",
                                      "crossComponentResources": [
                                        "{Subscription}"
                                      ],
                                      "gridSettings": {
                                        "formatters": [
                                          {
                                            "columnMatch": "$gen_group",
                                            "formatter": 13,
                                            "formatOptions": {
                                              "linkTarget": null,
                                              "showIcon": true,
                                              "customColumnWidthSetting": "40ch"
                                            }
                                          },
                                          {
                                            "columnMatch": "Database",
                                            "formatter": 13,
                                            "formatOptions": {
                                              "linkTarget": null,
                                              "showIcon": true
                                            }
                                          },
                                          {
                                            "columnMatch": "TimeGenerated",
                                            "formatter": 6
                                          }
                                        ],
                                        "rowLimit": 1000,
                                        "filter": true,
                                        "hierarchySettings": {
                                          "treeType": 1,
                                          "groupBy": [
                                            "Category"
                                          ],
                                          "expandTopLevel": false
                                        },
                                        "labelSettings": [
                                          {
                                            "columnId": "ResourceGroup",
                                            "label": "Resource group"
                                          },
                                          {
                                            "columnId": "TimeGenerated",
                                            "label": "Time generated"
                                          }
                                        ]
                                      }
                                    },
                                    "conditionalVisibility": {
                                      "parameterName": "GroupBy",
                                      "comparison": "isEqualTo",
                                      "value": "category"
                                    },
                                    "name": "GroupByCategory"
                                  }
                                ]
                              },
                              "name": "SQLVulnerabilitiesGroup"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "dbvulnerabilities"
                        },
                        "name": "DB Vulnerabilities"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "vulnerabilities"
                  },
                  "name": "Vulnerabilities"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 11,
                        "content": {
                          "version": "LinkItem/1.0",
                          "style": "tabs",
                          "links": [
                            {
                              "id": "c362a8ff-9321-4919-b818-70652ce2df57",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "User Signin",
                              "subTarget": "usersignin",
                              "style": "link"
                            },
                            {
                              "id": "256ca655-e827-4208-975d-c2a8837d9b92",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "Device Signin",
                              "subTarget": "devicesignin",
                              "style": "link"
                            },
                            {
                              "id": "74df56da-cee3-41bc-9275-a96b87ac09a1",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "Location Signin",
                              "subTarget": "locationsignin",
                              "style": "link"
                            },
                            {
                              "id": "9ed9fec8-f57c-4b02-b21c-be30c22d5d8c",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "Resource Signin",
                              "subTarget": "resourcesigning",
                              "style": "link"
                            },
                            {
                              "id": "f30749be-babb-4ffd-85ba-b83f610cfeef",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "Conditional Access & MFA",
                              "subTarget": "conditionalaccess",
                              "style": "link"
                            },
                            {
                              "id": "fabba53d-5e44-4355-93a3-b53764714a6d",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "Common Singing Issues",
                              "subTarget": "signinissues",
                              "style": "link"
                            }
                          ]
                        },
                        "name": "links - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "ea72c9f7-8881-41e4-a346-3fd1853594ef",
                              "version": "KqlParameterItem/1.0",
                              "name": "Subscription",
                              "type": 6,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "includeAll": true,
                                "showDefault": false
                              },
                              "defaultValue": "value::3"
                            },
                            {
                              "id": "006f3abf-ac3b-4072-b809-17fc42f4e187",
                              "version": "KqlParameterItem/1.0",
                              "name": "Workspace",
                              "type": 5,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "Resources\r\n| where type =~ \"Microsoft.operationalinsights/workspaces\"\r\n| summarize by id",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ]
                              },
                              "defaultValue": "value::all",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "id": "13f56671-7604-4427-a4d8-663f3da0cbc5",
                              "version": "KqlParameterItem/1.0",
                              "name": "TimeRange",
                              "type": 4,
                              "isRequired": true,
                              "value": {
                                "durationMs": 604800000
                              },
                              "typeSettings": {
                                "selectableValues": [
                                  {
                                    "durationMs": 300000,
                                    "createdTime": "2018-11-13T19:33:10.162Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 900000,
                                    "createdTime": "2018-11-13T19:33:10.164Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 1800000,
                                    "createdTime": "2018-11-13T19:33:10.164Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 3600000,
                                    "createdTime": "2018-11-13T19:33:10.164Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 14400000,
                                    "createdTime": "2018-11-13T19:33:10.164Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 43200000,
                                    "createdTime": "2018-11-13T19:33:10.164Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 86400000,
                                    "createdTime": "2018-11-13T19:33:10.165Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 172800000,
                                    "createdTime": "2018-11-13T19:33:10.166Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 259200000,
                                    "createdTime": "2018-11-13T19:33:10.166Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 604800000,
                                    "createdTime": "2018-11-13T19:33:10.166Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 1209600000,
                                    "createdTime": "2018-11-13T19:33:10.166Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  },
                                  {
                                    "durationMs": 2592000000,
                                    "createdTime": "2018-11-13T19:33:10.167Z",
                                    "isInitialTime": false,
                                    "grain": 1,
                                    "useDashboardTimeRange": false
                                  }
                                ],
                                "allowCustom": true
                              }
                            },
                            {
                              "id": "3b5cc420-8ad8-4523-ba28-a54910756794",
                              "version": "KqlParameterItem/1.0",
                              "name": "Apps",
                              "type": 2,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "SigninLogs\r\n| summarize Count = count() by AppDisplayName\r\n| order by Count desc, AppDisplayName asc\r\n| project Value = AppDisplayName, Label = strcat(AppDisplayName, ' - ', Count, ' sign-ins'), Selected = false\r\n",
                              "crossComponentResources": [
                                "{Workspace}"
                              ],
                              "typeSettings": {
                                "limitSelectTo": 10,
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "selectAllValue": "*",
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "TimeRange",
                              "defaultValue": "value::all",
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            {
                              "id": "0611ecce-d6a0-4a6f-a1bc-6be314ae36a7",
                              "version": "KqlParameterItem/1.0",
                              "name": "UserNamePrefix",
                              "type": 2,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "SigninLogs\r\n|where AppDisplayName in ({Apps}) or '*' in ({Apps})\r\n| summarize Count = count() by UserDisplayName\r\n| order by Count desc, UserDisplayName asc\r\n| project Value = UserDisplayName, Label = strcat(UserDisplayName, ' - ', Count, ' sign-ins'), Selected = false\r\n| extend prefix = substring(Value, 0, 1)\r\n| distinct prefix\r\n| sort by prefix asc",
                              "crossComponentResources": [
                                "{Workspace}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "selectAllValue": "*",
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "TimeRange",
                              "defaultValue": "value::all",
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            {
                              "id": "f7f7970b-58c1-474f-9043-62243d2d4edd",
                              "version": "KqlParameterItem/1.0",
                              "name": "Users",
                              "label": "UserName",
                              "type": 2,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "SigninLogs\r\n|where AppDisplayName in ({Apps}) or '*' in ({Apps})\r\n| summarize Count = count() by UserDisplayName\r\n| order by Count desc, UserDisplayName asc\r\n| project Value = UserDisplayName, Label = strcat(UserDisplayName, ' - ', Count, ' sign-ins'), Selected = false\r\n| where (substring(Value, 0, 1) in ({UserNamePrefix})) or ('*' in ({UserNamePrefix}))\r\n| sort by Value asc\r\n",
                              "crossComponentResources": [
                                "{Workspace}"
                              ],
                              "typeSettings": {
                                "limitSelectTo": 10000000,
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "selectAllValue": "",
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "TimeRange",
                              "defaultValue": "value::all",
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            {
                              "id": "85568f4e-9ad4-46c5-91d4-0ee1b2c8f3aa",
                              "version": "KqlParameterItem/1.0",
                              "name": "Category",
                              "type": 2,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "value": [
                                "value::all"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "selectAllValue": ""
                              },
                              "jsonData": "[\"SignInLogs\", \"NonInteractiveUserSignInLogs\"]"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "name": "parameters - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let data = \r\nunion SigninLogs,AADNonInteractiveUserSignInLogs\r\n| where Category in ({Category})\r\n|where AppDisplayName in ({Apps}) or '*' in ({Apps})\r\n|where UserDisplayName in ({Users});\r\ndata\r\n| summarize count() by UserPrincipalName, bin (TimeGenerated,5m)\r\n",
                                "size": 0,
                                "title": "User Signin Activities",
                                "timeContextFromParameter": "TimeRange",
                                "timeBrushParameterName": "TimeBrush",
                                "showExportToExcel": true,
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "count_",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 1,
                                        "max": 25,
                                        "palette": "greenRed"
                                      }
                                    }
                                  ],
                                  "filter": true,
                                  "labelSettings": [
                                    {
                                      "columnId": "UserPrincipalName",
                                      "label": "User Name"
                                    },
                                    {
                                      "columnId": "TimeGenerated",
                                      "label": "Time"
                                    },
                                    {
                                      "columnId": "count_",
                                      "label": "Recurrence"
                                    }
                                  ]
                                }
                              },
                              "name": "query - 19"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "usersignin"
                        },
                        "name": "User Signin"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend Status = parse_json(Status);\r\nlet data = \r\nunion SigninLogs,nonInteractive\r\n| where Category in ({Category})\r\n|where AppDisplayName in ({Apps}) or '*' in ({Apps})\r\n|where UserDisplayName in ({Users}) \r\n|extend errorCode = Status.errorCode\r\n|extend SigninStatus = case(errorCode == 0, \"Success\", errorCode == 50058, \"Pending user action\",errorCode == 50140, \"Pending user action\", errorCode == 51006, \"Pending user action\", errorCode == 50059, \"Pending user action\",errorCode == 65001, \"Pending user action\", errorCode == 52004, \"Pending user action\", errorCode == 50055, \"Pending user action\", errorCode == 50144, \"Pending user action\", errorCode == 50072, \"Pending user action\", errorCode == 50074, \"Pending user action\", errorCode == 16000, \"Pending user action\", errorCode == 16001, \"Pending user action\", errorCode == 16003, \"Pending user action\", errorCode == 50127, \"Pending user action\", errorCode == 50125, \"Pending user action\", errorCode == 50129, \"Pending user action\", errorCode == 50143, \"Pending user action\", errorCode == 81010, \"Pending user action\", errorCode == 81014, \"Pending user action\", errorCode == 81012 ,\"Pending user action\", \"Failure\");\r\ndata\r\n| summarize Count = count() by SigninStatus\r\n| join kind = fullouter (datatable(SigninStatus:string)['Success', 'Pending action (Interrupts)', 'Failure']) on SigninStatus\r\n| project SigninStatus = iff(SigninStatus == '', SigninStatus1, SigninStatus), Count = iff(SigninStatus == '', 0, Count)\r\n| join kind = inner (data\r\n    | make-series Trend = count() default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step {TimeRange:grain} by SigninStatus)\r\n    on SigninStatus\r\n| project-away SigninStatus1, TimeGenerated\r\n| extend Status = SigninStatus\r\n| union (\r\n    data \r\n    | summarize Count = count()\r\n    | extend jkey = 1\r\n    | join kind=inner (data\r\n        | make-series Trend = count() default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step {TimeRange:grain}\r\n        | extend jkey = 1) on jkey\r\n    | extend SigninStatus = 'All Sign-ins', Status = '*'    \r\n)\r\n| order by Count desc",
                                "size": 3,
                                "exportFieldName": "Status",
                                "exportParameterName": "SigninStatus",
                                "exportDefaultValue": "*",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "/subscriptions/b661db5b-6c7e-435f-a989-6de3b26c40d3/resourceGroups/vpk-eun-pr-sec-sentinel-rg/providers/Microsoft.OperationalInsights/workspaces/vpk-eun-pr-sec-sentinel-la"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "SigninStatus",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Success",
                                          "representation": "success",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Failure",
                                          "representation": "4",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Pending user action",
                                          "representation": "error",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "uninitialized",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  },
                                  "leftContent": {
                                    "columnMatch": "Count",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "none",
                                      "compositeBarSettings": {
                                        "labelText": "",
                                        "columnSettings": []
                                      }
                                    }
                                  },
                                  "showBorder": true,
                                  "size": "auto"
                                }
                              },
                              "name": "query - 5"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let nonInteractive = AADNonInteractiveUserSignInLogs | extend LocationDetails = parse_json(LocationDetails), Status = parse_json(Status), DeviceDetail = parse_json(DeviceDetail);\r\nlet data = \r\nunion SigninLogs,nonInteractive\r\n|where AppDisplayName in ({Apps}) or '*' in ({Apps})\r\n|where UserDisplayName in ({Users}) \r\n    | extend errorCode = Status.errorCode\r\n    | extend SigninStatus = case(errorCode == 0, \"Success\", errorCode == 50058, \"Pending user action\", errorCode == 50140, \"Pending user action\", errorCode == 51006, \"Pending user action\", errorCode == 50059, \"Pending user action\", errorCode == 65001, \"Pending user action\", errorCode == 52004, \"Pending user action\", errorCode == 50055, \"Pending user action\", errorCode == 50144, \"Pending user action\", errorCode == 50072, \"Pending user action\", errorCode == 50074, \"Pending user action\", errorCode == 16000, \"Pending user action\", errorCode == 16001, \"Pending user action\", errorCode == 16003, \"Pending user action\", errorCode == 50127, \"Pending user action\", errorCode == 50125, \"Pending user action\", errorCode == 50129, \"Pending user action\", errorCode == 50143, \"Pending user action\", errorCode == 81010, \"Pending user action\", errorCode == 81014, \"Pending user action\", errorCode == 81012, \"Pending user action\", \"Failure\")\r\n| where SigninStatus == '{SigninStatus}' or '{SigninStatus}' == '*' or '{SigninStatus}' == 'All Sign-ins';\r\nlet appData = data\r\n    | summarize TotalCount = count(), SuccessCount = countif(SigninStatus == \"Success\"), FailureCount = countif(SigninStatus == \"Failure\"), InterruptCount = countif(SigninStatus == \"Pending user action\") by Os = tostring(DeviceDetail.operatingSystem) ,Category\r\n    | where Os != ''\r\n    | join kind=inner (data\r\n        | make-series Trend = count() default = 0 on TimeGenerated in range({TimeRange:start}, {TimeRange:end}, {TimeRange:grain}) by Os = tostring(DeviceDetail.operatingSystem)\r\n        | project-away TimeGenerated)\r\n        on Os\r\n    | order by TotalCount desc, Os asc\r\n    | project Os, TotalCount, SuccessCount, FailureCount, InterruptCount, Category\r\n    | serialize Id = row_number();\r\ndata\r\n| summarize TotalCount = count(), SuccessCount = countif(SigninStatus == \"Success\"), FailureCount = countif(SigninStatus == \"Failure\"), InterruptCount = countif(SigninStatus == \"Pending user action\") by Os = tostring(DeviceDetail.operatingSystem), Browser = tostring(DeviceDetail.browser),Category\r\n| join kind=inner (data\r\n    | make-series Trend = count() default = 0 on TimeGenerated in range({TimeRange:start}, {TimeRange:end}, {TimeRange:grain})by Os = tostring(DeviceDetail.operatingSystem), Browser = tostring(DeviceDetail.browser)\r\n    | project-away TimeGenerated)\r\n    on Os, Browser\r\n| order by TotalCount desc, Os asc\r\n| project Os, Browser, TotalCount, SuccessCount, FailureCount, InterruptCount, Category\r\n| serialize Id = row_number(1000000)\r\n| join kind=inner (appData) on Os\r\n| project Id, Name = Browser, Type = 'Browser', ['Sign-in Count'] = TotalCount,  ['Failure Count'] = FailureCount, ['Interrupt Count'] = InterruptCount, ['Success Rate'] = 1.0 * SuccessCount / TotalCount, ParentId = Id1,Category\r\n| union (appData \r\n    | project Id, Name = Os, Type = 'Operating System', ['Sign-in Count'] = TotalCount,  ['Failure Count'] = FailureCount, ['Interrupt Count'] = InterruptCount, ['Success Rate'] = 1.0 * SuccessCount / TotalCount, ParentId = -1,Category)\r\n| where Category in ({Category})\r\n| order by ['Sign-in Count'] desc, Name asc\r\n",
                                "size": 3,
                                "title": "Device Signin",
                                "timeContextFromParameter": "TimeRange",
                                "exportedParameters": [
                                  {
                                    "parameterName": "DeviceDetail",
                                    "defaultValue": "{ \"Name\":\"\", \"Type\":\"*\"}"
                                  },
                                  {
                                    "fieldName": "Category",
                                    "parameterName": "exportCategory",
                                    "parameterType": 1,
                                    "defaultValue": "*"
                                  },
                                  {
                                    "fieldName": "Name",
                                    "parameterName": "exportName",
                                    "parameterType": 1,
                                    "defaultValue": "*"
                                  }
                                ],
                                "showExportToExcel": true,
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Id",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Type",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Sign-in Count",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "blue",
                                        "showIcon": true
                                      },
                                      "numberFormat": {
                                        "unit": 17,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "Trend",
                                      "formatter": 9,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "blue",
                                        "showIcon": true
                                      },
                                      "numberFormat": {
                                        "unit": 17,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "Failure Count|Interrupt Count",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "orange",
                                        "showIcon": true
                                      },
                                      "numberFormat": {
                                        "unit": 17,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "Success Rate",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      },
                                      "numberFormat": {
                                        "unit": 0,
                                        "options": {
                                          "style": "percent"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "ParentId",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "filter": true,
                                  "hierarchySettings": {
                                    "idColumn": "Id",
                                    "parentColumn": "ParentId",
                                    "treeType": 0,
                                    "expanderColumn": "Name",
                                    "expandTopLevel": false
                                  },
                                  "sortBy": [
                                    {
                                      "itemKey": "Category",
                                      "sortOrder": 2
                                    }
                                  ]
                                },
                                "sortBy": [
                                  {
                                    "itemKey": "Category",
                                    "sortOrder": 2
                                  }
                                ]
                              },
                              "customWidth": "50",
                              "showPin": false,
                              "name": "query - 9"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails),Status = parse_json(Status),ConditionalAccessPolicies = parse_json(ConditionalAccessPolicies),DeviceDetail =parse_json(DeviceDetail);\r\nlet details = dynamic({ \"Name\":\"\", \"Type\":\"*\"});\r\nlet data = union SigninLogs,nonInteractive\r\n| extend AppDisplayName = iff(AppDisplayName == '', 'Unknown', AppDisplayName)\r\n|where AppDisplayName in ({Apps}) or '*' in ({Apps})\r\n|where UserDisplayName in ({Users}) \r\n| extend Country = tostring(LocationDetails.countryOrRegion)\r\n| extend City = tostring(LocationDetails.city)\r\n| extend errorCode = Status.errorCode\r\n| extend SigninStatus = case(errorCode == 0, \"Success\", errorCode == 50058, \"Pending user action\",errorCode == 50140, \"Pending user action\", errorCode == 51006, \"Pending user action\", errorCode == 50059, \"Pending user action\",errorCode == 65001, \"Pending user action\", errorCode == 52004, \"Pending user action\", errorCode == 50055, \"Pending user action\", errorCode == 50144, \"Pending user action\", errorCode == 50072, \"Pending user action\", errorCode == 50074, \"Pending user action\", errorCode == 16000, \"Pending user action\", errorCode == 16001, \"Pending user action\", errorCode == 16003, \"Pending user action\", errorCode == 50127, \"Pending user action\", errorCode == 50125, \"Pending user action\", errorCode == 50129, \"Pending user action\", errorCode == 50143, \"Pending user action\", errorCode == 81010, \"Pending user action\", errorCode == 81014, \"Pending user action\", errorCode == 81012 ,\"Pending user action\", \"Failure\")\r\n| where SigninStatus == '{SigninStatus}' or '{SigninStatus}' == '*' or '{SigninStatus}' == 'All Sign-ins'\r\n| where details.Type == '*' or (details.Type == 'Country' and Country == details.Name) or (details.Type == 'City' and City == details.Name);\r\ndata\r\n| top 200 by TimeGenerated desc\r\n| extend TimeFromNow = now() - TimeGenerated\r\n| extend TimeAgo = strcat(case(TimeFromNow < 2m, strcat(toint(TimeFromNow / 1m), ' seconds'), TimeFromNow < 2h, strcat(toint(TimeFromNow / 1m), ' minutes'), TimeFromNow < 2d, strcat(toint(TimeFromNow / 1h), ' hours'), strcat(toint(TimeFromNow / 1d), ' days')), ' ago')\r\n| project User = UserDisplayName, ['Sign-in Status'] = strcat(iff(SigninStatus == 'Success', '✔️', '❌'), ' ', SigninStatus), ['Sign-in Time'] = TimeAgo, App = AppDisplayName, ['Error code'] = errorCode, ['Result type'] = ResultType, ['Result signature'] = ResultSignature, ['Result description'] = ResultDescription, ['Conditional access policies'] = ConditionalAccessPolicies, ['Conditional access status'] = ConditionalAccessStatus, ['Operating system'] = DeviceDetail.operatingSystem, Browser = DeviceDetail.browser, ['Country or region'] = LocationDetails.countryOrRegion, ['State'] = LocationDetails.state, ['City'] = LocationDetails.city, ['Time generated'] = TimeGenerated, Status, ['User principal name'] = UserPrincipalName, Category, Name = tostring(DeviceDetail.operatingSystem)\r\n| where Category in ('{exportCategory}') or \"*\" in ('{exportCategory}')\r\n| where Name in ('{exportName}') or \"*\" in ('{exportName}')",
                                "size": 2,
                                "title": "Impacted Users",
                                "timeContextFromParameter": "TimeRange",
                                "showExportToExcel": true,
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Sign-in Status",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails"
                                      }
                                    },
                                    {
                                      "columnMatch": "App",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Error code",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Result type",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Result signature",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Result description",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Conditional access policies",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Conditional access status",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Operating system",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Browser",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Country or region",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "State",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "City",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Time generated",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Status",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "User principal name",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Category",
                                      "formatter": 5
                                    },
                                    {
                                      "columnMatch": "Name",
                                      "formatter": 5
                                    }
                                  ],
                                  "filter": true
                                }
                              },
                              "customWidth": "50",
                              "name": "query - 8 - Copy"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "devicesignin"
                        },
                        "name": "Device Signin"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend Status = parse_json(Status);\r\nlet data = \r\nunion SigninLogs,nonInteractive\r\n| where Category in ({Category})\r\n|where AppDisplayName in ({Apps}) or '*' in ({Apps})\r\n|where UserDisplayName in ({Users}) \r\n|extend errorCode = Status.errorCode\r\n|extend SigninStatus = case(errorCode == 0, \"Success\", errorCode == 50058, \"Pending user action\",errorCode == 50140, \"Pending user action\", errorCode == 51006, \"Pending user action\", errorCode == 50059, \"Pending user action\",errorCode == 65001, \"Pending user action\", errorCode == 52004, \"Pending user action\", errorCode == 50055, \"Pending user action\", errorCode == 50144, \"Pending user action\", errorCode == 50072, \"Pending user action\", errorCode == 50074, \"Pending user action\", errorCode == 16000, \"Pending user action\", errorCode == 16001, \"Pending user action\", errorCode == 16003, \"Pending user action\", errorCode == 50127, \"Pending user action\", errorCode == 50125, \"Pending user action\", errorCode == 50129, \"Pending user action\", errorCode == 50143, \"Pending user action\", errorCode == 81010, \"Pending user action\", errorCode == 81014, \"Pending user action\", errorCode == 81012 ,\"Pending user action\", \"Failure\");\r\ndata\r\n| summarize Count = count() by SigninStatus\r\n| join kind = fullouter (datatable(SigninStatus:string)['Success', 'Pending action (Interrupts)', 'Failure']) on SigninStatus\r\n| project SigninStatus = iff(SigninStatus == '', SigninStatus1, SigninStatus), Count = iff(SigninStatus == '', 0, Count)\r\n| join kind = inner (data\r\n    | make-series Trend = count() default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step {TimeRange:grain} by SigninStatus)\r\n    on SigninStatus\r\n| project-away SigninStatus1, TimeGenerated\r\n| extend Status = SigninStatus\r\n| union (\r\n    data \r\n    | summarize Count = count()\r\n    | extend jkey = 1\r\n    | join kind=inner (data\r\n        | make-series Trend = count() default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step {TimeRange:grain}\r\n        | extend jkey = 1) on jkey\r\n    | extend SigninStatus = 'All Sign-ins', Status = '*'    \r\n)\r\n| order by Count desc",
                                "size": 3,
                                "exportFieldName": "Status",
                                "exportParameterName": "SigninStatus",
                                "exportDefaultValue": "*",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "/subscriptions/b661db5b-6c7e-435f-a989-6de3b26c40d3/resourceGroups/vpk-eun-pr-sec-sentinel-rg/providers/Microsoft.OperationalInsights/workspaces/vpk-eun-pr-sec-sentinel-la"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "SigninStatus",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Success",
                                          "representation": "success",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Failure",
                                          "representation": "4",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Pending user action",
                                          "representation": "error",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "uninitialized",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  },
                                  "leftContent": {
                                    "columnMatch": "Count",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "none",
                                      "compositeBarSettings": {
                                        "labelText": "",
                                        "columnSettings": []
                                      }
                                    }
                                  },
                                  "showBorder": true,
                                  "size": "auto"
                                }
                              },
                              "name": "query - 5"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend Status = parse_json(Status);\r\nlet data = \r\nunion SigninLogs,nonInteractive\r\n| extend AppDisplayName = iff(AppDisplayName == '', 'Unknown', AppDisplayName)\r\n|where AppDisplayName in ({Apps}) or '*' in ({Apps})\r\n|where UserDisplayName in ({Users}) \r\n| extend Country = iff(LocationDetails.countryOrRegion == '', 'Unknown country', tostring(LocationDetails.countryOrRegion))\r\n| extend City = iff(LocationDetails.city == '', 'Unknown city', tostring(LocationDetails.city))\r\n| extend errorCode = Status.errorCode\r\n| extend SigninStatus = case(errorCode == 0, \"Success\", errorCode == 50058, \"Pending user action\",errorCode == 50140, \"Pending user action\", errorCode == 51006, \"Pending user action\", errorCode == 50059, \"Pending user action\",errorCode == 65001, \"Pending user action\", errorCode == 52004, \"Pending user action\", errorCode == 50055, \"Pending user action\", errorCode == 50144, \"Pending user action\", errorCode == 50072, \"Pending user action\", errorCode == 50074, \"Pending user action\", errorCode == 16000, \"Pending user action\", errorCode == 16001, \"Pending user action\", errorCode == 16003, \"Pending user action\", errorCode == 50127, \"Pending user action\", errorCode == 50125, \"Pending user action\", errorCode == 50129, \"Pending user action\", errorCode == 50143, \"Pending user action\", errorCode == 81010, \"Pending user action\", errorCode == 81014, \"Pending user action\", errorCode == 81012 ,\"Pending user action\", \"Failure\")\r\n| where SigninStatus == '{SigninStatus}' or '{SigninStatus}' == '*' or '{SigninStatus}' == 'All Sign-ins';\r\nlet countryData = data\r\n| summarize TotalCount = count(), SuccessCount = countif(SigninStatus == \"Success\"), FailureCount = countif(SigninStatus == \"Failure\"), InterruptCount = countif(SigninStatus == \"Pending user action\") by Country,Category\r\n| join kind=inner\r\n(\r\n    data\r\n| make-series Trend = count() default = 0 on TimeGenerated in range({TimeRange:start}, {TimeRange:end}, {TimeRange:grain}) by  Country\r\n| project-away TimeGenerated\r\n)\r\non Country\r\n| project Country, TotalCount, SuccessCount,FailureCount,InterruptCount,Trend,Category\r\n| order by TotalCount desc, Country asc;\r\ndata\r\n| summarize TotalCount = count(), SuccessCount = countif(SigninStatus == \"Success\"), FailureCount = countif(SigninStatus == \"Failure\"), InterruptCount = countif(SigninStatus == \"Pending user action\") by Country, City,Category\r\n| join kind=inner\r\n(\r\n    data    \r\n| make-series Trend = count() default = 0 on TimeGenerated in range({TimeRange:start}, {TimeRange:end}, {TimeRange:grain}) by Country, City\r\n| project-away TimeGenerated\r\n)\r\non Country, City\r\n| order by TotalCount desc, Country asc\r\n| project Country, City,TotalCount, SuccessCount,FailureCount,InterruptCount, Category\r\n| join kind=inner\r\n(\r\n    countryData\r\n)\r\non Country\r\n| project Id = City, Name = City, Type = 'City', ['Sign-in Count'] = TotalCount,  ['Failure Count'] = FailureCount, ['Interrupt Count'] = InterruptCount, ['Success Rate'] = 1.0 * SuccessCount / TotalCount, ParentId = Country,Category\r\n| union (countryData\r\n| project Id = Country, Name = Country, Type = 'Country', ['Sign-in Count'] = TotalCount,  ['Failure Count'] = FailureCount, ['Interrupt Count'] = InterruptCount, ['Success Rate'] = 1.0 * SuccessCount / TotalCount, ParentId = 'root',Category)\r\n| where Category in ({Category})\r\n| order by ['Sign-in Count'] desc, Name asc\r\n",
                                "size": 0,
                                "title": "Location Signin",
                                "timeContextFromParameter": "TimeRange",
                                "exportMultipleValues": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "Name",
                                    "parameterName": "LocationDetail",
                                    "parameterType": 1
                                  }
                                ],
                                "showExportToExcel": true,
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Id",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Type",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Sign-in Count",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "blue",
                                        "showIcon": true
                                      },
                                      "numberFormat": {
                                        "unit": 17,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "Trend",
                                      "formatter": 9,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "blue",
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Failure Count|Interrupt Count",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "orange",
                                        "showIcon": true
                                      },
                                      "numberFormat": {
                                        "unit": 17,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "Success Rate",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      },
                                      "numberFormat": {
                                        "unit": 0,
                                        "options": {
                                          "style": "percent"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "ParentId",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "filter": true,
                                  "hierarchySettings": {
                                    "idColumn": "Id",
                                    "parentColumn": "ParentId",
                                    "treeType": 0,
                                    "expanderColumn": "Name",
                                    "expandTopLevel": false
                                  }
                                }
                              },
                              "customWidth": "60",
                              "showPin": false,
                              "name": "query - 8"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let selectedCountry = dynamic([{LocationDetail}]);\r\nlet nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails),Status = parse_json(Status),ConditionalAccessPolicies = parse_json(ConditionalAccessPolicies),DeviceDetail =parse_json(DeviceDetail);\r\nlet details = dynamic({ \"Name\":\"\", \"Type\":\"*\"});\r\nlet data = union SigninLogs,nonInteractive\r\n| extend AppDisplayName = iff(AppDisplayName == '', 'Unknown', AppDisplayName)\r\n|where AppDisplayName in ({Apps}) or '*' in ({Apps})\r\n|where UserDisplayName in ({Users}) \r\n| extend Country = tostring(LocationDetails.countryOrRegion)\r\n| where array_length(selectedCountry) == 0 or \"*\" in (selectedCountry) or Country in (selectedCountry)\r\n| extend City = tostring(LocationDetails.city)\r\n| extend errorCode = Status.errorCode\r\n| extend SigninStatus = case(errorCode == 0, \"Success\", errorCode == 50058, \"Pending user action\",errorCode == 50140, \"Pending user action\", errorCode == 51006, \"Pending user action\", errorCode == 50059, \"Pending user action\",errorCode == 65001, \"Pending user action\", errorCode == 52004, \"Pending user action\", errorCode == 50055, \"Pending user action\", errorCode == 50144, \"Pending user action\", errorCode == 50072, \"Pending user action\", errorCode == 50074, \"Pending user action\", errorCode == 16000, \"Pending user action\", errorCode == 16001, \"Pending user action\", errorCode == 16003, \"Pending user action\", errorCode == 50127, \"Pending user action\", errorCode == 50125, \"Pending user action\", errorCode == 50129, \"Pending user action\", errorCode == 50143, \"Pending user action\", errorCode == 81010, \"Pending user action\", errorCode == 81014, \"Pending user action\", errorCode == 81012 ,\"Pending user action\", \"Failure\")\r\n| where SigninStatus == '{SigninStatus}' or '{SigninStatus}' == '*' or '{SigninStatus}' == 'All Sign-ins'\r\n| where details.Type == '*' or (details.Type == 'Country' and Country == details.Name) or (details.Type == 'City' and City == details.Name);\r\ndata\r\n| top 200 by TimeGenerated desc\r\n| extend TimeFromNow = now() - TimeGenerated\r\n| extend TimeAgo = strcat(case(TimeFromNow < 2m, strcat(toint(TimeFromNow / 1m), ' seconds'), TimeFromNow < 2h, strcat(toint(TimeFromNow / 1m), ' minutes'), TimeFromNow < 2d, strcat(toint(TimeFromNow / 1h), ' hours'), strcat(toint(TimeFromNow / 1d), ' days')), ' ago')\r\n| project User = UserDisplayName, ['Sign-in Status'] = strcat(iff(SigninStatus == 'Success', '✔️', '❌'), ' ', SigninStatus), ['Sign-in Time'] = TimeAgo, App = AppDisplayName, ['Error code'] = errorCode, ['Result type'] = ResultType, ['Result signature'] = ResultSignature, ['Result description'] = ResultDescription, ['Conditional access policies'] = ConditionalAccessPolicies, ['Conditional access status'] = ConditionalAccessStatus, ['Operating system'] = DeviceDetail.operatingSystem, Browser = DeviceDetail.browser, ['Country or region'] = LocationDetails.countryOrRegion, ['State'] = LocationDetails.state, ['City'] = LocationDetails.city, ['Time generated'] = TimeGenerated, Status, ['User principal name'] = UserPrincipalName\r\n\r\n\r\n\r\n",
                                "size": 0,
                                "title": "Impacted Users",
                                "timeContextFromParameter": "TimeRange",
                                "showExportToExcel": true,
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Sign-in Status",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "App",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Error code",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Result type",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Result signature",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Result description",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Conditional access policies",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Conditional access status",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Operating system",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Browser",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Country or region",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "State",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "City",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Time generated",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Status",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "User principal name",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "TimeGenerated",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "filter": true
                                }
                              },
                              "customWidth": "40",
                              "name": "query - 8"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "// Signin Locations \r\n// Failed and successful sig ins by source location. \r\nSigninLogs\r\n| summarize Successful=countif(ResultType==0), Failed=countif(ResultType!=0) by Location\r\n| where Location != \"\"\r\n",
                                "size": 3,
                                "title": "Country Based Success and Failed Signings",
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Location",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "Successful",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "success",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  },
                                  "rightContent": {
                                    "columnMatch": "Failed",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "4",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  },
                                  "showBorder": true
                                },
                                "graphSettings": {
                                  "type": 0,
                                  "topContent": {
                                    "columnMatch": "Location",
                                    "formatter": 1
                                  },
                                  "centerContent": {
                                    "columnMatch": "Successful",
                                    "formatter": 1,
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                },
                                "mapSettings": {
                                  "locInfo": "AzureLoc",
                                  "locInfoColumn": "Location",
                                  "sizeSettings": "Successful",
                                  "sizeAggregation": "Sum",
                                  "labelSettings": "Location",
                                  "legendMetric": "Successful",
                                  "legendAggregation": "Sum",
                                  "itemColorSettings": {
                                    "nodeColorField": "Successful",
                                    "colorAggregation": "Sum",
                                    "type": "heatmap",
                                    "heatmapPalette": "greenRed"
                                  }
                                }
                              },
                              "name": "Signin Locaitons"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "// All SiginLogs events \r\n// All Azure signin events. \r\nSigninLogs\r\n| project  TimeGenerated ,  Location , Identity,UserPrincipalName,  AppDisplayName, AppId, ResourceDisplayName,ConditionalAccessStatus,IPAddress",
                                "size": 1,
                                "title": "Detailed View",
                                "timeContextFromParameter": "TimeRange",
                                "showExportToExcel": true,
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "gridSettings": {
                                  "filter": true,
                                  "labelSettings": [
                                    {
                                      "columnId": "TimeGenerated",
                                      "label": "TIme"
                                    },
                                    {
                                      "columnId": "Location",
                                      "label": "Country"
                                    },
                                    {
                                      "columnId": "Identity",
                                      "label": "Name"
                                    },
                                    {
                                      "columnId": "UserPrincipalName",
                                      "label": "UPN"
                                    },
                                    {
                                      "columnId": "AppDisplayName",
                                      "label": "App Name"
                                    },
                                    {
                                      "columnId": "AppId",
                                      "label": "App ID"
                                    },
                                    {
                                      "columnId": "ResourceDisplayName",
                                      "label": "Resource Name"
                                    },
                                    {
                                      "columnId": "ConditionalAccessStatus",
                                      "label": "Conditional Access Status"
                                    },
                                    {
                                      "columnId": "IPAddress",
                                      "label": "IP Address"
                                    }
                                  ]
                                }
                              },
                              "showPin": false,
                              "name": "Signing Activities"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "locationsignin"
                        },
                        "name": "Location Signin"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "// Failed login Count \r\n// Resources with most failed log in attempts. \r\nSigninLogs\r\n| where ResultType !=0\r\n| summarize FailedLoginCount=count() by ResourceDisplayName\r\n| sort by FailedLoginCount desc nulls last",
                                "size": 4,
                                "title": "Failed Login Count",
                                "timeContext": {
                                  "durationMs": 2592000000
                                },
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "piechart"
                              },
                              "name": "query - 3"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "// User count per Resource \r\n// Distinct count if users by resource. \r\nSigninLogs\r\n| project UserDisplayName, Identity,UserPrincipalName,  AppDisplayName, AppId, ResourceDisplayName\r\n| summarize UserCount=dcount(UserPrincipalName) by ResourceDisplayName",
                                "size": 3,
                                "title": "Resource Wise User Signing",
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "ResourceDisplayName",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "UserCount",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  },
                                  "showBorder": true
                                }
                              },
                              "name": "User Count Per Resource"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "resourcesigning"
                        },
                        "name": "Resources Signing"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend Status = parse_json(Status)\r\n| extend ConditionalAccessPolicies = parse_json(ConditionalAccessPolicies);\r\nlet data = \r\nunion SigninLogs,nonInteractive\r\n|where AppDisplayName in ({Apps}) or '*' in ({Apps})\r\n|where UserDisplayName in ({Users}) \r\n|extend CAStatus = case(ConditionalAccessStatus ==\"success\",\"Successful\",\r\n                    ConditionalAccessStatus == \"failure\", \"Failed\",                                     \r\n                    ConditionalAccessStatus == \"notApplied\", \"Not applied\",                                     \r\n                    isempty(ConditionalAccessStatus), \"Not applied\", \r\n                    \"Disabled\")\r\n|mvexpand ConditionalAccessPolicies\r\n|extend CAGrantControlName = tostring(ConditionalAccessPolicies.enforcedGrantControls[0])\r\n|extend CAGrantControl = case(CAGrantControlName contains \"MFA\", \"Require MFA\", \r\n                            CAGrantControlName contains \"Terms of Use\", \"Require Terms of Use\", \r\n                            CAGrantControlName contains \"Privacy\", \"Require Privacy Statement\", \r\n                            CAGrantControlName contains \"Device\", \"Require Device Compliant\", \r\n                            CAGrantControlName contains \"Azure AD Joined\", \"Require Hybird Azure AD Joined Device\", \r\n                            CAGrantControlName contains \"Apps\", \"Require Approved Apps\",\r\n                            \"Other\");\r\ndata\r\n| where Category in ({Category})\r\n| summarize Count = dcount(Id) by CAStatus\r\n| join kind = inner (data\r\n                    | make-series Trend = dcount(Id) default = 0 on TimeGenerated in range({TimeRange:start}, {TimeRange:end}, {TimeRange:grain}) by CAStatus\r\n                    ) on CAStatus\r\n| project-away CAStatus1, TimeGenerated\r\n| order by Count desc",
                                "size": 4,
                                "title": "Conditional access status",
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "piechart",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "CAStatus",
                                    "formatter": 1
                                  },
                                  "subtitleContent": {
                                    "columnMatch": "Category"
                                  },
                                  "leftContent": {
                                    "columnMatch": "Count",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  },
                                  "showBorder": false
                                }
                              },
                              "customWidth": "50",
                              "name": "query - 9"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend Status = parse_json(Status)\r\n| extend ConditionalAccessPolicies = parse_json(ConditionalAccessPolicies);\r\nlet data = \r\nunion SigninLogs,nonInteractive|where AppDisplayName in ({Apps}) or '*' in ({Apps})\r\n|where UserDisplayName in ({Users}) \r\n|extend errorCode = toint(Status.errorCode)\r\n|extend Reason = tostring(Status.failureReason)\r\n|extend CAStatus = case(ConditionalAccessStatus ==0,\"✔️ Success\",                                     \r\n                        ConditionalAccessStatus == 1, \"❌ Failure\",                                     \r\n                        ConditionalAccessStatus == 2, \"⚠️ Not Applied\",                                     \r\n                        ConditionalAccessStatus == \"\", \"⚠️ Not Applied\", \r\n                        \"🚫 Disabled\")\r\n|mvexpand ConditionalAccessPolicies\r\n|extend CAGrantControlName = tostring(ConditionalAccessPolicies.enforcedGrantControls[0])\r\n|extend CAGrantControl = case(CAGrantControlName contains \"MFA\", \"Require MFA\", \r\n                            CAGrantControlName contains \"Terms of Use\", \"Require Terms of Use\", \r\n                            CAGrantControlName contains \"Privacy\", \"Require Privacy Statement\", \r\n                            CAGrantControlName contains \"Device\", \"Require Device Compliant\", \r\n                            CAGrantControlName contains \"Azure AD Joined\", \"Require Hybird Azure AD Joined Device\", \r\n                            CAGrantControlName contains \"Apps\", \"Require Approved Apps\",\"Other\");\r\ndata\r\n| summarize Count = dcount(Id) by CAStatus, CAGrantControl\r\n| project Id = strcat(CAStatus, '/', CAGrantControl), Name = CAGrantControl, Parent = CAStatus, Count, Type = 'CAGrantControl'\r\n| join kind = inner (data\r\n                    | make-series Trend = dcount(Id) default = 0 on TimeGenerated in range({TimeRange:start}, {TimeRange:end}, {TimeRange:grain}) by CAStatus, CAGrantControl\r\n                    | project Id = strcat(CAStatus, '/', CAGrantControl), Trend\r\n                    ) on Id\r\n| project-away Id1\r\n| union (data\r\n    | where Category in ({Category})\r\n    | summarize Count = dcount(Id) by CAStatus\r\n    | project Id = CAStatus, Name = CAStatus, Parent = '', Count, Type = 'CAStatus'\r\n    | join kind = inner (data\r\n                        | make-series Trend = dcount(Id) default = 0 on TimeGenerated in range({TimeRange:start}, {TimeRange:end}, {TimeRange:grain}) by CAStatus\r\n                        | project Id = CAStatus, Trend\r\n                        ) on Id\r\n    | project-away Id1)\r\n| order by Count desc",
                                "size": 3,
                                "timeContextFromParameter": "TimeRange",
                                "exportParameterName": "Detail",
                                "exportDefaultValue": "{ \"Name\":\"\", \"Type\":\"*\", \"Parent\":\"*\"}",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Id",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Parent",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Count",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "blue",
                                        "showIcon": true
                                      },
                                      "numberFormat": {
                                        "unit": 0,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "Type",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Trend",
                                      "formatter": 9,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "blue",
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "hierarchySettings": {
                                    "idColumn": "Id",
                                    "parentColumn": "Parent",
                                    "treeType": 0,
                                    "expanderColumn": "Name",
                                    "expandTopLevel": true
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "query - 10",
                              "styleSettings": {
                                "margin": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let details = dynamic({Detail});\r\nlet nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend Status = parse_json(Status)\r\n| extend ConditionalAccessPolicies = parse_json(ConditionalAccessPolicies);\r\nlet data = \r\nunion SigninLogs,nonInteractive\r\n|where AppDisplayName in ({Apps}) or '*' in ({Apps})\r\n|where UserDisplayName in ({Users}) \r\n|extend errorCode = toint(Status.errorCode)\r\n|extend Reason = tostring(Status.failureReason)\r\n|extend CAStatus = case(ConditionalAccessStatus ==\"success\",\"✔️ Success\",                                     \r\n                        ConditionalAccessStatus == \"failure\", \"❌ Failure\",                                     \r\n                        ConditionalAccessStatus == \"notApplied\", \"⚠️ Not Applied\",                                     \r\n                        ConditionalAccessStatus == \"\", \"⚠️ Not Applied\", \r\n                        \"🚫 Disabled\")\r\n|mvexpand ConditionalAccessPolicies\r\n|extend CAGrantControlName = tostring(ConditionalAccessPolicies.enforcedGrantControls[0])\r\n|extend CAGrantControl = case(CAGrantControlName contains \"MFA\", \"Require MFA\", \r\n                            CAGrantControlName contains \"Terms of Use\", \"Require Terms of Use\", \r\n                            CAGrantControlName contains \"Privacy\", \"Require Privacy Statement\", \r\n                            CAGrantControlName contains \"Device\", \"Require Device Compliant\", \r\n                            CAGrantControlName contains \"Azure AD Joined\", \"Require Hybird Azure AD Joined Device\", \r\n                            CAGrantControlName contains \"Apps\", \"Require Approved Apps\",\r\n                            \"Other\")\r\n|extend CAGrantControlRank = case(CAGrantControlName contains \"MFA\", 1, \r\n                            CAGrantControlName contains \"Terms of Use\", 2, \r\n                            CAGrantControlName contains \"Privacy\", 3, \r\n                            CAGrantControlName contains \"Device\", 4, \r\n                            CAGrantControlName contains \"Azure AD Joined\", 5, \r\n                            CAGrantControlName contains \"Apps\", 6,\r\n                            7)\r\n| where details.Type == '*' or (details.Type == 'CAStatus' and CAStatus == details.Name) or (details.Type == 'CAGrantControl' and CAGrantControl == details.Name and CAStatus == details.Parent);\r\ndata\r\n| order by CAGrantControlRank desc\r\n| summarize CAGrantControls = make_set(CAGrantControl) by AppDisplayName, CAStatus, TimeGenerated, UserDisplayName, Category\r\n| extend CAGrantControlText = replace(@\",\", \", \", replace(@'\"', @'', replace(@\"\\]\", @\"\", replace(@\"\\[\", @\"\", tostring(CAGrantControls)))))\r\n| extend CAGrantControlSummary = case(array_length(CAGrantControls) > 1, strcat(CAGrantControls[0], ' + ', array_length(CAGrantControls) - 1, ' more'), array_length(CAGrantControls) == 1, tostring(CAGrantControls[0]), 'None')\r\n| top 200 by TimeGenerated desc\r\n| extend TimeFromNow = now() - TimeGenerated\r\n| extend TimeAgo = strcat(case(TimeFromNow < 2m, strcat(toint(TimeFromNow / 1m), ' seconds'), TimeFromNow < 2h, strcat(toint(TimeFromNow / 1m), ' minutes'), TimeFromNow < 2d, strcat(toint(TimeFromNow / 1h), ' hours'), strcat(toint(TimeFromNow / 1d), ' days')), ' ago')\r\n| project Application = AppDisplayName, ['CA Status'] = CAStatus, ['CA Grant Controls'] = CAGrantControlSummary, ['All CA Grant Controls'] = CAGrantControlText, ['Sign-in Time'] = TimeAgo, ['User'] = UserDisplayName, Category\r\n| where Category in ({Category})",
                                "size": 0,
                                "title": "Detailed View",
                                "timeContextFromParameter": "TimeRange",
                                "showExportToExcel": true,
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "CA Grant Controls",
                                      "formatter": 1,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "All CA Grant Controls",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "User",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "filter": true
                                }
                              },
                              "showPin": false,
                              "name": "query - 7 - Copy"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "// Failed MFA challenge \r\n// Highlights sign in failures caused by failed MFA challenge. \r\nSigninLogs\r\n| where ResultType == 50074\r\n| project UserDisplayName, Identity,UserPrincipalName, ResultDescription,  AppDisplayName, AppId, ResourceDisplayName\r\n| summarize FailureCount=count(), FailedResources=dcount(ResourceDisplayName), ResultDescription=any(ResultDescription) by UserDisplayName",
                                "size": 0,
                                "title": "Failed MFA Chalange",
                                "timeContextFromParameter": "TimeRange",
                                "showExportToExcel": true,
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "gridSettings": {
                                  "filter": true,
                                  "labelSettings": [
                                    {
                                      "columnId": "UserDisplayName",
                                      "label": "User Name"
                                    },
                                    {
                                      "columnId": "FailureCount",
                                      "label": "Failure Count"
                                    },
                                    {
                                      "columnId": "FailedResources",
                                      "label": "Failed Resources"
                                    },
                                    {
                                      "columnId": "ResultDescription",
                                      "label": "Final Result"
                                    }
                                  ]
                                }
                              },
                              "name": "Failed MFA Chalange"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "conditionalaccess"
                        },
                        "name": "Condtional Access MFA"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend Status = parse_json(Status);\r\nlet data = \r\nunion SigninLogs,nonInteractive|where AppDisplayName in ({Apps}) or '*' in ({Apps})\r\n|where UserDisplayName in ({Users}) \r\n|extend errorCode = Status.errorCode\r\n|extend SigninStatus = case(errorCode == 0, \"Success\", errorCode == 50058, \"Pending action (Interrupts)\",errorCode == 50140, \"Pending action (Interrupts)\", errorCode == 51006, \"Pending action (Interrupts)\", errorCode == 50059, \"Pending action (Interrupts)\",errorCode == 65001, \"Pending action (Interrupts)\", errorCode == 52004, \"Pending action (Interrupts)\", errorCode == 50055, \"Pending action (Interrupts)\", errorCode == 50144, \"Pending action (Interrupts)\", errorCode == 50072, \"Pending action (Interrupts)\", errorCode == 50074, \"Pending action (Interrupts)\", errorCode == 16000, \"Pending action (Interrupts)\", errorCode == 16001, \"Pending action (Interrupts)\", errorCode == 16003, \"Pending action (Interrupts)\", errorCode == 50127, \"Pending action (Interrupts)\", errorCode == 50125, \"Pending action (Interrupts)\", errorCode == 50129, \"Pending action (Interrupts)\", errorCode == 50143, \"Pending action (Interrupts)\", errorCode == 81010, \"Pending action (Interrupts)\", errorCode == 81014, \"Pending action (Interrupts)\", errorCode == 81012 ,\"Pending action (Interrupts)\", \"Failure\");\r\ndata\r\n| summarize Count = count() by SigninStatus, Category\r\n| join kind = fullouter (datatable(SigninStatus:string)['Success', 'Pending action (Interrupts)', 'Failure']) on SigninStatus\r\n| project SigninStatus = iff(SigninStatus == '', SigninStatus1, SigninStatus), Count = iff(SigninStatus == '', 0, Count), Category\r\n| join kind = inner (data\r\n    | make-series Trend = count() default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step {TimeRange:grain} by SigninStatus)\r\n    on SigninStatus\r\n| project-away SigninStatus1, TimeGenerated\r\n| extend Status = SigninStatus\r\n| union (\r\n    data \r\n    | summarize Count = count() \r\n    | extend jkey = 1\r\n    | join kind=inner (data\r\n        | make-series Trend = count() default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step {TimeRange:grain}\r\n        | extend jkey = 1) on jkey\r\n    | extend SigninStatus = 'All Sign-ins', Status = '*'    \r\n)\r\n| where Category in ({Category})\r\n| order by Count desc\r\n\r\n\r\n\r\n",
                                "size": 3,
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "tiles",
                                "gridSettings": {
                                  "hierarchySettings": {
                                    "treeType": 1,
                                    "groupBy": [
                                      "ResultDescription"
                                    ]
                                  },
                                  "labelSettings": [
                                    {
                                      "columnId": "ResultDescription",
                                      "label": "Authentication Failed Reason"
                                    },
                                    {
                                      "columnId": "ResultType",
                                      "label": "Result Type"
                                    },
                                    {
                                      "columnId": "Count",
                                      "label": "Count"
                                    }
                                  ]
                                },
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "SigninStatus",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Success",
                                          "representation": "success",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Failure",
                                          "representation": "4",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Pending action (Interrupts)",
                                          "representation": "3",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "1",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  },
                                  "leftContent": {
                                    "columnMatch": "Count",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "none"
                                    }
                                  },
                                  "showBorder": true,
                                  "size": "auto"
                                }
                              },
                              "name": "query - 5"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend Status = parse_json(Status);\r\nlet data = \r\nunion SigninLogs,nonInteractive|where AppDisplayName in ({Apps}) or '*' in ({Apps})\r\n|where UserDisplayName in ({Users}) \r\n| extend ErrorCode = tostring(Status.errorCode) \r\n| extend FailureReason = tostring(Status.failureReason) \r\n| where ErrorCode !in (\"0\",\"50058\",\"50148\",\"50140\", \"51006\", \"50059\", \"65001\", \"52004\", \"50055\", \"50144\",\"50072\", \"50074\", \"16000\",\"16001\", \"16003\", \"50127\", \"50125\", \"50129\",\"50143\", \"81010\", \"81014\", \"81012\") \r\n|summarize errCount = count() by ErrorCode, tostring(FailureReason), Category| sort by errCount, Category\r\n|project ['Error Code'] = ErrorCode, ['Reason']= FailureReason, ['Error Count'] = toint(errCount), Category\r\n|where Category in ({Category});\r\ndata",
                                "size": 1,
                                "title": "Summary of top errors",
                                "timeContextFromParameter": "TimeRange",
                                "exportFieldName": "❌ Error Code",
                                "exportParameterName": "ErrorCode",
                                "exportDefaultValue": "*",
                                "showExportToExcel": true,
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Error Count",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "orange",
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "filter": true
                                }
                              },
                              "showPin": false,
                              "name": "query - 5"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend Status = parse_json(Status)\r\n| extend DeviceDetail = parse_json(DeviceDetail)\r\n| extend ConditionalAccessPolicies = parse_json(ConditionalAccessPolicies);\r\nlet data=\r\nunion SigninLogs,nonInteractive\r\n|where AppDisplayName in ({Apps}) or '*' in ({Apps})\r\n|where UserDisplayName in ({Users}) \r\n| extend ErrorCode = tostring(Status.errorCode) \r\n| extend FailureReason = tostring(Status.failureReason) \r\n| where ErrorCode !in (\"0\",\"50058\",\"50148\",\"50140\", \"51006\", \"50059\", \"65001\", \"52004\", \"50055\", \"50144\",\"50072\", \"50074\", \"16000\",\"16001\", \"16003\", \"50127\", \"50125\", \"50129\",\"50143\", \"81010\", \"81014\", \"81012\") \r\n| where '{ErrorCode}' == '*' or '{ErrorCode}' == ErrorCode\r\n| top 200 by TimeGenerated desc\r\n| extend TimeFromNow = now() - TimeGenerated\r\n| extend TimeAgo = strcat(case(TimeFromNow < 2m, strcat(toint(TimeFromNow / 1m), ' seconds'), TimeFromNow < 2h, strcat(toint(TimeFromNow / 1m), ' minutes'), TimeFromNow < 2d, strcat(toint(TimeFromNow / 1h), ' hours'), strcat(toint(TimeFromNow / 1d), ' days')), ' ago')\r\n| project User = UserDisplayName, IPAddress, ['Error Code'] = ErrorCode, ['Sign-in Time'] = TimeAgo, App = AppDisplayName, ['Error code'] = ErrorCode, ['Result type'] = ResultType, ['Result signature'] = ResultSignature, ['Result description'] = ResultDescription, ['Conditional access policies'] = ConditionalAccessPolicies, ['Conditional access status'] = ConditionalAccessStatus, ['Operating system'] = DeviceDetail.operatingSystem, Browser = DeviceDetail.browser, ['Country or region'] = LocationDetails.countryOrRegion, ['State'] = LocationDetails.state, ['City'] = LocationDetails.city, ['Time generated'] = TimeGenerated, Status, ['User principal name'] = UserPrincipalName, Category\r\n| where Category in ({Category});\r\ndata\r\n\r\n\r\n",
                                "size": 1,
                                "title": "Impacted Users",
                                "timeContextFromParameter": "TimeRange",
                                "showExportToExcel": true,
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "❌ Error Code",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "GenericDetails",
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "App",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Error code",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Result type",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Result signature",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Result description",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Conditional access policies",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Conditional access status",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Operating system",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Browser",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Country or region",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "State",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "City",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Time generated",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Status",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "User principal name",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "filter": true
                                },
                                "sortBy": []
                              },
                              "name": "query - 5 - Copy"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend Status = parse_json(Status);\r\nlet data = \r\nunion SigninLogs,nonInteractive|where AppDisplayName in ({Apps}) or '*' in ({Apps})\r\n|where UserDisplayName in ({Users}) \r\n| extend ErrorCode = tostring(Status.errorCode) \r\n| extend FailureReason = Status.failureReason \r\n| where ErrorCode in (\"50058\",\"50140\", \"51006\", \"50059\", \"65001\", \"52004\", \"50055\", \"50144\",\"50072\", \"50074\", \"16000\",\"16001\", \"16003\", \"50127\", \"50125\", \"50129\",\"50143\", \"81010\", \"81014\", \"81012\") \r\n|summarize errCount = count() by ErrorCode, tostring(FailureReason), Category\r\n| sort by errCount\r\n|project ['Error Code'] = ErrorCode, ['Reason'] = FailureReason, ['Interrupt Count'] = toint(errCount), Category\r\n| where Category in ({Category});\r\ndata",
                                "size": 1,
                                "title": "Summary of sign-ins waiting on user action",
                                "timeContextFromParameter": "TimeRange",
                                "exportFieldName": "❌ Error Code",
                                "exportParameterName": "InterruptErrorCode",
                                "exportDefaultValue": "*",
                                "showExportToExcel": true,
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Interrupt Count",
                                      "formatter": 8,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "orange"
                                      }
                                    }
                                  ],
                                  "filter": true
                                }
                              },
                              "showPin": false,
                              "name": "query - 7"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "let nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend ConditionalAccessPolicies = parse_json(ConditionalAccessPolicies)\r\n| extend DeviceDetail = parse_json(DeviceDetail)\r\n| extend Status = parse_json(Status);\r\nlet data = \r\nunion SigninLogs,nonInteractive \r\n|where AppDisplayName in ({Apps}) or '*' in ({Apps})\r\n|where UserDisplayName in ({Users}) \r\n| extend ErrorCode = tostring(Status.errorCode) \r\n| extend FailureReason = Status.failureReason \r\n| where ErrorCode in (\"50058\",\"50140\", \"51006\", \"50059\", \"65001\", \"52004\", \"50055\", \"50144\",\"50072\", \"50074\", \"16000\",\"16001\", \"16003\", \"50127\", \"50125\", \"50129\",\"50143\", \"81010\", \"81014\", \"81012\") \r\n| where '{InterruptErrorCode}' == '*' or '{InterruptErrorCode}' == ErrorCode\r\n| top 200 by TimeGenerated desc\r\n| extend TimeFromNow = now() - TimeGenerated\r\n| extend TimeAgo = strcat(case(TimeFromNow < 2m, strcat(toint(TimeFromNow / 1m), ' seconds'), TimeFromNow < 2h, strcat(toint(TimeFromNow / 1m), ' minutes'), TimeFromNow < 2d, strcat(toint(TimeFromNow / 1h), ' hours'), strcat(toint(TimeFromNow / 1d), ' days')), ' ago')\r\n| project User = UserDisplayName, IPAddress, ['Error Code'] = ErrorCode, ['Sign-in Time'] = TimeAgo, App = AppDisplayName, ['Error code'] = ErrorCode, ['Result type'] = ResultType, ['Result signature'] = ResultSignature, ['Result description'] = ResultDescription, ['Conditional access policies'] = ConditionalAccessPolicies, ['Conditional access status'] = ConditionalAccessStatus, ['Operating system'] = DeviceDetail.operatingSystem, Browser = DeviceDetail.browser, ['Country or region'] = LocationDetails.countryOrRegion, ['State'] = LocationDetails.state, ['City'] = LocationDetails.city, ['Time generated'] = TimeGenerated, Status, ['User principal name'] = UserPrincipalName, Category\r\n| where Category in ({Category});\r\ndata\r\n\r\n",
                                "size": 1,
                                "title": "Impacted Users",
                                "timeContextFromParameter": "TimeRange",
                                "showExportToExcel": true,
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "❌ Error Code",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "GenericDetails",
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "App",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Error code",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Result type",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Result signature",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Result description",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Conditional access policies",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Conditional access status",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Operating system",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Browser",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Country or region",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "State",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "City",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Time generated",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Status",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "User principal name",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "filter": true
                                }
                              },
                              "showPin": false,
                              "name": "query - 7 - Copy"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "signinissues"
                        },
                        "name": "Signin Issues"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "iam"
                  },
                  "name": "IAM"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "Resources\r\n    | where type =~ 'microsoft.network/publicipaddresses' and isnotempty(properties.ipAddress)",
                          "size": 0,
                          "showExportToExcel": true,
                          "exportToExcelOptions": "all",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "$gen_group",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "linkIsContextBlade": true,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "id",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "name",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "type",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "tenantId",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "kind",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "subscriptionId",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "managedBy",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "sku",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "plan",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "properties",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "tags",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "identity",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "extendedLocation",
                                "formatter": 5
                              }
                            ],
                            "rowLimit": 10000,
                            "filter": true,
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "subscriptionId"
                              ],
                              "expandTopLevel": true,
                              "finalBy": "id"
                            },
                            "labelSettings": [
                              {
                                "columnId": "id",
                                "label": "IP Resource Name"
                              },
                              {
                                "columnId": "location",
                                "label": "Azure Region"
                              },
                              {
                                "columnId": "resourceGroup",
                                "label": "Resource Group"
                              }
                            ]
                          }
                        },
                        "name": " resources with Public IP"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "publicexpo"
                  },
                  "name": "Resources With Public IP"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedoption",
              "comparison": "isEqualTo",
              "value": "security"
            },
            "name": "Security Dashboard"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 11,
                        "content": {
                          "version": "LinkItem/1.0",
                          "style": "tabs",
                          "links": [
                            {
                              "id": "d5749b77-230f-45e3-89f5-be4c85ecfa36",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "Event Overview",
                              "subTarget": "overview",
                              "preText": "",
                              "style": "link"
                            },
                            {
                              "id": "d2568e3f-dddc-47d7-8bb1-afcbc94c0f97",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "Open Alerts",
                              "subTarget": "openalerts",
                              "style": "link"
                            },
                            {
                              "id": "7ef3a846-67a4-4458-b430-b19d4d03e181",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "Activity",
                              "subTarget": "activity",
                              "style": "link"
                            },
                            {
                              "id": "7e76897a-098c-4097-9d7c-a755c2436197",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "Log Analytics",
                              "subTarget": "monitoringdata",
                              "style": "link"
                            },
                            {
                              "id": "61c1706d-c2bb-4d82-bf0a-c58d69c1921d",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "Workspace Retention",
                              "subTarget": "workspaceretention",
                              "style": "link"
                            },
                            {
                              "id": "ec5b4c56-201c-4628-833d-05b421f8450f",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "Workspace Usage",
                              "subTarget": "worspaceusage",
                              "style": "link"
                            },
                            {
                              "id": "2effc40f-b743-485d-b930-5bb21163e216",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "Agent Helath",
                              "subTarget": "agenthealth",
                              "style": "link"
                            },
                            {
                              "id": "f70c247e-3530-410f-8985-23749ca838e1",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "Latency Spikes",
                              "subTarget": "latencyspikes",
                              "style": "link"
                            },
                            {
                              "id": "825d4a0d-49da-48e5-ba69-2b9f55b0dbf2",
                              "cellValue": "submenu",
                              "linkTarget": "parameter",
                              "linkLabel": "Service Health",
                              "subTarget": "servicehealth",
                              "style": "link"
                            }
                          ]
                        },
                        "name": "links - 0"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "value::selected"
                          ],
                          "parameters": [
                            {
                              "id": "1f74ed9a-e3ed-498d-bd5b-f68f3836a117",
                              "version": "KqlParameterItem/1.0",
                              "name": "Subscription",
                              "type": 6,
                              "description": "All subscriptions",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "where type =~ 'microsoft.operationalinsights/workspaces'\r\n| summarize Count = count() by subscriptionId\r\n| order by Count desc\r\n| extend Rank = row_number()\r\n| project value = subscriptionId, label = subscriptionId, selected = Rank == 1",
                              "crossComponentResources": [
                                "value::selected"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::3",
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "defaultValue": "value::3",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "id": "df4a3e18-45e6-41fd-ab9b-903226867436",
                              "version": "KqlParameterItem/1.0",
                              "name": "ResourceGroup",
                              "label": " Resource Group",
                              "type": 5,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "where type =~ 'microsoft.operationalinsights/workspaces'\r\n| summarize Count = count() by resourceGroup\r\n| order by Count desc\r\n| extend Rank = row_number()\r\n| project value = resourceGroup, label = resourceGroup, selected = Rank == 1",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "value": [
                                "value::all"
                              ]
                            },
                            {
                              "id": "f60ea0a0-3703-44ca-a59b-df0246423f41",
                              "version": "KqlParameterItem/1.0",
                              "name": "Workspace",
                              "type": 5,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "where type =~ 'microsoft.operationalinsights/workspaces'\r\n| where resourceGroup in ({ResourceGroup:value})\r\n| order by name asc\r\n| extend Rank = row_number()\r\n| project value = id, label = id, selected = Rank <= 5",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "defaultValue": "value::all",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "id": "182d6324-854c-4cc0-802a-de4f3bee9f76",
                              "version": "KqlParameterItem/1.0",
                              "name": "timeRange",
                              "label": "Time range",
                              "type": 4,
                              "isRequired": true,
                              "value": {
                                "durationMs": 86400000
                              },
                              "typeSettings": {
                                "selectableValues": [
                                  {
                                    "durationMs": 300000
                                  },
                                  {
                                    "durationMs": 900000
                                  },
                                  {
                                    "durationMs": 1800000
                                  },
                                  {
                                    "durationMs": 3600000
                                  },
                                  {
                                    "durationMs": 14400000
                                  },
                                  {
                                    "durationMs": 43200000
                                  },
                                  {
                                    "durationMs": 86400000
                                  },
                                  {
                                    "durationMs": 172800000
                                  },
                                  {
                                    "durationMs": 259200000
                                  },
                                  {
                                    "durationMs": 604800000
                                  },
                                  {
                                    "durationMs": 1209600000
                                  },
                                  {
                                    "durationMs": 2592000000
                                  }
                                ],
                                "allowCustom": true
                              }
                            },
                            {
                              "id": "5ab45df9-371b-4dba-8ee3-6ec9fbb33ff9",
                              "version": "KqlParameterItem/1.0",
                              "name": "Message",
                              "type": 1,
                              "query": "where type =~ 'microsoft.operationalinsights/workspaces'\r\n| summarize Selected = countif(id in ({Workspace:value})), Total = count()\r\n| extend Selected = iff(Selected > 200, 200, Selected)\r\n| project Message = strcat('# ', Selected, ' / ', Total)",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "isHiddenWhenLocked": true,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "id": "46dfcfa4-d5d4-47c2-9dfd-ca0fcb935dc7",
                              "version": "KqlParameterItem/1.0",
                              "name": "ResourceName",
                              "type": 1,
                              "description": "Used for 'No Subscriptions' workbook template",
                              "isRequired": true,
                              "isHiddenWhenLocked": true,
                              "criteriaData": [
                                {
                                  "criteriaContext": {
                                    "operator": "Default",
                                    "rightValType": "param",
                                    "resultValType": "static",
                                    "resultVal": "Log Analytics Workspace"
                                  }
                                }
                              ]
                            },
                            {
                              "id": "1c84117c-7449-4484-b693-00f41a578bd6",
                              "version": "KqlParameterItem/1.0",
                              "name": "ResourceImageUrl",
                              "type": 1,
                              "description": "Used for 'No Subscriptions' workbook template",
                              "isHiddenWhenLocked": true,
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "TimeRange"
                            }
                          ],
                          "style": "pills",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "conditionalVisibilities": [
                          {
                            "parameterName": "submenu",
                            "comparison": "isNotEqualTo",
                            "value": "agenthealth"
                          },
                          {
                            "parameterName": "submenu",
                            "comparison": "isNotEqualTo",
                            "value": "servicehealth"
                          },
                          {
                            "parameterName": "submenu",
                            "comparison": "isNotEqualTo",
                            "value": "worspaceusage"
                          }
                        ],
                        "name": "Log Analytics Workspace parameters",
                        "styleSettings": {
                          "margin": "15px 0 0 0"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "AlertsManagementResources\r\n| where todatetime(properties.essentials.startDateTime) {timeRange}  \r\n| extend AlertStatus = properties.essentials.monitorCondition\r\n| extend AlertState = properties.essentials.alertState\r\n| extend AlertTime = properties.essentials.startDateTime\r\n| extend AlertSuppressed = properties.essentials.actionStatus.isSuppressed\r\n| extend Severity = properties.essentials.severity\r\n\r\n| extend Details = pack_all()\r\n| project id, name, subscriptionId, resourceGroup, AlertStatus, AlertState, AlertTime, AlertSuppressed, Severity\r\n| summarize count() by tostring(AlertStatus)\r\n",
                                "size": 4,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "piechart",
                                "sortBy": []
                              },
                              "customWidth": "50",
                              "name": "query - 1"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "AlertsManagementResources\r\n| where todatetime(properties.essentials.startDateTime) {timeRange}  \r\n| where type =~ 'microsoft.alertsmanagement/alerts'\r\n| extend State=tostring(properties.essentials.alertState)\r\n| summarize Count=count(), New=countif(State==\"New\"), \r\nAcknowledged=countif(State==\"Acknowledged\"), \r\nClosed=countif(State==\"Closed\") \r\nby Severity=tostring(properties.essentials.severity)\r\n| order by Severity asc",
                                "size": 3,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Count",
                                      "formatter": 3,
                                      "formatOptions": {
                                        "palette": "greenRed"
                                      },
                                      "numberFormat": {
                                        "unit": 0,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    }
                                  ]
                                }
                              },
                              "customWidth": "50",
                              "name": "query - 2"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "AlertsManagementResources\r\n| where type =~ 'microsoft.alertsmanagement/alerts'\r\n| where todatetime(properties.essentials.startDateTime) {timeRange}  \r\n| extend State=tostring(properties.essentials.alertState)\r\n| summarize Count=count(), New=countif(State==\"New\"), \r\nAcknowledged=countif(State==\"Acknowledged\"), \r\nClosed=countif(State==\"Closed\") \r\nby name\r\n| order by name asc",
                                "size": 3,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Count",
                                      "formatter": 3,
                                      "formatOptions": {
                                        "palette": "greenRed"
                                      },
                                      "numberFormat": {
                                        "unit": 0,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    }
                                  ],
                                  "labelSettings": [
                                    {
                                      "columnId": "name",
                                      "label": "Name"
                                    }
                                  ]
                                }
                              },
                              "name": "query - 2 - Copy"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "overview"
                        },
                        "name": "Overview"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "AlertsManagementResources\r\n| where todatetime(properties.essentials.startDateTime) {timeRange}  \r\n| extend AlertStatus = properties.essentials.monitorCondition\r\n| extend AlertState = properties.essentials.alertState\r\n| extend AlertTime = properties.essentials.startDateTime\r\n| extend AlertSuppressed = properties.essentials.actionStatus.isSuppressed\r\n| extend Severity = properties.essentials.severity\r\n| where AlertStatus == 'Fired'\r\n| extend Details = pack_all()\r\n| project id, name, subscriptionId, resourceGroup, AlertStatus, AlertState, AlertTime,  Severity\r\n",
                                "size": 3,
                                "title": "Open Alerts",
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "filter": true,
                                  "hierarchySettings": {
                                    "treeType": 1,
                                    "groupBy": [
                                      "Severity"
                                    ]
                                  },
                                  "labelSettings": [
                                    {
                                      "columnId": "id",
                                      "label": "ID"
                                    },
                                    {
                                      "columnId": "name",
                                      "label": "Name"
                                    },
                                    {
                                      "columnId": "subscriptionId",
                                      "label": "Subscription ID"
                                    },
                                    {
                                      "columnId": "resourceGroup",
                                      "label": "Resource Group"
                                    },
                                    {
                                      "columnId": "AlertStatus",
                                      "label": "Alert Status"
                                    },
                                    {
                                      "columnId": "AlertState",
                                      "label": "Alert State"
                                    },
                                    {
                                      "columnId": "AlertTime",
                                      "label": "Time"
                                    }
                                  ]
                                },
                                "sortBy": []
                              },
                              "name": "query - 1 - Copy"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "openalerts"
                        },
                        "name": "Open Alerts"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "// All Azure Activity \r\n// The query presents all AzureActivity events. \r\nAzureActivity\r\n| project TimeGenerated, Caller, OperationName, ActivityStatus, _ResourceId",
                                "size": 1,
                                "title": "Azure Activity",
                                "timeContextFromParameter": "timeRange",
                                "showExportToExcel": true,
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "gridSettings": {
                                  "filter": true,
                                  "labelSettings": [
                                    {
                                      "columnId": "TimeGenerated",
                                      "label": "Time Generated"
                                    },
                                    {
                                      "columnId": "Caller",
                                      "label": "Caller"
                                    },
                                    {
                                      "columnId": "OperationName",
                                      "label": "Operation Name"
                                    },
                                    {
                                      "columnId": "ActivityStatus",
                                      "label": "Activity Status"
                                    },
                                    {
                                      "columnId": "_ResourceId",
                                      "label": "Resource ID"
                                    }
                                  ]
                                }
                              },
                              "name": "Azure Activity"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "activity"
                        },
                        "name": "Activity"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "// Billable performance data \r\n// Calculate the volume of billable data (in GB) for Perf data, over the last day. \r\nUsage\r\n| where TimeGenerated > ago(1d)\r\n| where IsBillable == true\r\n| where DataType == \"Perf\"\r\n| summarize TotalVolumeGB = sum(Quantity) / 1024\r\n| extend Item = \"Billable Performance Data (GB)\",  Key = 1",
                                "size": 3,
                                "timeContextFromParameter": "timeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Item",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "TotalVolumeGB",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    }
                                  },
                                  "showBorder": true,
                                  "size": "auto"
                                }
                              },
                              "customWidth": "20",
                              "name": "Billable Pefromance Data"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "// Volume of solutions' data \r\n// Chart the volume of data (in Mb) sent by each\r\nUsage\r\n| summarize total_MBytes=sum(Quantity) by Solution\r\n| sort by total_MBytes desc nulls last\r\n| render barchart\r\n| extend Item = \"Billable Performance Data\",  Key = 1",
                                "size": 3,
                                "title": "Volumetric Solution Data (Mb)",
                                "timeContextFromParameter": "timeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "piechart",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Item",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "TotalVolumeGB",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    }
                                  },
                                  "showBorder": true,
                                  "size": "auto"
                                }
                              },
                              "customWidth": "40",
                              "name": "Volumetric Solution Data"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type has 'microsoft.insights/'\r\n        or type has 'microsoft.alertsmanagement/ smartdetectoralertrules'\r\n        or type has 'microsoft.portal/dashboards'\r\n        or type has 'microsoft.operationalinsights/workspaces'\r\n            or type has 'microsoft.insights/components'\r\n| where type != 'microsoft.insights/components'\r\n| extend type = case(\r\n              type == 'microsoft.insights/workbooks', \"Workbooks\",\r\n              type == 'microsoft.insights/activitylogalerts', \"Activity Log Alerts\",\r\n              type == 'microsoft.insights/scheduledqueryrules', \"Log Search Alerts\",\r\n              type == 'microsoft.insights/actiongroups', \"Action Groups\",\r\n              type == 'microsoft.insights/metricalerts', \"Metric Alerts\",\r\n              type =~ 'microsoft.alertsmanagement/smartdetectoralertrules','Smart Detection Rules',\r\n              type =~ 'microsoft.insights/webtests', 'URL Web Tests',\r\n              type =~ 'microsoft.portal/dashboards', 'Portal Dashboards',\r\n              type =~ 'microsoft.insights/datacollectionrules', 'Data Collection Rules',\r\n              type == 'microsoft.insights/components', \"Application Insights\",\r\n              type == 'microsoft.operationalinsights/workspaces', \"Log Analytics workspaces\",\r\n              type == 'microsoft.insights/actiongroups', \"Action Groups\",\r\nstrcat(\"Not Translated: \", type))\r\n| summarize count() by type",
                                "size": 3,
                                "title": "Summary of Azure Montior Resoruces",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "piechart",
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "type",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "count_",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "40",
                              "name": "Summary of Azure Monitor Resources"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "monitoringdata"
                        },
                        "name": "Monitoring Data"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "where type =~ 'microsoft.operationalinsights/workspaces'\r\n| where '{Workspace:name}' has name\r\n| extend \r\n  state = trim(' ', tostring(properties.provisioningState)),\r\n  sku = trim(' ', tostring(properties.sku.name)),\r\n  skuUpdate = trim(' ', tostring(properties.sku.lastSkuUpdate)),\r\n  retentionDays = trim(' ', tostring(properties.retentionInDays)),\r\n  dailyquotaGB  = trim(' ', tostring(properties.workspaceCapping.dailyQuotaGb))\r\n| extend dailyquotaGB = iif(dailyquotaGB !=-1.0, dailyquotaGB,\"--\")\r\n| project ['Workspace']=id,  ['Resource Group']=strcat(\"/subscriptions/\", subscriptionId, \"/resourceGroups/\", resourceGroup), ['Location']=location, ['Retention (days)']=retentionDays, ['Daily Cap (GB)']=dailyquotaGB, ['Licence']=sku, Subscription=strcat(\"/subscriptions/\", subscriptionId)",
                                "size": 3,
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Licence",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "colors",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "pergb2018",
                                            "representation": "turquoise",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "premium",
                                            "representation": "blue",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "standard",
                                            "representation": "redBright",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "free",
                                            "representation": "green",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "capacityreservation",
                                            "representation": "orange",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "pernode",
                                            "representation": "yellow",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "standalone",
                                            "representation": "pink",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "gray",
                                            "text": "{0}{1}"
                                          }
                                        ],
                                        "customColumnWidthSetting": "10%"
                                      }
                                    },
                                    {
                                      "columnMatch": "Subscription",
                                      "formatter": 15,
                                      "formatOptions": {
                                        "linkTarget": null,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "filter": true
                                },
                                "sortBy": []
                              },
                              "name": "query - 3",
                              "styleSettings": {
                                "margin": "2px"
                              }
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "workspaceretention"
                        },
                        "name": "Workspace Retention"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "crossComponentResources": [
                                  "value::selected"
                                ],
                                "parameters": [
                                  {
                                    "id": "ccd5adcd-8d59-4cfe-99ec-98075de2e253",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "DefaultSubscription_Internal",
                                    "type": 1,
                                    "isRequired": true,
                                    "query": "where type =~ 'microsoft.operationalinsights/workspaces'\r\n| take 1\r\n| project subscriptionId",
                                    "crossComponentResources": [
                                      "value::selected"
                                    ],
                                    "isHiddenWhenLocked": true,
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources"
                                  },
                                  {
                                    "id": "1ca69445-60fc-4806-b43d-ac7e6aad630a",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Subscription",
                                    "type": 6,
                                    "isRequired": true,
                                    "multiSelect": true,
                                    "quote": "'",
                                    "delimiter": ",",
                                    "query": "summarize by subscriptionId\r\n| project value = strcat(\"/subscriptions/\", subscriptionId), label = subscriptionId, selected = iff(subscriptionId =~ '{DefaultSubscription_Internal}', true, false)\r\n",
                                    "crossComponentResources": [
                                      "value::selected"
                                    ],
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::1",
                                        "value::3"
                                      ]
                                    },
                                    "defaultValue": "value::3",
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources"
                                  },
                                  {
                                    "id": "e94aafa3-c5d9-4523-89f0-4e87aa754511",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Workspace",
                                    "type": 5,
                                    "isRequired": true,
                                    "query": "where type =~ 'microsoft.operationalinsights/workspaces'\n| project id",
                                    "crossComponentResources": [
                                      "{Subscription}"
                                    ],
                                    "value": "/subscriptions/b17d03eb-4598-4cc2-9046-83a94e7c56ee/resourceGroups/vpk-eun-pr-hub-network-rg/providers/Microsoft.OperationalInsights/workspaces/vpk-eun-pr-la-hub-infra",
                                    "typeSettings": {
                                      "resourceTypeFilter": {
                                        "microsoft.operationalinsights/workspaces": true
                                      },
                                      "additionalResourceOptions": [
                                        "value::1"
                                      ]
                                    },
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources"
                                  },
                                  {
                                    "id": "c4b69c01-2263-4ada-8d9c-43433b739ff3",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TimeRange",
                                    "type": 4,
                                    "typeSettings": {
                                      "selectableValues": [
                                        {
                                          "durationMs": 300000,
                                          "createdTime": "2018-08-06T23:52:38.870Z",
                                          "isInitialTime": false,
                                          "grain": 1,
                                          "useDashboardTimeRange": false
                                        },
                                        {
                                          "durationMs": 900000,
                                          "createdTime": "2018-08-06T23:52:38.871Z",
                                          "isInitialTime": false,
                                          "grain": 1,
                                          "useDashboardTimeRange": false
                                        },
                                        {
                                          "durationMs": 1800000,
                                          "createdTime": "2018-08-06T23:52:38.871Z",
                                          "isInitialTime": false,
                                          "grain": 1,
                                          "useDashboardTimeRange": false
                                        },
                                        {
                                          "durationMs": 3600000,
                                          "createdTime": "2018-08-06T23:52:38.871Z",
                                          "isInitialTime": false,
                                          "grain": 1,
                                          "useDashboardTimeRange": false
                                        },
                                        {
                                          "durationMs": 14400000,
                                          "createdTime": "2018-08-06T23:52:38.871Z",
                                          "isInitialTime": false,
                                          "grain": 1,
                                          "useDashboardTimeRange": false
                                        },
                                        {
                                          "durationMs": 43200000,
                                          "createdTime": "2018-08-06T23:52:38.871Z",
                                          "isInitialTime": false,
                                          "grain": 1,
                                          "useDashboardTimeRange": false
                                        },
                                        {
                                          "durationMs": 86400000,
                                          "createdTime": "2018-08-06T23:52:38.871Z",
                                          "isInitialTime": false,
                                          "grain": 1,
                                          "useDashboardTimeRange": false
                                        },
                                        {
                                          "durationMs": 172800000,
                                          "createdTime": "2018-08-06T23:52:38.871Z",
                                          "isInitialTime": false,
                                          "grain": 1,
                                          "useDashboardTimeRange": false
                                        },
                                        {
                                          "durationMs": 259200000,
                                          "createdTime": "2018-08-06T23:52:38.871Z",
                                          "isInitialTime": false,
                                          "grain": 1,
                                          "useDashboardTimeRange": false
                                        },
                                        {
                                          "durationMs": 604800000,
                                          "createdTime": "2018-08-06T23:52:38.871Z",
                                          "isInitialTime": false,
                                          "grain": 1,
                                          "useDashboardTimeRange": false
                                        }
                                      ],
                                      "allowCustom": null
                                    },
                                    "value": {
                                      "durationMs": 3600000
                                    }
                                  }
                                ],
                                "style": "pills",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources"
                              },
                              "name": "parameters - 1"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "union withsource=['Table Name'] *\r\n| summarize Entries = count(), Size = sum(estimate_data_size(*)) by ['Table Name']\r\n| order by Size desc\r\n| project ['Table Name'], ['Table Entries'] = Entries, ['Table Size'] = Size, ['Size per Entry'] = 1.0 * Size / Entries\r\n",
                                "size": 3,
                                "timeContextFromParameter": "timeRange",
                                "exportFieldName": "Table Name",
                                "exportParameterName": "Table",
                                "exportDefaultValue": "All Tables",
                                "showExportToExcel": true,
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Table Entries",
                                      "formatter": 3,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "green",
                                        "showIcon": true
                                      },
                                      "numberFormat": {
                                        "unit": 17,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "Table Size",
                                      "formatter": 3,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "blue",
                                        "showIcon": true
                                      },
                                      "numberFormat": {
                                        "unit": 2,
                                        "options": {
                                          "style": "decimal"
                                        }
                                      }
                                    },
                                    {
                                      "columnMatch": "Size per Entry",
                                      "formatter": 3,
                                      "formatOptions": {
                                        "min": 0,
                                        "palette": "orange",
                                        "showIcon": true
                                      },
                                      "numberFormat": {
                                        "unit": 2,
                                        "options": {
                                          "style": "decimal",
                                          "maximumFractionDigits": 2
                                        }
                                      }
                                    }
                                  ],
                                  "filter": true
                                }
                              },
                              "name": "query - 2"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "worspaceusage"
                        },
                        "name": "workspaceusage"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "crossComponentResources": [
                                  "value::selected"
                                ],
                                "parameters": [
                                  {
                                    "id": "1ca69445-60fc-4806-b43d-ac7e6aad630a",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Subscription",
                                    "type": 6,
                                    "isRequired": true,
                                    "typeSettings": {
                                      "additionalResourceOptions": [
                                        "value::1"
                                      ],
                                      "includeAll": true,
                                      "showDefault": false
                                    },
                                    "defaultValue": "value::1"
                                  },
                                  {
                                    "id": "e94aafa3-c5d9-4523-89f0-4e87aa754511",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Workspace",
                                    "type": 5,
                                    "isRequired": true,
                                    "query": "where type =~ 'microsoft.operationalinsights/workspaces'\n| project id",
                                    "crossComponentResources": [
                                      "{Subscription}"
                                    ],
                                    "value": "value::1",
                                    "typeSettings": {
                                      "resourceTypeFilter": {
                                        "microsoft.operationalinsights/workspaces": true
                                      },
                                      "additionalResourceOptions": [
                                        "value::1"
                                      ]
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources"
                                  },
                                  {
                                    "id": "c4b69c01-2263-4ada-8d9c-43433b739ff3",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "TimeRange",
                                    "type": 4,
                                    "isRequired": true,
                                    "value": {
                                      "durationMs": 259200000
                                    },
                                    "typeSettings": {
                                      "selectableValues": [
                                        {
                                          "durationMs": 300000
                                        },
                                        {
                                          "durationMs": 900000
                                        },
                                        {
                                          "durationMs": 1800000
                                        },
                                        {
                                          "durationMs": 3600000
                                        },
                                        {
                                          "durationMs": 14400000
                                        },
                                        {
                                          "durationMs": 43200000
                                        },
                                        {
                                          "durationMs": 86400000
                                        },
                                        {
                                          "durationMs": 172800000
                                        },
                                        {
                                          "durationMs": 259200000
                                        },
                                        {
                                          "durationMs": 604800000
                                        },
                                        {
                                          "durationMs": 1209600000
                                        },
                                        {
                                          "durationMs": 2592000000
                                        }
                                      ],
                                      "allowCustom": null
                                    }
                                  },
                                  {
                                    "id": "15920bec-4a72-4e23-a0ee-c7b4e0b7acb4",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "UnhealthyCriteria",
                                    "label": "Unhealthy Criteria",
                                    "type": 2,
                                    "isRequired": true,
                                    "typeSettings": {
                                      "additionalResourceOptions": []
                                    },
                                    "jsonData": "[\r\n    { \"value\":\"1m\", \"label\":\"1 minute without heartbeat\", \"selected\":false },\r\n    { \"value\":\"5m\", \"label\":\"5 minutes without heartbeat\", \"selected\":false },\r\n    { \"value\":\"30m\", \"label\":\"30 minutes without heartbeat\", \"selected\":false },\r\n    { \"value\":\"1h\", \"label\":\"1 hour without heartbeat\", \"selected\":true },\r\n    { \"value\":\"2h\", \"label\":\"2 hours without heartbeat\", \"selected\":false },\r\n    { \"value\":\"8h\", \"label\":\"8 hours without heartbeat\", \"selected\":false },\r\n    { \"value\":\"1d\", \"label\":\"1 day without heartbeat\", \"selected\":false },\r\n    { \"value\":\"2d\", \"label\":\"2 days without heartbeat\", \"selected\":false },\r\n    { \"value\":\"7d\", \"label\":\"7 days without heartbeat\", \"selected\":false }\r\n]",
                                    "value": "1m"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 1,
                                "resourceType": "microsoft.insights/components"
                              },
                              "name": "parameters - 1"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "datatable(State:string, Rank:int)[\"Unhealthy\", 0, \"Healthy\", 1]\r\n| join kind = leftouter (Heartbeat\r\n| where TimeGenerated {TimeRange:query}\r\n| summarize LastHeartbeat = max(TimeGenerated) by Computer\r\n| extend State = iff(LastHeartbeat < ago({UnhealthyCriteria}), 'Unhealthy', 'Healthy')\r\n| summarize Count = dcount(Computer) by State) on State\r\n| extend Count = iff(isempty(State1), 0, Count)\r\n| project-away State1\r\n| extend Rank = iff(State == 'Unhealthy' and Count == 0, 2, Rank)\r\n| order by Rank asc",
                                "size": 3,
                                "noDataMessage": "Looks like you have no agents sending heartbeat information in this time range. Pick a larger time range or a different workspace.",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "State",
                                    "formatter": 1,
                                    "formatOptions": {
                                      "showIcon": true
                                    }
                                  },
                                  "leftContent": {
                                    "columnMatch": "Count",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "showIcon": true
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false,
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "rightContent": {
                                    "columnMatch": "State",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "showIcon": true,
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Unhealthy",
                                          "representation": "critical",
                                          "text": ""
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "success",
                                          "text": ""
                                        }
                                      ]
                                    }
                                  },
                                  "showBorder": true
                                }
                              },
                              "showPin": false,
                              "name": "AgentHealthStateQuery",
                              "styleSettings": {
                                "padding": "0px"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "Heartbeat\r\n| where TimeGenerated {TimeRange:query}\r\n| summarize LastHeartbeat = max(TimeGenerated) by Computer\r\n| extend State = iff(LastHeartbeat < ago({UnhealthyCriteria}), 'Unhealthy', 'Healthy')\r\n| extend TimeFromNow = now() - LastHeartbeat\r\n| extend [\"TimeAgo\"] = strcat(case(TimeFromNow < 2m, strcat(toint(TimeFromNow / 1m), ' seconds'), TimeFromNow < 2h, strcat(toint(TimeFromNow / 1m), ' minutes'), TimeFromNow < 2d, strcat(toint(TimeFromNow / 1h), ' hours'), strcat(toint(TimeFromNow / 1d), ' days')), ' ago')\r\n| join (\r\nHeartbeat\r\n| where TimeGenerated {TimeRange:query}\r\n| extend Packed = pack_all()\r\n) on Computer\r\n| where TimeGenerated == LastHeartbeat\r\n| join (\r\nHeartbeat\r\n| where TimeGenerated {TimeRange:query}\r\n| make-series InternalTrend=iff(count() > 0, 1, 0) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step {UnhealthyCriteria} by Computer\r\n| extend Trend=array_slice(InternalTrend, array_length(InternalTrend) - 30, array_length(InternalTrend)-1)\r\n| extend (s_min, s_minId, s_max, s_maxId, s_avg, s_var, s_stdev) = series_stats(Trend)\r\n| project Computer, Trend, s_avg\r\n) on Computer\r\n| order by State, s_avg asc, TimeAgo\r\n| project  [\"Azure Resource\"]=ResourceId,State, [\"Environment\"] = iff(ComputerEnvironment == \"Azure\", ComputerEnvironment, Category), [\"OS\"]=iff(isempty(OSName), OSType, OSName),  Version, [\"Time\"]=strcat('🕒 ', TimeAgo), [\"Heartbeat Trend\"]=Trend, [\"Details\"]=Packed\r\n",
                                "size": 3,
                                "title": "Agent Details",
                                "noDataMessage": "Looks like you have no agents sending heartbeat information to this workspace. Pick a different workspace.",
                                "exportFieldName": "_ComputerName_",
                                "exportParameterName": "ComputerName",
                                "exportDefaultValue": "\"\"",
                                "showExportToExcel": true,
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "_ComputerName_",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "State",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "showIcon": true,
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Unhealthy",
                                            "representation": "4",
                                            "text": "{0}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "success",
                                            "text": "{0}"
                                          }
                                        ]
                                      },
                                      "tooltipFormat": {
                                        "tooltip": "Click to see details of the last event sent by this computer."
                                      }
                                    },
                                    {
                                      "columnMatch": "Heartbeat Trend",
                                      "formatter": 10,
                                      "formatOptions": {
                                        "palette": "redGreen",
                                        "showIcon": true
                                      },
                                      "tooltipFormat": {
                                        "tooltip": "Each bar represents the bucket of time based on the Unhealthy Criteria. Showing last 30 buckets max."
                                      }
                                    },
                                    {
                                      "columnMatch": "Details",
                                      "formatter": 5,
                                      "formatOptions": {
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "filter": true
                                },
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Computer",
                                    "formatter": 1,
                                    "formatOptions": {
                                      "showIcon": true
                                    }
                                  },
                                  "subtitleContent": {
                                    "columnMatch": "LastCall",
                                    "formatter": 6,
                                    "formatOptions": {
                                      "showIcon": true
                                    }
                                  },
                                  "showBorder": false
                                },
                                "graphSettings": {
                                  "type": 0
                                }
                              },
                              "showPin": false,
                              "name": "AgentDetailsQuery"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "agenthealth"
                        },
                        "name": "Agent Health"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "// Agent latency spikes - by data type \r\n// Check for agent latency spikes per data type, in the last 24 hour. \r\nlet StartTime = ago(24h);\r\nlet EndTime = now();\r\nlet MinRSquare = 0.8; // Tune the sensitivity of the detection sensor\r\nunion withsource=source_table *\r\n| where TimeGenerated between (StartTime .. EndTime)\r\n// calculate ingestion duration in seconds\r\n| extend AgentLatencySeconds = (_TimeReceived-TimeGenerated)/1s\r\n// Create a time series for each source table\r\n| make-series RatioSeries=avg(AgentLatencySeconds) default=0 on TimeGenerated in range(StartTime, EndTime,10m) by source_table\r\n// Apply a 2-line regression to the time series\r\n| extend (RSquare2, SplitIdx, Variance2, RVariance2, LineFit2) = series_fit_2lines(RatioSeries)\r\n// Find out if our 2-line is trending up or down\r\n| extend (Slope, Interception, RSquare, Variance, RVariance, LineFit) = series_fit_line(LineFit2)\r\n// Check whether the line fit reaches the threshold, and if the spike represents an increase (rather than a decrease)\r\n| project source_table, PatternMatch = iff(RSquare2 > MinRSquare and Slope>0, \"Spike detected\", \"No spike\") \r\n|order by PatternMatch asc",
                                "size": 0,
                                "timeContextFromParameter": "timeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "tiles",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "PatternMatch",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Spike detected",
                                            "representation": "3",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "No spike",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    }
                                  ],
                                  "labelSettings": [
                                    {
                                      "columnId": "source_table",
                                      "label": "Source"
                                    },
                                    {
                                      "columnId": "PatternMatch",
                                      "label": "Result"
                                    }
                                  ]
                                },
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "source_table"
                                  },
                                  "leftContent": {
                                    "columnMatch": "PatternMatch",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Spike detected",
                                          "representation": "error",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "==",
                                          "thresholdValue": "No spike",
                                          "representation": "success",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "success",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  },
                                  "showBorder": true
                                }
                              },
                              "name": "query - 0"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "latencyspikes"
                        },
                        "name": "Latency Spikes"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "ServiceHealthResources\r\n| where type =~ 'Microsoft.ResourceHealth/events'\r\n| extend eventType = tostring(properties.EventType), status = properties.Status, description = properties.Title, trackingId = properties.TrackingId, summary = properties.Summary, priority = properties.Priority, impactStartTime = properties.ImpactStartTime, impactMitigationTime = todatetime(tolong(properties.ImpactMitigationTime))\r\n| where properties.Status == 'Active' and tolong(impactStartTime) > 1\r\n| summarize count(subscriptionId) by name, eventType",
                                "size": 3,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "value::all"
                                ],
                                "visualization": "piechart",
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "name",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "count_subscriptionId",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "30",
                              "name": "query - 0"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "ServiceHealthResources\r\n| where type =~ 'Microsoft.ResourceHealth/events'\r\n| extend eventType = tostring(properties.EventType), status = properties.Status, description = properties.Title, trackingId = properties.TrackingId, summary = properties.Summary, priority = properties.Priority, impactStartTime = properties.ImpactStartTime, impactMitigationTime = todatetime(tolong(properties.ImpactMitigationTime))\r\n| where properties.Status == 'Active' and tolong(impactStartTime) > 1\r\n| summarize count(subscriptionId) by name, eventType",
                                "size": 3,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "value::all"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "name",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "count_subscriptionId",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "secondaryContent": {
                                    "columnMatch": "eventType"
                                  },
                                  "showBorder": false,
                                  "sortCriteriaField": "eventType"
                                }
                              },
                              "name": "query - 1"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "ServiceHealthResources\r\n| where type =~ 'Microsoft.ResourceHealth/events'\r\n| extend eventType = properties.EventType, status = properties.Status, description = properties.Title, trackingId = properties.TrackingId, summary = properties.Summary, priority = properties.Priority, impactStartTime = properties.ImpactStartTime, impactMitigationTime = todatetime(tolong(properties.ImpactMitigationTime))\r\n| where properties.Status == 'Active' and tolong(impactStartTime) > 1 and eventType == 'HealthAdvisory'\r\n| project name , type ,subscriptionId ,eventType,description",
                                "size": 3,
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "value::all"
                                ],
                                "gridSettings": {
                                  "filter": true
                                }
                              },
                              "customWidth": "100",
                              "name": "query - 2"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "submenu",
                          "comparison": "isEqualTo",
                          "value": "servicehealth"
                        },
                        "name": "Service Health",
                        "styleSettings": {
                          "margin": "1px"
                        }
                      }
                    ]
                  },
                  "name": "Events"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedoption",
              "comparison": "isEqualTo",
              "value": "events"
            },
            "name": "Event Dashboard"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "5e8f8ef7-c57e-4c97-8356-67e34bdd1eb1",
                        "version": "KqlParameterItem/1.0",
                        "name": "Subscription",
                        "type": 6,
                        "isRequired": true,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "typeSettings": {
                          "additionalResourceOptions": [
                            "value::1",
                            "value::3",
                            "value::all"
                          ],
                          "includeAll": true,
                          "showDefault": false
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "defaultValue": "value::3"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "parameters - 5"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type has 'microsoft.web'\r\n           or type =~ 'microsoft.apimanagement/service'\r\n           or type =~ 'microsoft.network/frontdoors'\r\n           or type =~ 'microsoft.network/applicationgateways'\r\n           or type =~ 'microsoft.appconfiguration/configurationstores'\r\n| extend type = case(\r\n           type == 'microsoft.web/serverfarms', \"App Service Plans\",\r\n           kind == 'functionapp', \"Azure Functions\",\r\n           kind == \"api\", \"API Apps\",\r\n           type == 'microsoft.web/sites', \"App Services\",\r\n           type =~ 'microsoft.network/applicationgateways', 'App Gateways',\r\ntype =~ 'microsoft.network/frontdoors', 'Front Door',\r\n           type =~ 'microsoft.apimanagement/service', 'API Management',\r\n           type =~ 'microsoft.web/certificates', 'App Certificates',\r\n           type =~ 'microsoft.appconfiguration/configurationstores', 'App Config Stores',\r\n           strcat(\"Not Translated: \", type))\r\n           \r\n\r\n\r\n\r\n\r\n| where type !has \"Not Translated\"\r\n| summarize count() by type",
                          "size": 4,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "type",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "name": "query - 0",
                        "styleSettings": {
                          "padding": "3px"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "where type == \"microsoft.web/sites\"\r\n| summarize SiteCount=count() by kind \r\n| order by SiteCount desc\r\n|extend ['Count (AppService Apps)']=SiteCount\r\n| project Kind=kind, ['Count (AppService Apps)']",
                          "size": 4,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "Kind",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count (AppService Apps)",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "name": "query - 1",
                        "styleSettings": {
                          "margin": "3px",
                          "padding": "3px"
                        }
                      }
                    ]
                  },
                  "customWidth": "60",
                  "name": "App Service Overview -1"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "where type == \"microsoft.web/sites\"\r\n| summarize SiteCount=count() by Status=tostring(properties.state) \r\n| order by SiteCount desc\r\n|extend ['Count (AppService Apps)']=SiteCount\r\n| project Status, ['Count (AppService Apps)']",
                    "size": 3,
                    "title": "AppService Apps",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "visualization": "piechart",
                    "tileSettings": {
                      "showBorder": false,
                      "titleContent": {
                        "columnMatch": "Status",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "Count (AppService Apps)",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "35",
                  "name": "query - 13"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "<hr>"
                  },
                  "name": "text - 6"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type =~ 'microsoft.insights/components'\r\n| extend RetentionInDays = properties.RetentionInDays\r\n| extend IngestionMode = properties.IngestionMode\r\n| extend Details = pack_all()\r\n| project Resource=id, location, resourceGroup, subscriptionId, IngestionMode, RetentionInDays, Details\r\n| summarize c = count()\r\n| extend Item = \"Application Insights\",  Key = 1",
                          "size": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Item"
                            },
                            "leftContent": {
                              "columnMatch": "c",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              }
                            },
                            "showBorder": true,
                            "size": "auto"
                          },
                          "textSettings": {
                            "style": "bignumber"
                          }
                        },
                        "customWidth": "25",
                        "name": "query - 3"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type =~ 'microsoft.insights/components'\r\n| extend RetentionInDays = properties.RetentionInDays\r\n| extend IngestionMode = properties.IngestionMode\r\n| extend Details = pack_all()\r\n| project Resource=id, location, resourceGroup, IngestionMode, RetentionInDays",
                          "size": 3,
                          "title": "Applicaiton Insights",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "resourceGroup",
                                "label": "Resource Group"
                              },
                              {
                                "columnId": "IngestionMode",
                                "label": "Ingestion Mode"
                              },
                              {
                                "columnId": "RetentionInDays",
                                "label": "Retention(Days)"
                              }
                            ]
                          }
                        },
                        "customWidth": "75",
                        "name": "query - 4"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "Detailed View",
                          "style": "info"
                        },
                        "name": "text - 5"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type has 'microsoft.web'\r\n           or type =~ 'microsoft.apimanagement/service'\r\n           or type =~ 'microsoft.network/frontdoors'\r\n           or type =~ 'microsoft.network/applicationgateways'\r\n           or type =~ 'microsoft.appconfiguration/configurationstores'\r\n| extend type = case(\r\n           type == 'microsoft.web/serverfarms', \"App Service Plans\",\r\n           kind == 'functionapp', \"Azure Functions\",\r\n           kind == \"api\", \"API Apps\",\r\n           type == 'microsoft.web/sites', \"App Services\",\r\n           type =~ 'microsoft.network/applicationgateways', 'App Gateways',\r\n           type =~ 'microsoft.network/frontdoors', 'Front Door',\r\n           type =~ 'microsoft.apimanagement/service', 'API Management',\r\n           type =~ 'microsoft.web/certificates', 'App Certificates',\r\n           type =~ 'microsoft.appconfiguration/configurationstores', 'App Config Stores',\r\n           strcat(\"Not Translated: \", type))\r\n| where type !has \"Not Translated\"\r\n| extend Sku = case(\r\n           type =~ 'App Gateways', properties.sku.name,\r\n           type =~ 'Azure Functions', properties.sku,\r\n           type =~ 'API Management', sku.name,\r\n           type =~ 'App Service Plans', sku.name,\r\n           type =~ 'App Services', properties.sku,\r\n           type =~ 'App Config Stores', sku.name,\r\n           ' ')\r\n| extend State = case(\r\n           type =~ 'App Config Stores', properties.provisioningState,\r\n           type =~ 'App Service Plans', properties.status,\r\n           type =~ 'Azure Functions', properties.enabled,\r\n           type =~ 'App Services', properties.state,\r\n           type =~ 'API Management', properties.provisioningState,\r\n           type =~ 'App Gateways', properties.provisioningState,\r\n           type =~ 'Front Door', properties.provisioningState,\r\n           ' ')\r\n| mv-expand publicIpId=properties.frontendIPConfigurations\r\n| mv-expand publicIpId = publicIpId.properties.publicIPAddress.id\r\n| extend publicIpId = tostring(publicIpId)\r\n           | join kind=leftouter(\r\n               Resources\r\n               | where type =~ 'microsoft.network/publicipaddresses'\r\n               | project publicIpId = id, publicIpAddress = tostring(properties.ipAddress))\r\n               on publicIpId\r\n| extend PublicIP = case(\r\n           type =~ 'API Management', properties.publicIPAddresses,\r\n           type =~ 'App Gateways', publicIpAddress,\r\n           ' ')\r\n| extend Details = pack_all()\r\n| project Resource=id, type, subscriptionId, Sku, State, PublicIP",
                          "size": 3,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "filter": true,
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "type"
                              ]
                            },
                            "labelSettings": [
                              {
                                "columnId": "type",
                                "label": "Type"
                              },
                              {
                                "columnId": "subscriptionId",
                                "label": "Subscription ID"
                              },
                              {
                                "columnId": "Sku",
                                "label": "SKU"
                              },
                              {
                                "columnId": "PublicIP",
                                "label": "Public IP"
                              }
                            ]
                          }
                        },
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "Appication Insights Summary"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "Web Apps",
                    "style": "info"
                  },
                  "name": "text - 5"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' \r\n    | extend SubscriptionName=name \r\n    | join \t( resources | where type =~ 'Microsoft.Web/sites' \r\n    | extend WebAppId=id, WebAppRG=resourceGroup, WebAppName=name, AppServicePlan=tostring(properties.serverFarmId), SKU=tostring(properties.sku), Type=kind, Status=tostring(properties.state), WebAppLocation=location) on subscriptionId\r\n    | order by WebAppId asc \r\n    | project WebAppId,WebAppName, Type, Status, WebAppLocation, AppServicePlan, WebAppRG,SubscriptionName",
                          "size": 3,
                          "title": "WebApps Status",
                          "noDataMessage": "Sucess",
                          "showExportToExcel": true,
                          "exportToExcelOptions": "all",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "SelectedTab",
                          "comparison": "isEqualTo",
                          "value": "Never"
                        },
                        "name": "query - WebFunctionStatus"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.web/serverfarms\"\r\n| extend  skuname = tostring(sku.name) , skutier = tostring(sku.tier), workers=tostring(properties.numberOfWorkers), \r\nmaxworkers=tostring(properties.maximumNumberOfWorkers)\r\n| project id,name,skuname,skutier,workers, maxworkers",
                          "size": 3,
                          "noDataMessageStyle": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "SelectedTab",
                          "comparison": "isEqualTo",
                          "value": "Never"
                        },
                        "name": "query - AppServiceplandetails"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources \r\n| where type ==\"microsoft.insights/autoscalesettings\" \r\n| project id=properties.targetResourceUri, PredictiveAutoscale=properties.predictiveAutoscalePolicy.scaleMode, AutoScaleProfiles=properties.profiles",
                          "size": 3,
                          "title": "query - AutoScaleDetails",
                          "noDataMessageStyle": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "SelectedTab",
                          "comparison": "isEqualTo",
                          "value": "Never"
                        },
                        "name": "query - AutoScaleDetails"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"e65e5991-8cf6-4d4d-b0b7-75b1ce30803e\",\"mergeType\":\"innerunique\",\"leftTable\":\"query - WebFunctionStatus\",\"rightTable\":\"query - AppServiceplandetails\",\"leftColumn\":\"AppServicePlan\",\"rightColumn\":\"id\"},{\"id\":\"71f6b336-0f07-4a5b-a795-ffdb0f1cb08a\",\"mergeType\":\"leftouter\",\"leftTable\":\"query - AppServiceplandetails\",\"rightTable\":\"query - AutoScaleDetails\",\"leftColumn\":\"id\",\"rightColumn\":\"id\"}],\"projectRename\":[{\"originalName\":\"[query - WebFunctionStatus].WebAppId\",\"mergedName\":\"WebAppId\",\"fromId\":\"e65e5991-8cf6-4d4d-b0b7-75b1ce30803e\"},{\"originalName\":\"[query - WebFunctionStatus].WebAppRG\",\"mergedName\":\"WebAppRG\",\"fromId\":\"e65e5991-8cf6-4d4d-b0b7-75b1ce30803e\"},{\"originalName\":\"[query - WebFunctionStatus].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"e65e5991-8cf6-4d4d-b0b7-75b1ce30803e\"},{\"originalName\":\"[query - WebFunctionStatus].Status\",\"mergedName\":\"Status\",\"fromId\":\"e65e5991-8cf6-4d4d-b0b7-75b1ce30803e\"},{\"originalName\":\"[query - WebFunctionStatus].WebAppLocation\",\"mergedName\":\"WebAppLocation\",\"fromId\":\"e65e5991-8cf6-4d4d-b0b7-75b1ce30803e\"},{\"originalName\":\"[query - WebFunctionStatus].Type\",\"mergedName\":\"Type\",\"fromId\":\"e65e5991-8cf6-4d4d-b0b7-75b1ce30803e\"},{\"originalName\":\"[query - WebFunctionStatus].AppServicePlan\",\"mergedName\":\"AppServicePlan\",\"fromId\":\"e65e5991-8cf6-4d4d-b0b7-75b1ce30803e\"},{\"originalName\":\"[query - AppServiceplandetails].skuname\",\"mergedName\":\"skuname\",\"fromId\":\"e65e5991-8cf6-4d4d-b0b7-75b1ce30803e\"},{\"originalName\":\"[query - AppServiceplandetails].workers\",\"mergedName\":\"workers\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - AppServiceplandetails].maxworkers\",\"mergedName\":\"maxworkers\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - AppServiceplandetails].skutier\",\"mergedName\":\"skutier\",\"fromId\":\"e65e5991-8cf6-4d4d-b0b7-75b1ce30803e\"},{\"originalName\":\"[query - WebFunctionStatus].WebAppName\",\"mergedName\":\"WebAppName\",\"fromId\":\"e65e5991-8cf6-4d4d-b0b7-75b1ce30803e\"},{\"originalName\":\"[query - AppServiceplandetails].name\",\"mergedName\":\"name\",\"fromId\":\"e65e5991-8cf6-4d4d-b0b7-75b1ce30803e\"},{\"originalName\":\"[query - AppServiceplandetails].id\"},{\"originalName\":\"[query - AutoScaleDetails].id\"},{\"originalName\":\"[query - AutoScaleDetails].PredictiveAutoscale\"},{\"originalName\":\"[query - AutoScaleDetails].AutoScaleProfiles\"}]}",
                          "size": 3,
                          "noDataMessage": "No Web apps found",
                          "showExportToExcel": true,
                          "exportToExcelOptions": "all",
                          "queryType": 7,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Status",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Running",
                                      "representation": "Available",
                                      "text": ""
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Stopped",
                                      "representation": "disabled",
                                      "text": "Stopped"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "Running"
                                    }
                                  ]
                                }
                              }
                            ],
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "name"
                              ],
                              "expandTopLevel": true
                            },
                            "labelSettings": [
                              {
                                "columnId": "WebAppId",
                                "label": "WebApp ID"
                              },
                              {
                                "columnId": "WebAppRG",
                                "label": "Resource Group"
                              },
                              {
                                "columnId": "SubscriptionName",
                                "label": "Subscription"
                              },
                              {
                                "columnId": "WebAppLocation",
                                "label": "Location"
                              },
                              {
                                "columnId": "AppServicePlan",
                                "label": "App Service Plan"
                              },
                              {
                                "columnId": "skuname",
                                "label": "SKU"
                              },
                              {
                                "columnId": "workers",
                                "label": "Workers"
                              },
                              {
                                "columnId": "maxworkers",
                                "label": "Max Workers"
                              },
                              {
                                "columnId": "skutier",
                                "label": "SKU Tier"
                              },
                              {
                                "columnId": "WebAppName",
                                "label": "WebApp Name"
                              },
                              {
                                "columnId": "name",
                                "label": "Name"
                              }
                            ]
                          }
                        },
                        "showPin": false,
                        "name": "query - 3"
                      }
                    ]
                  },
                  "name": "Group WebApps"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedoption",
              "comparison": "isEqualTo",
              "value": "applicationinsights"
            },
            "name": "Application Insights Dashboard"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "tabs",
                    "links": [
                      {
                        "id": "e12edfd2-6dd6-44f4-a631-2e4f9d20a0c6",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Untagged Items",
                        "subTarget": "untaggedresources",
                        "style": "link"
                      },
                      {
                        "id": "cf279b1a-e629-4cb9-8719-53a8b580286d",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Orphan Items",
                        "subTarget": "orphanitems",
                        "style": "link"
                      },
                      {
                        "id": "fb1f31ba-58e1-41ca-bc3c-21a653467fad",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Workspace Protection",
                        "subTarget": "workspaceprotection",
                        "style": "link"
                      },
                      {
                        "id": "a20afaec-0a2d-4ed7-bfce-9e14d4c775b1",
                        "cellValue": "submenu",
                        "linkTarget": "parameter",
                        "linkLabel": "Advisor Recommendations",
                        "subTarget": "ourrecommendations",
                        "style": "link"
                      }
                    ]
                  },
                  "name": "links - 0"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "5e8f8ef7-c57e-4c97-8356-67e34bdd1eb1",
                        "version": "KqlParameterItem/1.0",
                        "name": "Subscription",
                        "type": 6,
                        "isRequired": true,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "typeSettings": {
                          "additionalResourceOptions": [
                            "value::1",
                            "value::3",
                            "value::all"
                          ],
                          "includeAll": true,
                          "showDefault": false
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "defaultValue": "value::all"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "parameters - 5"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers\r\n| where type =~ 'microsoft.resources/subscriptions/resourcegroups'\r\n| extend TagBool = iff(tags != '' and tags != '[]', \"Tagged\",\"Untagged\")\r\n| summarize count() by TagBool\r\n//| project resourceGroup, tags\r\n",
                          "size": 4,
                          "title": "Resource Group Tagging",
                          "exportParameterName": "tagtab1",
                          "exportDefaultValue": "untaggedresourcegroups",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "TagBool",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "Resources | extend TagBool = iff(tags != '' and tags != '[]', \"Tagged\",\"Untagged\") | summarize count() by TagBool\r\n\r\n",
                          "size": 3,
                          "title": "Resource Tagging",
                          "exportParameterName": "tagtab2",
                          "exportDefaultValue": "untaggedresources",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "TagBool",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "ResourceContainers\r\n| where type =~ 'Microsoft.Resources/subscriptions' \r\n| extend SubscriptionName=name \r\n| join  ( ResourceContainers | where type =~ 'microsoft.resources/subscriptions/resourcegroups'  \r\n    | where tags ==\"\"\r\n| extend resourceGroupName=id, RGLocation=location, RGTags=tags) on subscriptionId\r\n| project resourceGroupName, RGLocation, SubscriptionName\r\n",
                                "size": 3,
                                "title": "Untagged Resource Groups",
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "gridSettings": {
                                  "filter": true,
                                  "labelSettings": [
                                    {
                                      "columnId": "resourceGroupName",
                                      "label": "Resoruce Group"
                                    },
                                    {
                                      "columnId": "RGLocation",
                                      "label": "Location"
                                    },
                                    {
                                      "columnId": "SubscriptionName",
                                      "label": "Subscription"
                                    }
                                  ]
                                }
                              },
                              "name": "query - 3"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "tagtab1",
                          "comparison": "isEqualTo",
                          "value": "untaggedresourcegroups"
                        },
                        "name": "Untagged Resource Group"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "Resources \r\n \r\n|extend TagBool = iff(tags != '' and tags != '[]', \"Tagged\",\"Untagged\") \r\n | where tags ==\"\"\r\n| project name,id,type\r\n\r\n\r\n",
                                "size": 3,
                                "title": "Untagged Resources",
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "gridSettings": {
                                  "filter": true,
                                  "labelSettings": [
                                    {
                                      "columnId": "name",
                                      "label": "Resource Name"
                                    },
                                    {
                                      "columnId": "id",
                                      "label": "Resource ID"
                                    },
                                    {
                                      "columnId": "type",
                                      "label": "Resource Type"
                                    }
                                  ]
                                }
                              },
                              "name": "Untagged Resources"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "tagtab2",
                          "comparison": "isEqualTo",
                          "value": "untaggedresources"
                        },
                        "name": "Untagged Resource Group - Copy"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "untaggedresources"
                  },
                  "name": "Untagged Resources"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 11,
                        "content": {
                          "version": "LinkItem/1.0",
                          "style": "tabs",
                          "links": [
                            {
                              "id": "6fd83c56-0130-451d-a883-8d2ab4e94910",
                              "cellValue": "buttonname",
                              "linkTarget": "parameter",
                              "linkLabel": "Availability Set",
                              "subTarget": "orphanavailabilityset",
                              "preText": "",
                              "style": "link"
                            },
                            {
                              "id": "57ce2c48-7b3e-4204-809e-0d7e985288e9",
                              "cellValue": "buttonname",
                              "linkTarget": "parameter",
                              "linkLabel": "Disk",
                              "subTarget": "orphandisk",
                              "preText": "",
                              "style": "link"
                            },
                            {
                              "id": "6d587a23-8f5a-4554-9b5d-771719294720",
                              "cellValue": "buttonname",
                              "linkTarget": "parameter",
                              "linkLabel": "IP Addresses",
                              "subTarget": "orphanip",
                              "style": "link"
                            },
                            {
                              "id": "2cc0eae2-fa7b-4ae7-b5da-9e71ec702b3e",
                              "cellValue": "buttonname",
                              "linkTarget": "parameter",
                              "linkLabel": "NIC",
                              "subTarget": "orphannic",
                              "style": "link"
                            },
                            {
                              "id": "716a5b8a-0c1b-43c1-bb1b-57f0a596bb2e",
                              "cellValue": "buttonname",
                              "linkTarget": "parameter",
                              "linkLabel": "NSG",
                              "subTarget": "orphannsg",
                              "style": "link"
                            },
                            {
                              "id": "8240e492-7559-449c-a16e-8fac9993d60e",
                              "cellValue": "buttonname",
                              "linkTarget": "parameter",
                              "linkLabel": "ASG",
                              "subTarget": "orphanasg",
                              "style": "link"
                            },
                            {
                              "id": "0053f2bd-f0ca-45ea-8f09-7b1b82a24083",
                              "cellValue": "buttonname",
                              "linkTarget": "parameter",
                              "linkLabel": "LB",
                              "subTarget": "orphanlb",
                              "style": "link"
                            },
                            {
                              "id": "25d74e53-eff1-4747-aaec-4dc6c4790428",
                              "cellValue": "buttonname",
                              "linkTarget": "parameter",
                              "linkLabel": "AppGW without Backend Pools",
                              "subTarget": "orphanappgw",
                              "style": "link"
                            }
                          ]
                        },
                        "name": "links - 5"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "\r\nresources\r\n| where type =~ 'microsoft.compute/availabilitysets'\r\n| extend VirtualMachines = array_length(properties.virtualMachines)\r\n| where VirtualMachines == 0\r\n| summarize c = count()\r\n| extend Item = \"Orphan Availability Set\",  Key = 1",
                                "size": 3,
                                "noDataMessageStyle": 5,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Item",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "c",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": false,
                                  "size": "auto"
                                },
                                "mapSettings": {
                                  "locInfo": "LatLong",
                                  "sizeSettings": "Count",
                                  "sizeAggregation": "Sum",
                                  "legendMetric": "Count",
                                  "legendAggregation": "Sum",
                                  "itemColorSettings": {
                                    "type": "heatmap",
                                    "colorAggregation": "Sum",
                                    "nodeColorField": "Count",
                                    "heatmapPalette": "greenRed"
                                  }
                                },
                                "textSettings": {
                                  "style": "bignumber"
                                }
                              },
                              "name": "Orphan Disk"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type =~ 'microsoft.compute/availabilitysets'\r\n| extend VirtualMachines = array_length(properties.virtualMachines)\r\n| where VirtualMachines == 0\r\n",
                                "size": 3,
                                "title": "List of Orphan Availability Set",
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "table"
                              },
                              "name": "List of Orphan Availability Set"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "buttonname",
                          "comparison": "isEqualTo",
                          "value": "orphanavailabilityset"
                        },
                        "name": "Orphan Availability Set"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "Resources\r\n| where type has \"microsoft.compute/disks\"\r\n| extend diskState = tostring(properties.diskState)\r\n| where  diskState == 'Unattached' or managedBy == \"\"\r\n| summarize c = count()\r\n| extend Item = \"Orphan Disk\",  Key = 1\r\n",
                                      "size": 3,
                                      "noDataMessageStyle": 5,
                                      "queryType": 1,
                                      "resourceType": "microsoft.resourcegraph/resources",
                                      "crossComponentResources": [
                                        "{Subscription}"
                                      ],
                                      "visualization": "tiles",
                                      "tileSettings": {
                                        "titleContent": {
                                          "columnMatch": "Item",
                                          "formatter": 1
                                        },
                                        "leftContent": {
                                          "columnMatch": "c",
                                          "formatter": 12,
                                          "formatOptions": {
                                            "palette": "auto"
                                          },
                                          "numberFormat": {
                                            "unit": 17,
                                            "options": {
                                              "style": "decimal",
                                              "maximumFractionDigits": 2,
                                              "maximumSignificantDigits": 3
                                            }
                                          }
                                        },
                                        "showBorder": false,
                                        "size": "auto"
                                      },
                                      "mapSettings": {
                                        "locInfo": "LatLong",
                                        "sizeSettings": "Count",
                                        "sizeAggregation": "Sum",
                                        "legendMetric": "Count",
                                        "legendAggregation": "Sum",
                                        "itemColorSettings": {
                                          "type": "heatmap",
                                          "colorAggregation": "Sum",
                                          "nodeColorField": "Count",
                                          "heatmapPalette": "greenRed"
                                        }
                                      },
                                      "textSettings": {
                                        "style": "bignumber"
                                      }
                                    },
                                    "name": "Orphan Disk"
                                  },
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name | join (resources | where type =~ 'microsoft.compute/disks' and tostring (properties.diskState) == 'Unattached' and name !has '-ASRReplica' | extend DiskID=id, DiskName=name, SKUName=sku.name, SKUTier=sku.tier, DiskSizeGB=tostring(properties.diskSizeGB),DiskRG=resourceGroup, Location=location, TimeCreated=tostring(properties.timeCreated))on subscriptionId \r\n        | order by id asc \r\n        | project DiskID, DiskSizeGB, SKUName, SKUTier, DiskRG, Location, TimeCreated, SubscriptionName",
                                      "size": 3,
                                      "title": "List of Orphan Disk",
                                      "showExportToExcel": true,
                                      "queryType": 1,
                                      "resourceType": "microsoft.resourcegraph/resources",
                                      "crossComponentResources": [
                                        "{Subscription}"
                                      ],
                                      "visualization": "table",
                                      "gridSettings": {
                                        "filter": true,
                                        "labelSettings": [
                                          {
                                            "columnId": "DiskID",
                                            "label": "Disk"
                                          },
                                          {
                                            "columnId": "DiskSizeGB",
                                            "label": "Size(GB)"
                                          },
                                          {
                                            "columnId": "SKUName",
                                            "label": "SKU"
                                          },
                                          {
                                            "columnId": "SKUTier",
                                            "label": "SKU Tier"
                                          },
                                          {
                                            "columnId": "DiskRG",
                                            "label": "Resource Group"
                                          },
                                          {
                                            "columnId": "Location",
                                            "label": "Location"
                                          },
                                          {
                                            "columnId": "TimeCreated",
                                            "label": "Creation Time"
                                          },
                                          {
                                            "columnId": "SubscriptionName",
                                            "label": "Subscription"
                                          }
                                        ]
                                      },
                                      "sortBy": []
                                    },
                                    "name": "query - 1"
                                  }
                                ]
                              },
                              "conditionalVisibility": {
                                "parameterName": "buttonname",
                                "comparison": "isEqualTo",
                                "value": "orphandisk"
                              },
                              "name": "Orphan Disk"
                            }
                          ]
                        },
                        "name": "Orphan Disk"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type =~ 'microsoft.network/publicipaddresses'\r\n| extend IpConfig = properties.ipConfiguration.id\r\n| where isempty(IpConfig)\r\n| summarize c = count()\r\n| extend Item = \"Orphan IP Address\",  Key = 1\r\n\r\n",
                                "size": 3,
                                "noDataMessageStyle": 5,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Item",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "c",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": false
                                },
                                "mapSettings": {
                                  "locInfo": "LatLong",
                                  "sizeSettings": "Count",
                                  "sizeAggregation": "Sum",
                                  "legendMetric": "Count",
                                  "legendAggregation": "Sum",
                                  "itemColorSettings": {
                                    "type": "heatmap",
                                    "colorAggregation": "Sum",
                                    "nodeColorField": "Count",
                                    "heatmapPalette": "greenRed"
                                  }
                                },
                                "textSettings": {
                                  "style": "bignumber"
                                }
                              },
                              "name": "orphan Public IP Count"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type =~ 'microsoft.network/publicipaddresses'\r\n| extend IpConfig = properties.ipConfiguration.id\r\n| where isempty(IpConfig)\r\n| project id,location , resourceGroup\r\n",
                                "size": 3,
                                "title": "List of Orphan Public IP Address",
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "filter": true,
                                  "labelSettings": [
                                    {
                                      "columnId": "id",
                                      "label": "Public IP"
                                    },
                                    {
                                      "columnId": "resourceGroup",
                                      "label": "Resource Group"
                                    }
                                  ]
                                }
                              },
                              "name": "List of Orphan IP"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "buttonname",
                          "comparison": "isEqualTo",
                          "value": "orphanip"
                        },
                        "name": "Orphan Public IP"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "ResourceContainers  | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name | join ( Resources | where type =~ 'microsoft.network/networkinterfaces' and isempty(properties.virtualMachine) and isnull(properties.privateEndpoint)\r\n    | extend NIC=id,  NICName=name, NICRG=resourceGroup, NICLocation=location, NICType=tostring(properties.nicType)) on subscriptionId\r\n        | order by id asc\r\n        | project NIC,NICName, NICRG, NICLocation, NICType, SubscriptionName\r\n| summarize c = count()\r\n| extend Item = \"Orphan NIC\",  Key = 1\r\n\r\n\r\n",
                                "size": 3,
                                "noDataMessageStyle": 5,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Item",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "c",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": false,
                                  "size": "auto"
                                },
                                "mapSettings": {
                                  "locInfo": "LatLong",
                                  "sizeSettings": "Count",
                                  "sizeAggregation": "Sum",
                                  "legendMetric": "Count",
                                  "legendAggregation": "Sum",
                                  "itemColorSettings": {
                                    "type": "heatmap",
                                    "colorAggregation": "Sum",
                                    "nodeColorField": "Count",
                                    "heatmapPalette": "greenRed"
                                  }
                                },
                                "textSettings": {
                                  "style": "bignumber"
                                }
                              },
                              "name": "orphan NIC Count"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "ResourceContainers  | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name | join ( Resources | where type =~ 'microsoft.network/networkinterfaces' and isempty(properties.virtualMachine) and isnull(properties.privateEndpoint)\r\n    | extend NIC=id,  NICName=name, NICRG=resourceGroup, NICLocation=location, NICType=tostring(properties.nicType)) on subscriptionId\r\n        | order by id asc\r\n        | project NIC,NICName, NICRG, NICLocation, NICType, SubscriptionName",
                                "size": 3,
                                "title": "List of Orphan NIC",
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "filter": true,
                                  "labelSettings": [
                                    {
                                      "columnId": "NIC",
                                      "label": "NIC"
                                    },
                                    {
                                      "columnId": "NICRG",
                                      "label": "Resource Group"
                                    },
                                    {
                                      "columnId": "NICLocation",
                                      "label": "Location"
                                    },
                                    {
                                      "columnId": "NICType",
                                      "label": "Type"
                                    },
                                    {
                                      "columnId": "SubscriptionName",
                                      "label": "Subscription"
                                    }
                                  ]
                                }
                              },
                              "name": "List of Orphan NIC"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "buttonname",
                          "comparison": "isEqualTo",
                          "value": "orphannic"
                        },
                        "name": "Orphan NIC"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name | join ( Resources | where type =~ 'microsoft.network/networksecuritygroups' and isnull(properties.networkInterfaces) and isnull(properties.subnets) | extend NSG=id, NSGName=name, NSGRG=resourceGroup, NSGLocation=location ) on subscriptionId\r\n    | order by id asc\r\n    | project NSG,NSGName, NSGRG, NSGLocation, SubscriptionName\r\n| summarize c = count()\r\n| extend Item = \"Orphan NSG\",  Key = 1\r\n\r\n",
                                "size": 3,
                                "noDataMessageStyle": 5,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Item",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "c",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": true,
                                  "size": "auto"
                                },
                                "mapSettings": {
                                  "locInfo": "LatLong",
                                  "sizeSettings": "Count",
                                  "sizeAggregation": "Sum",
                                  "legendMetric": "Count",
                                  "legendAggregation": "Sum",
                                  "itemColorSettings": {
                                    "type": "heatmap",
                                    "colorAggregation": "Sum",
                                    "nodeColorField": "Count",
                                    "heatmapPalette": "greenRed"
                                  }
                                },
                                "textSettings": {
                                  "style": "bignumber"
                                }
                              },
                              "name": "orphan NSG Count"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name | join ( Resources | where type =~ 'microsoft.network/networksecuritygroups' and isnull(properties.networkInterfaces) and isnull(properties.subnets) | extend NSG=id, NSGName=name, NSGRG=resourceGroup, NSGLocation=location ) on subscriptionId\r\n    | order by id asc\r\n    | project NSG,NSGName, NSGRG, NSGLocation, SubscriptionName",
                                "size": 3,
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "filter": true
                                }
                              },
                              "name": "List of Orphan NSG"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "buttonname",
                          "comparison": "isEqualTo",
                          "value": "orphannsg"
                        },
                        "name": "Orphan NSG"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "Resources\r\n| where type =~ 'microsoft.network/applicationsecuritygroups' and isnull(properties.networkInterfaces) and isnull(properties.subnets)\r\n| project Resource=id, resourceGroup, subscriptionId, location\r\n| summarize c = count()\r\n| extend Item = \"ASG\",  Key = 1\r\n\r\n\r\n",
                                "size": 3,
                                "noDataMessageStyle": 5,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Item",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "c",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": false,
                                  "size": "auto"
                                },
                                "mapSettings": {
                                  "locInfo": "LatLong",
                                  "sizeSettings": "Count",
                                  "sizeAggregation": "Sum",
                                  "legendMetric": "Count",
                                  "legendAggregation": "Sum",
                                  "itemColorSettings": {
                                    "type": "heatmap",
                                    "colorAggregation": "Sum",
                                    "nodeColorField": "Count",
                                    "heatmapPalette": "greenRed"
                                  }
                                },
                                "textSettings": {
                                  "style": "bignumber"
                                }
                              },
                              "name": "orphan ASG Count"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "Resources\r\n| where type =~ 'microsoft.network/applicationsecuritygroups' and isnull(properties.networkInterfaces) and isnull(properties.subnets)\r\n| project Resource=id, resourceGroup, subscriptionId, location",
                                "size": 3,
                                "title": "List of Orphan ASG",
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "table"
                              },
                              "name": "List of Orphan ASG"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "buttonname",
                          "comparison": "isEqualTo",
                          "value": "orphanasg"
                        },
                        "name": "Orphan ASG"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "// Run query to see results.\r\nresources\r\n| where type =~ 'microsoft.network/loadbalancers'\r\n| extend loadBalancingRulesCount = array_length(properties.loadBalancingRules)\r\n| extend loadBalancingRule = properties.loadBalancingRules[0]\r\n| extend loadBalancingRuleName = tostring(loadBalancingRule.name)\r\n| extend protocol = tostring(loadBalancingRule.properties.protocol)\r\n| extend frontendPort = tostring(loadBalancingRule.properties.frontendPort)\r\n| extend backendPort = tostring(loadBalancingRule.properties.backendPort)\r\n| extend displayNameWithSameFrontendBackendSplit0 = split('{0}/{1}', '{0}')\r\n| extend displayNameWithSameFrontendBackendValue0 = strcat(displayNameWithSameFrontendBackendSplit0[0], protocol, displayNameWithSameFrontendBackendSplit0[1])\r\n| extend displayNameWithSameFrontendBackendSplit1 = split(displayNameWithSameFrontendBackendValue0, '{1}')\r\n| extend displayNameWithSameFrontendBackend = strcat(displayNameWithSameFrontendBackendSplit1[0], frontendPort, displayNameWithSameFrontendBackendSplit1[1])\r\n| extend displayNameWithDifferentFrontendBackendSplit0 = split('{0}/{1} to {2}/{3}', '{0}')\r\n| extend displayNameWithDifferentFrontendBackendValue0 = strcat(displayNameWithDifferentFrontendBackendSplit0[0], protocol, displayNameWithDifferentFrontendBackendSplit0[1])\r\n| extend displayNameWithDifferentFrontendBackendSplit1 = split(displayNameWithDifferentFrontendBackendValue0, '{1}')\r\n| extend displayNameWithDifferentFrontendBackendValue1 = strcat(displayNameWithDifferentFrontendBackendSplit1[0], frontendPort, displayNameWithDifferentFrontendBackendSplit1[1])\r\n| extend displayNameWithDifferentFrontendBackendSplit2 = split(displayNameWithDifferentFrontendBackendValue1, '{2}')\r\n| extend displayNameWithDifferentFrontendBackendValue2 = strcat(displayNameWithDifferentFrontendBackendSplit2[0], protocol, displayNameWithDifferentFrontendBackendSplit2[1])\r\n| extend displayNameWithDifferentFrontendBackendSplit3 = split(displayNameWithDifferentFrontendBackendValue2, '{3}')\r\n| extend displayNameWithDifferentFrontendBackend = strcat(displayNameWithDifferentFrontendBackendSplit3[0], backendPort, displayNameWithDifferentFrontendBackendSplit3[1])\r\n| extend nonEmptyProtocolPortDisplayName = iff(frontendPort =~ backendPort, displayNameWithSameFrontendBackend, displayNameWithDifferentFrontendBackend)\r\n| extend ruleProtocolPortDisplayName = iff(isnotempty(protocol) and isnotempty(frontendPort) and isnotempty(backendPort), nonEmptyProtocolPortDisplayName, loadBalancingRuleName)\r\n| extend multipleLoadBalancingRulesDisplayNameSplit0 = split('{0} {1}', '{0}')\r\n| extend multipleLoadBalancingRulesDisplayNameValue0 = strcat(multipleLoadBalancingRulesDisplayNameSplit0[0], loadBalancingRulesCount, multipleLoadBalancingRulesDisplayNameSplit0[1])\r\n| extend multipleLoadBalancingRulesDisplayNameSplit1 = split(multipleLoadBalancingRulesDisplayNameValue0, '{1}')\r\n| extend multipleLoadBalancingRulesDisplayName = strcat(multipleLoadBalancingRulesDisplayNameSplit1[0], 'rules', multipleLoadBalancingRulesDisplayNameSplit1[1])\r\n| extend loadBalancingRules = case(loadBalancingRulesCount==0 or isempty(loadBalancingRule), '-',\r\n                                    loadBalancingRulesCount==1, ruleProtocolPortDisplayName,\r\n                                    multipleLoadBalancingRulesDisplayName)\r\n| extend backendAddressPoolsCount = array_length(properties.backendAddressPools)\r\n| extend backendAddressPool = properties.backendAddressPools[0]\r\n| extend backendAddressPoolName = tostring(backendAddressPool.name)\r\n| extend virtualMachineCount = array_length(backendAddressPool.properties.backendIPConfigurations)\r\n| extend singleVirtualMachineDisplayNameSplit0 = split('{0} (1 virtual machine)', '{0}')\r\n| extend singleVirtualMachineDisplayName = strcat(singleVirtualMachineDisplayNameSplit0[0], backendAddressPoolName, singleVirtualMachineDisplayNameSplit0[1])\r\n| extend multipleVirtualMachineDisplayNameSplit0 = split('{0} ({1} virtual machines)', '{0}')\r\n| extend multipleVirtualMachineDisplayNameValue0 = strcat(multipleVirtualMachineDisplayNameSplit0[0], backendAddressPoolName, multipleVirtualMachineDisplayNameSplit0[1])\r\n| extend multipleVirtualMachineDisplayNameSplit1 = split(multipleVirtualMachineDisplayNameValue0, '{1}')\r\n| extend multipleVirtualMachineDisplayName = strcat(multipleVirtualMachineDisplayNameSplit1[0], virtualMachineCount, multipleVirtualMachineDisplayNameSplit1[1])\r\n| extend singleBackendAddressPoolDisplayName = case(isempty(backendAddressPoolName), '-',\r\n                                                    virtualMachineCount == 1, singleVirtualMachineDisplayName,\r\n                                                    virtualMachineCount > 1, multipleVirtualMachineDisplayName,\r\n                                                    backendAddressPoolName)\r\n| extend multipleBackendAddressPoolDisplayNameSplit0 = split('{0} {1}', '{0}')\r\n| extend multipleBackendAddressPoolDisplayNameValue0 = strcat(multipleBackendAddressPoolDisplayNameSplit0[0], backendAddressPoolsCount, multipleBackendAddressPoolDisplayNameSplit0[1])\r\n| extend multipleBackendAddressPoolDisplayNameSplit1 = split(multipleBackendAddressPoolDisplayNameValue0, '{1}')\r\n| extend multipleBackendAddressPoolDisplayName = strcat(multipleBackendAddressPoolDisplayNameSplit1[0], 'backend pools', multipleBackendAddressPoolDisplayNameSplit1[1])\r\n| extend backendPools = case(backendAddressPoolsCount==0 or isempty(backendAddressPool), '-',\r\n                            backendAddressPoolsCount==1, singleBackendAddressPoolDisplayName,\r\n                            multipleBackendAddressPoolDisplayName)\r\n| extend probesCount = array_length(properties.probes)\r\n| extend probe = properties.probes[0]\r\n| extend probeName = tostring(probe.name)\r\n| extend probeProtocol = tostring(toupper(probe.properties.protocol))\r\n| extend probePort = tostring(probe.properties.port)\r\n| extend probePath = tostring(probe.properties.requestPath)\r\n| extend probePath = iff(strlen(probePath)>1 and substring(probePath,0,1)=~'/', substring(probePath,1), probePath)\r\n| extend probeNameWithPathSplit0 = split('{0} ({1}:{2}/{3})', '{0}')\r\n| extend probeNameWithPathValue0 = strcat(probeNameWithPathSplit0[0], probeName, probeNameWithPathSplit0[1])\r\n| extend probeNameWithPathSplit1 = split(probeNameWithPathValue0, '{1}')\r\n| extend probeNameWithPathValue1 = strcat(probeNameWithPathSplit1[0], probeProtocol, probeNameWithPathSplit1[1])\r\n| extend probeNameWithPathSplit2 = split(probeNameWithPathValue1, '{2}')\r\n| extend probeNameWithPathValue2 = strcat(probeNameWithPathSplit2[0], probePort, probeNameWithPathSplit2[1])\r\n| extend probeNameWithPathSplit3 = split(probeNameWithPathValue2, '{3}')\r\n| extend probeNameWithPath = strcat(probeNameWithPathSplit3[0], probePath, probeNameWithPathSplit3[1])\r\n| extend probeNameWithOutPathSplit0 = split('{0} ({1}:{2})', '{0}')\r\n| extend probeNameWithOutPathValue0 = strcat(probeNameWithOutPathSplit0[0], probeName, probeNameWithOutPathSplit0[1])\r\n| extend probeNameWithOutPathSplit1 = split(probeNameWithOutPathValue0, '{1}')\r\n| extend probeNameWithOutPathValue1 = strcat(probeNameWithOutPathSplit1[0], probeProtocol, probeNameWithOutPathSplit1[1])\r\n| extend probeNameWithOutPathSplit2 = split(probeNameWithOutPathValue1, '{2}')\r\n| extend probeNameWithOutPath = strcat(probeNameWithOutPathSplit2[0], probePort, probeNameWithOutPathSplit2[1])\r\n| extend nonEmptyProbeDisplayName = iff(isempty(probePath) or probePath=~'/', probeNameWithOutPath, probeNameWithPath)\r\n| extend singleProbeDisplayName = iff(isnotempty(probe) and isnotempty(probeName) and isnotempty(probeProtocol) and isnotempty(probePort), nonEmptyProbeDisplayName, probeName)\r\n| extend multipleProbeDisplayNameSplit0 = split('{0} {1}', '{0}')\r\n| extend multipleProbeDisplayNameValue0 = strcat(multipleProbeDisplayNameSplit0[0], probesCount, multipleProbeDisplayNameSplit0[1])\r\n| extend multipleProbeDisplayNameSplit1 = split(multipleProbeDisplayNameValue0, '{1}')\r\n| extend multipleProbeDisplayName = strcat(multipleProbeDisplayNameSplit1[0], 'probes', multipleProbeDisplayNameSplit1[1])\r\n| extend healthProbes = case(probesCount==0 or isempty(probe), '-',\r\n                            probesCount==1, singleProbeDisplayName,\r\n                            multipleProbeDisplayName)\r\n| extend natRulesCount = array_length(properties.inboundNatPools)\r\n| extend natRulesDisplaySplit0 = split('{0} inbound', '{0}')\r\n| extend natRulesDisplay = strcat(natRulesDisplaySplit0[0], natRulesCount, natRulesDisplaySplit0[1])\r\n| extend natRules = iff(isempty(properties.inboundNatPools) or natRulesCount==0, '-', natRulesDisplay)\r\n| extend skuName = tostring(sku.name)\r\n| extend sku = case(sku.name =~ 'Basic', 'Basic',\r\n                    sku.name =~ 'standard', 'Standard',\r\n                    '')\r\n| where backendPools=~'-'\r\n| project name, id, sku, location, resourceGroup, loadBalancingRules, healthProbes, natRules\r\n| summarize c = count()\r\n| extend Item = \"Load Balancer\",  Key = 1\r\n",
                                      "size": 3,
                                      "noDataMessageStyle": 5,
                                      "queryType": 1,
                                      "resourceType": "microsoft.resourcegraph/resources",
                                      "crossComponentResources": [
                                        "{Subscription}"
                                      ],
                                      "visualization": "tiles",
                                      "tileSettings": {
                                        "titleContent": {
                                          "columnMatch": "Item",
                                          "formatter": 1
                                        },
                                        "leftContent": {
                                          "columnMatch": "c",
                                          "formatter": 12,
                                          "formatOptions": {
                                            "palette": "auto"
                                          },
                                          "numberFormat": {
                                            "unit": 17,
                                            "options": {
                                              "style": "decimal",
                                              "maximumFractionDigits": 2,
                                              "maximumSignificantDigits": 3
                                            }
                                          }
                                        },
                                        "showBorder": false,
                                        "size": "auto"
                                      },
                                      "mapSettings": {
                                        "locInfo": "LatLong",
                                        "sizeSettings": "Count",
                                        "sizeAggregation": "Sum",
                                        "legendMetric": "Count",
                                        "legendAggregation": "Sum",
                                        "itemColorSettings": {
                                          "type": "heatmap",
                                          "colorAggregation": "Sum",
                                          "nodeColorField": "Count",
                                          "heatmapPalette": "greenRed"
                                        }
                                      },
                                      "textSettings": {
                                        "style": "bignumber"
                                      }
                                    },
                                    "name": "orphan LB Count"
                                  },
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "List of Orphan Load Balancers",
                                      "style": "warning"
                                    },
                                    "name": "text - 2"
                                  },
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "// Run query to see results.\r\nresources\r\n| where type =~ 'microsoft.network/loadbalancers'\r\n| extend loadBalancingRulesCount = array_length(properties.loadBalancingRules)\r\n| extend loadBalancingRule = properties.loadBalancingRules[0]\r\n| extend loadBalancingRuleName = tostring(loadBalancingRule.name)\r\n| extend protocol = tostring(loadBalancingRule.properties.protocol)\r\n| extend frontendPort = tostring(loadBalancingRule.properties.frontendPort)\r\n| extend backendPort = tostring(loadBalancingRule.properties.backendPort)\r\n| extend displayNameWithSameFrontendBackendSplit0 = split('{0}/{1}', '{0}')\r\n| extend displayNameWithSameFrontendBackendValue0 = strcat(displayNameWithSameFrontendBackendSplit0[0], protocol, displayNameWithSameFrontendBackendSplit0[1])\r\n| extend displayNameWithSameFrontendBackendSplit1 = split(displayNameWithSameFrontendBackendValue0, '{1}')\r\n| extend displayNameWithSameFrontendBackend = strcat(displayNameWithSameFrontendBackendSplit1[0], frontendPort, displayNameWithSameFrontendBackendSplit1[1])\r\n| extend displayNameWithDifferentFrontendBackendSplit0 = split('{0}/{1} to {2}/{3}', '{0}')\r\n| extend displayNameWithDifferentFrontendBackendValue0 = strcat(displayNameWithDifferentFrontendBackendSplit0[0], protocol, displayNameWithDifferentFrontendBackendSplit0[1])\r\n| extend displayNameWithDifferentFrontendBackendSplit1 = split(displayNameWithDifferentFrontendBackendValue0, '{1}')\r\n| extend displayNameWithDifferentFrontendBackendValue1 = strcat(displayNameWithDifferentFrontendBackendSplit1[0], frontendPort, displayNameWithDifferentFrontendBackendSplit1[1])\r\n| extend displayNameWithDifferentFrontendBackendSplit2 = split(displayNameWithDifferentFrontendBackendValue1, '{2}')\r\n| extend displayNameWithDifferentFrontendBackendValue2 = strcat(displayNameWithDifferentFrontendBackendSplit2[0], protocol, displayNameWithDifferentFrontendBackendSplit2[1])\r\n| extend displayNameWithDifferentFrontendBackendSplit3 = split(displayNameWithDifferentFrontendBackendValue2, '{3}')\r\n| extend displayNameWithDifferentFrontendBackend = strcat(displayNameWithDifferentFrontendBackendSplit3[0], backendPort, displayNameWithDifferentFrontendBackendSplit3[1])\r\n| extend nonEmptyProtocolPortDisplayName = iff(frontendPort =~ backendPort, displayNameWithSameFrontendBackend, displayNameWithDifferentFrontendBackend)\r\n| extend ruleProtocolPortDisplayName = iff(isnotempty(protocol) and isnotempty(frontendPort) and isnotempty(backendPort), nonEmptyProtocolPortDisplayName, loadBalancingRuleName)\r\n| extend multipleLoadBalancingRulesDisplayNameSplit0 = split('{0} {1}', '{0}')\r\n| extend multipleLoadBalancingRulesDisplayNameValue0 = strcat(multipleLoadBalancingRulesDisplayNameSplit0[0], loadBalancingRulesCount, multipleLoadBalancingRulesDisplayNameSplit0[1])\r\n| extend multipleLoadBalancingRulesDisplayNameSplit1 = split(multipleLoadBalancingRulesDisplayNameValue0, '{1}')\r\n| extend multipleLoadBalancingRulesDisplayName = strcat(multipleLoadBalancingRulesDisplayNameSplit1[0], 'rules', multipleLoadBalancingRulesDisplayNameSplit1[1])\r\n| extend loadBalancingRules = case(loadBalancingRulesCount==0 or isempty(loadBalancingRule), '-',\r\n                                    loadBalancingRulesCount==1, ruleProtocolPortDisplayName,\r\n                                    multipleLoadBalancingRulesDisplayName)\r\n| extend backendAddressPoolsCount = array_length(properties.backendAddressPools)\r\n| extend backendAddressPool = properties.backendAddressPools[0]\r\n| extend backendAddressPoolName = tostring(backendAddressPool.name)\r\n| extend virtualMachineCount = array_length(backendAddressPool.properties.backendIPConfigurations)\r\n| extend singleVirtualMachineDisplayNameSplit0 = split('{0} (1 virtual machine)', '{0}')\r\n| extend singleVirtualMachineDisplayName = strcat(singleVirtualMachineDisplayNameSplit0[0], backendAddressPoolName, singleVirtualMachineDisplayNameSplit0[1])\r\n| extend multipleVirtualMachineDisplayNameSplit0 = split('{0} ({1} virtual machines)', '{0}')\r\n| extend multipleVirtualMachineDisplayNameValue0 = strcat(multipleVirtualMachineDisplayNameSplit0[0], backendAddressPoolName, multipleVirtualMachineDisplayNameSplit0[1])\r\n| extend multipleVirtualMachineDisplayNameSplit1 = split(multipleVirtualMachineDisplayNameValue0, '{1}')\r\n| extend multipleVirtualMachineDisplayName = strcat(multipleVirtualMachineDisplayNameSplit1[0], virtualMachineCount, multipleVirtualMachineDisplayNameSplit1[1])\r\n| extend singleBackendAddressPoolDisplayName = case(isempty(backendAddressPoolName), '-',\r\n                                                    virtualMachineCount == 1, singleVirtualMachineDisplayName,\r\n                                                    virtualMachineCount > 1, multipleVirtualMachineDisplayName,\r\n                                                    backendAddressPoolName)\r\n| extend multipleBackendAddressPoolDisplayNameSplit0 = split('{0} {1}', '{0}')\r\n| extend multipleBackendAddressPoolDisplayNameValue0 = strcat(multipleBackendAddressPoolDisplayNameSplit0[0], backendAddressPoolsCount, multipleBackendAddressPoolDisplayNameSplit0[1])\r\n| extend multipleBackendAddressPoolDisplayNameSplit1 = split(multipleBackendAddressPoolDisplayNameValue0, '{1}')\r\n| extend multipleBackendAddressPoolDisplayName = strcat(multipleBackendAddressPoolDisplayNameSplit1[0], 'backend pools', multipleBackendAddressPoolDisplayNameSplit1[1])\r\n| extend backendPools = case(backendAddressPoolsCount==0 or isempty(backendAddressPool), '-',\r\n                            backendAddressPoolsCount==1, singleBackendAddressPoolDisplayName,\r\n                            multipleBackendAddressPoolDisplayName)\r\n| extend probesCount = array_length(properties.probes)\r\n| extend probe = properties.probes[0]\r\n| extend probeName = tostring(probe.name)\r\n| extend probeProtocol = tostring(toupper(probe.properties.protocol))\r\n| extend probePort = tostring(probe.properties.port)\r\n| extend probePath = tostring(probe.properties.requestPath)\r\n| extend probePath = iff(strlen(probePath)>1 and substring(probePath,0,1)=~'/', substring(probePath,1), probePath)\r\n| extend probeNameWithPathSplit0 = split('{0} ({1}:{2}/{3})', '{0}')\r\n| extend probeNameWithPathValue0 = strcat(probeNameWithPathSplit0[0], probeName, probeNameWithPathSplit0[1])\r\n| extend probeNameWithPathSplit1 = split(probeNameWithPathValue0, '{1}')\r\n| extend probeNameWithPathValue1 = strcat(probeNameWithPathSplit1[0], probeProtocol, probeNameWithPathSplit1[1])\r\n| extend probeNameWithPathSplit2 = split(probeNameWithPathValue1, '{2}')\r\n| extend probeNameWithPathValue2 = strcat(probeNameWithPathSplit2[0], probePort, probeNameWithPathSplit2[1])\r\n| extend probeNameWithPathSplit3 = split(probeNameWithPathValue2, '{3}')\r\n| extend probeNameWithPath = strcat(probeNameWithPathSplit3[0], probePath, probeNameWithPathSplit3[1])\r\n| extend probeNameWithOutPathSplit0 = split('{0} ({1}:{2})', '{0}')\r\n| extend probeNameWithOutPathValue0 = strcat(probeNameWithOutPathSplit0[0], probeName, probeNameWithOutPathSplit0[1])\r\n| extend probeNameWithOutPathSplit1 = split(probeNameWithOutPathValue0, '{1}')\r\n| extend probeNameWithOutPathValue1 = strcat(probeNameWithOutPathSplit1[0], probeProtocol, probeNameWithOutPathSplit1[1])\r\n| extend probeNameWithOutPathSplit2 = split(probeNameWithOutPathValue1, '{2}')\r\n| extend probeNameWithOutPath = strcat(probeNameWithOutPathSplit2[0], probePort, probeNameWithOutPathSplit2[1])\r\n| extend nonEmptyProbeDisplayName = iff(isempty(probePath) or probePath=~'/', probeNameWithOutPath, probeNameWithPath)\r\n| extend singleProbeDisplayName = iff(isnotempty(probe) and isnotempty(probeName) and isnotempty(probeProtocol) and isnotempty(probePort), nonEmptyProbeDisplayName, probeName)\r\n| extend multipleProbeDisplayNameSplit0 = split('{0} {1}', '{0}')\r\n| extend multipleProbeDisplayNameValue0 = strcat(multipleProbeDisplayNameSplit0[0], probesCount, multipleProbeDisplayNameSplit0[1])\r\n| extend multipleProbeDisplayNameSplit1 = split(multipleProbeDisplayNameValue0, '{1}')\r\n| extend multipleProbeDisplayName = strcat(multipleProbeDisplayNameSplit1[0], 'probes', multipleProbeDisplayNameSplit1[1])\r\n| extend healthProbes = case(probesCount==0 or isempty(probe), '-',\r\n                            probesCount==1, singleProbeDisplayName,\r\n                            multipleProbeDisplayName)\r\n| extend natRulesCount = array_length(properties.inboundNatPools)\r\n| extend natRulesDisplaySplit0 = split('{0} inbound', '{0}')\r\n| extend natRulesDisplay = strcat(natRulesDisplaySplit0[0], natRulesCount, natRulesDisplaySplit0[1])\r\n| extend natRules = iff(isempty(properties.inboundNatPools) or natRulesCount==0, '-', natRulesDisplay)\r\n| extend skuName = tostring(sku.name)\r\n| extend sku = case(sku.name =~ 'Basic', 'Basic',\r\n                    sku.name =~ 'standard', 'Standard',\r\n                    '')\r\n| where backendPools=~'-'\r\n| project name, id, sku, location, resourceGroup, loadBalancingRules, healthProbes, natRules",
                                      "size": 3,
                                      "title": "List of Orphan Load Balancers",
                                      "showExportToExcel": true,
                                      "queryType": 1,
                                      "resourceType": "microsoft.resourcegraph/resources",
                                      "crossComponentResources": [
                                        "{Subscription}"
                                      ],
                                      "visualization": "table"
                                    },
                                    "name": "List of Orphan LB"
                                  }
                                ]
                              },
                              "name": "Orphan LB"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "buttonname",
                          "comparison": "isEqualTo",
                          "value": "orphanlb"
                        },
                        "name": "LB"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources | where type =~ 'Microsoft.Network/applicationGateways'\r\n| extend AppGateway=id, AppGWName=name, SKUName= tostring(properties.sku.name), SKUTier= tostring(properties.sku.tier), APPRG=resourceGroup, APPGWLocation=location ,backendpools = properties.backendAddressPools\r\n| mv-expand backendpools\r\n| extend backendPoolName = backendpools.name ,backendPoolIPTarget = array_length(backendpools.properties.backendAddresses) , backendPoolVMTarget = array_length(backendpools.properties.backendIPConfigurations)\r\n| distinct AppGWName\r\n| summarize c = count()\r\n| extend Item = \"App Gateway Without Pools\",  Key = 1\r\n",
                                "size": 4,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Item",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "c",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    }
                                  },
                                  "showBorder": false,
                                  "size": "auto"
                                },
                                "textSettings": {
                                  "style": "bignumber"
                                }
                              },
                              "name": "query - 3"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources | where type =~ 'Microsoft.Network/applicationGateways'\r\n| extend AppGateway=id, AppGWName=name, SKUName= tostring(properties.sku.name), SKUTier= tostring(properties.sku.tier), APPRG=resourceGroup, APPGWLocation=location ,backendpools = properties.backendAddressPools\r\n| mv-expand backendpools\r\n| extend backendPoolName = backendpools.name ,backendPoolIPTarget = array_length(backendpools.properties.backendAddresses) , backendPoolVMTarget = array_length(backendpools.properties.backendIPConfigurations)\r\n| project AppGateway,AppGWName,backendPoolName,backendPoolIPTarget,backendPoolVMTarget\r\n| order by AppGWName",
                                "size": 3,
                                "title": "List of Application Gateways without Backend Pool",
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "backendPoolIPTarget",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": ">",
                                            "thresholdValue": "0",
                                            "representation": "success",
                                            "text": ""
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "0",
                                            "representation": "disabled",
                                            "text": ""
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "backendPoolVMTarget",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "is Empty",
                                            "representation": "disabled",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": ">",
                                            "thresholdValue": "0",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    }
                                  ],
                                  "filter": true,
                                  "hierarchySettings": {
                                    "treeType": 1,
                                    "groupBy": [
                                      "AppGWName"
                                    ]
                                  },
                                  "labelSettings": [
                                    {
                                      "columnId": "AppGateway",
                                      "label": "App Gateway"
                                    },
                                    {
                                      "columnId": "AppGWName",
                                      "label": "App Gateway Name"
                                    },
                                    {
                                      "columnId": "backendPoolName",
                                      "label": "Backend Pool Name"
                                    },
                                    {
                                      "columnId": "backendPoolIPTarget",
                                      "label": "Backend Pool IP Target"
                                    },
                                    {
                                      "columnId": "backendPoolVMTarget",
                                      "label": "Backend Pool VM Target"
                                    }
                                  ]
                                }
                              },
                              "name": "query - 0"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "buttonname",
                          "comparison": "isEqualTo",
                          "value": "orphanappgw"
                        },
                        "name": "App Gateway Withoutpools"
                      }
                    ]
                  },
                  "customWidth": "100",
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "orphanitems"
                  },
                  "name": "Orphan Services"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.operationsmanagement/solutions\"\r\n| project Solution=plan.name, Workspace=tolower(tostring(properties.workspaceResourceId)), subscriptionId\r\n| join kind=leftouter(\r\nresources\r\n| where type =~ 'microsoft.operationalinsights/workspaces'\r\n| project Workspace=tolower(tostring(id)),subscriptionId) on Workspace\r\n| summarize Solutions = strcat_array (make_list(Solution), \",\") by Workspace, subscriptionId\r\n| extend AzureSecurityCenter = iif(Solutions has 'Security','Enabled','Not Enabled')\r\n| extend AzureSecurityCenterFree = iif(Solutions has 'SecurityCenterFree','Enabled','Not Enabled')\r\n| extend AzureSentinel = iif(Solutions has \"SecurityInsights\",'Enabled','Not Enabled')\r\n| extend AzureMonitorVMs = iif(Solutions has \"VMInsights\",'Enabled','Not Enabled')\r\n| extend ServiceDesk = iif(Solutions has \"ITSM Connector\",'Enabled','Not Enabled')\r\n| extend AzureAutomation = iif(Solutions has \"AzureAutomation\",'Enabled','Not Enabled')\r\n| extend ChangeTracking = iif(Solutions has 'ChangeTracking','Enabled','Not Enabled')\r\n| extend UpdateManagement = iif(Solutions has 'Updates','Enabled','Not Enabled')\r\n| extend UpdateCompliance = iif(Solutions has 'WaaSUpdateInsights','Enabled','Not Enabled')\r\n| extend AzureMonitorContainers = iif(Solutions has 'ContainerInsights','Enabled','Not Enabled')\r\n| extend KeyVaultAnalytics = iif(Solutions has 'KeyVaultAnalytics','Enabled','Not Enabled')\r\n| extend SQLHealthCheck = iif(Solutions has 'SQLAssessment','Enabled','Not Enabled')",
                          "size": 3,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "table",
                          "gridSettings": {
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "subscriptionId",
                                "label": "Subscription ID"
                              },
                              {
                                "columnId": "AzureSecurityCenter",
                                "label": "Azure Security Center"
                              },
                              {
                                "columnId": "AzureSecurityCenterFree",
                                "label": "Azure Security Center Free"
                              },
                              {
                                "columnId": "AzureSentinel",
                                "label": "Azure Sentinel"
                              },
                              {
                                "columnId": "AzureMonitorVMs",
                                "label": "Azure Monitor VM's"
                              },
                              {
                                "columnId": "ServiceDesk",
                                "label": "Service Desk"
                              },
                              {
                                "columnId": "AzureAutomation",
                                "label": "Azure Automation"
                              },
                              {
                                "columnId": "ChangeTracking",
                                "label": "Chanage Tracking"
                              },
                              {
                                "columnId": "UpdateManagement",
                                "label": "Update Management"
                              },
                              {
                                "columnId": "UpdateCompliance",
                                "label": "Update Compliance"
                              },
                              {
                                "columnId": "AzureMonitorContainers",
                                "label": "Azure Monitor Containers"
                              },
                              {
                                "columnId": "KeyVaultAnalytics",
                                "label": "Key Vault Analytics"
                              },
                              {
                                "columnId": "SQLHealthCheck",
                                "label": "SQL Health Check"
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Solutions"
                            },
                            "leftContent": {
                              "columnMatch": "Solutions"
                            },
                            "showBorder": false
                          }
                        },
                        "name": "query - 8"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "workspaceprotection"
                  },
                  "name": "Workspace Protection"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "AdvisorResources\r\n| where type == 'microsoft.advisor/recommendations'\r\n| where properties.category == 'Cost'\r\n| extend\r\n\tresources = tostring(properties.resourceMetadata.resourceId),\r\n\tsavings = todouble(properties.extendedProperties.savingsAmount),\r\n\tsolution = tostring(properties.shortDescription.solution),\r\n\tcurrency = tostring(properties.extendedProperties.savingsCurrency)\r\n| summarize\r\n\tdcount(resources),\r\n\tbin(sum(savings), 0.01)\r\n\tby solution, currency\r\n| project solution, dcount_resources, sum_savings, currency\r\n| order by sum_savings desc\r\n| summarize c = count()\r\n| extend Item = \"Cost\",  Key = 1\r\n\r\n| union\r\n(\r\nAdvisorResources\r\n| where type == 'microsoft.advisor/recommendations'\r\n| where properties.category == 'Security'\r\n| extend\r\n\tresources = tostring(properties.resourceMetadata.resourceId),\r\n\tsavings = todouble(properties.extendedProperties.savingsAmount),\r\n\tsolution = tostring(properties.shortDescription.solution),\r\n\tcurrency = tostring(properties.extendedProperties.savingsCurrency)\r\n| summarize\r\n\tdcount(resources),\r\n\tbin(sum(savings), 0.01)\r\n\tby solution, currency\r\n| project solution, dcount_resources\r\n| summarize c = count()\r\n| extend Item = \"Security\",  Key = 2\r\n)\r\n\r\n| union\r\n\r\n(\r\nAdvisorResources\r\n| where type == 'microsoft.advisor/recommendations'\r\n| where properties.category == 'Performance'\r\n| extend\r\n\tresources = tostring(properties.resourceMetadata.resourceId),\r\n\tsavings = todouble(properties.extendedProperties.savingsAmount),\r\n\tsolution = tostring(properties.shortDescription.solution),\r\n\tcurrency = tostring(properties.extendedProperties.savingsCurrency)\r\n| summarize\r\n\tdcount(resources),\r\n\tbin(sum(savings), 0.01)\r\n\tby solution, currency\r\n| project solution, dcount_resources\r\n| count \r\n| summarize c = count()\r\n| extend Item = \"Performance\",  Key = 3\r\n)",
                                "size": 3,
                                "title": "Azure Advisor Recommendations",
                                "exportParameterName": "b2",
                                "exportDefaultValue": "cost",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "piechart",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Item"
                                  },
                                  "leftContent": {
                                    "columnMatch": "c",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    }
                                  },
                                  "showBorder": true,
                                  "size": "auto"
                                }
                              },
                              "customWidth": "50",
                              "name": "Cost Recommendations",
                              "styleSettings": {
                                "margin": "10px"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "AdvisorResources\r\n| where type == 'microsoft.advisor/recommendations'\r\n| extend\r\n\tresources = tostring(properties.resourceMetadata.resourceId),\r\n\tsavings = todouble(properties.extendedProperties.savingsAmount),\r\n\tsolution = tostring(properties.shortDescription.solution),\r\n\tcurrency = tostring(properties.extendedProperties.savingsCurrency)\r\n| summarize\r\n\tdcount(resources),\r\n\tbin(sum(savings), 0.01)\r\n\tby solution, currency\r\n| project solution, dcount_resources\r\n\r\n| summarize c = count()\r\n| extend Item = \"Distinct Recommendations\",  Key = 1",
                                "size": 3,
                                "title": "Distinct Recommendations",
                                "exportedParameters": [
                                  {
                                    "parameterName": "button4",
                                    "defaultValue": "distinct"
                                  }
                                ],
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "piechart",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Item"
                                  },
                                  "leftContent": {
                                    "columnMatch": "c",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    }
                                  },
                                  "showBorder": true,
                                  "size": "auto"
                                }
                              },
                              "customWidth": "50",
                              "name": "Distinct Recommendations"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "advisorresources\r\n| where type has \"microsoft\"\r\n| extend type = case(\r\n             \r\n              type == 'microsoft.advisor/recommendations', \"Resources with Recommednations\",\r\n               type == 'microsoft.advisor/suppressions', \"Resources with Suppressions\", \r\n               \r\n            \r\n              strcat(\"Not Translated: \", type))\r\n| summarize count() by type\r\n| where type !has \"Not Translated\"",
                                "size": 4,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "type",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "count_",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": true,
                                  "size": "auto"
                                },
                                "chartSettings": {
                                  "showLegend": true,
                                  "xSettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false
                                      }
                                    }
                                  }
                                }
                              },
                              "name": "query - 4"
                            },
                            {
                              "type": 11,
                              "content": {
                                "version": "LinkItem/1.0",
                                "style": "paragraph",
                                "links": [
                                  {
                                    "id": "fd9ff9e2-7a85-4416-8b2e-225f4f0e1a00",
                                    "cellValue": "button",
                                    "linkTarget": "parameter",
                                    "linkLabel": "Cost Recommendations",
                                    "subTarget": "cost",
                                    "preText": "",
                                    "style": "primary"
                                  },
                                  {
                                    "id": "75c270e7-d92c-4b41-ac30-dbd12c4831b8",
                                    "cellValue": "button",
                                    "linkTarget": "parameter",
                                    "linkLabel": "Security Recommendations",
                                    "subTarget": "security",
                                    "style": "primary"
                                  },
                                  {
                                    "id": "c69ac99b-d363-4634-94d8-c3e5494e3151",
                                    "cellValue": "button",
                                    "linkTarget": "parameter",
                                    "linkLabel": "Performance Recommendations",
                                    "subTarget": "performance",
                                    "style": "primary"
                                  },
                                  {
                                    "id": "410b2423-d1e7-42c3-b853-e6cf5b9782fc",
                                    "cellValue": "button",
                                    "linkTarget": "parameter",
                                    "linkLabel": "Distinct Recommendations",
                                    "subTarget": "distinct",
                                    "style": "primary"
                                  }
                                ]
                              },
                              "name": "links - 10"
                            },
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "List of Cost Recommendations with count of Resources and USD Cost Saving",
                                      "style": "warning"
                                    },
                                    "name": "text - 2"
                                  },
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "AdvisorResources\r\n| where type == 'microsoft.advisor/recommendations'\r\n| where properties.category == 'Cost'\r\n| extend\r\n\tresources = tostring(properties.resourceMetadata.resourceId),\r\n\tsavings = todouble(properties.extendedProperties.savingsAmount),\r\n\tsolution = tostring(properties.shortDescription.solution),\r\n\tcurrency = tostring(properties.extendedProperties.savingsCurrency)\r\n| summarize\r\n\tdcount(resources),\r\n\tbin(sum(savings), 0.01)\r\n\tby solution, currency\r\n| project solution, dcount_resources, sum_savings, currency\r\n| order by sum_savings desc\r\n",
                                      "size": 3,
                                      "queryType": 1,
                                      "resourceType": "microsoft.resourcegraph/resources",
                                      "crossComponentResources": [
                                        "{Subscription}"
                                      ],
                                      "visualization": "tiles",
                                      "tileSettings": {
                                        "titleContent": {
                                          "columnMatch": "solution",
                                          "formatter": 1
                                        },
                                        "subtitleContent": {
                                          "columnMatch": "dcount_resources",
                                          "formatter": 18,
                                          "formatOptions": {
                                            "thresholdsOptions": "icons",
                                            "thresholdsGrid": [
                                              {
                                                "operator": "Default",
                                                "thresholdValue": null,
                                                "representation": "resource",
                                                "text": "{0}{1}"
                                              }
                                            ],
                                            "compositeBarSettings": {
                                              "labelText": "",
                                              "columnSettings": []
                                            }
                                          }
                                        },
                                        "leftContent": {
                                          "columnMatch": "sum_savings",
                                          "formatter": 18,
                                          "formatOptions": {
                                            "thresholdsOptions": "icons",
                                            "thresholdsGrid": [
                                              {
                                                "operator": "Default",
                                                "thresholdValue": null,
                                                "representation": "Save",
                                                "text": "{0}{1}"
                                              }
                                            ]
                                          },
                                          "numberFormat": {
                                            "unit": 17,
                                            "options": {
                                              "style": "decimal",
                                              "maximumFractionDigits": 2,
                                              "maximumSignificantDigits": 3
                                            }
                                          }
                                        },
                                        "rightContent": {
                                          "columnMatch": "currency",
                                          "formatter": 12,
                                          "formatOptions": {
                                            "palette": "blue"
                                          }
                                        },
                                        "showBorder": true,
                                        "size": "full"
                                      }
                                    },
                                    "name": "List of Cost Saving Recommendations"
                                  }
                                ]
                              },
                              "conditionalVisibility": {
                                "parameterName": "button",
                                "comparison": "isEqualTo",
                                "value": "cost"
                              },
                              "name": "Advisor Cost Recommendations"
                            },
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "List of Security Recommendations",
                                      "style": "warning"
                                    },
                                    "name": "text - 2"
                                  },
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "AdvisorResources\r\n| where type == 'microsoft.advisor/recommendations'\r\n| where properties.category == 'Security'\r\n| extend\r\n\tresources = tostring(properties.resourceMetadata.resourceId),\r\n\tsavings = todouble(properties.extendedProperties.savingsAmount),\r\n\tsolution = tostring(properties.shortDescription.solution),\r\n\tcurrency = tostring(properties.extendedProperties.savingsCurrency)\r\n| summarize\r\n\tdcount(resources),\r\n\tbin(sum(savings), 0.01)\r\n\tby solution, currency\r\n| project solution, dcount_resources",
                                      "size": 3,
                                      "queryType": 1,
                                      "resourceType": "microsoft.resourcegraph/resources",
                                      "crossComponentResources": [
                                        "{Subscription}"
                                      ],
                                      "visualization": "tiles",
                                      "tileSettings": {
                                        "titleContent": {
                                          "columnMatch": "solution",
                                          "formatter": 1
                                        },
                                        "leftContent": {
                                          "columnMatch": "dcount_resources",
                                          "formatter": 12,
                                          "formatOptions": {
                                            "palette": "auto"
                                          },
                                          "numberFormat": {
                                            "unit": 17,
                                            "options": {
                                              "maximumSignificantDigits": 3,
                                              "maximumFractionDigits": 2
                                            }
                                          }
                                        },
                                        "showBorder": true,
                                        "size": "full"
                                      }
                                    },
                                    "name": "List of Orphan Availability Set"
                                  }
                                ]
                              },
                              "conditionalVisibility": {
                                "parameterName": "button",
                                "comparison": "isEqualTo",
                                "value": "security"
                              },
                              "name": "Advisor Security Recommendations"
                            },
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "List of Performance Recommendations",
                                      "style": "warning"
                                    },
                                    "name": "text - 2"
                                  },
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "AdvisorResources\r\n| where type == 'microsoft.advisor/recommendations'\r\n| where properties.category == 'Performance'\r\n| extend\r\n\tresources = tostring(properties.resourceMetadata.resourceId),\r\n\tsavings = todouble(properties.extendedProperties.savingsAmount),\r\n\tsolution = tostring(properties.shortDescription.solution),\r\n\tcurrency = tostring(properties.extendedProperties.savingsCurrency)\r\n| summarize\r\n\tdcount(resources),\r\n\tbin(sum(savings), 0.01)\r\n\tby solution, currency\r\n| project solution, dcount_resources",
                                      "size": 3,
                                      "queryType": 1,
                                      "resourceType": "microsoft.resourcegraph/resources",
                                      "crossComponentResources": [
                                        "{Subscription}"
                                      ],
                                      "visualization": "tiles",
                                      "tileSettings": {
                                        "titleContent": {
                                          "columnMatch": "solution",
                                          "formatter": 1
                                        },
                                        "leftContent": {
                                          "columnMatch": "dcount_resources",
                                          "formatter": 12,
                                          "formatOptions": {
                                            "palette": "auto"
                                          },
                                          "numberFormat": {
                                            "unit": 17,
                                            "options": {
                                              "maximumSignificantDigits": 3,
                                              "maximumFractionDigits": 2
                                            }
                                          }
                                        },
                                        "showBorder": true,
                                        "size": "full"
                                      }
                                    },
                                    "name": "List of Performance Recommendations"
                                  }
                                ]
                              },
                              "conditionalVisibility": {
                                "parameterName": "button",
                                "comparison": "isEqualTo",
                                "value": "performance"
                              },
                              "name": "Advisor Performance Recommendations"
                            },
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "List of Distinct Recommendations & Count of Resources",
                                      "style": "warning"
                                    },
                                    "name": "text - 2"
                                  },
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "AdvisorResources\r\n| where type == 'microsoft.advisor/recommendations'\r\n| extend\r\n\tresources = tostring(properties.resourceMetadata.resourceId),\r\n\tsavings = todouble(properties.extendedProperties.savingsAmount),\r\n\tsolution = tostring(properties.shortDescription.solution),\r\n\tcurrency = tostring(properties.extendedProperties.savingsCurrency)\r\n| summarize\r\n\tdcount(resources),\r\n\tbin(sum(savings), 0.01)\r\n\tby solution, currency\r\n| project solution, dcount_resources\r\n\r\n",
                                      "size": 3,
                                      "queryType": 1,
                                      "resourceType": "microsoft.resourcegraph/resources",
                                      "crossComponentResources": [
                                        "{Subscription}"
                                      ],
                                      "visualization": "tiles",
                                      "tileSettings": {
                                        "titleContent": {
                                          "columnMatch": "solution",
                                          "formatter": 1
                                        },
                                        "leftContent": {
                                          "columnMatch": "dcount_resources",
                                          "formatter": 12,
                                          "formatOptions": {
                                            "palette": "auto"
                                          },
                                          "numberFormat": {
                                            "unit": 17,
                                            "options": {
                                              "maximumSignificantDigits": 3,
                                              "maximumFractionDigits": 2
                                            }
                                          }
                                        },
                                        "showBorder": true,
                                        "size": "full"
                                      }
                                    },
                                    "name": "List of Performance Recommendations"
                                  }
                                ]
                              },
                              "conditionalVisibility": {
                                "parameterName": "button",
                                "comparison": "isEqualTo",
                                "value": "distinct"
                              },
                              "name": "Advisor Distinct Recommendation"
                            }
                          ]
                        },
                        "name": "Advisor Recommendations"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "submenu",
                    "comparison": "isEqualTo",
                    "value": "ourrecommendations"
                  },
                  "name": "Our Recommendations"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedoption",
              "comparison": "isEqualTo",
              "value": "gorvernance"
            },
            "name": "Governance Dashboard"
          }
        ]
      },
      "name": "Dashboard"
    },
    {
      "type": 1,
      "content": {
        "json": "Azure Monitor Dashboard (Version 1.0 - August 2022)  -- Designed & Developed by Capgemini Cloud Operation Services",
        "style": "success"
      },
      "name": "Footer",
      "styleSettings": {
        "showBorder": true
      }
    }
  ],
  "fallbackResourceIds": [
    "azure monitor"
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}